<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-001</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-001</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-001">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d35b7d109c8f2daedd3c23bbe29a99c285d1dfa18f87abfe9e20cb59db3d9b68ae02fb13aa467bc57e633dd411a95a7de184e988308db2e6885ecedbaa4047e9256f71ee7c1958510d2643b987e301648d60fb71d6db50202da5a8e3d2d2f6b5af02ffbe1e7cd072ab523832b0dcd0a965dfafbe6d6b8d8aa467f4dc7eea5fa73c8850e47081d6c3cab2a0c9969b1b07751160aa42de121b6a54e4ed29a636957bfacd240f783a319a958cb90cd4c37bf807aad8297dca6ab5c9f8eeea5bb1f4abddb04b6cb5592e1ec7d9b8f223e553f0adda3957892841bb010f4fb970f2540cc4f5eb00e38d6fe68f243b112effaa840d3431be71c157043d0ef191e592bc9826e42940eee4792bc1e64fdcf523f13daa6c526483a82fa6200519d07f0b464840e55b76cbc8213b9e88b7a0eb82a191f2865fe49d60166aead8bb3ecf8284c9bc2410330133cc2d56db8d3d713e102c85c11932b273229966e997c4059e292c261c5a03bb9a0f5b722663e30034804dc318db7c81497e761fa149bfedd946d5e64c3aec15510b1b6dc7e70596ba75e789c4ef0ab0e4d3cd3c5b6f55701e73e84c8d8374299e42ec614acfbb3b3797ce775abfc17d63852c0c806db0c99ae93cf2be50ec58f836246032e29bb47d81d498786fb1eaae31ea73b7581451c9d91be4b8c4f72b727117f93c28328e2853c5d8c0b0a56d177335a1b233fbf062f143092fec171c106792685ad7df8d4a5c6fcacdacd51f4e714ad07e37e817080094426ffac2e0e777ae657393ee353d2055e858a81adac6c31ca0658974d8fc8ba28df6c62a23156f1c6f61f9c3704531d4d0b7e12e59720be844d82786671e33ed07777ab77e953a918b84c586f69b16713c825eb1b86f89146d4a6fa4a53e1dd8261a49b1699509f0bac4c3ed332132e84bf04e31b11a8cb5f689ff601eaa5b075c98c5da155c9ce490af0f3a40995ecee2d855358be78c071129cfe6f2b77fb1c11c341420b9e8acbbb52b6d3e13ae38d45c733b5ca498a120b5f44eaf0cac862d08251e17dfb9059edad0234ee10d0062f750f2ca112b6b82366d956f6f026053d3a447c7b04da894828dd18f73e7780142225db241a2087fa4d1c0bbe350c4ae9b118e8f6f122d311c92e477865132180516f78e2cca21ebf5a5a88d29d34729f4212a0a1dba4d611925e1355a37d8c70c2bb40d1a9c4acb9394b54214598d89a21cbe73e76ca967f8c56a5d1f5be723d7297eac131c978024d88d2b5e26c563e2caeea60287b5cc8c315f4f0cc57c946cd60ff72f53e2d2258f3ae718aaca4c2ac5f6fd8113d3b50047a260c4d17b13f612d2f5fc44ce7bc05e882631db5146338a51cc22aa3a89b360ecef093f7c50d0117958b04307055de0dd27b2ca65a64b208f1d685a8a193bcf4f23df28226990c3e864e69ec12dc6af48e7f44959bbc05f1d108cd865dc69fd21b801e56d687fcc99f246bebdf7370f6b99bc2f929af5f8d8f39436b0f4194175885323844585046a6711be38b1d3893a6b8f0ebd8ecffc404b92326cf91e74a310041825c67f5eb4c5501a5d64ba13c1214f544105cd6814326118a26540b454135d652f0744a9cb7a9ece346bee3437e92d436787456fc5f3f969a5e6e40e28bee604cfaa96c6cebdf3af07f3a41f19c4cec58faec6997d3ee6b1ee1b43c883dc1cc73e0011fed8e4926af46eb479d506c983f2578fdfd4300ed39ef6da973eb8f460fcd74236003eee10b4cc664d497c923d6af72458397ac03754405f41da160ea61bc9ef913416eb6fee4490ef81454c86086b47ecce3550844ea9d026ca397fc7d2abcc1a2f82dd5066959e725a5637bcb1663ef0b1ba1222de6b68b2322ca635f557a097e0841013ddc01258596bc3c7d55c622b9eee092608bc95caa37a6e528ad5af6270ddad9224b0df10a8321b0dc511c9f6b374138692a8ba9db0d53cc763efe903759464bcc7e5f0740d2e66c1f91004badc19ad41897547854e910415a70bfea367554f6a2ea473d89554286ac1e05ea4a22fef7d496ece4deff093aa52dc51beff87af0bd90bcebf55c95b8ad2009b28759ad1b23fa692683757d67e8c9e57687837bdb83a6be1b13d53d1a7ba8d3d27a0b62af74563e6391130754a6eb1ac8463639bb3e839fe54093d01dd9676282c82c6786c1e8207cac2588340b2d269f3486fbc9f06fa2a379138d7927624da3aa449335608a4e0136fc8bcbea7bb575350f156ebc2577a66967d9ce6a973bb8fc89dd718d3d024f4f706156a23fd165d9143541c7866ee05985da6160ecc67b307dcc3da4c472c95cca44dc7168d928878aeb988486b5a3e01218d21fc435f75c6483ec4c336c05200f8c8bb9305fc5b34146d8c99e3619b67161c40bbcee7aaacb3c6b308bdd47d442add4b221139d972624af0703137f60ee59f87b8f179ad54008aec1f6502a349880868017a978d50e7bf248978b660058be3f5845b7aaa768d8e89a2b21fd19682eeb1cfe12f5af165c9dcf256d057038f7cf73360d760c1834b741631916341ef4178e31534475c23312f0453b5ca94f0b58591ff202214ea043b735e67665980de0cb78ff3304ee63b14079418623b9c48a41d4ed8b3df4ea03db8523c13111a65208b85ea7fcf410b2e7a48318b4a3b2ccdf650a05dbe7c06e0cb3afd31576ea18030a3441f01674d2d7f34852bc48a8fda349d13296b9fc07f349c26ebeb36811f480658cd93168ea47349c41b0f5a1bdc266e6945ee3e7540a4f4c0a17394b1be8030897ede9fa5f0994a91cb8c6ef3733e4d26d41ebeb5a2cbc7188225fdcdd3cc6ee991cb8faf6967fef36a3e5b8dd647f504497aac0439e615527f1ceca0048808e41a8c274ca73d2aefa18f4020b8e22c18b9a377351356ff6c6fb4b61140c2bead682e84a92cb2573a118a81d386d6f6d46cb84490371025f2003c9b7ddae2df5441d58b64da2697c21c73967e32a80a8e97a5e4ab18dba8057a77e7a152f095a2d11b55e5d7a5a2842531999334c5eb797c68d215c06f3c295d10dd00ec4ce097cf68d994553b313783f92b263a8721e1c2d54698e59647432a683a805d6c8023813659ab14ecfcfc9fbbfa9aa84faecb5f58e3e6c7163c310c41963edb3a2e95c1ae1a807fbb78067a1aeb17a30f5fa3e04e98b614efe255cdef6a0b240fcb18b1fd3c1be2bca070cf7b90d4449e7ca2aa58984464839d32ca74004d856e407d317745adb3dc982ea3ad8853fe3e8726d6e58855c689079e9b658d8a42c32dc89f522ce97175425f424ced5f0aab9a4a1d2c1c1c187e852ad167f82ad1aa923289d41bbaaa39ee0575f3cbbd39278308974b17ccde5ce3240fd0400ae83e6eab7d2dfb622f7492362760ea207d19821635b851862dd2c1a61681c2df4503f201dcf972cf79b9ac9ba8e29ddf2527f1883bd9d649a1114c9ecda30d5f108fc60a662e890de9cc2e4378e1b7c19e9b352fa326b1c6e27146121b870a20fa7a610ef3c62477db3e90c36f623492b845c72953af97c14d2ea9385bfed30df96f99946a3cc5ac67a428871f2fa966de80b8de1363ca469e52d87d6ea0f6c0f54b1465e31ca355d78245228a962e5dd9f9dac8eb8d9f3991aa7694f9c65962c1d28aa2205add2215f673e5df5df2ad058b4d9f2b4b5115d2fe384917de5c08cacd0e892b6b62c7b1d049749eba0adfecfa2c416d08069ace537d36dc9a0a6d4d97ac76ae451aad4a815a86788c6c641f45d2824369d66c425af946da1f07e16c0e57a70cf2e33277a9b9c3c2f577ddbbaf79a5116347869c0bc00a9248ba93350d23cc6fa0f2698ed1b6c902596d5eb4c9674a4f94bd38a5e4a6f7b87e86041bdae7c5e543c4f760e9c34eb00bab1b7d4e221c0fb53c5b7872648cdf6b97dbcf6ade2947a45569a7e02b421a9e9b12636c9c88e244eacc6c8dedf1811f7f64a1a499fae261d9b00c1abd39a5549a4d000b0a69589900f420680bffd949808ec9fa0fccdf9a068d0bf6431a2354b2d92a93cd34b0ecfb56f573fc080acfc0a72bf86bbf8dcc45a0544629bb9dd6ecab707040d77bbc29d62462a87b563c3659ee3a86b53f97798a80c3eb1c74ce12221609e24ef941e4902c23ea3c6ba6c5ff459113274108fa55daaa2dd5a0d8dded43b84c96907036e72f9e22f98ff8c0ef9b745f0867e0a3b21871963f20d32dafd3689dc6efaccec005b11dae85569d67b5866d760363842dfe789a77b4d686b91c934540df6debefafcad6e0bc13cb8a8ac4e553ead11a8fbc228f7fd4d31abe8c0db02f2fc373bc5ecc890dfaff6323719a636e06d7a30bf6edcc5d00e22a687180ed687c5c649ba461c9088e77ecf2017070c310709cebdeae23f950c6bea3b76d32c1d029b0e39749f09f7fa620992c5b68d30938112e4e89b6bdc577965a439f3de8c737b6d4479ef12f52da81466006318551839a8594c1d7243cbd489ccc29046d723b6251d1d8b0a81fbc1416c339465d265ac106aa0c4b53276e3152c14ae49225a4912fef656d6779f1e56fef35037cddafee36ef4d40303e0773a275c6509480d3f6806626cdf696fd3aa1a5a019310150284bd1d285bcf954a07becd4a1359530c2ebd0d59a50c1d25b3e5200759ce57a7ba13a70e14c938c6f7f7e43822921980d51a75db3c2cb3ebcef9e7f09431a95069a4600f66b6e60ba7e741de0335bb4f5c3a9df94f37c7b40a1b8a0618735c9809bf97831c221ef424c9ba4641210237d1e3723c221932656f8054e1952224bc51f1e17715ca6090e8854c0e66191aefa1743094c6f284889ecbcf614aa14063cc90589af44c753bf5de7481d5f43693dfcbc2fde3749f065d8179b7a71a183571633214d6775e961abf87a0b3be6204714ceb095705f313dc9f1e9e7ce2a3f01544512e34e54fa3fd24146d0a5b7b418737bf4d4a5bf07026fabf977feb0c0be070ec62ded80f2b5cf9b01d70af4bed723163fd1088d90be13bb34f60101944c9f76e7edc4a4ee3b4fd735d54becb5dfc6626ecbccfc498eba05dcd6e09f5a5a0149fab10b572e3925ea3faaf9f6f1760f965122f3d3e492e03efd142b1e485602e58346efd7733a01732f2171c377be61f81b53b5c77ade1f1ee2ca28aeeed5e4277d083e512c932881b6a12e5fc7b2b2409202eca5bd4668947f911ceb809f9d5f65ee2f6965f8f18eb6e4ef944aa84f3fcd9a9c48feb18c57eee2214a1a616de28750d98c3d2d74c7731be52f8536494baca104dcb108cce33d979be53a93cedd733575c17ca36a9b9370b4111f84b6aeba84c2d08bcec295e747fd02511d576bebbdd8a6ff41b07f30f4349c8e6e1eb7a23d002c3ab915c12df66019ac0030a13e0728025f13fd5eaafb0e056949c94b525be07d15055762c607c71066df829505aba907ca85c35e89d3c8ad1922054ddb79e6f89730d00a74ad7281269c0e09a435472a737d43b5583570f4f92cedecea0a81daa78c769ded66949ff923380eb770c87d5cf72ffd11d75d37c9d65ba3321ced249d85b42550bc2a4e8ec5181ce4d53bc3232505404ea19d2efe112d94c21e38652a8ce4a6f3e010db4b00788416d709cc004f95504a5f6b53c208af5c64e691bc5b110a3d5cb090a39e35b135167305bb8a260e7409f67ca0a26b963fc885f42481ba9b57e6180eb6292289992e8fc0ccd34e5f86dd92bc19a614ea7b77fdb426fa1b43367c9d6d50877e752c21c9531c6c6773f02e43554e10c2ac36457e3e4efcff61e39f1d9c98df522580f6009c3233c1c823beceee5ea1e8c9bb380a606b717647fd22b56fcf2ed14de98d651cc90df31a1ba7a867c656827435689a4440b8108f1f119d3a4b4f10405f086610042856196ec5f03c6153303f8e2dace7b3fa2869493b9c9bdffb51e52ab4cdadb823e349de271647e2b0bf853d7a3f54710d8fe59168b7f5223f0f4fff80e9e9995a4daf18eea6bf73805cf14b4a0c8f0bbdb5955c3c2fc47632ee0b112ac19a6b5ca3a0dc48b00f1cef122cfb16de648c675d3a164dc96c69855616ba4705f5917720e66a24a8d4011fbb50c960b32ff3ef75598cb73718a78b9fa5e15cf938c23ff02f54483e7a31a946ba2d178625f49d3226c10294c9fac0e9ee0ae60f9c5d40cfb8ddceb8774ad64691720b773a821044fd3827ad93de18402e2576cc3a674a8363cda4e90e9eb494c64e3d1238abd08adf6b6ee888948a32512602981cab01ffa860420199a308ac8f04469943b89ec50e9ea840ab426a32519de00dc33d98844ada2b85523505551c096940c54abe152aa8492e597a1fe40d44a72576525114e2d5a63969641271db0fb4955ac7bea2fb491b2f3b36215ed26dc9d68fc9ed24419dc4d1b24bfc6c1ab446982dbbb03b170d9a6fef8220319d999a528edc9480194944e4381268b765d4ab537833a08c2666e0c6a0c78211da34ae7b2391e9eef2b402dab8ea51235a0611e343f2ca4b7ad1a9ca927973091966fd03a9ab1c5a0e794e75f61de54ccdc71d6727a23767a9ca648f5f29cc51d12d1c0e7ac0559d89c1eaf7b8d77a5cdf90c725d42b2c6acf79ea86fc07a2bb8ec68ad92d14c0a0507b117088efc4e587a259383742cdcc894801fd34f8dc517e001cba5d234eb1f240fc25094cfcbbe0b6ce94ec7478bd0c5c836b09ad8d94ffaf805a3d1b8057ebd303091b27788d0311f5bf5747d818b1389540238b09cf8a990b61052474712136d23e843a5b01ef7584ee57e66e2b6b89fd6d527cfe67f2cca81ca74ea3dce4445b510e1b1dca2331aa83b643717f22161fd82907b04fc8cc69896672cb85973359a7d68b28b4c85f3d13f04fa57539b3d87ce6b5a708bc2bb981e6132f205f3c689a467b785637d3d2e23365bdefb6de41e928ecd5159baa2161db8cbd1376dc5410b3b2cd167f9d77d74604fffa26dca012b9c0cd7883ecab5c6b96b9fccf2c95608d0685b474cc8d37d45e0180a63b636a5f9d77d988cdde2a6befdcea5b598b4c09c33b003564fdc8c5559f65716857374606ec2410a81ff6feccfcca0b8537db4e19b0615171f27fdef730402084cc8aad80ca5d23c1ed4c674ab80d3518b11666dc4c71d90ee06e844bef155a8a3dad27f757c45a474a838b8bfa5f12234319c611a2b4595fb638d33fa47494712de3cbec29ba1ce42019cfb304ba42f0c6aa2ba9efec6c67e76e552b88164881775b49b4365e96db9c61852751df6c23d27adee545f49f7b1589fbcd459794516c1ca802a1ba9e7ff0371a9d539c5005a711529044b1cae7006ef782bdc02d3098d66a438795d02bc0d1f49e93c5077abb2d0e136417503d11bec10f29abd4fcc47574d9d502c09e924e2d87a64f4c96f29c51dac4871505da9e3a29dec77198cac2924e365a6bd38c547e6d8c7332476a842d8e1ba545f159a68af868cc9e8c7197b6ec337cccc9b1b9d7fb75588e5d06a48a366ae812fa6bd8babb07eb0e803b0d680d202153ea65687bd691c255a50f298d396bcc904f607830b30a26c9c4595db0b8d41251e32c37844f13d6089d0407c2f1fb56cd600163815b9364e7fb5c4f11689803b12ffba1719be5308ff504c6a2b5e95c43c2e610dac8f48cb8b3d04b5ffcca27ed778f34ac45deac073893cb75f66aebf6abc959fadfc976876e870d640a4bae2a0a362803ef6b1cadb7735884813a5384b0af0176fd06756e88585298e2e6368cebfaa315c0baefe70f16574bdbb09bd61e73be051c39de64c880bde2884156dc010286e3c7bea7ab1059b9a545c65ff83fccd47af38da126e58d7e78410a019caaf02852dd330bd702a974cc00cba65fea9f5b5dd9daccd989b4972d6d0c020e88eb78ebbdd8628202a887053541e99f37433f05a778f3e37857a354c61434ff779a92c03688cf19e038c59b7cd67085af555207d5235e0795184f59f40c7c453cd84b94824e09a631ae1fa18ee85e7fcb45c35dcc1663adbb71f2325d36855d2518364584480327fcfc736458e8443744c8c2c38dfe3c0bb434212915a805f35736f24940a6f3d8c33319cd1c4fb4133c0f5de0c8561e26cb8debfc8e9023f2632e1563c55958241723be1fffafb054ee2902b220a9fd31e6b9d4d223eb9e7adc6b61fcb9c7f0e6b3ba06c738f77beb2588052e48c81fb6dbddd13797403f4b71a3204c7627fca30dee69d05618548da4c082d18ccebce1bd592ed1ddf56a7c9a84dc2dc33c322855d993d207ee5f1247093a44ce3e9e99237f2b4583c77874a69b764c0abba1e1d3c55aac9f514168938feccd54aa61e30c9aa41caeefd9e9fc4bdb9d3e4e41a55926e9ec85a1aaf39e813747a486dee444d1adac89982ee4f5d719673929ed813ef73118c180a92f05eb47a875dfce101a5d48d03ad6ccd1a1c99109888c4b2a4910dbce31da7c43f951ba21b19d0b603437989a4865394af6fffdcc45a769189aeb9b439e47e2d133fe38a9528d88194b066b78229755782c4871777164545bc1099366e4c525d1a0dbc3c1c17207bd99918a59b03969e0447744773c986797e9ad35ae4bb4f9770d1cfa70723738f83b39f2a8ccbbde76c738b1d3baabeb25d0f66c4617d20fc6169365ff58d07a0828767140106d924fad6d5fe78ccecfed66d669264a72e0883b30e9f0142db14c6d9a9226f1267239dfeed9cb0beedd7c03cd1db065664c1199d11fccc7055e71d078b188f720da2f830f0c4aeecb74c5528febf035bdf9c6d1a403ef42b98d1f2e182947c2c6a9c71d0bb34646ecd751daa5550fe474247f76d4f7c112e0d1ea0e5230c84a7be5d4fc49aa8893f019fc0e6b970b7fd5ca9905f7f0a4a482c237b65ae2dae4c96d668a4ccdb1d6b620c5bcb6a2ef054e7e8d156cf77b441ca4f49df7198b44e4d3da32f09c77d4defaede4c47f082b321e3ed5411b7a86c45fd465d4b2a7ab7301eb3e182663ca5effbd7ec74e6eaf33c8ede5bdf6f2485d53c6af56a18ada23f46839090cbef13fc0adfb5647669c0272b1ac17b1af30fbf685954217b9ba92702f12893b731efdc677e9ff928cf368cbe61f0d8c6051e812fe0e6ac364a4f182a395608265f73147beb46f7853d6703b0def227f18bd78b146bd9225424fe6076b5b39cd811fa1fe020ba19b0cb1fefdb987e47112d0e66fbfbd5c519bd49d3a2b250d5ad949c45a6276354537ed980bfa35de5eba64a30ac97c4d8deff49704467ee93772c09c21c38017b30d0b07d300a29c95aec19ced8f98970b7db4efff2d5d7396bcf00fd878dabfbc0e41610d58d5b1f55a8847f84b40056d032651cfc45e346433239c7e5de52ad77b755a73d7d954cbd6ec75db258e43b2697d1b648a6c3b42c73bd722a8cb0e17b3e27e0a3c0abdfc8f4f50529b3a18958f35f67f6c4f6134f0ba62273427d9c4d3b04ddf579be71940bf6ddcdccec0ba1e89a2c92bf64aef4c49f75fd2c25a7427a28d3dbcd8ab37c0f7e8231ff6467df278327b47d596377e43e6563023246c6e17673414cff27cd958974b26cc8c78cc8856b0c973220eafe766d33e805ed816b1ef4b5d0ca42226c17b96b3b0e7a331d91dad9e05b74149acc8de9be1f3eebd573f0fd0fc44b82f02f628dc16739845b620f8a5146395166e87050a4d0966b1ac721353d34fd2fee17a66b9dc97a8fcd7765e42cffcf11ac6cf72c95a9857a62200280c83f25bc7df754627a9b21bed1e764a3dc10c8255a622fdaac17e34eee6706e8d95726787ed3d26e132166431f05bcef3ddc8471dbf6d60efaa8b85bf3a9be3f0f3829d30f11369a20d5adb77ad755b8f99a5ffd7a0000c183ed1b769a9a7dc61513e84df0c307a506622553182b79d0b116ecd1c8abec06d60d3160b79f49cb4b6ea92b4aeec4da26be092141ba35a7a48247a51483ecbc33b562926c4fa99977b91776ca54bc5f9faad080018b059d7f65d08c246a69cc2e1a180674a0fea1464e1dda9fb88921904d5d5e597d983b5344b2439d02e60613e8d623d0598f2d33b57ecc2ff5fc561d9f13217c8f28d939d83d939f27bb23daca45891f63e012c627e516aefc4ca0500755227dae9913a4dbaf5f2c360911859dfa738e2d77de6e3b789e5ba845f464d60ee566e51d1e98d5f44d2c567e5f7f84b25a6dbc630ece02a82d286365c6884b90e62ba62eba2c58dc5b78da2fd2cf4b1672479af6c1d5e0c4b029224c685bd8c5a18ba549058a5485248e4896a893aac07cad7334155fc47c169a256f4b2f379eefe0cab43fbb1799c2492c5216f330d73dadf7971a016edac7a07e765b415a7ec3021044684cd5034d2cc6483eca1d591d457ce44edd8466365a4d0238c3cb5d343abe40de788ccd5ac823e69a0767a5695d239a26bfface55c56f338f3044bcec04271f3d405afc30a1d8476d15ec7257a41517007179a3b2751ac09d006bda6e460b8145d962322afccaecc2832ff5d33672b62b81c4705fe363a2fc4df4a5994a96bca2ef579c83889e4dec88fb0cc8302f878eb2cf78249ccde7cf93add5d626dca89eb37a796550c1f91051d179eac9e479ef0df26cf77ec5a23f6063b46178fd30b6ecf75f6680ea5f59323888001bbbc5186c6e74213fad75bfd6c1fc418196dc7bddf1a903f7eebdf1ecf48de66f6bb4cc35f8034b491d95d9e08a291a4fddaa85ca72581d8d01d1b70bf4df5d696414d41e0855cbfc5a2a9adbef16cd2b7fc8e0773757cc8119594ba7423917966e466a0e2b1b686d31430d751a0d51e9358d50784acf3b3101cc76564f96564c3cc67ccce61992a88ccfb50a75588768082de71c87c8e285b864ce8a172d991eb20ddaecfd42c57be6bc22da8034f66ddad8fcb7771a8a6f664e31347570593fdbb2bcd6c7dde905a769f38b38f20715171922e7e647a5b9686516b39dfd635012866b3310b713be06843cd65237e640078e7e0487be94d12ff6807c57345e72ccbd4378fdad4315e6cb4e85c91296d0f1352dc9ee278a118e0b6e7884cf9ff35f95226590552f17f0632181f6c8c0c4f3b8a9e2ee24b45572b0fc44b539280ca7770e8359ca63cd12ddfbda1cb17a68c5f86248b5c2e04400469e80f334eb714625fa26f9d3f7ab97e9133dde3aeb2658a66af785c1bf696e29e25ae694625ecbd98b8c144fd90ca540377d055786829ed686e4846656a8eaa8878c9b81c9f8238c95c4cc673c76a009e1ab1ff056b8f95086f44b465026b718ccbde132f6e630e681d3836072935304c807df4fe3a6f0bbd73afd72a98161327c88d40d06d56affc60f69939d01efc180d163dfa7f888b7977b8f51e989e2156963334604340638c5b7ba93222f62ac45388004290d55cdc3e2d5358d55fefca6ba21e564721ba94e713a34d1d595d21bf40c6506478def20febc65ea53f865d313eb45a304dcbb9e5cedb7612d11810a84f5312d96effeea7c6098711e293e60b88bc903e9ea1da5034fa16e8b435d09fbcb22283449cc6cc68271c44b3394df705b9d16cd11fec553b18f22e6acb3c0eed1adee0677a53eb620cbe90d7faed1e2632cf4d36160a195d7cd40dd110559469b830e923c413fc27b9703fc1ff5617fc6a6fa60cdef38e56fa78de211972abcae5b1deb0756f11d0ba80e43ef5e2b65e0dc66876dfbd188d847978c038751fed6e396787ffa77dcd102b188e80afeb36421a3331633f45e4ec073ed8f9a98ea35ddfe8aa15e7569c2cc9fd182fe141c796c920ccb30ecdc9ca77891bf3bc23384b1262aa114382b89aa08becb041e980725ef1fe170292beb4fef4f68a0360baccac30dccd81a6c4627b2c3b72013aa8f25e11ffa187faee0c24e98bc2ad8acea984bb0628e5e961d3ff53b9d1eefd97c158e0f6e675934bba7647c248fff7170ae0c9c2e5999b3349ba310d4f98e908ebff33a058a0d3e0727d7b14cee11c0e55b7d9230ba0c9f0a72502f36ed4504d3aadc762a850964e2e8718618dec9df64a690175a7cf7c41190eb511fed6d9787ce09470936a0478c12e21fe095f1f13e5885208f9cc48f6737b62d25a9528409046a5edb04e5a6e701149c9e22383472e3ec375f37790900260602b75373440d5bdfcc8fb7ce979ff7c75e59ab9767cf41c873b77001393d5fd528be013ac26f705179778d99104fec8f5daf33fa6c3161e068c2dfe86d37eb50c3a3d4de1917d6866bdbe33734c7c437cbdaf3ac8e9e6b8cda69130e5d4d0ff993b0d89c4e0de1b3e6ee920ec31c3bda7c04351f058ebaf18528ea322612f75e5ea941f332d61fee8b246c0d8dc0734f771cb23303b34d6908cd2d8c74cad14e159a084c15fe00d5f3d71390b3ff3f593b281f03c9b780f2e964cb98dcce91513d211505784ad8a9eb932a97639f936e9f68f72c8f1b30e6b7e29955b4506944c8a4aa9592a516c47cca10f98ec949088b607545fc4043e59eaec7c67b8f50a33fb802f033d5e8921423ba39cb81f1e79e39543f47aff06295c1322275ecb2f63bb79411e7083038290125d69ee2e78b4dc526e4a467836e2b487f08668dc5d41e809250a7b0f7221856b2b90aa9e5f69d8ac904075d3891d396738551837a4624a90d9147f8134b6b3dba268f00e7cf7bb7d3fa0550ebba54730b1594c1af68cc7126e6da7d324edb85cc4b046b76900c9e3c0d6ed68553ca18d81073cd2b0d70e5b3d69b0b881d2f04a3e6480392fa74685792ca22eefea43150d9ab8a3620ed99a74b0376e93dbfa77b43011a0e6caeb89a0d6f3573b36218801b72180edf07dbf30bbbea131eb96e75ca13b7d400db112f66af1a771f9d707261ed25f6577f4c40b9bebc7b2629308ef796ab9ff1931a10715d54ff74460241b925a9d18c59451e4ea29a351327c2786cfa102fe51ac34ef4fdd1dccb14cbb17fd086952583d9930b06941142ce37efbfca3c7d890f55092040f28c62691f40f37b2ce5972a2508805f72992dc85d109f235cbacc12b3663c0db43dfc295866c590b52688705bc145bd049d5b767fca3f8e33247d524adf4cbd96a9ec9038c68b9d56c356572247dc1b7074b5b243e3b03b2e0db6c00b22143f0f927f48cac0643762ee58900e0fb3f2515c5ab2d1a88962984c1a550176b1d6119d5bee9cff858c38030287d32a170e6fcb85ed3be219e76ff7839d710d379f929bb788b965b2415292e111f3d8fdddbf2567cda5d66642a5be38bef357d6d5a6b6b1efc19102ebc86cb45de4d141ad3ea51bbe8437e815be37d2c210096e7ee603acbda3b496659e08c98b20c716a0d315528d74a9b16344fbc69f1a369410f269c19b2817d066e68e75940d3068dbcfc7b8cc2f657c1959e94e8d9ca2390afc9be2f961ba139b519fead8a2895cdd4d7e190d21249633a96c350a71f07a43e94368ae400e00359d3de6a0b2980a4323d529917854d5835e38db78da50bcd5564acda0235756c0d8801514a9b14446c268c358774dfae5a569d7530044d37a2a667c21a579b5d736702d43b887cdbcb925dc19460219ab9616df415f4c2500e34c4ba33c8044e6594b6f24e47eca1714a7137717f57bed20421fac3b37bbf8c91ea3228778d20791fb70e6bae1db1eb46936a5b928b3fdae8692f106e2c5a35f2f2e66425ce74e2e2a2cd0e10b6d2004b97290ce3f70a810ad5db7ffdae4c9d252623ed0c5726a7f37c10b51998e58e85d42e0272d2aa2d335a067b2cdad38faf925d46a608f72014038a9df87e2c4c875c025e5fb1d9bf0d1b7eeb5cbf6247a0ece0f635236cd87e307cff4f12b627c436332da42d6f945ee1f5df4ffd3b92f5018ed5632dab0932f085ea1b57627b9b2e30f5e8e9b637b4729337ff8c0e189b48432acae53b4b0c24042aea761b0eac942804d69ece9985fc4807a7659604f41c23c3543920e0c23dfa5134f9468f734aa2c51ad5222e9e5f87a92b0a378ad3e3b130c540f744ba6b5c45539830b5606164e40ba13d867284e52f1a263dd7c562bb03faff33db2bcc1fc20ba695d4c2c34c6229038d17dab58dfb24dcc68cfba30ca45f96cfc66e7746bf6fd2541ade422de24ea1966e33f872db21844bc4ebb2bf0b5962c6c2e9700243277fbaa349a58bc092150ed3bedad6aa8efb584c343ac15315dec9338409f2f0f56a1419b716b4cf06f2fec8f95c8bbb80a1c4bdbae533bdff7e051feb1d3730066ad751151f2a643adaaf1c3c9262329c893d506ab121f4e9ee9feda02b291445d968de03753d9f312c22947d6f2c8b9873c3e2a5c79b2862404baedb887d3a1cece158552fdc8d828963f0d6ba302bcf47527af4cd36a89343cf6d68a3d22bc71072abdb0b6043e30c0b54fe88fc084425c9df0d40b9980ba57c3bf577a707a7006bed5afe79eb065db527eee138752d195fc567e66711e00ed5d640646801b15f47c37bdad00eacc4d4c6de7b92d7a7e04944d85ebc8ba6450bfe7bdd2685d51c89e232b7694d88161bae381d0911e77c7af0b4a5b5209f7efbb9eaacaeccae68fcf9c2e6697a542f93caca6f842490f1cf1301cb41855a642b73887abfb5930cf4234082d076d79b66e3c6b416940f53378fdc2ab2a97d7873be32a7e64f68b1ebca667c4e1ecab0992f7006a2c282b26843573b9552cbe23f0e206683d370cdcbada228ae66b0e0c0de8339cc537c11f47319a55ccaaa317a6c978c750c0be2b08d1d567da6a1acbb7c56eba91fb73f6fe746d1db63d9651c3aad61aaf23e7357777cd0a85dddf14e5002ca65b32dba6aad74e69c1ad24c49ec02e55b1ac7725ffe76e2f87277811e699527d8d003e3f35bda16cac1565a60a31db3cb3ccd4ef11d34a96a9888887f31223ce3e0e41d335630cabf7032a1a04166c138bf8865fb225441743480e5c0c4300cad2fc0561177965eaf53e1d460d72791cdab687d682f340e305035017bb77f50d51b1e25b207ad44358cfbc73c20b8da17415725be6ecc11e062041cbad6cdca3cfa0e0f50212c144476b8e237aea974a7c79ff383a4cff28cb85a8a55361f85cedab010a67f439910f3d73cf52901676d84400cc01ffe3446f5110fadb42eb1c9be68b4a3699afe33b8ae66fffd9709918de6047625d8faa79c9162db4de350de10238371d7b8c89dbe03f7faa72950dcfe64475f66beddc716fd05e741eba06aee047f68fb64071e8a5cbf8a50719b4e731cef1df131ab7494d7f6f0c0c111496f079a5bd0549d6ba1e3f204db0f1470cecd011f03607ed0e038b7b6e05c733a26a752d74829794ecc09c96c04826e561d03d36e1b1ab2b970d4f0ef48c7a37e1b80476c96079fb0fb5113f2bb9acb3aa56a8986a1f6edb727821e9aadda97a120aa58565ebb2354a2454d9c7ebb56dddb419fe2e0fd11c1c445be83395caac3d24a25fc73b19a77c0205a9aceebde8354879ed370c561202a3db8b655a782a9704f5b50bc09efb6809fe166cd92a04ebbe57312261cca230e77a9d88bbc88a555029598c0743e1259b0c3b1aea34ceb28bde25345ed5f149c8d4a789dc0b76d65b92e8403c9a9815d606ce6c32d56f7f1e25efffaa7556fdc0be36c45232209ba6a05cca49387f2ce6e9711fbc89bc7b93b0f736a18b6b12d75543d0d5be96bc2e2029cecadf5c77575b27f01d9ad280b9deb35cceeed8e3566ee1e44b3554852dd553bd81575bccd4a44a4d2a44ea89486343590854ca31ddd6db367922ecf9439df4b39284591f8fcf9ace1dd31320d856df95f78596e0a23a3fe575f20aa849a23ad7569a9dcf5f3f73b5a9d00ceffc525687facf4711d6ab522b2ddbfd7868084a8968114edf877f428a9b8dfec4cf49ca9fbc8ae5b610be227ecfad4d55e9388b9f8db3b766a5376cc210536d3b1e599cc8579c586997c7fcd6c8f11e55670a0b07cd6add879ffb5672ceea746f9fc83685e29d110cd8e00d722873a2926327c7bbe26fb9d847b6a7fec6acd1b4a9891f33c208bf95da494303b826a2c8ebdfd11b594d436689de3d82b058f3022b20cdd04fb5a4f4cddfc2c9943e497202499f150608e9fe54f5f99da7f0983e0b5a3a49005674a4598d4e322db65b357d9244044a91e2146d850944e18d720e1664ec75f5282cff607a6e09a92f92ebc603ca5af9d6947f634ef3e3d725c53b03140ff8ce74e2a8aa79ff56c7542712920543cbeae68ca22eacc908852018583baa5f670c6599f21b67d792963d6513d8272abf3f7c0ef3ce8c4fd034c7b4391514943bbc924c27763ee16be27f4f66c1f7278b758f3a1315a0c697b4be909e83f13b8791ef82f6692e80fdee82a7c451650ac9f5a4d3bb225ca5db63fb60fe1d220ca3d3b8e09468d6267a74b198abbd459ef259e54ddb07aec2caee6598b825420cd32d0179c4749648f4ceac9aa40858ffcff93844b45e68cac9ecdedf7505f56b39fe1083694830ec977e6ba398f777e4a7703ca48d70a83978b8546d727c29e8e30843dd01374e67b9aa66a45fac552a2bd81a1b85f409a564e934a3152cb68c08ecc9f2abdb14c33cbd9a5d1a6d80598de38fb2eabc7e4c3b219e81ce142003b8b38ae302698ac60b1be369179e74666c3a3137f3d38f9b9233bd3780e12fd75b8f9102d7e939b73516189e3e2d3a0db3e21e5b54e5f9db011c3fe333dc9644e07eca2887341ddd602442a436ca0c28f5b2a1afcb19882d8f9fb4d2594df13b38965a45583716a7740564a4ebd1d6dda9837ab265da47b55263611df810d33e3e4488b045b95f878dc2bbe67f93465ad8e1a0e08b796d219cf41bde4c471b37d13c055235df009c14b6b8cb949f5f3d0d69769a069663f8a2efdbf13a78591ab735cd22a5c44448573e564cd2066d556cfc74a6cd16a29b4bd40f0a23471288c44ce6a9962a5aaa1630ac5305ea889f1deb6645cb3a9e69b4a182e9cae998ad3019f9e72f4a0f3d900aab3a7a8dfdb3134001d8e54c9c6cef8579137389ab403c0a27e79d1e016b6ea34927d61969eab711d73c8f36a5440ec7ca9a40ec460a34c4120be1c2b5020dd3fcdcf305506ba2b2dd6928aaa9b6627ab1248de8af11fa26d62f134765e6ffab1c042da0972b58ecbc8fa6d8176975acd891591c0a365eb8b0e851cd4cc0c2e8d7e97fc37418ae36b78a0e05702104d36a5d34aaa2edc7f90f9674e374d7d78027559667e6514ae702f3731eb4a1de560e9514de9ad01e528e53848a6410132b5f8e7b6f1a3a1562045f8e5f38a9d3771a7a182efdfceae","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"90c03189d912d9b037d9d6b650d6c0d9"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
