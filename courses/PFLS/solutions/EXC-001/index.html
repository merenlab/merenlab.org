<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-001</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-001</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-001">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"5af876376167fdff5e2d0df3f073f1547648e34af46125654a3c2a6f17146083b0e724c077e573f446fe33ae0c48b1f21f3ee62c914b6b212daf315330dea8e5ddac6cafc4bbab263c22c035c81a3adca588039443c0cc38355e747ce65258c295cab3e3e1ed0c5b5e9bb74d1de9aa5d1c9748177f43798f102eadd58ddb92391ca51fe1a9b2fa2d1ae4c76811c2ff94da256176b91f62e4850fb2ad7e12120d0e683cd04d817d1a9c77b45a1fb99d1b44dbca3d671c208c3b786e72d582089010ec82e89096c09719bf623cf5512be1d3aa52b49e7d4c023f9ae02efd3d618453f21c88dc814b3e985e1019bc362e3d178cfd3d558c0641e7ad6a3da5e6a7bb332837de8921c39878ab90b8821eccb0e938dab5ef52fc8e599bec9a9c9ca2046fcf702a4cee1b275aefba5639a613c0e024ae19349aa1dc70401d3e06e8f51f36b705437c38f54cfdb4f4f20cf17a8c5f248949ba5a533a60f4240a0bd404865e17002f2bddfc257a1c77f0764092ab01b46d6ae6d1852975191bf75a85126b7c024ee130e86d69fd01bb012ad3c0f515f9644f94d4d50f5b13c752a225d3379ac6e8a4bfb2579e5d3c75300b50ff4132a72ee1842d9b1aca61d4e5b5a0e57a3fd9801dbea4cde16d46ee440631724108f68aff7b87e02b0c215a6e256257b18556e4682bcc05f8afba05ee4478b21607a24e7f42fdf443490e5a940a652c3090b14399db0812d95ecb3ac2ef7993411aae2cad663aeddedb24ea25cf05d5121e9360cc6428f9f507063d2da69ea72f698ba70de1b978cec4a4a73c504fa708fe8c818746776c6761d6661effb3ab8794e5fb5dab93aee9ffbc2d2e3c395830579baeaae314b01524d488f617bf2eafaf13d6b6455620a2de3a9f0be0b117768b412f89ea5b73e0fc3554542d0c09190770e732e9a68977eee8045f20162108de611853a3926f9969655d27e28b59912914a2e7b4c891a90f9b3dde16bd475ee16c2f2aab331a53117726f0375a44b3fb6cc9c2349ce000eb2bbda472ddf9f85325265b9d164272c50293ec5ef110ba5d6a5d877e2dbe9b2f78e31a20664a8e221eaca5105f44e7b3880d880bb57021f255a5fa887e7ff358fbd38bedc6edd5851d41d99cefdb3d69b90dde2c9df9e4e16fe9ab064f08f9d61a3923d5a7664dd2b0b58c80fd07cf8e712f9dcc5968a611104c9b0df09ba457f26a6aa50ee8f76436898c9cae02c387925d7d768f4a502a992192f4fefbfb266d487042068d098bdbf3118f4517b0c174fd276156762dfc85db5d9d85a5937669b4dead18a13a3371cb3e3cc69845d8fd255454d4bf5f39482fbdd05f5319d2f91b5883730dd33c2b27752058414b247cb023e16ca9bdfe6cc70376714af9f4e543c203ce33b724cf3de3ae2af0f738b868a0942f0a32063fa7780dc4f1601441648ceac133e2e47dc3c326827279ebd9c351d00aae27b07d998a422b48951cde0f9c3ec4e0238df7069bc6127fbbfd455103928653b842fac598e002dbe51e33259fff75a941ca5fc42b7b3923ab4f46dd8fb0eee69c037914fbbdf69fc4508f99eacddd79e3e59b19c7441c30eff40d67a0525582b25fe9c0b14c4ba8a6c9d733c450f0898399cd5cd6574d562146f2e4b955e65ed0151360e6b4627debe589a27656f12bddb791e387155d4740b7a6f41c9d6d5e3af2b2104c3f40eadd76fd38372c60523a8e952d8e2035d2a5fe9692639a0ca6368e08541a6121a44c5ab466bc9aa63af4b4fd35b4aeeeb15e92a438c1a818169469a23d724cae8905e9dd41ffc929f5c4b2644121f49bed7ab8bba082bf8e8ff2f7572c0ad682e8ae22fe1f147d21133b9d3bcacdc471df3dc6d5ecbb0d7ee471958beef648630042c28eba0653e60fffd5f950ffc4781e75c08f64d0f1398d48291f809ee6837468182f199eb5cc1c604d08e14e58bcac4e10bc878565d326a0456a36a39933e615de86119df78fda94e09986c0476c8d195812bfd6cfdeecda87b79f7b727fbfb74b744561cc172365120895b3d3ab4e04f7dbf587154de788e3def9dd23f21f6eb2d52ee20f0cfed57ed605fb456250e85efa74761c5b94d88086b218c12f064bf04f4afb25bad7e1cde38c685718ab5389ebfbc5335ff6fe037dd36564fba2e51dc7b2a527dc270614ce73522acc36a1817e94bc1eab9d27b98b829fc88be89aa8163c88ece27b475f3cb971f2f422367a659347533df816adf8d3a40a9f68c236f87f16c9583abb8f208dcb42f65fb5f7d62425dc7d6b1e874ec1550b900cf1d361e827b3cb26982bed3746483b84e97e6b5d163da819149981c89c655f2ad9aa686d4db7fa13a3abdf1000e0f2475dcef3987aa6254aaa9f97e45a5f7db81e89fd4ace5e981b14536e4ebb73efe365493b28c13bea8b3d24509c2032ccda951eaff2249fc2d7cb079a53aa78fb96f1695611f96dd47d88b6e4a5cf2a47540f3173bb485f32047db56fbcd4a0aca204bfb9251a0329601cc2908e8ae4312ac554aff91f30e0a1616371517d56624fd499fffac72dd674ad24b79fac58ef2c3695e9f37e9b612e51e16cf78320cb2149523abbba49d9c46de1f474c6b0028a60d1c50594ef5458426d49df12d2e5b101fa2b6c0e25de6606cfd5e70258a8e9876cdf0114ee481fd603673f4dbbe16c199f1e999cf725a3ddca456236b145cbca4fdc285a03eaf156b0047197722f2a34a226db0511a2cecc0200f55940952d310ccad7f73bb2fab9bf255818b4537bd73f898729fbca3b4006f49df2427287e8e1dba0a9e72c14fd304d6e98ee615c0606dcb8a7a1f32cddfea2d7a1a4fb6b42fa54147f8ff389e08ac81e8b780c5a743cd50dfa56ffcaa5c672b4576bcdff99abb9395b3d6da1a970fb37b3c79abf1eb53fc8318641e358e34c0fad520cf07445b28b8b8bf62f554a5887debc3806c46c195d6ea0692298c5baa5a7e0f67f71e7195cd0c34796fc028548089d813903f44aeb9f511e400114fd8285aee8d45d8498c210a98a09d9279d38797f9e04d91b753060d234565f8e407d2134f49e48c23351ac9a379158d4d90dc987a87d1dd40837d1124d80f384dfc9a6727ede790c0e9e0985b800963191115c18e0a2bd6a8c17fe33c1772c6cd26cb6c1ae82520937b2948437df09e52d33c87291c9915254a1ac5dd57bf38a17debc8a336ac061f445cb3e5f8429723ca750d8bf3dcfbc4586c4681141a5f660dcfaaf3e796c08c3a79904b386da3d9d71e93dc3dd863eff24278130aaf884d56f5b529d751f3b2470111c176268a01c2cd17e7f7af3951e589a38664e2a85eb255f5138ea8c1ac46a37298617df901077e916ed68628123e8b9c81f599ee5bd33504c3792951739fa9333e450a010f927088cb7b7da74b3ebbd3fee5d70450c68a7372837c87613fd35701ac17a7928cf4d1a21b03053feb11dda73adfb4319a126fb2407099018f372dbf71cbe12411c9139456dde58a39aa10d3c7f25a0ba932f756a16976e70c15e4e3ae2ad6779b17228e3c08e2235fc0dfd8ebef7edfc413d39e6255865d68d824b38d950c3092bdd5bf1ac4ecee65f6da24d2fa013fef2a9caee9dee367fa804f0bec275d31da4eb905c75008ef04f08e3fe81cdb6b7081e7b17cadd19f9390dad96aecf4ba5850a2b642f760e9d5cc178083285838f1b38a01168edce7f41f16515d7a4f882f34b9e6a0497cfb7fa190d385ff5847f6e64c9f45525e1c30045d1c7505d21786c7e5d191d4bf8e112017cf320933b379a4a345b17020af783a16cc0163236f57b7e3b9afbe704883b0fa7404af44431993c07cf6979e6365c91f50e854a458838db9cd6be8dd6bef6d5c629ba1d9260527da156e2adb3a77716e8f90888033c7ec625254b7c4678d199457f818565918425024897a0547f543505443698bb45fc273fd10597728d5a81a3e26c69e84cd775ea9e16be86db4362f177c5d537429a7e027dbc94753932e6ee7d409779465bd2492e8beb8a73b27c21d2c09739afeed43df0fb84339fbecc5c013c40b34fbbe5946e3296685e8e409b7f61a9cb16884cf4f06ec1d84d3e0d1e75bde514f8cf64163a2fe3181bead5d3d70d0114767ccabce0e0b0e4fb7a3672bdd685bfbc973ec6f40d668efe0aab2c0fcb46787b78205bfaeb00563cb978458cc64cef6f18ef6cce08368c48e6618f5488a737f501cfe35d67ccb2d512f4254316a2a9215575f10da9b7cef25e27780d8da72705a67dcb65ed3981f82aa16b3e66609182297e03050cef8113a6b754c36875f0260517413c97883dc890ccf07cf9147e6c358973f30bb90e5f22c60772c15349f1d8df0963b74c835b53078fe1715532aaf480cc28bcd6c862b4539945767837cd8d394abd707f36b80d1731b38829ce3d78c53272b309c37f59855a397dd2ed91e23d56101462787cce834161f7cf55bf05b16bfe61f42c2ba4977bf1372ba73e112437b8f0fb39990f3d5188bb0c4741a040a69ff6ad883230940fb2bc9a63568950105019ef6e78cfdafe58f65b9c909ea8dd09b9ac7d7e78076248fdd26e6976e505384884adafb4f2e6d11434d6ef059ea85973a3273075431469051ae7f499303f5848e2bdc701eba7d5cbc66ccea873e624e82f942ca32d64269b553a46c1e614ed0e3431c05c8a9e8c42bd99a806e1d9f95d8323d2080ab450e9c0830240d99c497f9390e92bccd3cdce915c6ab590dbf8646f2ff50b39d0565b2e984d1c9304c56fd55bd9ad1882d82081bb1ea47d828b9692a071ae17bdfe78836c766d3a7408016850b01c97ea49249c18a492d7e620c4418b5cabc6102a3723d17c3c33839f502a0fc3fd4911070802248262c4173d36d21876ed9a9c3ad7ebb0ad596f92f85d461d933371c386e5a4eb0bfe5a6f26461c4afccc5254eec87ec48928f36e906666bbaf9f183a9f5afd7a6caf5a4729acf09050620f27afbb1f3e2683177f494d6ba232968f5c29ed4d160c46c70332b59e4946e95d4a69b41942278cf1e60460be5709f68b66e4f91b3a69d650d820ddd61a2b00c8c2dddd74b70ff526972151559393c7905350be7babc3d172b564655574f7ca93fe4b522756d2a89f90c722185cc4e68f9dfa63b55743841083d05324c818f1cb23eccb6be9c7132f48d4eaedc97c82c59ef60d619b24f2e0f7305cd751ccb8d1452b4ac4b7538956ca73bc7a7b7818c967d038e363065c7d10763dbd3987e10e4ba92e29e2e77a8172b900884bced34db039d5c78999b2295a285e8e2b469e6899d50e98c6e540b0765f889ec47d90995d4577bb26c1d886a53d2950d8d4a50e2ba3a271755d3fb99f9b210731ac80fa2c944895be7ebe083fdaa906f444ba815ad2a2c514a1d246cdd16868df36a85a26a497d9d51ec4427fe5acaff74f3e900682be1d3972981f0ddd272f11fd073a005e8431125c2701b0d5f40edd767f8bf6b67fc0c0976ea897d7a0c0d60ff0852cb46018a2c187b10810684fed84b85a357d7f364fdba418a6d536cc1c56ff9725bee60d7ab0d73a4ddcb1423d54c145f0eb799ed07ae4620744a3b89bab222a62b8599a03b62c1726f65bc58c740d3133f4a112bd0591f6d5e4d9c1883c67341c3361e11f4f0b421c393950a535d7d83a335abeb43081c4428543c6bcfef3e6ba2eb815b8161f194f365daae00f27a6d3cd6900b6695a49fa3e9b1324d637c0dac6296e50263e620a704b2dd697f781fd70f8317c59fd49d01fad5f6b969294418bd22df8fff7ca2e3ad2a99da6bc944ca53ef86939f5caeb4cb2d68f1ac4d957d89624f9eb3d5c9cf666c5a79056f5c8d8f118ad643c4d49f67baf64822d6b767d781fd4c9fa40ac07d961d58222949d65063138954f0d9bfdf188bf83e88501799c3481ef99d47b0e4aa1e03ff60f2e1fe1ec04689b60f90d5c9c73bdbde867b965bf38c79514f585c0ec5c42cd4df047bc7d6f79dea0a890ce4632d41269a3893e8f80773e896dd57e3abe8f520ed0eac238888ac36747c6810b27894eade28762f4072d889a8aff97a8a2f7284d48885b98b18ac65e7c67a3a670efc90de1a048cfef4e013b9a805593e7e68ac88d80f0c77f18c658828042f805cb3214f007d48f3d32724b16803247541721d66805cd57c6fcfe319bf3473a40a559bd69b51777594d6caf67ec8053df9f44580369872baca91541b92389e7b78234cbd20aaf258a26dd4c17b24960a7ae1ff2364ec5f22df037d48b98cad80247c06d92c508001a1cb20d8169ed3200becea64cac5475a561cdbdf90a281bf7393f654e7b7d2ddfdf4f031b5e1a79938b51ac2676c63aaeaf16c501a89c03570331cb9583e4f1947196a9c114cf437e3f40df6ee1d2e3af3f38c1f5ea4876ac906e0962bd6ec133828e098a10d910162c4408af774cfec9e7852b01d0867044d2ff423ee817fd526ecb1f17910b60b8fa4df01f55e44e6b7110592ce18e734aad9dbc9f7ad335b8eda1f4f68c2f39c4f6d3d40e4cd2b04527f660ce7c9b5f47042e014e46320d08ec27b8e6a18502c422950a78ae6d8c1d4d43917616af2bc12baf2244869fdc3eabc796686d42bc39f39975967b824f2d48a9f02a16cff5c23ad6661359c9e05a32ec160b6c64cd21fad53f0823312d48a51a22154765158ab26d40b0591fd5c2138239f1c5c4d985056e7bff180de97258f865362b1933469d73db0a833ebc48f313823cfad8a5af665deb001abfa0fa19134b432cea2d4a154549fdea860025b649d7ec50cee5e6e8d1cbeed10076304233dee2f92ebc4f887af8ef8363395950c28416c4e8596f6ecb869d3eb77ebed6528cf36d41f239f4a221415d1ffdb165a9866d3e7c5e0524dd258766526ed42c27dda7772351ba21c06ed0802d4ec31ccdef594bc4b81d96269fb64fb6fc3853e37aab4ac29dc66ecc58a5deddc2e0ccf4729d86ff664de45d77cfdc4ea39b63fa7b5eb24e6c15bbd056b3e2722da146f4efc6ce50f00507936ff173457e0d145d4be0704ea8d62b71d4a057376b9277279e2ecad7a9d54cdc5efdb933a4acd182dc8821eb1eb1080f9f724f62a3d399abca85bcd51b7a685a87892b1931f53777089ba87bcb7f664a15a953e2da4cdcb438ccaf289b0092f3e0ef3d651ec454c8981db728c4e91df1cc353ad0ec731c7c567bc036c4879c49fd6dc2a0c03b0b5c4e7659217e878e078e7a6a6267430b989930c8c5d7d4a244d81d3a8ad7818b189e8658a6967b45a571433d168c074deeaf1770136fcd18d1b881fbf3f8a62ed11a90f5df2f0ed2998c5f275826ed413f7b1bd4fb1cd8f44e20e388d09a85ea95fbf8ce35f6db6835eb6113e972a6364462c0d35cca1d236a2329b21b50ed57676c5b6ec17f5e5427e393d39e7c8e127793a1dbd15ef5e033885bbd581939132cedf1beaa8436cb6f8754d2bcc86d873daf76301bd2fab9e89002da8d3f86e04b975f87dac5299ffa70e4b84ecab24a6698350f4587aad6de3589ca4178c92db0e211a5165f3fb0f8f764287333cd4b370ac3748c7a6d3df9f85e6706e312e0259ae13ccbc59159c55dded54dd710618a98c683308bf2dced931815db3e4a33808c5e17e9faf3220579c41745f3164c776e992a5cbc5975ab8bc521359257de31d272a488a4655c01b8c5c68b1a831d723937eb06bdae7daec59dbfd9af71c18ed24ec9168edee03e6628af772d2a1a61cd3f389a00e2ace49885d6478c6a36586729d7895b06466e9cd8738958dda7aec8c033dbf4c798339027251581e2b2c1bbf8c373e4e3b824d5b69de54705db2eb52b75459b8b35868e20687d43264a9227a97c561e1c37d883c37b1b9422599489b9e45ec1eb4e13c6332fd6d2036340cccf3d0cc0d8761b6432784bdeacb26c150df5295a5882c7a5f6134ed4b2d9d7c91364b57a9f7d02c466e67ce756f5e9ca0e0bfc62d64f8dde056020b50c10b6e52d5cc8fdd6ad44b546669a2c36679062befea4b1da5ac34f8ec59fb05599315e015f60d26143936bcd7cfd3a5a622df5c3bbad6e9dbd63dc9a7a7e6513036dd799f24333f96515c530785f893894e2a09673460feecd5484413e4370016ecd86e64e1100df41b67cd9c96f995b5227ab76b89d42bda012a5081c727b6f5b01f0e6c3470abf90d2ff7b53d0a9fbe451cdb8643c562d7cc1b79bbe2fe5694dabb6288ec1af299f07645043364782e58c50f2f2ba4e43fa717b8d8590be6b3d1ff4c4eefcf605ca6729ca8e31c48655e9273af76b23aae81d018fb991dbe2a4d5b620ca864d7a157c710d809e4ed8faebc907f527d1b9b1a44784ce5e9efe4a2a0fa660758b2fa686f4ccbebda02e83b45f9f2bd573c4ead6124c072004902a822a969ddfc314b93b62582b94934e5c07e3bdabca4112bb0aa88cbde489b09483cfa3cc196058ad4fb84fe614263baa6f0d37bf2dcc1f500a18069a82c9f4872a504ddf5db263de086b4a149885146a8cb8d2eb3b752f8faa6a2014bafe7ce5e81d8d929fc0aacf4cde63e9290d2e7185ebb03707ab29a0fe6cd36b815fcbed727d3e004c533186b0604bc2fbb8d3a0fc32bea9b55da3670e7789ae35ee84438ab1a67c172dd088a488da2f0f169ef0c31314a302260102f62906e1157945e03dc8c259d338c2454b6cfd9f5d22b0dcaa6514fcce088750728cee5763be8214b63e49e448a08b008612b43e904686e4d56f0bc4f9ef0ebc979360bcad91fd5a1d958de7e8f38bb00bc04469223699c8caf6c4cfbb75644e35d1dc231b7d1c17a3392aedb18fc24d4ec1a10a734f175bef7b0e3d8d4372a205c6cb5afa5f824d1d97636020c4e833cf97362fed2864edaaf591746a46e64d63da0725038230483099e087eada9410eda4c884cd6f4fc47d23fba21cf44c145a291b334c2a8e6aab242deffbe1bba6aca13f79a43f701df11f4e64d01c1d5f963bd25564f040157a589a55adf78f43886443082b0670fbf19c28dba757ea0f0dabba5becef73b14ecb2788983dbff8bc0dfdae5dab9a5958360e44a74ee6583dc4406cfde14f7edfc6a33e7d7751df556c2fac24c40f0f9cbbfc2d910146f6f7d420744955ec05ba558de8e0f809c32fc29ed545ba76157a72e304c4632928cf7e3ca71ac6f110a9114670cfbc89a7814b14fe1a76fbaee0fae19c801dee85c63fa6a6002bd96fedabac477b4c38efd5ca6460d42c835e14eb05a59e05e5ba774bded1a535cc0eb2abb063c27a9f1dc5c139ac98aa24e073b9d25b3e9b18c2018a1c411fcb212f6c0ce3f0b28efe0923333cdfc0b8be98c37a77378ad554876374c32ec44476c28b43780fe7033c86a882a0cde7f1aee08d1d3cdacb8facb9ba9f1c1a3da742681e943484c80fdd9d027b300cef4d2b18bbc6f826dd8222b5241918719763c7a52bb250ed4284c5b303639b6bdd9aec3106cf3d2c87bd8e7bee10c5bbdafd7e8b753f65188f30e0d02a6dec1248c1428a5e51aee3d1ab0f6e18059947091f7dd284766ae2c9d497976308d02dfa12ad559bbd7c3b6c29a4079d001a4276c78f0cd0544e20aeaf52522008fb1e1d2999042138c28889ee8fd483332aaaadc44eecc2bd7e49793d5ad8f8387fb691afdbdf9df8c9ef05bb21592dce42b3e2ef095a85f9dd4faf2b24acf603c36f0f17efbbe19ecedff3984abfa4153eb92c852c46a3a3706134a578455bca68290ab64ed2f0890cd11f4494a2a29600d896fb5792a23aa2405e8512519c28f36dd35f455b5f1061cf0045a57e978672b059be94a5b7a6a91ad14bb801de533da00969d97fdca56da270a6ed0aff064ef0775157e6712fc11b8ca20af6ada518816c7c31df15539242292540267e673fb1d8ae4f9a952bc92f666bf2aecb90912589fbd6f928530c49fba45af2af7623fbd8b15d5327edbe2d7f6416f601bbe4b6b66a2b042faeb149ab05b362f5f4c0825ada96aba0130a94b517073fd66da883ee4be5557097e9a985742c2d33fb50948d9aeb9dea67d917305922cf772ebb1a452065bc3f5d9ff351b21889b8eb19b5d17a7290647d2d31582eadfe6823a85eaffa84452c53a5cecef51a255c536816f8cbff2c7d8dd2869b40519fa32ca1bc5e37fe44b4a44bd21ad0a42ed69c2f8ef3762dea6d0d69b48dc95b12d04fcab169cc7e07e57bcf1460a1b5d489622437cb04acbe713840a5ee71cbaf9cf2573dfbd53d6fef3e47aa690c0df373da714889cf15337f0f2f82ce43e31bcbeccac061b6832bd29ae7e70684f3913a18f6a149974eca923c987476cc3d9efda31ae1cd167ebda2f955e36117f75e7b6ecfb322cd3a57d64509f7c71a7af23b94f8076b2557368e373a1f13f1b07db24e6a73af6f03b4d041e54899b95e8978783ae508087c6a5737714279cb0877b2603a9e6668a6a7e0e0750a52a4470634a8abc69f5cbbb2a8c008eb73bb29fa54fd41faa0f3d0fad010c71db9207c40af287825a64fabf92da8d587461f8f7c364ee27ed3b294c41d91a637d5bdab60e95786ded00e3877010a1cda0a5b1f68f0bc967132acff74e8b4649a0d1eb8b59d29bce1f4ccef929011832d2b706b188a7a74f95fc47caaccb5b6ae2c0d91968bd7e7e94910bfd72184110889960708f4a891755670f2e49ffca69ccbed0e8d8376ee21f02246190d28d36e567735f37e9de2148b9b6585a1a9a4c4b797653ac8e35d05a25855a79045bcaed8a7520677bcb677402422614081bec245f1963939ecbbcdf5f65e1d50beb340ec14e8a02e4731f249627fe3837f68af5852c87c2e5477bad01afc42f940dc39035e2f1ac2fc3f8b3c4b7e14629428bdb1747b3f8c421699867a6b751e78f952df8ad14b6a74f7a43d312bc9853329a5c84605be2c6cf8c5457460967590e396506b5b4c89ea2b17da451a07504ec010eae10f5509190a25883e398f9083b7c8125c911fbfedd0c04471a2eed3784fe9cc7707abe900f1d52fa8fddc64a599399b5ed4240e200339de4a17353da2c4a0dc32b0af2e3fc5ee1fc0dcb673678f0cc2902c4141f266620f861627b25d97788e04eab501cccbac8dea28eb7c2975539fa7940cb01c9955e71e32a37cb7966ab630e33aed77898c8313385d7148de13a27ce3bfdfd554ccd193e3bbfde4cfbfa98b83c3dfc85a6dd4f8ce9b1d8f73fe944239f71b644894620215ddc53f5a42ba722bcd66696375dcf914c558c7bbd70c4423084693eb5e71175eb098a6ad56856f5ab01be50402b4cccc2b231d027123001afe9076626145586ae19210fe22c706e0e6b35172ed1abbc2eb457d7536591dea6b684a79a1a19bae4b0903148d3f26f84972dde7bba7e20c786c070b154f9dc27d551407bbf968c26e05d582befef0b76e7265341bdf4b84506273505616bc2d6554bc0015b3e377e28b29df4d2c390563a2faba026f6af4fae33e47cdd8559014a012932eaa16b7e9aef351eac03cc825ae0ea0308e4ffb467bd4b8c9b2d94321b6201ebcb15e0426fae1c8228cea87750e3940760411f6d0752f7eafa5a10241cfea8ca57e108c331d87b16514e2c7b858ec8da586bd9728055bea6d67683ce53787adf8ba496f134bbb950c4f3cf283e410480a8fd07c3e16a73cc37075413f15a2e5d9fac34d01686657bf5901ff02c95e814cf429f126412ff91fd84dbc0903d603db4db72b000b81f14cdcfb2c172388f8f40d33898745e60e717efeb364205450923895b6ba34d96a77c1b26ede6b10360204234e9739c1c52bccfa16deec552867a573638bbd4698ccb7b4f3102ce1588bb720fff8ee4244762d018e30c95215ff0652e88cadee2529aa3c0f6fa12614912dc99ac22d7664ed5b3a0e59f160a0045af462458cc76ce6c0c824199522733fac4a03da55956a8a9b4d76323288d24bf15032540ed02747be8768a261d8065b751ea54bfe43386d1c2dbfd908d737adbb38781db717c29c2e8a41c1f92bb0bd96d0aa306324328098bf3eb2e9d9705cf6ebeec296570edbb9815514deccf90bf94d1057bfb8be806296cad99d4f6ef1a24ac3a5039352889a042be9314e9b4b6754349c51a6504d598e4cb1777537acb3aa585223907a8270e82d476ceff48b1438788a2df4a450b28cc5c6701b9b7709697b1cdcb962b1968a61bf30ccb972b36ebee3a01cd90f22864c7ce8fbb31a0a38d9755086b81e72763b2cd74984856eb546cd167ccd8813a6470ecff686d375af50996e34807fcc105f19fba8fdf5a0396d19c5e7ca9894ff5b35869b943fb77be46623449f5ab148a556711eb13efd4772fd7a14ab696e4e53b37ce3d1d82f2e9d623f4d582c4a8e14ed2fbbb82df7f576731b4bb374bcb4f3dabdc73d446f146497cb04dacc0cb92a6a82e99ef6ea83cecd74653aaa9bc52a9e3544010306100bbdf9581469b2cbbb5ba4999434bd3c35922bfd4f9436a582aa8b5a492dae0630e52b13cc37a63f82ccbedae3b7ba488afbf7ba350c1baa2aa93b44f6817bebe3e88ee4986c3f559c493e7a967182dc9ffbc88c6bc33e44ce07481c89fb959699dec4e87f1a272a54ad84e6e2bf2fc881209f73078036c76ed77713e52236ac80e6ac4a57f8bfb6604175d4e9e4f600af5046e3874478190a49c5d07bf1cb2c06152f2d10b4e5aeb6ce52485481e3dd6c6533278311cbc4030f45725eed1d03b2349e9ab7ec5208e998a434870ec3f9d2cbb008e115d432a1d633c6873cb397dea2909f61fee568ce4b744d0a47716313d948214cafea0dea081efdd19f1a89c030395d2b29f166632e2bf1d2261af3fd61dc2b57623b107cd69a321f28aa08dea2a7aff0a30e78e36b2b9f36890afbbd0fca738b1eb39062cb1180e1386f07f7bebed486c07aab57a3e2932824df0339401e99cec77c398fe1b42b5330adc9c2bf7370bcdb6a894607781e5ccb7c8a81b41cf1d3af2c2c8c961cd742ff41d4b81c1b57119148ea2929e20e8fe36285f4520a72b858d597ed5ce2ae3f6e340261ae2d9c5164a1ea9646a837852817dd67e436ad5694386f8e5e3fd71c01a7dbf7bf643f80eebce95025ea1d8a71c9af3a0f0ca18fc4b4c07fbfc97d01fa4d9f2108e9a2172b70592267301596d33d5be24c40f7116db0bac913c885c41af949b819b85ead342b34c0eca494efd06b4336f451bd7929cbb08168db2c8aab35dfaeceb8b370d92064f69068be8bb0b5691cab63ff6e90df94d70eb0dc90369646c12ee8a12a16a464c9bb9e9e777565d5e7948dfedd0d09eb188ccafb1ce7ae279fc4f43ae552b055e5434f1bb5e9b5bc4ed68d5e92889b057f6172acf069861e5d8cb7d8bb1ef651edb5d2aed589340b4b4bd600f72071b421adc3fdd0bfa769c6e1b73f8267bc21dcfe51f632868a535c51793979ab2bf3622781f5e924fe81b456767066da083a9e6c77066f4ecb604f6698b171bcd10db4036508d727039d870b33617e09228561bc26877ce9fe25615b94215c57b083afda9257298eaee43dbbb0805ed0302e194dbd16d0f91bff4691d0de779d3170913970f3b7cb850c8403e20efc2dcee8054c7996d71af9fb618f00c3ef2faeba492600a2ee969d45e0ddbcebbe65abb1034454069438d3d70b6f8776cefd2883a111bd743bf837dca8701713e8a25b323bb93ff198e474fa460c060c90ff5e71bedffb5e0451f203b1ed879777b572ce73c42d716d7381b77e3f5ef1e1d0f6ec8a90518181db84759694671e27759761c214be41183c6728ff68ea30381cbb3593bf8c9fea13e7884efadb532aefc372625dd1b29d5796ea8b2ad0a207a42f2b4554b4684dac07bba2d9d7d84b51529a52d5d9270cf691c8f1cf7a3e72824a9058ceb37c406cb49d25218bc09ac44a3257814296e1294bbbe76eb765498c0a98ea9afef984187f9b2bf25bbf56d812da4c37f7d6b142f913fdfef7ff9878944ea3b92b4165c74ee929fe04c98456819322048c140e04be6a1184e06d3a7d795893722eb1fd9360598bae975cb07b57d55859e44cc48d8c3fbabb55889f2901e780a22174746288c550897929250c8715fab268ce9fafb5af5b0cad43b5b4bd491ca3be2c03c1a8c353694e5babc6828f3f63c1236ef86b32cd79f2b8eacc1f7e596dc4e3ff17c18949660b5b44d2cd6f9a4fb80c4f46a958f76cc5f7bc977a54eb853d3173f1e033dd1f13513796afc36ec7a7643a1ee6a4813db4c139a0457cc8228fe786eeee94abe89b6aae5a18f0cb83a3181bd189f1b39c97ff0e14876f415f25a1e64744d28e59f3a79a6e4705074f5c1724839ba63b10808605a8bc3ce50f117fc8ebaef06947af8ae4c562f74db97d5931eecfcb34cd519e013557dbff5ac3397aeeb000e430a0ba1f8f2ddc2e4954d76ad5cf32dee9ffcf761a219a48464c803011d19e8e5c3c8ed5f20cbdba7d605771557316f6a9c2efdba2d973bf94ca36d35a415b36af21a292915403363c6696ff6783252012b1dd1c152475bfa2a3546ecc1f2061672b73c7a5d711fc9b408c388f9be6dc22ea51352d3facb970193629b30ed0d25cad03a7476b98b1e2abad26c83d2b4df7b7ce0050d0fcb0060f34ca8294736da39618a932b0fd48377bf89a8d7d301348ddf1fb040fc6191edd1227dff9329b0a8ec97a8a91ee0a875bc42571564a385e8242d97a66cf6a33dc5cbb8b967b569e135760d62b27b153983f21e2eeb7434d309edee4cacb2fdde01d0bbab41e18244ac10146044564a416900e6c35fcd270d56111e67db80c2f6a4951d98ea953743d5ed5b70a7e7d8b67f05cd07f4b256cd25b3e1f4502fa76e8609751995f1c056d66fc669a7e462d875d479fc76c8c562951d1a6ba0cc7cb4fffef16fc564f9e7ed824ee86009c6669766a2cd923e697062b6d38c28321228b5106990657ac3808aa48c597577a88657acfa488f158b5132858a1de84f52a90e17aa4ba4883516c1dc9d34f48e7262ab153be4b6d5082c0c55b247cb610e7291ff0a62c81154053b5e7d32c71b7ece1399bb848784e655c9e8a8b25a06bd10b76f7a9d1295aded43190b42093dad27eac6c0c1cf234b553d842519a6eb2b290e97b17904c8aa989baf1464b2874d41060084daa20dbdd88f709b2ac1e79d17aa15b7069c39b77cac06008faec090e5bc013eab7d445f6cb50c07c355a98f9ee4b20ed76215a6fec4dcd66d09af62448ba632a90a0af44fdca1476548b64344f3a32890b51d2a44e37dbcd839d42cbdef603783eb46bf12c0867740815c0c6401a301a974ff2e3252eb55098a175d6c53ade1ba7c4d92c3d2f448f4016af1cf34fffdd6c87d053f04670a7cdf25ecdb1ec078b1eb6d061e4899b5e4bcd8fcf6ab3d2e8c7c575eea2137b5b7371f779bac52de3d874d44d344d29d29e909a8522e993aac4f4ad85d087445fd76129cc46dde786c6dca3b9f11a81ca93450c3716779e744eb1cb36036fc5600c59a21a73ab9ed7faa403149b692a47b5adda96c17ee81be6236ef87d499902f3d924b12aadb847e1c2430110d5c3780c2a6153e17f06a49b13b3d1c3a9734f747a72869dd913ad43663307c9ee5b63c618c9c18b1695073ec735d23ab147c522ad5924fe17b8997acdc10a7a30b23aa0d5b63d60dd181e8d9f7e19a79fc904d3329fd27aa810d9095bd788f1fe7ccecb3be62bee17ff97abeb6c4405e6d6a02f6d1a0608fa65e749e1ee55436f187624f144a9b0659f3d180a8b0ec599f1ceeec9c633064f59b94b076069176663457087399f46d444282394331aa6669bfcac369ced933ca1bd17edf0e01cd7e62e3ad5977b72275fa36e3214fb5571673e8a63c19a28d7277e21afcb97cfe6f52f79e80edfab1ed02953fe638ae53e933eccc000573fff73cc4176d6a783ecab63bd925b4feba4379f6a0a326417b3550621fff16f42896df532ddab62c20bca907954e4f8c264c67b9252abef240969c5612217848cc85e385754387a7ba940a4f0b0ead3c049095ab85905da59c402d2a569fa007cc773f779c46441b844b22a9532db4a14ffd4b5578094720791599a75dc32a33adb845d90aa0b358903ba2808aee50599519091c3fe42dbbe10cee196ccf9c13adef476e3521cd9f3829caa2b87d96521df917891fca131546107d0926385f919ee8fb68e98ad36d650af11a2fba37213c9e04f26cf20b544f7df9d7e0d51f04f12497e8159c49531aad8de94d9d9132665d2a441d4f45a5e2b4a931b2401218d70ef113d86c599899d79e0320f2f5a2d4dfcf738594cb2302d01fd0494098aa7e1c8ab1ee293bdd383aaaceed781a3b54773fd5c1902b1346a5ed6171b9533c3a5e1163155cfe77cb47e8c6943677c81e70901c64897437e34bb7a0e2cfcaa106398b99c696dcaf175799bc3ba3c7fa6a4933d296e99120752bde5d9d2fdf01a42d7955637158eb2444f15e5f7def039fff66dc1543713dffd9e84585ce23f237891055d713f5b9ef190e5a5b35247637611fadb3f2dde9e24cb5d3143a92a7bac73db3be4b0ba59db878e8380c8fc9bfc6c8f7e2529f45ee58bf3f6b19c254fddf31ad9f096c53f0d7dff6659448fa5a03c5862d1f8804530273858e5fdbd942bf28e1f92c48fbc39b351d461961ac3b113a31bbe1193277fbda7ad273baa36a0701288930fdbe7345f601fe67bd9f9c023fdb943a9a80f87e31014ef3fea18bfd28b003a83ed4cefc60b407f38cfc1cba86edb2a34b70191e21fce1380fe6502b9c4374c65f6b2b142611a1f8ae0080273e4401c56a92a2b652e6b2f1bd4ff86cb0826dbdb57bf5161f7e8e5be03a4ac74b1157cb34628f54f2aff6f7c70361625eaaa3d86f5f25552881776d41d75a7a48a0469a03c3ffc7054e5c8edfebe609f7c386396ef5df75e6cea5b238e956fac63f71e5498aa7a6edf5dd4bab5679bfbd4e02a83745fdf7feca09b8cb537a8d1ee7fb28cd58dc872119104f1da45395a015a3c5e0cf464c45ce63a419d53aba774c75c6261fbdb06f4d16c6a80dc92f43068ee5fb05be83cb73abe9023a2cd45802cad14a69fe5ac7fde0fa8349e91ed88c7b4994498676c563f8bd00f534cebd8ebabf91ae29b4882c48268821d9a82b2a4e7ed4842c32627a10af3a64ed0019943a5b8331af2e025f063e3d3670e9c04b8d756e2b4f1a50be6cdf276d9084247fce5dc36f19ea012d22aa704dc45f1cc5b51afc58e414da2bf9f7b629064ae6de29e","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"9834bb2cf06e555beb39e890cd24f3c5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
