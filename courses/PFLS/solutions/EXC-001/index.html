<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-001</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-001</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-001">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"89b9b6492753200f48c4b6d82bb4ed72e5605f338003847a54e0733a4bb6adb0b342484f72e1b9298ada91cb875f866dbdd57406f406069f2c8b5d1b18f2fd43c8cc7b0550e97d174c42828cb238dff7cd7cb6ed8c5aac75754ef756b127b12c91cb33ce365b119e92fddb4daaeef215337e5e25f8d017c4fb4316c3feb2aaca8a2a60c0a6b0f9e8c5469874e95a08b30c19b5a672b0cda86671671d52af47e66ab73469cb5b89287350c4fc42aa4fa7e7d2cced9e80f60d2177aead94be1008b6aacb10857da81972961c2a99ac758158a5307761b106b0c2538f38f96fa1de591a94f4b7eca9f42b5d0668ce895e7fbc003833ba2bd1f3c06df0c7e7c4fe828aa41407f0b59c5509d8ce41f7a7c6c69df8289afcf2624c8d1eb295e0822b0c1343b799f9b063fecbd89c79a4532815af38b4484834f7751181cb3ff32d4f47e013bbf1e1201a2c637530f7c9316131e38a99bc63afe5dbdbc27873532c9229fb0de79d8ced6d28ba6c9f583b8c30e39291caaba180f9708ff89f854e478a253a403c8c069c59514b8b8c2fee4ff71747e2df9750c2ba9825c189038acc61b795c0c380c0039e2d5fee8d38d4094c28e78bde20c541367ab51a5a95db441b660150f27b835d46a8daeb6611091299164cf976baed7f51781be82cf6dd248f5fc095e8011a3e979a150bc88493e3bea271e1620ebcc3aafc4314474e18826d19fdec0a447390db7b28c737727e624f0ac5a7213b141787be9ab6da66ae552d3a8599221397bb737aa11bf971eebad863f82401a578bb914c784baa7965ebeb6adf62d588f6d8d397bc4eca1611c587fe00562f232df44867b9a1412189d12935599e7650b5b2fb7bea0df43cae6705c511cfe17a668ae95acf22a46a775ea237aad49cc24be8eb1b2cbf4288d5e879cd9f0288eda3567b5b1841aa2ce13cc81c41ef2d4b7975e5f468d4495f4879e3af80720018eed06e682a7932135767e8320e7756c759e199e32d1afedfcaee196547c59984c8b6c7a26a7e1ea224f6c7125f3b06d881a3bac9acdb0231daac41abb9bb3d64f564292dbdaaea5cf6f50394d1f4fde2f6ac7eab60c35a870217c6c1cae2b53266e19bf03ad1606410cbb92b3b00239c945f76bdc45acafd01920addd6e540082ffdb2d19d9b0e0bef6c1d4621bde4d68b1f73c52937c9d648cb89e546f99e8723aa5db27d16a85e8acc12f3dc24abed8be7954942c3a39d26da2e83e24a2972b4d58e0264cbb152aa347d232152c767a472d0fea87b0311773ec8eac5c6749a30b782ce217dbfa951f8d94d052be6b4cea35dba35dbac08767a90b3f4a3c48856c564e935c908c75282add9d426f5c08cc25aa92bd5339b1db3b64b61d827818f8feed584205fcb43b1d39a040dbd58551d5c9d1b16911cb2b66eb0c3491455ffa6fb970372b7f816db9ba3492da28c0b0afa2b3787904a19ff2e5ebb34f8cfd73b7bfb4316033f3c1cdcac74939c3ccb6a557b0f1d1c70e58d58e0a6804b1979eccd16cf92b732a989d8a87588b32adcbce2570e41fd5827021f12881fdabcdd1985eb14890f0aa6606ecb8d1fba75980918a0a4fc6c241f2c781c810c65d2a36b284d38be6c0066e03047e24911d8f9fe8ed0683e8313adeb58b311c23defcb64a740f3ec2c930f72b5f63823bc3ceb3811c1852ce47a53dec2135a7917efad7da6dde5c6b305e6833be6e2b67edfe50ded6bd8c4125cbad72572e193d195ae784d67fd7102b25b367acc64c4d73e65aaee6e4dcf6289ee8813d962eeaf6dc52511af908a77b567d276b01ca633573790916285113a5684fc7ebedd6512e7411284469b2b97327423657fbf3ea69713a30a7e3c7a7e6141b611311f4b5626e418edb489d7afea3b5aec89eae2e4b9e7860512e6945d3a949f76087311129adae469b41a17b7d4d0b7cc1abbfc0d3d07abe4f91701b8534c9fb55e3309d7102efa2e843b2abb388f57ad5c03500baa873561175302465a8a0833f2c8582dbdf45052a6608dc3ea4387f7600c508ff4830560ed082f9c3bd44c57bab71a081c87ea19ef517e2d16c6914f0e0b6c841d1a418c9259eb96494fcaf688f9896d7505b57de99a63080fe1ed75a25ad56343c9f07f0295b003e8ce4b333e4aca70d2783f796e6cec6cd91c6fb9a797ab18e95eacf3fa6eedadef021c23a12b3da843be6d8eb8d01f8c079885358095a13f6b315a2fabe86ed6acf5b70ffb6a43ee9a7b66118bed8c14fb20f65f0c0e31fbc29a725b3cf055750420247edcfd71ddc54adf4c813d209ed9df4a0f4f7db8eb6c65da57b2def6154d987a228cb5c30a76613886b796dec5b5d8e1ef17a842522a45c1ceb59e1d6279577ef53d58df16d69362ca3ad0b0e87465f467ba59d4f2df2fc8b7e1a304290f0773f3c9f790e11b28758de7717bfa3053b82f265e1fa94c4b71c94c380329d80a59125b5a682bb4949e3bcfe3318342b7d45ed84318cb91843152d49894faf282b6d0fa54e6951815057cb0ec2452ddc6a929dd403c94025089d68ba4be3f1941fb355cd3f421b9886aa3b0d571664ff20a72455e81e4d4a734886192b3c816dd4e3bd34d9bb49448ac73b1bcdfbad854dfd5391d935402e1ec95e34784665a041841050b33d9f7eea3b59be221ef28ce7424913e620530e7081cb7a91fc06b2f894d58a4f78ba13fdcdabfc230a781d9d980232e71dc2c9933fbd78f2c0843ff19c4d09b32165bc626b2c25ee2ea2207732a1ce48bca5ba11b031437f46c3222da563acbca00ef01a2b4ae31936b7bf857fb92179d063a25e8ef778a6ecbb53c82ced0d2af36740b0c5c75d440fc7688cbddbd36001398e2fc8200ec319dbf9a10325c274b2e1d2a612f701e83df33f1f06d7db2f3ff588f1808701022959781a4f7eb6c47abb635462cd32355cc5b1378e11ee1d7846d2b7ada3a9171287fe7319e5901cfb276104b135f43f66c5c5231c45a1c4e817be6f5aa80c39ff2d390b0b570e7b61ff0757a09777f8c9bd771546eb388c1ceafc0bb6e3838906236595323313d1b855c8093cdecc91ff0f8d082d0c7dd288d5274faf4168c73e952be54652d850ed54235c4653c91515ba7ffcff972a2bb99f54dfc0756016be9b150d6c3e2d107a559707d20609a108ef14880876cafe80283ff3b77068920e8b92ce7be283d7f84469333d7af9f7fee1c7eea9b8be47c417aad66345569dfef17481ca9f538a42775493ae4d71e335a4414b042ec32a0d129e353069ee8e3421c17a935ef680313ab34750930883771e8e5d6aee2de70590253eeb955caa45db93010df5b90641011badecae64da6a0a255162c114c4789de79c68cf49f01d3842954d6bda5ca7b2ab3eda3b79cc032f93ef608011e6df410cd82a4d169309f6896f0a3dfe24f346305264626c20ac5c97ddde7e9060bf3b3bdbe2765b1233932c13f231680aa1288a0c440218320c97824e7d5bf6c240f6597329c22f71ed85f8dfcc1e8d6ff58d6e71d915d5c7bb8e5f70aa5425b1c9a150c8a93209d2bbe7b2437b80d78dd677fff4c8241f54eb0d274f528d27d1861984d6c1359c970d2afe3fc5a04ee5bbe1f1cde52612e318cb35f0c1cf723afdfaaa0f47e5234bdf8aecb86846da86487d98c0bc1a956ec52da910c6d0c45a41c21fe9cf4fb5abfee0933922a49ec4d8c9b3cc27ade3953cbdb1a2f84161cb953614492e316e492e0602dcf534e29b06d9660ce4a4ae706f108a1ee16bc6f1d34b13cbc8ade4b82f3c189e02dc1ca0c3abc26399a3196446addf36e10ab5116606fd56cca4a21053f736221757e9defaa5556c33b03d52d530162bc166b6d57116b27f8b332f4664993aa86b8b77af7c2f443df7b04a2140c199df2415e3e3a28b0f6664143c88bca78cd13e848636f17e970e5e403383561677d8a0c7994135c861bfd8509c1c2bf0603a2f3ea47c632443d5b98a95bdc61efea21dbfd70fdf7edbfc79dfa4e9f5189c06201d936f5700b5449ea9a5efa3a04c735e6737ca4ab45a376763437e281f41eeda589ef0ba644ea38c66b03793f8eee3e9a88306913acb60caeb9bee06fdc1f4f240bfcb29e12934ed496fcde107697673211d5fc6d08203bcc0ea20b8484b7e5c28e73ee6eb95963d73741d6be304d81aa44171e268a6e94c7029287c7dabb3908b166016341d904724626f9d181220068efc269aab1769118928a4eca26105ba456c8724e172b7f5627ea3527deaf8b4c348e212e2e06e339a425bf9deb4a176264bd3faf53318ba8eb174c81a3d5c5921d571f1dcb51b89f0bbf63260b57956750b23772f75f71c5cced613a042fa1a4fe541c3fcf6b1b6ad1798eb3b7250559889a760991bb9f5ecc2d2bca9e17d070f64e7b91a162b5646c594340753d3bea29cf57b6b0a8c5e6d2256f4a650083ffe2dcc5e6e81e626f56472219d4cf96469bcacdc33732d7e50e37d57881f847118fb491cc194ef7a7e82f8e73ac998581b66ba5d8f1caa8b32b12af656597cc48b4292d47d75b6a0d6a6cee8f5cfe578ddacc1284b08cfbacdb513839520c870d0bce0a9eb597bfd393f7fd617d0e26387f3a816d42f7eda9c9cf42248c0d02b8121103edff0bb884c578c74ed4fc7fc0bca9fadb19f14d07833ab40ce8408dd40e8e9727d6dd98a5109dc2f4695b18bc2fd42be24906ab0dbd87104dc60462b6a98edb48d9f22ef00eb3466f542ad1dfb7b8696f16f24ead7781e6a8672b37ca6192023947e79bfebdf68365643d284d52996a506a51f009ffe765aca2154e5e30318a3fa5011c68400d2ce5589a47aefa7aa7b67b8d578b6638863159d3370311d52d3c4c0534061bc12c409ca24826d0c0a5c80ff5f19d976fe5dad30aed7a999c57e2c4e7c643c4750a6b0dbe6e38e9db217c2af3b81e66d2487fa8e934f7eb946a57597b5fec539a299ff04029a440ba64c879d9960dcb85951029019c0ba67e51ee03aa2ca693460fa183a8cff946c1b671f248a070eb671d1bf24072bea64995095a47f01b8352d3c2320459b8d7c0e9856be8fc8b32c52928cab0a8d81c7a5422844711e12fb32230570ce850788c1eb628c1bf4d5e0901bdc5c95ae9a9439da458514af14407a431a561769e0d5291b9989da736533ded2aaaa5cb4413c6fac1f1c995e6aa958f5f838a34cdcde03eb7b3429b39664e599a85106a52ea02ca84a557879e843b21d039e27cc2056a31a2f5913c92946269657518e3c87a7520540fdd8a5f35b428ad1e7552152e560778ffec89940657e829aa7e2a2fb81cc934cfbf6de6d23961f39981ec18888e305fb645d94d2cad4b95d0a7868ee02dd8839c160bb8fd665e4cb08c964ce2cbbb32286f3a1a730ef89072e48dcf9e268e6b0a8c64b84b27d695d523b5abdfdbdc87318a1bfb97a0cf7a63776b4b657362529bf4cd025425a5dcdaa9ce31351e4ea784d697b1a2a75246be243765d89daa93bf80015483f6f8b8ebf81461f0b5d222f473d4c8761075ab2122a7c954411818b25215892b01c7feb484c0160608397c72f726a593db643039efc57d4db07e066624f43cf6cb22a56c2b200eff5e0a9333e75af90407fff068dfa9faacaa4d2322c3dfb2ae13c3ca2ce846eb77247322d508c6ca8b128fab907c772ffb847faa7d8318a40ae0c9e1bf95890b5fff48e0cc6a466c3ad3bff8c745dcc1fd9509c69dcfcd9f18e9dd1cf9f5c5eb5a3fd8f6741b949f2d9272d633a531460786ff798edbd52086e1167c6071e6ae4a0d7e180b5d8ea64a9fe770afe7172b2b9b4aeddeebc489c88e40caec579431ccdb42fe15a4f8b5e7a7118b75a77a5c2ee6d8e9a2334ffc3fe2aa4330f378e962ee266d811c1b98d24801128566e48066ba7dbd5ae821b376a9333053af001e7ef895399aecd2c14ae7e4548d6ed788212615991905ecead8aa97ff02f55c5bc031401c1517608d4edafb13f76e5e2a3fef5bda9590b40b00061082132629174c75dae855225e6a905d456bc286b59a4f700b41466eef0ec89d2064f5d849849aeb75384a1a61955ae11e74095727a1d96aedda6d2aa9d9e768cc0b46f712c30dc86ef447343a1b45f35284360ccc39ef34f17d26a71dacbd68513c09c62e5dbe9288b6092c492e50c4563b2d497f014646ba873475a170039246e38696ec0050fe95ff1c0fb0988f4378cdbdbe4381bdbc0e689300649b03b8b27abeb79fd7cbfbd4c0b869dfce35e8008468829cfa46aaed14d9f196ec7c6a35e62ac53e915d9e42b30fc29fea08e1686449e74b533a1ebf087dbed788c6f48a783fef2e576082b317b24e5d567aee243e3e032af191a3394cb9801ffcaa5ce17897cb0623534fa37164a417633d09f4a2dea829e1ce8f73cfb4aa517169005eff44610d58b1df708d155b441f09cf9026c026cc5b87b0f2651118e144e742524a0ed4decf9a2a94330df3dbda71c788adb2018ab1da3b65779f4b1d2e110d7aac82af3b6e05e1e0dd24220aed60ecd4e9009a84b72a41b83af25143eee94db40d1038fa5a14051f280a14d76a124745322a09042455ee27377b7f7cf78909249a74280dda138fc82d788efd18994c38839012026b069940345a187c83d473acbbfa7950384f5a235c012174cf1990c656c7b93db609264cf76dda32923bcd3d61d18c8676e07fbac7f3b9759a97530960a646774aa19f47f290c73a0ecf24925a93800c29ae4857229520cbbd6b34dd860a8573e6b5681d3bb5e19eb06e2d860f66d9556191fe687e573d75c1e0f203eeeb7a43f30a7bcf7970f9d60ab60a49be44d9f1c0848a566cacbf67d39e923bdd5c3c769eee1163b0c6b7280591fdce0bd9bbd84f91d076e144866d8852f94d94094ea58eed351e170ca0f9683c16e1bc22aa4506083c98698b51ddfe79ab10eb91af46da40829e8d5d2ae30a74ae9b9c82d686570280e0591a2fc5984e19c79e34164f73f0c39d51fe3424cc5fde6be6137acf6e23e6b8bd6fc60612159e9e153755ffff14f25a3a162e6257d4b449d894a644f6fbd05ff6e9b2610e977f7c618a83902ca867d847c264773f16b16dce44b3e56f4992c020f07e9fd11ba606ef29855413c3ba0b6721b76b6e555c980ef9a89ccd2ec6917e60a45f7ddd730be92c72d1855e461f98827609a37921e25ddd6e23051c8737f561028198933978d7a3cc4913ebfc3c27079377cb2b12f09951d8d08c4728008cfd37d069a92bed940c2d5dbc02c9ce4de1c1cb8cdfb96b38259e76a06343348fa9d524b9f3c3ba819aedd69caf06e5a30c5de43aac45cc6aec9012bfdc7852287f4ec5fee6959d8b6d22bfa94167e3d6368b6dfce3117225ab4e46d2011e8fa75bd82a18ba47ee4af5fd9bc9b50e7f63c08a405990ba62778bf0cb9ab3073259dea7d419342769922c966353fa6b1d6bd5bfffa28cbf35fbccdb368abec9264536ad9a3f4043fed0866a28e0a6e08991bc4921583f9b63aa7d27bcf780ee7ceb170e8cf8b3c048a30b1be40129667bc8733bb6f16456a2a9e130a4bfe338f7c598e2c808672edefd1af3554ab3574020e781893aac1de1e5e6178533a630bcdd206a288e5af13230ec3b9028064bb90b3f557a1bca45442d285f317f76d8115e8cda2036477e3beebf90c1c5ddc29705fbc422ce6be3ce0e479cba75da836d3a58b9368a95a47f0ae5c2b0db5a58ba5c14583a1a46c42e1f2fc8c5aa39ff3b5318a961b24bce586d295825389cc25d0e214520c680db6d29d5bed476ca10aa206ea5d1446e1291278934e7f5b35fa5dbf5573472dfb7d33cae5a42a23b50e4f62b7cc8ecc806cd54140f0880ed2934be6e2a5c310cbb032cab725fdad2ed1a3677fb2f0d399d809156e1ac0d18b8f223bd72e3dbcba2c0ec984b68884ab96958efa28604259f086c27ffc98a15dbd0e21f25bd6636a4ff43750c97ecda6c5c3aebf8ace5500f354bed879aeb0c4e8b66d0830e0638d287f6d252cf02c6e274e38fba3d6b2264cbcecbac5cf6a465ba10fffda35cddcc48fa0e6688ec9739528c03f3bb39d4f0d37a6985830cb918c2b5653ea0984c47e6b2fc3201a5fc05c54a4a7255da4e5d144957cdbc17a063b1b73d9793fb000771f8b52e1c0e56e77c8a11adb6eabd7cc180c3e584ab98956f4b919c9d795200a5cbded73318640f4cadeed23eda62ba91dd4a5a5c3d3836d40babe414358acfe96f003de538d1d094029a7251ac750d19117cee09a47f43f84a9a6593ea4d66f13f52481a39f6e15108a56636797dc072675fd601be6031280bebf4a27aed3d5c67aaaa2ae2ef02f96edc629e71cb5dae87fe265c51c2f4c2e4c20eb7dca93b6cec53225d08e2b496c8dd09d4d3c3ed6a28ae3a5148300b17ef62491555c2838df021bdcba50cccf49be8e16bc94e21f23db943774813aa99f4bbb103e7d7f58fc85177ed45662bd92b8c16ff93e6b31db1cbe3f686b82a4783232ffd76ab733c5afc63dfbb8a658c951dfc8460140924b64648f4283dbc37f0f9d32235655c17dec9a2c16e26eee6a58dee27c9c6930cfd4a254b82a9e106298afa1c82e2e9010263d7f793758fe367c40b4a06b052d53dce11df810a2950dff2e24c0fcb99521aa88b312010e458d7945bad1441bf35668f92042ab41ff0144e707c99d326f9646f54b6d42321bbd7273a0e694207401da1f638adb4552889282ad0e58cfe15179d926c71c2b7e0a818418a3e222b170ff944a734c10034b1dbf635aa38e37bb6b369749a955e9f8db76bf2e8e053de5a37a33249b09984f612f97f1ae2b66736cda9ec069cf65f8f9bd49102ff5b39864eb673c4bc9147fa3c7593056330426a4fc7df112f582e9ee618d863f1858fd92d292230092b5c9ae023174d44423de1b82e394f7467c60f9f7d0dba1ee7ba2bb93086858766fa0fe0ea150540ad26b8052aedf7e0c2058fa5a14a8b5353b71f7b75ba9ea6ed7ae734083af73c62c16f99bc5681cb4969dd85d5cdbfab69d5b0f9d8314c9dfddaf0326118755a7f5fa59229adaf4f6858ff84d708438f454472f6123c350732f3781b27089d398d2fb60bfee2c4c4d80d0f346cdae26d375fe1f08fe5191bdfe40c49a8a58195d8d482e7207fc6fdf6d9d288fae044448f70a75b8361514723fe852cc63cb7cdfd7158a3d45367e9263810e84f405a7d455d8a30da2372fff693b0e150b1de82cc11103801666168e30035be8f180044034ee9ff2cb3160aa4f6e402f554e004371e218c5c5fbe11d84e2fac0383d3ca18cebd810171055b77dca007186be175390b22ac36af37264d7e261f1e0f139c12ac86d119d4e43751becd91d04feb9a6e1240bc7270880fd0caaf193c601848873bf5252c4dbecb5992066e886d31fc971337e0bd501ad8391c5b1c6df4ab5f5d34ad0ad1aaccca2c133210103ce47923ed4703c89501a7b721dff1fdab4be5f03cbb35fb1ba4de35104cffcc375790614fa1892a84451bbd1243c965dd0c47a0d8db3fe47d4fa4b0a8e546a7b9a9dbd1ab974963962c0b6190072e33e9a9b4745d7bf27e5d946c0ca374f397170fc2970280f8b840e3e0a89a915e14426db74dd2eea8f9f62ca12c9377242ea152cb11bc482b056acc594153269fa81fa37dacadd0528af6d8d457499401429b71760ac6e55adba818b11a01103b90905761f7882b3f2dfc29d3437a9af078cf0edc70dddedc094924bb40fd44d6eb383ee194bb7be86e8ceff27371d1bb89323534cdf079a30c4acd975aba8738601ea2176d2ba7e0af7b4520ebd92656f48d52ace6e3d5c5026b4c5ec5d94f4a94f827330d8d0d2e084b7cbac57790588a435a0c110ffb6f9250d669039e87df1ba1cbe56be97a0b23321f8b365b8e66560077f8482d8ed249d0eaab650012a6e099d12e6d11207834923de3ebec950cd146c5a62df0e82d44880a61a24a47d855f9f8a965c3f3c5a430604eb8902f35b07e64f66af8729f3c18734d28a6f9db806061afc4c9518fc04791e7f5268eca6815ac0d52de240359c0a34196dc7a899fe065c0f86c4acf814079ea184187efeacbc893daf9fa5e25c77acf2b4671e97d56bf438d0d383047463c554c1c4a215cb8b7c4a1651a24dbd418e2b842b4321e8b53bec8c30b03a81e1960c7338645fea03cc8e97742a1db0bbb05e1e425b643c9746ea80b39161d3e5d9f58f3bb8aec0b5f426f76b0a1d9c5dc5046c4c2eedf0caf7db3110eabc9c4dc9c83fd662be32afa9cb798da945e4b148d5106d95eb922e90807dae44be2e39bf861f1f9c2e5edb34bd37f6f200de2c010c307adf4aca9cab8778097b3fc9b88c2dab73212c7b8a1bef4b00808bcefd5b166156458a0474608e8874f6627e159d610c524800648bb5fade8af7dfa945818e33311f0059601b2fc1eb880ade50be95e346961a85519f1813bc250523043a246669f2f89b47930403b46b4c5cd8fee5778f2b4befed7c07f785e9827149707cc1151edb3c7e9d5c16fa35fcdb90517bfcabecb3da9821d44bc5d2669707c5f8d2f9f4ec0144f0982667eae8c90b7850abc66c266513c8eba95a551ecd37d7d34dc3f39c124a8cddfb047c685e118109eb740c1d413e9c986c7a6edc8396234c900ded91d395b38b2bf85d359a32863ffc597d028ab0707bebeef3fa0ae0828b6002d7a60f09526a719892404a8ceefd32abadecc2930bfa200dd50615245b3c49fedb9af99540cd17be77c9095f50d3ccadf1ca682cdc0af6edbb50e777ecc7dd954e26161f1b1c9e5a02e1b4de10d9192a232c6638796858e8792d22627c9960aed6dc134e75675f72ab7267343a335c885c994975763ec4289258f95fd12b771b5e4cfc6e8f412f70cc7343d02bc3cdbc78b3ca66f444ab750406d687f14d5584a4cc43e3d8caa926157be4f4d33e22da68f1de282b61d7a4c10a49f067f3d660ecf5867532d98bbc9b2456c2896cbf46e05fcb08b1d7e53c975cb08133223d00e08de4af0e97470e63c9ebd703b7130ea233b2afabeabfcd13c057e0a33a9919cd0bc672de0c9e2c87139769770be6d98c75462dddefcabb4d0d5eca13f51b254ede1c6603077ae64ea9b92c9b32e6c26cdc9151d8992f9c49328138ed5c1d8082b7cd2dde4351a2f7bcdf910cab1f21b960dadb739c2142cc092ebe143e7c83f805d2a76e96bba61498684a7e9f24496bc75a66b5d8aed9d2e14f0ea88df649b616f6ee5e8bef11c51a85ec94e523ccd22cee2557f7266194f4348543c9a17fe551f0d095aa985104ccc03746c6f54df87500a00ce1a356c43e298c6b08078a42236884a511e3d0ced5272450d44f3e02c6601cce8a33e2067860845029756eef065d41f7c2d5f6244a3741040901cfff8c99a6cb6d436e4243b5c7604fbc40bb8b9ff7fa49ab7b687a04919411ecf9bb20dedebc1a66fd4963be84f8cabc32b4969c1d891d300a2829dc6aee9b59aad599f47be60fba5f284ac7cea199b7c5c05d8a5fde5d8749cb3ba7f4c7a21d43707086d7aa0ff14d871975d64f0311fffe3c8a9866a403617212bd66dcd0e5188c3f1445df67048e4be44253352bccd441e26ccfe57fa46fa68e232070a35c9fb48d27344d28ebc934507f0e6659acca79787a2d29a215fdbff2e5e619ceae5c174b9c732be1c92b720946d52ed976555d39ace4b14c0c3ce1a7a65dd811e5f0d40680386440164f53c5817f1b0ee4bd6d0049507ba07671798c994f170e164d1d4b8509905bf1702aa047cdee269e1778213ba9991ff4b35fb77de506b8542642cf879d2628c4e0e23223516c858190ce245d76687890f4adb382930ebbc836371c6a5fd0fa8c36ce0883b9dcf38093a70bb9d5946c0e9a98469b65f01053f2ba4bf93928ec4d00855cd817fa1e96e8866455bfb484bdfb512f8d857f2b9c291f6bb036e0bdd85f67bf25b5ff3d69471a7099f31f46d68bb513ae908f0a780a737e0ea0b975d4de153ae64a6d8c794198dba71001d6e7125cffd2890935f3d58c1de4fd5f27d816aa31e5c58ea4506b68dc3bce3e0e675d9a37275f4263166b8b51f3e82369b65b2e75e50143e417f25c91d8e38619e1973f3b00f1864a9392a43583154c71d3affcb0bc226d29e09446437cb7e4b93cd0da16a7c3284fb6fd6408c78c39e365c56aa6e7d9b4c916558fe114d830e13fbff932ad175a1ce148eee0c5e7aee7ba66499d7b6506a0a8597cd200f020769812f56ed313e74f6f5d02dc35a51aa76d0b4651a1b1264e9c2c81b6286d6ac24d32698a2515d0bbf989261f6c4ca43186fdb74543402b394b3ee83ae4145445f10004cdd1f756bf027e8baca071f7c18786eaa480bb9461bf4e13ff2c91dd51b04d641f0f892edd05231b260b53fdad79da73c32c8230d4441b8fc2b6736fceac7a583dbcb8bb47b8b4f297475a9ee78559362e919f824fa24b12d6fcf58d1edc8a02e1345d3e212c7928a1c661e64d3d523f08d51c9b25ebca3f1e568556aad6235c308efeba129f473213217b581826bb0ed542cf18fc94b20c504151b40bfbc51d4e0ff791b11dce7aae1107389d42628413b204f4d2008f7d769d68614d533d4a48cbac24737c139a12bb97ced7fd34a2d65ed43a8f1bcb977b58c83f08f425c2104b0b8b15e79b8653bba1571bb964095527259c1b7afc0e674c0d6304d4b4ee221086b859155b9f82de88c657887027bf1c2979ec015cd92116e8a9d0f8296277598982620f6e872a964498b81dd8bac704f28048ddd8e31b218cce8aafc7c755ec3c4e9ab2cbe3fef9145cb9d5ee6585c2dbd8020f0c20c35abe438ac80cd8b8218398b857b12fe1c2b7a88d19acb8e4bcf1d16c1d929928d9d2b36cda3e14d6591e6537e14335900940e9a87620c9b40faf083ee18c65eb999e3a8ab9766f0c82c6026e5f96fcd4ae39cd63a5ddb1a71dd40dcbdf1de0b98f5a4dbd9907593f9ae9627f0a570b681e2936742ca43fbc2bf06eea0664e44e695b558406f4029e264a877d1a9d861366cff5502256d8b7ed26b754e52cc6380ba9f1900a5b501199fc66a40f9416a904d9a7d6fb362ba239d00aba65083a6d1d280fa067422189e80dea8e6c95759c6fc58d97b678ce28b2ab7b75bebf362a955a208292c7eada110281c82db9d2d8d14959f5e97c4ee924c2b1545bfd06d7c999d76449a7cced720330eceb97746f0bc410edaf810a3bd3f382659936ec75f60d48fc78b51744c82c80a303d1c40f5d0d13ed9f70465fc86ee68f509200afe82ca3b326dacf4fd858f9dd7584db5bd7bc5ddacecf0c7fe6b7dc48d1d7051fc2ff33ad741493ef49b41917ad6259c0ec6a3cc855c2dade399f97075b3dfa243eff584428be81e90b9dce1bece09ee970564445f88e3c16b2fd32f6db7c0df001919f58013b9252e0ad136e64896a82022c5d473b047aa6968401c7d691e5d29665a55b39310fec3ee89f2dc65dd9b996bb98c4014001bb5aec70e4b2e0f59a99ce79b2cfccf3f36f1062598cdfb137ca906eec2e594fa27a3be57b57b182d38f65bfe277a8c50ff9f48768620548be13e67ae96923eef83ffc7f79d1a4cec244f7e18f721667a15fb3063649b2d8d725e96e703a37c30271c2d794cd4eb344198f12eec4307a3f81240e42ea0739014073abb3a067fa6a2d4c827b46270fe27671d9bf116a23656cef210289b5491b7b2271a91c4d78dda03a7ad3531f4d75a840b2528dd0590ccb0a669d7efb3571e571020c4e3a7d1378ed626ca958c2c93003798cc6e5e037e2e05be04a42ef09107f86fbafa53282a4311a654098295ad254b9898f873001130bd39a970b234f32f3c8ca8d3c94fb373993dbae39e333a11acc160bc0af6598f4ef77b1eb09fbf70c5b95b38705117797685d7856b4b3533a7e62142309d3814ed67be8e33a8d59c2cfe08d0f419d0f9f6950746877b421640d0d22c5f65f072b3a559c38518fb4140212adfa42edb186fe8ed89c9cf8c6c1f4e1a9289d5d73ee5c2c4cab5d77aa889bccc29d17026bb3b70ef279b039cfb5711a493c3fe683ea1bda4f6c697db23a62474bea614cacce967c70901be5c49038ab614725f9b28a068e222bef9180195fe7d96ed62b56c26d4942eb7403897fc95bb338e54e95f3a60317d2e12649af0ee5e8dea85d31906bd756ac7e1682dbc9a0293ebd3bcb2651242ff9ac3386245522d95546105d3cdcb155743b72d9ef48d49d1f219c926a2265ea97ba3c28c2c4d4c171bab8e0217d4a0b7e7825dfdc04ffeb59dfa3b5b89ebdd52c04d7b698821d603de081ca484e03f82c8e6d8e96e34c44d1c4278d6a8e37749640cca998a73de38ad88db0ecc4c56e6fcece968dea092daa93287d27658ca4707b1c1ee9c9977891a39120e2d8a4d1cad0c22fd25183c293bede4b11a900aa824bec94385b75f780033b0ee18ef5c4affc7165b71ea0c1936f698cf7d11b4ef394abdfd1f7c49c31bd08b24b954edb9931db9521c301896e7b331fed8c3c08d0369b1abb468fa75765568f47fecc42e18d77961623ce879e70857fe050c1dad169c12d449691b81d5bc20b0ad7798dde37f4316ec6f6dc53a36c37011c5d08b139ffbaf98d91d413b6934c6fdc74d3756f59072f5e7cbefb77140e637c01c3a55e5e929672c4b56c87fcca0707d4bc66ad4d24a33d2325bec514c816d3aedd781223aee2b40c431ee2ca3dc919b0e7d0d328fd2faf44e383f97a2ad090d2c2554a8f7ad8d3ef27bcbfeef9f3f557d49722805679cdbda446534e7f5a60ad94f20d15518e60c11952872bb68c7a6adbaabd8f26e59bcaff2c57351bf37cfb50ed154f039c84426a13775c8df5802d52170643863520615e2612dba422937e0299c4b2fc8a993eabab96c7e075f650684c17417ef5b3c4f59c70ca289e03671bf2e2befae40f6487fa8c0656203c57da11fe3004f47fd5dc2ebdeb7281e833a8e0a29e0ab09655811a6ca6a0d80a5296310df09d1f734707353b728e1e0d8e634048a88612606759fe6db48bd5179d0119a8fd81371088236842cf223c95450c1c984c01699f13df03864496af2a41c7a91dec2afcb95fa41df327a7a5586288e2d1d53487e7629a1a0281433eef5357e9424bdcfb6856d9510d84c8fdff19d58c65f78d65298f858127acf2bcbfd487ef00df5c7e5041b01932e37604655fdea2815ab092b3223dd353b250b89d3e726d4e72ee1a5937b686976e97eae7099ae9eabc9b55fae47ace6e01f4fcd235ef15ef367cd39f93a96c34f522103718b50f9ea2e42040ff351e86bcdb117b3c31ab032c92216b621952aeeea970cfe925eba08a572cae682f8a85cc7471b270117139c9c21463a4fb5880121df4f487efca58105d2fe5edcd2fc437ef8e3552b935db5bcf90fb51d83339e04ee2d0ce1e500601206bb75c8ace38ec1bf6f56faa5c770e952362f2525b53bd8d104e2dac0358693dd02ae023780bb05ab5579f8a3be13f0969fcc55453b71ca35976f8d51407f19467413f38a18efda21851795617dc47d70e1a86b5965f95d3817375d7e216397eddab71e6dfb9d32896f767cf10f7c9b8df008c3901441e2465829f1d43789951b3e48e10a8d68d717027ad80457029a41e1d4783ea119a7d2abb83c77916f4ee56c04caa81ce26290cd320014a9e67b29a19f80dfaef9bfe6cf3328cb08407f53ddc193761c68d2b70931f3bfdfa53df2b155eaad12d8f271547a175fa52d0449d54f25d3dc7817b178ad3fbf901b297c3338fc4022a741c4783884161b014242a854bd5d7d9d50e1235073a7ef57654ea538d4883abe7c4ae0e7d8d92e44ce3575b440ec2432d8ca9bc289a6039500103cc4318236c2f2883f4ea27ad6cb2ace568c2951fb431490f088200fd12e34acf4d853581c08c805b8a04fad46879552726b24db24ebe6c53c296a697f98d290eb2ef37f2021da353d2ea79327fcadb88021ae24ee784255dded89bb3b08b51640acfec8d241b49cbe4af542d3b83bc571944e66b0359ad8c20bcf68391b559c7d1314f8ab1e64dba2e4aee293000af3cc7758ab4546b5542cc0c8ad2030491652c91156b2c3043d1c8624e9c743ffcd052ca900721e10d421d257c748283cee79dc99b0ac3380c499578c351dc83e40f4bb6c9833c93582b8932f6ea8a67010b9ec8ba0fc4bfae9ab4338bd973e5e18e5aad4063883ab259def924356977c262774c843712db04888b836590dc3e20bfc35c15804283ad3fe87ed0165d687d617b97c92a6b3de358d0aa0c5166f39b02d2c52ccbd3667b6e86f563550cc7eeca5b11b49a0137da7f5431dfcb8ac291e7f84f741085e1d263eb353d6f211d887b78ce67e357932e4fab8f0c86e925230f8d6b5dcf0c99d704eaa77b610ec5d3ffcaab293958baba53fa15e8b26bead977e7a09e1269d125ab15820769552995eca7bd242c7f26fef0e95423539e8571ea7a6d8c3949489a4b484ab9d2d09f0db5f21b7fcefbe22396a3503a867ceec65bd587018894ef781f9a54acf5e4a6266adcb4d096d159e8af9244efefbc56e9572fb4007396591cfb62a18923daabe6d22a2c533124af37f0a320a198e279d8644989b28338d31e910f302f768bc855380705b0d4759ea8d4d12807fa77e858eaf9ff05396499a2f580f7c2d415d5f5d93ad13dcc41db5fcab4b4daf735ce884af154da72a128990d2605388715e250e2d447c0f6d2bf0b45c85183d0a4a29e310c003da77f1fc4342942f3a25fa517d48235aa94095372b5eac15a180d140f20e7e06dd58ab184e938fb87de95e30359840e0cb4a38587b1cc687f55bc2d2c23cf43d02a524ad15f23a3f78251945d62a35866316f63390240a88eafc7bb0d5066aaeecdd28c2d21cf6b504c5d2eceff8beea6aa9e203579977aa972d32c4a882997c1be15279d437a5996111afa2a2440ffeb7d97cf19f57c96c7697f30b40a29438ae972759c4b4136875c0ff898fee921a498321c31742b41d480cd05b6401de0716112752983fabdfacd2223bd0dc7fac389c63efe386bd6d4e2a9c41d56d5bab53797239e94c56f29c6adffebea4c1809708c71bae860a8fd778fcbe3bfb773689e2e25b02efda1218b2e77b21aa81984ee33aec9800e422b6a65e60c46ae3ef09f1b5f2aa170d26370f4a87bae53fc7fe20f89c1f3b15a2ad38ddc0e24212eb1dfbc2a4c38a64f992a8af5fc0f559a74f0733a4bf1404","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"ae5b657c1a4e3bd93d3887d8f43c20c0"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
