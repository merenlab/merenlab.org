<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-001</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-001</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-001">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a397d9474aff2c0b71acf2d5c850b4c37675a598567c4484e5bf19646eb1211e24d191096393bb56068ffd86708ea7158ebe630bf14d51158b952ba3aae02e1dd443bcb8842ee886e0fda398fb32b5435bc24971f4e5ccfbc3a71a32eb4204e7da03b94e63ce6db032667414d33b0fc0b39317aa51271290a270d0fc96e43a5f50245df1ec6c86aa0ae447e2c601eb4f609f9fa2732015a0b3feabef3de743996d76257e75aea0dd9133777f19b7832fd58d72de719fe47592707e2df186b66d68e9ed6cc07ff876f0df549a6037e404f7c527ab82b2671608850fc5894d90d11c7a07c4d0881d85b5c25d9e7a55d4659622efc4b31a23d2bf0f6c0e49e67cb63bffcc1757ae4d6753321be2589254d180d495fbe250c47367a591cdf9dd33b0b5bfbcac402eae1337b2fd3ac75d2b6c8c50513714149899e9b37e0e3115723a5418f7ee9b66ac12712df3e4817e6e349ee41e8a69356292897eb6a2beb4ec24e7e5f04bc24adccf6f153e5372c1e554f2c4683a3a6a4afa2208d877da62336a4baf1f81cb5d427862ab02cc5664f4aa3bce2ff982cbe491dbc9375cfc17d1bc0bc5dbdeb2e072c887c09ede808551f5257a1cac42322cfdf7bfade6d16809413707a3101527d06abcf03ceb4239c09efdc2b826420b98d5f80a1e82b2ae3d3730b21109d0fea2d8610564ca445f4246ff69201cfadd7bfcb83ca912aa4a5d50e85fe47aaf595351d1601e69dfa396462bb3374219f0790e2cffaddc4659dff0243c8809f4219eca74c3504dee153d932bc525c072755eb9b4887d8dc0cf236d24935eca31ed6d104315a6a14941a25b279eb78b0e9a2e8c57f8c723dcd663d2699666d4f66c2459bcb34016ac9fe1aef75f657818d9850517fc5114122be64f1ae109bab21dc2967653a54d3c414728edc0680292f89030cd352b0337afb7d9e3e4ddac42ace8d6a68365784c2f969a1b23e677dc248fa9b1d05b1962b1b2fef462b102087bbc27ce3dc56afb16749101e1edccbe49fee1bda758b7fa9af2a72ecb60f9e7b14230e55468b411ab3407f82e9668a6a0512135acb7bfd0fa5acf8818cfa709bd9a5fcea90c7f02fe8b4e30dfc3109daf8c95cdbbbcea92b0cccb8584a1c9fd6a2bde76b191cecab41e63562f667cff7196caade24fb6cd32de4c18663e8ada9a40ddd10a31d5b7daf3c27a965bbdabdd78803b6605d18576517002196dae458852eeec291aaf18ac5a4130fb11c89aba61a48e4160384d39f32a3d29aa7376774496e5c50c4efad8722b259eaf641538d99e35c418ab5d7dcfb13c648101c1c71e0b57b2cd424b8689eb45621ce62d3bc7cac5700605679b646f4ce2e1edfc59fe0322c22d550aa957d7ff6b524584e85a19dc00074e78bfe792c6691e63126af1d92395c34c38be786b3d06254de8b174251969e03b71bb66dd1e7eff0148f1f0d6eb24b219f95d09e81613b9d6a0899bab87e1823d1b8bb779164f187d20911fac7c099ace04a644fc5192b0714deaf86cf79095d7522572ece8f59ee25b9bf2442ab7bfeefff28b942b3d3e84d826bfe439191785ab7a94c04eb7671ca6d687ebd31972a85810dec5c7459c6db6018ce3a8880b562b09b162aeb2b4200dde2eeee577e4c29c584bf1b3992a3ae92c8e0f3a283a377fda9b953c6f3524fb1c16061c1395365521a3e098ebc6f7f4d66c92550f32c4b1476bb883125a55195e432400ed1429cda663fd375c7fb3c5602b165596be797d59634464c6b60ed75d5163d54369d5055b4599c8768139aba7724e452eebbe07364af27f5615d965371e49789ae511940da619579a77813bca4bd12fe251de7edf58cb08760023f9723b6d81dac2eda43093c92fd4780e8dcd263ef5fc03bed5da75d5f827f1b43f911265d32d1a4c1df73b2389673e107dfc99a93bd7561b1cc512adcc5b22f2f8efdc725010b7b10c77a0c1130b227e9b9a9bac5e275794d184ddb4b8cf6946c998bd4cb7e799c7b467c7cacbb512c6c267083b4195c79ebf976ed53e71a76c7cdf380714ac1cb0365b54da4b2ac79d65ac1cbfed818a46a378bba31e30579759260eeb04b18a383c006cb3756043f2b16db6880797436496fdd2d19e49c0c2d1402dc1a3ed69e0d905cbdd3d52cfc387234e6e302540a6915a36bf341d3d74309ddcb0b417bd450c7460faf709a46e7ab5cbbc9fdf86c971e4d94e2afc1625ed9435e575a58ce3d127dca24853586874254be9bca7f65194c053f78b9a5690b56ccd36e6c9ea94c5614f3f3eac9d737adc9c2e3cd2951c560d2f8d6ee386e85fbcbe491ed40fccf5a6bdccd4e2bac3a88b47d316f59d824515fea665676704f15b9091e52c9c9187cd7f4518f694515c9709cb81eec1628d731dbe8cc8d2adf7de98f3e13e953e3a8970b84cad348dfa0ce93d0112dc4e87bd9eb1904c0eb949a11380353e5dbccbda60aaf1b4e24233a2b560b8b3721bcc45fec4b75fa5b76dd06ee1f25c9217312394afb5a9f0e95ec0e3388f6630cebac3d9fc298a4379b385e04caaec4667c0f69621a3d8dd6f72e449953a3472ff3daa14b655290302850bc2c0581c5da69ecf0510e52f726da698c355a53395b5d35280e3dd27310a07d217dcbe3453490d9d9aa716416693333336c1e02141b0326fcdcc3411bb853131fc98149bbc05bd9a23f90b15174960d4e2ee1c7cc88d9668699a0d66926aca2cc13d9da493a1b4cd4a217f1f1ee8c8afdfde5996a3c24d1d112a3ce2cee67e14766e7284ac057fa5410363225b7604ebc7183a4d6ccde92af9f1aebdc7528349c7c5f560f95638301560ad5d116c6932bafae44ee44a28f210b55baa78c93ef734cad3cff2f2c58110f6d4fba17f60ea2c0c71c504201b1771d2a33a7334a55ccc2fca8f56828920f54725b8e3dca2434e01eca4812186b1a1280831454ab8b513c5e4069ecb9403c8f7d210b674df6befd780a303f9e0efa0fff8d47c9e82293295ee2fad3c33589c2b33dd404aeb138da782681b2ea84394fd734b693e2e1a242a71a5d2738c7736fc76baf454e8466aeebd3b61a289dfa0f6a7c26c601624996abafbed6466a5fdda66b1a1fdcbf7a0bfdb32cf73ad1485a36ee435e2545b112f69c9d159b58a9700ade898c7b9b02b060b54bbd774759b9e6df72c638049b5f5ab347391d0e1676cf515fe5df677162ecb188b09cd4a76306e0f27da9c9246515ba4f20c754f097b90938b230c57ec4f8bae6d229490abc5a4357425fe649420313dd7b77acc76d65405017e63eee3c2f9ee8929ca16212b66147657c284f74a6f53165d47e1437fa3c2b3eb8de86bc968662951902d2a1e062938fd64b1a981ec93f52cd879fa685830ede293fcfb12379f83eec8ddc9ac78876683f94611070935ee7d0cafdaa3d2cc9c44bf1ebd778f574a98c1e2164ec25b4d2982a3feecedb25fbf8b6c50366da0170a6abd01384dc0969d58dc0accb4b71f766681124930bffc2e038166ef8390679799cf45be1817638cd8d3acf931d2717531667ba25c3f96d4cca9692829644529431215d799a2982e3f021a4fb2d9f60b59e506290804dca7d1a20db37de1b5c0720f07cf3fd3f98728d519901db2e99b687f49de82db6c1c08a366173f7cf1c01650b750bec6b7b7f1e884da7c0fd247c80745807b2a29c8e05bcef229b59251ee1419db6e78590cd622dadf3586eb077ee72e90145f1348d4ee2a3c9a6047a66323f34cf29a13ec59a480ec7efce89d675e48fe44ffd779853f8bae0ac3f2ffda057d15eb5c8518fd84dfa3d1d55318f084b9c9c68103db9c86e6aeaaaf1a4e0778bbd078ee466184dcb06e4c584c3ab730dbc11b0891835cea15958d3caaa3f48d51a5e8a4c6cc26534d290c1ef584ebd26bad35cd981458d37fa389bec4dc592709a25fc10bd79e7d28277f2057557444928cac125aa8c6874c73a83f43d992d142f4edbe886b32e00721f9a4928adaed0ea69ff6da7fee9a28be5c036f45ff0b9dc0f9c6db45f6603b4b5c64e1e85ab78f974460e9d8a30b8ede3ee4a1149c514e7ef23b33cd13e676514e39c3f215f78329acd072ac78025fbccfaf47856f8931cfe78ac4403553a1cbb02f616f5c043f9f6eb8e7946953aa16bfb7c4a5f5430e05f588907d95e380e6bdc0bcddc3cb3b6e0778d5a04c6c94859f6f30ae229833adef19f12c25ace039d3c10bdbaa18497e1e8cb6348274b47235772832656edbae158839453ba8d613834a140499f8b09cb907c9f644afd2c20b09db5b06363491809cb71082505e1b9b4e735240acc430733ceb945953e91ea58a3e82fc4261ab2590fe21821527ae05c7096bad8718a0355b89fa860c14e8928974ea0378f157edd2a58bd6df97651129b90035496ebffa678e1111c7d70ce6925f8553cb3f8cfa625969a503d654253ecbc85a944392848290f71933280447c88f92a4b04d4bc4988619643a7686ca1ef966aa1d1b96d5a46a4a73890cf3bbf722ae7cb59444856ef30b9ee145c5d4d4a1c29f91d8d8064e419173c7e0ebc58ced5908ac8b841585a1ba02f739655388e35b55cffe7d639d99ae739374f9a8c913dd9057a8a37f53f3a76e30ca9849161e8f5cef08ba7735fe96863d41a220108f4bda1f329872d4c68f3c22a4b2b32d09581e739ce8fa3acdb29d7c24d400ce78d58d1730430abbcf38c025f2b206116e8b4dc997cd2491731f3e0f0775b40ef6a47273531a9afc987a2d27150d6f7f8ded1fb91d4a014135a80a9e86067317946c3febcd0ee381bc12d7b5fcf111b8a30eec250310dd49a293cd951776ef603d406ab04b0b8c232bb56c3cb82bf8908194b17b31ab1972425f25820cc5896370e2be8c737c68c6777f11b0ae970d03a1ad1eb35ea56402e87befd073ef1317f1bb8bb7fbaf6def5a21c8c2b1414042fc0571613095d5f34742f231755cb24b1984e6e2e23b3a0a99e9581387632631d31a8e715ddd60a4b2657192e810394367809c048518ffbdc459d563f3fb8041f96e8073fde49c359b098a64b890a8e744e09c3264ec7716b0c870cda46d13bf13c0bcbd1b0c9557a4e52ea700ca92cc0fc8aa3b9b2cba9511f01661e58f04c10e4cecf030e98071ed5b8729dae8aebe0f5514aa636cd0bf7ce7a7bec9b4397fabe358782fab4a9031a4ceabdf671b20692301cd86ec0da176759c60bef186ebce24969269bedc0f8154bd581d503802975a766cdabd602232fc5d6f902e7e42cf871a22869e50314adb7203541b8be5bb22beddfe37463b2aa1bfed5942a4abd3c4ce876786df3b8feb66920b3222914d394df724813cdc76ddc515bf4f80eafaded0a7fb97ee2e90cae63d67037ab7d80b02d181bb70a41f6be5c6b44f4010a3a6552091c14596565fbfddb139cfa99848198d98f6b8e8ea5f94e5f2761231da45d9950af65242b4d9f9829f3dba96ebcdead17a370827585dfa156fcd23f262054e19aa154a7584638a12174cde7eca4d963886ac77cc4ee2b2da4c6856cecb6958469e32a7d2e8f0fcea9d43878a573db30611b298d2f0dfa6328566f640b2a9f919cfb5b827c3ab09f7e7df752168eb2412bc1a3f0def00000daec78d923ec679c70a9364fd7dc4263dae9366fd99e4392058fe9de081fda816107c93018f150a0799c44b6df139bea58172a3d163e4e22c924b8354b20457390627a3b9ac91fcf1eda45f16f987a572eeca77b218cf9ebb529622c879b531ca848013f7ec95ba0ef1bd1b0879662e29ca0d4e6a813bc074fc5cd726aa4829b361df6dd9cee3524414d4bbe89b02d6ca702f84cf1cf12348acfc36990ab9e83982f3c7dbc5f7e8e04a3542db9b21996f0c1efb07dbe99d78573ff4b1b08f053cc858043832d714365e21f1dbc2c26f4977a1fb488debf08a5be0dace8a4ebbb66ffc2a46338e17c10c01b15f9145a4ed91cf02c3969ae40e9caa0e04b7cdab36563f080d2a88325bee42225d979afea9f7b18807573fa781f7b67e4e2212913ee211f14503b2a87b0881832ebf22c957a9d10aad246c974ca763e55411846983e56146f25fd4dd8b1a9f288e80922667c3a76e2118ccdeb4b5674ed672fc9cf4e296d9f04dbb9bf0bfc9bbb4c9cd9c7cb7a21b03eddf82e6286949810aae72f5a6e22e686e4a1353820a7c0c6b7d20e1b4046bf91a312f64188b73c40d108093aff77ed11f9f9550b1614aefa9e4151e9252183e8f8f88718cd42c8c3ee55c6ac180fa20cd7ee132f9a71ebedd00e8e62a7456b718471bc8d720682bb80aa0d026401f13c99ef4c81ff569bcb8f16c73250476303e2c434ce85723f064dbff9b9ad13dd5b464b81b2e49d72be56bffc406c4901e59c4c23b7289258d31b72ba2f9c41d45ae9698a421a6767572ac478bd96c5f94113e1c149341fcd42b815d341302415a28291ddb46b0eb1a6eab423d31b512e460a937b66a0d373d70b9d964ab8f6da1854b8701adf10fc24015e3b8b96beca1ab09ed1151aa22f49897ef17c811f31117b0892447177fdac008475fa383d6444de35f3e1fae1876d04cfc67a13956de1cd6346fbe562fffa046ceef65134298cdd7c46901f978b1c9fc62ed5ac469be40a3f0f3b7dae8514a073b089512c21db228ef8e9783bc8ece08cc7afa34a5de127ba8ffa1c08090d29b6f7b5aa4efaa75166a8f6a2ee600c024486497b5b9baa94b451f0b417f65831fdab035a4edd4e70c49f6ed145a3b433ffd7cb19c0d90b7ad2ebbe0d6f4298e7309c20645ff4a3dc45b9b57f752d036c6d77d23c3f87131ab41e7a46649c51e063debd360706df67cfaa3dd0024eca0ca919b9c66ef63d0b6f4741f45099b75074267beb4610f1e4d22bac764d23c490de7c8dd4676a47b6afbad91f25f5b803acd8f9f550c5bd037365cfac408a3995cf83517eab65f375c5225ef38f050fb8f6cfcedbc0f8fd23fc381d49c24ea21e31d26024d049e8a4e68454b649782a9d287120bf484b4461ce575a279026e42f9232ef7bd9b45971d2b1140b10a8b02b0b282c06f612957c59ae216b303f29b1506a3f3d4934b934a7df1a40efaed2446727ba42d7a209ba84fc76a78837350c72b941d7c0e7a61ffa4ad859129bb9ea0f13e8c4ab34fce319a9c4e0200ac66b5c42925acce529597620a342da0c836346dedc288ceea9418590b90172b85c26876ad9c7c53ac1aee805f32d657050bc0b28f09eda8156b7ae9f8c7306b194cdb2e779aace3c04ecb9dee4fa08759b1d2db2ae4ba4352c40a61ce4c93b7119f3c4d4bfb1ac302bc71ed9f9ad80b6fbdd8d11e1f59aaae6a27d66e1fc79e1e20c411c65f892082c0da06559bbe95974f4208d58ad3307363df4bbc6bf506ab2f8952f60902c70bcc2af3534fb3428f619bf0462f376dc4cd35beae9e3e497a411c26f5106e1d177186448a92bba92ba8643894ad2dfbfabf687cb1be466679b2d216b986c090816559ff60e8402c66a64c3c4111de9d62dcbcab66e91a7b2da509c38a58fd6aa7ea68cc29ccee7b29ee05775b8c0ea80602d6da12da27fd4b1c445fbe785852aa39be700529a54d3e5ef87f073b938242af9d7e3d203d42bbcc39ae75e01a84dfa57b27381c5db6c4d3519504038be812793c7368b15892f718ebc3c7359aeebe3b388bf2820b12b803364702c1a6ffd8c71b1852de9790161861c63b60a8176643c276bd461c5a39db08e5b06ece487980954ec3795eb3ec4e5ba966fa676b66eca3b30f17fa1f01745e9bcbd4e2fc9c3a09e94fdc3ecf2646530ddcf60a2caf464218879096fdb1ea3b0cc50e56219b5c78f3b9b9ccaef9790a13c0e78b01a45ef3289c0564f5c0e7677387504f59e3fa02be4218f6475c34e98a5459254854254a9b9944ef84330f133dfe9b2a2ff1ecac4544daa857a3dabdbbd7aabf47e71d7a11c1e83e4e82b9fb64190c358dd35618a24ba2bca8b7231546f6821f631430ade0ca8c44c849280f5d823f99f39e686b48dbdce1af7b3da89a7d82d88f3fddf4f397931f0e7a3643e48d1adedfaed55fdc2d590699b5664c5e13a1910a26683c8ed94a8201fccab3735cc5d87a95e11bbb0e67438a27fb55c11da0c7b57db7cd62d9c39bc29afd589807344988cbd9c382db2c708afbcb77872728899a39003af2871c4fcfd8e9f3caf152dd63468b4b7c0032e3936abe401bd974bfaa3bf9589f735d70194d590049c34fa08a2ed385282a08cef0436f3b3eedf15c98ddf44275559ab3e1ffc459e2faea6b59086542fcdd1e0407a4862931a53b2fa68f99b5d6132132f3411e7722b8be74c09e6806aeedc32ea2630b157c40f5aba3a772d27940417fd28f50bc92e4abe1e56259aaae8958f4fc3a05ea1260d0579df88cd808432d1c04da84bad915828b3966f1ed87357a8e17d7505f8206fa341f295e2d595780dd71381ce7c4dcdfd8eb4c918a9c34c3226da00774bd1803baddb2f57f2e81a9895b3cbcd71d6affe5dd1e6a86cc19f8d45883778e60d8df90876d6c0426f5edd44190dd637139784b3603dc51130d28aa780b44a2e55ce7f12b468a0bb985d7054a399f04b2358bd6ff8026a5211f95f881fa5050f8f84a858a79ce28c0d5f3017b41b9915a11934b0703ad2c1411058bab0c59ed4d153101077aa7312f11e1a75a3a0818ba76145c848c6b6a950c15812faa7282bccfb5057e85fffc240027333270c0fa36eaf9c1456dc5bc72de51153023844ac1321fd277f3a6a2dfc73b4504194de48dfbca8c0db64bf1b6a546968a77f045d2f18b30bad960f407eaa2c76c0bad08a6e9f9cbca283e77849fa51c1d84e9907524df22350e2e5844b29eba836e6e63d2d18498e25269dd26d60ed7b5ae3ebe037278460c14a6d97b450022c61e7137cad6d730b224b60c782ccad530977a80e49f73c2de485233c26c603529d956f657240b6a03e6b74ce79df3a64ff1f32054663c981f16b23db0143d330e05a00e36cdf5657cfe638d860617458057aef0967dae871f10a4a074b58ae5fbef6da24649d9ea74bf9ed5a70746091c2120484378e0c78c8f327dff4b0fc370c6bcb0092d33033017e296219a5d50e0da70df93bc2fca65003b0580c325d3af96b2081c6785ec6397f790fcffe24775cc666a248e4a7bb7a953d0534a5d1429ee6f6989a87552169bc5d4b4dd31ec375a488c0ef2cd0db1fee76d5ad99a4ff65e7e67b70a8c2b73b0592902692a4e87333922ce73db7e508bef4c99ad16cdb768911719e3ef57c74000a901e29fd08f7b19c2f832fbff38dffb007a8316f9d79fc0f3f5203fef17f8fb1c245c7d0cedb6857909a50e0696aa58e5ea6fc1b517b9f392b9a98b007f7ba6629d09de77f31b8dda06c9411a95848a95df625edbeefdc71736fe41a9f98c5a990c7975782102b3707568c98b7896569d6a662164a392215bf95184943c089ca1bb97c11b92ff3f387e67c99d9201e28e6886d5abbf68184f8c8f82cdb2cb2dbee3f354e9f138bb14af7aa24fcfbe66b5d3384bfffc7ec32812e7cdb094b3bcbb8486c714b08c0658f2e675a45531ff4d54f0a13007e60d0f27cd71f4a967eccd0ad148cd88f16b7e8459e16e62a3c91a47159fa5e2bb89022a48eabe9bbdf0f9d59ea7efcdc08367d404d24556a7acbbd0631b621c29f017babad5833b8f7149060c087ab8ad688c87a62bf123f513277455a2f9f32264a289ad5cd950333a350910bb362339505cd5f4b409050fc3c65882d00e4363249a2f9408150a5ec7e223f0043a1c42083e56441fe512ad529d17cad3d334f069d7de3072cc6e33b0a9b743cacd7373325f31e56415ed6b6beeefa48470adfce8c152f187af4217ba4ad8ed777f1de7081432abc5f1c9bf718cd66ab2a92680f582334e84df376dcb56516af8497b9f140045ac05c0dce7bd68e21b70c7b4995f795d699e97eea39ffb77d1cf665b6c42c53172293fa676142afebe4c41c1a8da86da7c20400e6d52d75fb6409cb92739dbcc1a6394019def2ea91364b04a11d026695a36aba383045e21e98534013a174eb7d42545d0edcd2d1b548923de259311ebff1c0f10b696db6b391afc303c39365071edbfd371ebad3c457cfe53a91778e9e37e7b7be0f87f8a37b1fd642e143aaf3cb281f63f06e1fb4e5155936853e1c30e0e41171418907524f5a1e3d04b2ff2371630f2c657092372b108d3644bec6e7752ff859a8ccf78bc9a9e89795a04055afec6ab4cfa2c0a9c634bef6a23a8869ed0c3588ff7854e3194092f64683dc8e8bbcd3996f23b3d4794a2da98eea5826cf66f6f86a0bec4becc2d6ef2b6caf6a166d5db385e10f7712dc1f25754dd1b4f4bc1ae80637987191cc66f7ddb13535082c3e65eca384c794640362eba1cb19c26146db77c5d0f104a076863d6075bdeaae154b690c26a10815db8257306a8deafa26d43de67d2c8ed3942faebe5f413a7a50126b02dcc06b5eaf7e28683de1ca0e88ad60709cbec0354e889a0f0b5284efa138b09d695fffc240d6f01ccdabe99ff85aea074362fc3aa64ebc0a908b9a3fb52e55df272b8d6e96a38558d287ad0458f67015d6a55639306cc8a5a25f411879223ae7b3be3c39824b290595594529f4d3d4b99940290b0f84e5f95bc8360ee3de7be3eb073f630009bb936e5298343668aa94e31133c6a020a0507d554d5267e0f2d4cb12d1e5610ed9c7e03d97f4e07032ddc6792f10f3db21a4695de0b0ea1b614f7fe0b9337fa18433786104ed1c0ed9ada5277a6b90ef2026ee138577b39e257334567035f401575579c481b5a36308f4a7e7ee31a79ec6580d83e08a106dca0351dbefbc8f1ab4193536a0d76dea69a7651c05127893a0df9347fc605c75580e2cf08b35b5027ce6f9282d6b895ec96ebe1a9b53dff8927289eee2ffc8d3af67e104e06e99a2596a6c2e179a0bc16d7c6ce2ef258d7fb4e045723696813a6f13078e7861a63401995340706b9575b1ce4e834b3b0760b5f9b8726b6ed7ad21b8d8748800d4ccb0f38db758110209e8930356866f169fba22688d1aac323875e7b4a3f00652ec1d9a166bf73acfc821206ae4640c3219cffffd1d04bf1f1d12f49381fe03c466c792e50aa759baa7abaf6b9fdff4a754815a4f96d9e6788e5ef5965c843a6311a97970508cd2ea6ae51a8c5bc78a91f8f9a0c9c41241c55456f0fe16acf2e66bdcdb3b2b371d5f4375790abc238f3b2388ea452aa3a88cf7e942cc593250871d0a19e0e5480f9dd185cf03d1cb22cc19ebc15d3657d061ea6dd837738c694ae758665772f8021dbfeb5f0562095a0aa8d4c49997dbe8206157519b08946ecf89bd603eb8b626f3b58c9dd460e7504bcb1d18e153b9f85d0e75d1f5e85b388e4e92faece0efcd896a919b9dfedcaaa0cdaa168e3b2311da86d09772e8428bbb11a9659216712cb48740cff1e85a9b0d1834d2e0fb546626a5bdb4939bdb4b55f74a3ce83272f395fcfb8ca500148c077c169226f1685b1709fe93284255f832f92dbdc4e97d10bac07dd5a3e24f1dc13d3abf8926b53838607387f8092f48366025fe8777c4d031a2d71eb7ba1310d8965afa4a4e766909b62601d5c714c85d47da0f685a0997935de9347aa469e158b6c3180c34b432cd90d60297e166105f68b546ad93c31af8460acf240801a1d43f83d0d9c75c678e6d8f1558fb5f80c9aad74d072fb2663da944a2ee0d9a53f850bf343e1b037aa3fd851679dd22e6d0ff026f3c75a6901543f14df64a88b7d366277453c3ca93e4f0e81ed20d10036a44f73ef02eb8c91dfbc9b730e6ff243da1914ab5203cae4ff46f85bd0dd121cd2821710ecc8aba6848a2ed50ebbf31151af0ccfe1476a3bf5e48c3f1121dcb19970a8a9e4751f81aae0ffa11c26686ea5edb4a2166ddc915f129c6606f71044ef47e3c29e521c544a507b199cc7f7fa047d0ec79a39a54a4c598cec6f67c431df31fb47678285ad0dac42382bbec9c73611cf56b0dd6ad7cacb34e651afd56efdb55bb1441b5c07e6c75681b3b9f772ce529779681ae7a7cc933a124ffa8ee8e78ddfaf52627c2ec9c6bc4745d5b5cc281a392dce7e4c2c00a2ca0d634df28cefb95a54887743a81b6f70d61c7ad0fe6646342e9f316023a59c3f09a13180d4ae22b7223af8c410db04637bc74a9af0d1447e95ea85a80a0efb1b8c2aa94134d6f964080109661e769d53847fd43b16c59c15e4ccba53ac939ea5a1b24460676ea6d1d39ddc7b5c983df05edf529f0297cd732b9da42de6d1dea981d2c668f4b3f7f5a95311865bde3a90ca3fe2b9e154cc3b716740d9889faf218623f55ba4b1d8fa395cd52b8ec55fef358b932161bcc7c75d7791f7adec3f103a5a60e3c566fab8538e786679bf1ff6ce14999f0a2c3ea3bcfda07c93a917fca5fda27c3923fd3ef2ac65f866e672b67950b959f7caa88a8d77387b4b2b29e44d1efe2b442db40fc3a4f401f341cd56e0eb5703db5ea3bc7c23e8811dee241f9fcf86b0be4c278caa399281ac33a0e21bb65071c47e236e68c0f6505cd780cd14cfba27191fafda9fff4a18d65db4c87cab338a7008f6dd559d12e9cc9c6bd342fde4887f7d37a815a6a3426e5df9b5ce3720ee0726257785635b64189e6b663ed6796d5368264c33f323e3a05d8ec279980847395a45057488ca1bfc23b90e5e8d192d61bfe5bc70ecb9d3ea22d2ade118cac828a92cd9e19c5cabcc953f6359f1aa9a65a4d09f5a13775f72709e00490f98a5b145e972ec57dc849c146b15383b19696677dd24b4c97498de3643d1e4c5d87ec631138b86622d47e4e6481bbe76334a32b27657ed345993fdb4ed7564c8083b47fb61e52543b4fb667de85004f6d7919f41c0a2d374699ef9c5ecdaee19089d87d7797474657bf025fd0cc2015ba0dcd47082050aff0c5c36e7ee1870390c61ef462d117cd9ccddb6d5056eb4ca767e4f5dc4002a6eb378d90ec6cb4d3aa737c81a93e41abefa80a33429c8c188a35d47ccc4d1162942c41634d196798e59eb28a2d18e1d96cc5bf020832964e3e01009cf569e2c1095df4907f1fd9f9aa1b4254bb30cb1a31c25b5231da2603acd0ee10871f84dcbbf11ab33a2a8df959b285ad0053277d519df98e99b88fc05d7a2c89faf5f117e02a8e97e263750da12575a4fb6202d2fa00c14d1273d78ad95532e0addeecc8126bc8e3045a496499aa0348886f42bb4fa07e0d83bb1dd6f04225d2725dde4a8fabf4e930e6557d35a7ceacfa89bb3adc070f1663170140d6b8ba7aaf743b153a5b90fd82af61304d0c4b97321a6174fadd6f3e4ff24b8b4cb838085923b112878ac7efa2355321f8a42277d92d5f35d0065ca0b45eaebe8741b967ab625b03fd9374650f0f80abbf1d9ff18b2c4b0155d18b3f7c29cddd1906f84bebc2e6a0acc34a099f074f9a26bccc794fe34176094b9af08640da81cd28f0467b6acd905046aa7feab9754273c6dc29427a1f32b1fc5acf0493a94fdf878ebbe9aa590cde0675715dad7576bdbb3e0060917f5fdab698a41eb2517ec54a9256741d001e4bbfdd16cb7b30f026d899fe088b805b66255225596ec12112134b209bc84527d52f44cfe19acfc92b7e03c4ab2dbf1612043dfb17c2d49333c5f9bf50e080d973ae843f71bc797825f5d70d1ae1f36255ab8e9888b872efd9f7e40ffc217d69964290724868878fe2539a73b2c4c1edab7faf21c8997cd6d0110a717979101343e5ff370da89541ebab6d388164fee9237e0d329c295a5b0a53c5e19e9c78e4e2ca8fc6dcfa03367c1b0f2c6cdf98389ed089b9a4661cc048ce6ec14e7c206227e4245c3393b9ff33a778db7fdc1299d13af3d4106e71cac43f0f5c1d5a5b128535f6ca97ed62484ac1f8c8c8130c2781df0547fd9d142ebe1b8e5a3029ade1e8202130771a5e232f17c113693b4d8ba3a55998219fa37e4211b835323ae7b55d0e5c0655ba56f1efd98d2a5f37fc014bd7802d6f16a8f5a383b0a65934bd93ff4047623a8a6544f96957dea87da1d1998650358476f010cf2e5f1f69fa5b5897073aa9fe33e36260ab40bec8b52d02c9b9d8926ceb606bd54fb1e2444491084b5948c3b4ca3e3f706d768b48c81076094d146863e5ff230a114f8890a20d1d87c2e1130a07bd868b98d0c483e69c86390727b1a69b318a675983d670a6c95275f97bf195c31068c1fcdc95d841223bc95f9f060a68228ccee56f6ab131197ea146856e302067063a4fd277513b999ffee7ab9a3ccd3f497879ff68b6426a5a48000084afd8850e1792384f1761c7c57c3d5e58598bfc6f76d426538be2a964243b480d6aa390f75e7628956df41acbc98d01dfedb9eca45469c46e31fe00a223719cf37d3e277ec12016473e572e833f2aa6a3f3dec3cf7dde094a3f0d1ad5280a392f261cb1f55240bd5054ceb99cbccf6fa1f93b3f386fb5493e73592b600e98cf1c7c9b80b86c8d8754610729e8c535aaa1732607fc2bad3fca99d6c882a82bcbedfa46403eb71615ab8bb410567fde6a55e148e29d1131f778a209a632e8e53b60566b7000ceecd4257364161ed8d39c445b378972023c69734d2d6e6d82f990f5594adea3dfae110e99069b44d7301cd040fee7f9bc732024f51d26e043d430fb665c2d53c97398b2dd209c00f1d718986ba337a7fc03bd0f244f767055df7caddba5f9dda0e84651e2ec11ab1519eb56ac301a2f23cc835a4b3af31324cb5f9028b00bc15d9fe15e8cd4dc7e4c11f91f8e7af3fb8da14512fb2c88fd4515c1e03222f1850777b12fe066ba0a831d29aec375fe7a1a53ca4ad92ed70e87d982fb2f9abc20d94f65bcda5afe3490309a40f0ad408aa55f5835edaa0e73d7be2c0bd2d76ddae4ee5a0bd716860acbc2a95bc3af886ab7fa25429cf9e183b4f534fbc0a609fe6161d2972b0da0d4e52cf6a601bbfc60d0b347a1af29af17e6596713085713c1e5c1474182e90b93f9aafde887f0c5079ee2dc389d76096af087196a1b834449bcb6be1b7162c524f2447c032275849c7fdc5fe21a702dac9005e12e9b98cb236998bf184f4bba78cb97d1155f53d894292bf7355559c50994bec1f1ef5f29145877f30f3f60eabebc1400081338cb17770973a93271794e604c636a4321d453ab2ae829ceeab7b2d03a2d5c7a2c8aab82af2e4efdfb2057ed8db2e46c65ef3885d5137a1d9b2c3673a6d5fb8442950d7ea85e5ac8efc19921fd0f39a58e2ec59fa31871d18934a2eaf5824cf3382a1bdfab2e42265c62f3aa8a9fb571db858119a08c942709044ad157dd4be73e9112b8753b201cbdf319a3f582bfc09667c5ca8fe9e289a955e9e6dae27b62b64aa1c70fbb3df2e4c213ab6f71cc20befd4fa822fab8537dd7131310e1a3092ef1a340439ee9c4318ffdd86653f4831aaf64eb2662c495fbfe570f1a809dbf123bf9c906591c886a9c5bbd2004ab1b0113ddb6ee1e6ce534313e39d0c3d0dc1992f1d0890932e614a984f951890215cde51bda9ddd26c2901535633b94348ee7a86fc371b9b05f4029c71b49205b8fe4d81eccd0c9b0519722d177355ff621624c66ee16b42a9a0f02a16d27b017dff6c8bb6ae2fc0d424bf216d6761bb979ac0f21091304f90708e99220380863d3bac5c4e8ce34f0779d34363eda54f69c304ef722e55d7b278893ef47976c9d9b9cf9adc34a9d49ee630c0c203433ad607dc838e4b5de1da126706b5be2895cc33e567ea7545b99d1da73ecc2666b6a0d1282d5f08e856b70f7e94fcce23e4926b06ee7d6e8372f2ba4f34e4130695dd43cf6c394710823987975536287ad4d4dd1ae962d5f5d923e8159de85e1ae261584663370b4dc20ad2093b4fec4914a639b2c722f6781247baa7dabba29721df426087dd8a1d53472d9457b50f7c31231a3064c4fa8a996e5e77007c61163c2d5ce47cc85b2d0063a93d1d1b64bcfbe57749fe3dc3d2013673369cb3ee8809cf18cca182cf1f509167ffb6b30a2664dba6adb51ddde237c1f0e22e8e2be8e2d78935dc4d34166f89ce0733f49f7203f51301ea083900910d450322624e09f402ad3f1b325af6d80714dc3ba3328585c74771a6074c480ffc987d17e0f4ae3993b7c3f365ee5b7cd61a6099b4be24f836f0aa8ea749c95497afd6cf92f8363ff3a665376795df58c1c1e4fb65a002ea06faa3b9f70787edf7fa21b39128e9b526f7c579c888e307e75616307376bb0bf1c2f225a3ea4f956badb956a547be07d7d1b2def404f224c6bca91ea6e3cd801c718b125a9255f22cf0520be1e59f58ae66cb803b42376c74f945e5c3eac15236576a02834f050bae494a4d46c1e092f77506d10d0574aa59711c9dcf3e4491fc9fb5d9aa66b21778582a3b218940a11733cb4390129230f396d315b40b845ea696089e42d054ceb47157bcf134d5d8bb367dba4e3533ef8e87880731ec1ca321453facf964bbd74b4e77013ec1508106fdef694237f72232bdc996caae0fc1f6917cbef40644e4c23c0e69e90484edd347f7d59dd092115322bc2acda793609938886476e1dc8f1e94690a3071f50068742a9b0cac8944c3fa16a4ebed45898992ba80f7b63de15a352412147b204b60ff191441f5e623cf8d9daf7d6523c45bc61d02b2227d6b5200acdb32b8d1dadf5bb0b0edbfdd7b3a4cbc72aecb6ba7686cd65708c1a48507b1fe327e49a23acf36dede173695e94288aa700f9cb392166a350f1998102f5369ad138debaa4b56fa7d6fafedb35467449d365f6fdd25892476a2d73adfa2cbd1ad71a11b85c84d921fccfbfd6ebd71fdd52b20f5e2035e7bdb624b51cc4fccb1f125d07dc7d38be683febf0ab0336fdcbb153cf898d5cfedba227e08317df0101e19d509d90a368a88f6145ace5c5cf831575d3eb7f8bbc7562af2cdcf4eb4c6087713014e6c2bd2a22d7b96cab441660f6779dc1fbdd5e89019c846a972bef0b0d2595ffad13c316c9c21370d892362fd0d711e830ff71ed1b499cf601eb20ad17a7305f90a7428bd5f183f68de00e418dbff4bd778a3d418d8a179f67ccdc9d8c4e0d4b9256c09e7737227a803ecbfc68964cedf9a611200e6114dd7623e22c3e8381f9335e12e2d2b54f629377efcfc19b06c0c1d636d142cd8c0b3c9875b62280c61656398ef123c7aabe6b9b202ae094ede2e40c340505a7391d2bca37725c8f9195845","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"0b2d4f1539eb0b2d25e22d929d0835a6"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
