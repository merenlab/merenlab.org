<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-001</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-001</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-001">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"baed97ebbef825d69656935a657924eb6df2346654323a9c05b65a8b3dfd6278159c405fca19dc3b5d507a88f349c4106378b13b562c03baa338b710592ed5c778e9ddf25a697cc8f73662027826a10bf4f6e630dc5dbc538b7bd8c8b3a7fc8523d5ea809708d485763a90fc8fd6ad04e91c88c71c1a1b71e721ef79f9251859996e29dbf5ec5da938cf02c92e7b5aea5ab8bc58cb970b08e1c2393bdba47f936c6852a82511387d41f66413f0a6a083fa795a066a7fc48700fcc7dd835187b2886a115ff78b6d9c438e9f5a4cac3b0d5c6347591faa2bc43ff8ff7404fa7fc5545c93d6f70863d844db28dcc9c8e6f08d7638a0b38eef5babb6066fd8684340068afad4383f23e8c1c9d1735c38b53f02460bbb5cda7b2fd98672691702ef2e30eb5917103ea646e13a09c12ba66094bcb7055a70babe8360b5205c1b52a5c6429affbc7ee27192b6c60e36e045687b23d56840a32a0e14e203d77113e648e4b93e07f21328b8575205e1beb95a1d5ad6fc10cec63ff96b921c1311e94cb6b1dc575f7db3486a39f819a8cb2b833456bca126254a525cb3775b7b10d97b3c38a46ca16f8a4464d1dd60e996d6f938e687fc28aec33f9009d09226509ce9e3f33ab17d2af5e99f25c3001059dbc9a78b24832300be0945bff754ebd7be2635c6303f6f98955673e70a8fdd9aa873af4215e75abc061c027035c1d1859fe5cc13e2f73782c62c3b60799082be8fcf317ece6b9530b1432ac42c21590585a59e9b38d8b34b6fbcd63098ca5570a7cd0782d6dc07f9bdf979bed88dd80a50bf425e3273c1d2622cc6fee47be146cd6e1e25a4c96af8d141bddac2d8edd9ad0723ceca41251099b050d3671aa5b52752957a31b555adca9fccfeed2ddd5e69711a3bf3dc5a5fd960cd50636f2b3ec3f18e1c1dec50f3c33e981af94d535481410c90f5529b2b61d46a112890de033b0995434433e38cb5c350acb7fd17efd0fcc2a0b43ce31a32bfec01c25cd64f120fde78ee2809e6ee94925b8d7f1cb813a99f42b58c8c3e63d1a145519799f89433f67dd9044a5f41bf14c3f675bd3ddbb08bbefb5fdb92e8d3f92789b0cef2def0390a567801c50dd71687efa5f3cafab1fdb885b83702e74a4e7f3e91c647153c43790cdbcbd41b80b364f2130de9a6dd237dc1fd6406c451add198d5ac1b70b57cc4ef9e7c87007699141efc78337309740f3f5ebeae7afdc65e4c22acdd8b320f58bd80e779bb72503dbe009f0fa693f6ffa5727d05feb24b4cf51a697b2d495350be93fad6ce53e9d03884f12743171a7b32a49a37fb3108622216fd30ad90360f3028d8645a34dcd369e947dc6ec9a34a42d548ac19cc4a881d65d46dca0826ade0f0c5421eb9805f4b060251a171b193404243f4400d1050a1dc48fc01d3317efb825772c2cd6e93601e91466dc680568876800bf913bf3e5398f1497fa960bf05c3115843e301f16d08883d7d506cf6519eb00d8a13f016ef79d3571c7fc7fedc8b498ae59379a04bfcae5bc88d6237bbfff9348140e1959e05386cac1c5ebab79fbda51030904ea679eed39536940db3a3afd1cba7c53b72b3f69cbbac64503e83507c03acd79b72d83aaa61ebe6c3d93202696ed60aaf3253eb0e0c60074f8e148796fa49fb19dd23e9a6fcbe2ec7c75731f86f323efc62c489c9db49ac794776e20facfd3df102db2dff02d393817f874934bf6dd3287d4b81cfb72ebeecec364f311eed6271d75752af6492beec2fcaaf7476b8b39e685819ed5d3b77369c73de2be57f29a893865b0e8462b771f60cb234d274c1551a88fdfa15a27fef7b1641d208dce15563cde3fca7344554b9076ce01039f7ce62b5d28c2de87abb52924fedb4a562df9064147fe7c559ee6f1afd986b4f01d96b9c88471bc2c26f0387f68a0a831f43ed8a9aa375d56ab4c50d6aa4d3901b7249336775c63b50fb535919fe6878f0511841b98a55732a72f9c538f27bcef9654df22cc19694ff7fdf5cc70d5716dc46f5b7024fa24f3d6f1985a4632bb223e1a7608f6b3242afd8124f0ab6d81bbb3225416eef34bf1014b3fe714fda84c6250155a5aaf9cecbebabbb6821944650e3b5164ec2583a57ccb6c82c677bbefac9f7d6690f1bc35157b4ba75ab2d7f4d20303896ae80eb28bce9ea1f74d9e32145aeb5566edf5b034a5daa98f40a67b32d709dd9e72fb9f2b03e61b439dc5f8054f647779308118011240952c7e102dc4a2a1ce30af1d9b5c768c6877c09ec5920dc68d748d728c3b165747480fa1fde72604c0b8905dfd29a6d84931023c90a918f30869504c9ca66c6f7d49cc3edc2eaafd0c38e48208c9f3e303d8dd5873cf7505fd03da020bf5b4e4413590c3f9d39cfdf81134343e1b9b755f19cf91b5eab0d56981fae8b3c02c729dfbc861f26c2a4426333b1a7a34b1da6ed0ca17419ba46ec2e5b42e24e864da55c0652fc67b7f9b9f37ba241a8e2c6e627f759d18b02dc3eafa226aa4b1af4b8b61a0a72976145ef7fdec779a5e232fbd3a00e2f418faa8a358cac5e003e196319c7a0c267b5514b963b311b5ae49295bd446f07499b92171cd9cd6eb1846e8fbcc128425f4f3afd39f897f3ac74bff78b848eb50ae5c7097b871f13234b99bc10f8af3e8c8a58e355f184c6382540436cfdde7a2d23b836d6b751cdfe34c73e886af318a59c5d4a0c98d329a732878c2d36abf0163479f68591f6b1f6145a3c39f0b573773dd01646f77e1ee55d21576152808a1048098b4ef8ceded5e06b5682eddae5a859bca1780cc97f3e5ef7d0d943204b1047d0ca6df9d1b9bed3b005083387f6366f8d4565d521a92fe7fcd67a658cc21ab70570d1a37cd3139e9a9d32b2354aa92ce74069ceeab44a454877f382e15012f71c6333e8200bd9a5c6076f478927e66f565c48ecd7bafb80363688eb370f251a2c008451420717f5dcba412261129e15b0144389320f12a32a82c0f4d7fcf78bd965e6ce604a5b5965b430f375310607a6a5ca829465dfe533b0503af266f40b5ee53229349aa0608191b1756e2b170bd2522492000ed4089005f1545701820f801e746ca8a85bc8a18ecd0dffdaf692acbcce515b6bf70364dc3c526be80b846d0173e68a2a4fd0a76d39bc133d6f85921b6760b9f1132e31cbdfec95a47edae62b263cb668d009528d2dd4d3caaf1b46dc0b92a8f54c388ef982fe5410f46779797e3badf1c638bc88402f1350be43fc58c42d8e29b2c2d865839ac74a0d6e1ee43d9b0d3c7c2fb6369f8d55c0dc3ce90ca98abf54ec9954766779c564dc631c6c17ce0ee20f219ce963180eeff92f3c7b8eea96525800f947613c6921e529dcf8f6a878cff3aefb8d3f9e34f3e0c8e8d098dfae9cbac38223caa36ec7d3164399f7ec6b84a6ccb2c1b9d1106baad0f64a93397ef0a87a88311fb9406c91a1e28a74fa5e51046b3ab2f0bcc3b2c1ec33879f0a59c7bc35095f3049f477cdd27718e9a00b3a83abbed9be6cc59a4b624a129760e656476f44e3f01a2032ee542212ccd5a39c85df17b7e6c719de6c4097e9a5143fc1ee8037e1d201625b235070087493d19273c6c14e1e9296cc970eb65daac8c087b63a4613c88007bf4408d00c1e7eb53e2eed51618ff1ca60c06202d96ac8564e444fe2c88f5494b2ee3a3890c80654e260071b3ee6b8c5fd3730543396dce4b44cd547b159ec6ff43fc409ca670ed9a89be427994f17c0903d811c3ecc6430b22c81e00c8054d76a71257df5d63efd190605e2a4e2253b6314b6468731b97d1c5a41048867ce9bddd84200e353a6edc5c9efdec748c5662cc2947a3ad0d1b06240bdb1a7f2f976128344566dcf64e80bace7267d3e2005e771c0a00337ba69e5e38a8469ebedf7fc1b988c68b2593024497d646a96673a4235fb54173e67e93699bb7e3cd8f9d6c862195a5729e0b9d05b1805c2d5c3d9b9816ec6dbc7b1f3d250632f2e363b8db82a35b31a019309cade465a72de124f8695630b0d97c83a0804e2860036e90837a47b8603619c28716c3eb62bf38c20651a54bd3f9a33678025b8e8f64b30fa81cd896262bfdcc26f4f780004b0ce9c5258401235a3052df0e803a2b318b6c8802abc2e8c31f4ee031b701e971a107b33d5f9a767b660ce2aa560f99e7a6ddd7997c2543dff1da8c967c68635a186b21f287e9d587899c626ee8dff78ca08feb24b76e6cfd83de7a74190577bb8c947d7f1922e3651e0fded09e149491006900ba38dacebcf6502f6670e3a938fd58320ed42e90d3060ca746a97ae5119bab0082ddc6779ab3a5e1f12d9aae8caca97d86e49af1e334e855ab31efafc922acac4122020ef6446eccd0b1428dd828f60a0a1ea35b1e13ff5a216b23636821853e5e327818d22d38e6b2540896beb457ec2e9049732243941d5f398ca70c9d5637baccbdf94fce53ea670c25726ee4f3f99269e1d263e66787346d38f33caaf685a95cf02113e8db2245cbf0aeba7aba33cc7b75c10e415bcf4f4530ab65bfbfb5059c4a87b90e8b39edabf261317b40a6133c6b82c9bc39fe69369c049e964e32152c2c928cda1844d5664963014f95395f0658fbde302cd792177679d52376452da4938ad63f4dbf237f091452a48c316c82a94c04b7179a50afdf98896d32d4420b8020bfc4db3efc27ac569ff1e058e28a6aee3651d98279335967f1ad12b0f41d8643d710bbf8afaf52d53235acb6abf4d7782ba2654a0d2887393d159db5904e226c66bfcb65d37dd682f7a03a79d4e6bf423917ed2eb52441926427d0869314eaf16c744ec7b8753f773c5a24086f9b69a9ee0dcb54ef163591cb4ae1353f9b9a319af4168fdbcb213afdefaff6a3fde66a3fb5f6184740783baff472ff11f79f7b380c9a6cd43f9e8ef0fe7c9198ec0413fb10f15e399dbf9a9b799b1800f7035841581b531e6c724b6a2ee31c0352fde4e3f7ed6f226b5b7977e107c662e0e98c1e3a56f6b22c465d13709217c66a7324c1fe7c7de441dd625e10275147f0726c7865d32472a0832a03bdfbd411809fbf556d5acb9b860ee5364b5761845b6ce83de689650682aabc81b94d68613b938906c7c09164a12ff392ecedcf2c7654269859d12167c6244a6b879ccb1a68e3a7319a986fe0481c9cc4e38a4d2870e193b53398998e8eae47ed08a618779d6478c377a938300ca7c3231fa62d74f120630c1a3534f507dc82fc736f234c0694f18ad992451009e9559ce48d010b3d2b826cee7e61515c93cf61d9eda39c52759afd261a545260efd98c263892bea7c5b4d3b03e668729297c7ac167b6a95b309887330138599e5f68a0f2e45b223918e6565ccfbea1f7b57462f89b515fa0d579955c52b54fb750240e77076e57fff132f8c22581fc431a51b89539a61928c6a7dd1f41b2531f06302b816941cb6e8ecad2ef3625d2499b7cfa5915ad43b21be1b09d2442e5aa1dc64682961a898e38cd72aa3b6fc536f5dbc71fb0bc53aacc8e33600ee7fe10ee0673e3f4eb57dcf7b30254e1eb859a81bb9860582c83d16c7a848e67933aff7eeca56dd82ed06c0be6c03db5db57c60f6dbe5fd8ba9c6c81c08126cdcad677929c21c5edf9f7a695b5e4b7c8a4626ff081e2f3450cec291daa846c68b6b2c00d47b865a69135c49badd9b4bce0df26f8c44fbf5af01bc4cdb5ab6322846175fa5e64db6aff130ad5380288da3356918148ee4eb6aad44f152d1ce30d1e1221f16345a645b6a52a1070ead341e68cda3cb9cfcda3412cfb9f2d630223066530228e77dc382232b8bc4752e30788a60fe3a2aca14ffa2b5a3b24a4ef3b3418a5497b3c3705769d6a99cdae6c97ccc7c671b2abceb5bd8f0cb6cc30882fd1f6b1b60c80e101d36353fee0dddc55b3a4a4582dbeee43a0da68d79021429cb59e4fe794bc99dc25cc98bd3e7d70a8a8b2b5bfc772e28ddff50133cd2816c69b48e7113d60e0882162ffa0ef27c2a6f8875f6175fabf07cda56801c55670024b4cfc64f720e5cf3e1ad1066f331f3e0d2d36cccec5377f6ac37c2df2d1bf149c9349e24760788d4f20f434dd59dc1a07984065914e0f951b18d2b8cf67ea2ac0f1ea1b9d9bf30bf3dadc439927cc124869dea387365c479ce1a708334ed26b4890e66c825822d3729735c102287041b6137876ba96c7743dc5496b44ae0da7bdb75a3e475f2ba9b91afc34507f8c20d25c6783521e43d9c70eb60372d53558333b5c8e20cac1aeb678a7302b108f7cdb299f6fd5b5e65e6199289c171508a9f931dc3973383a7ee681c2e13e569b68e84ba61501c01f64ce159882a427c0f8d273f2b6c35f70f6a8a7ffbcb2f10823901e638d29372eb4fac2a191dc53be4e22d77cea84b64c93f65052ff4d2d2c118ba0ec3e74d229cce3525aa04a2fb86fad4e5d4b12e53c73dd5d46323b55bc477e50e3d03f72fe9848c9227b82eb9c9503f8d954699d18403446d1b2ffce204539e036c7b1b8f9c58f02092f929001fb937c17680cb5182bf3fe5b810edf89e2d5222d718e7ca69220dc22e6bbc5356978505b73a8bed0f75afa30b9fc8966104092203871bc42e8dfc7bf162df7db6186af2379cf7ac4f94ae16fdc42317432cb1a6f3f4f1a4c74c4c7b8754161e4bad63b8de99b674d387c477ad6c57bbf16dfea71869029965f5d77f8cedb34a7e86fe0b436a1243aab7b9e57cd56a59b484deac938dc77fd04cad188038266dee035c7cfc2fce97c1bf39dcc1dcb2be5c8966c8a988d1cab280ffd0cc8470e196e7416e365e42d922f9142e97ebb950d4cb399b97de7a1368652ec8c75fbfe09592b43b5150123bcd9da2a9094e113933988f63844ad6a0eebfdfc73586e90a795f9c9452946577c93585c986b339029ec5658ca935f52ab815ca3140e5359b8849147c6c5dbc0aff9d48c892061e135aba3accc31b2349b38adc68786afdeab330a49764af0155370aa1c604a19f4ef536259b51a079e2be779bdadc34685443f4275f6c0efd7d6cea2f0a025c7d8303ae17a42241447489730ac9bde303ab7186eb1a6ef0c454bd93ce3d88c55a97c2adf5e23b9b66f609bee1d2c7d35ee8e13883162ad4d43625fb5ab5fbd54ddd64f88a8ed965ab9d27f104ac420a28c08a22118f2419a93a73f65131ad7971440df177a2441b7f9ee3bcdf7dd15448562bb62f11e967bcf9bdec281e1a4d13f7a2e91108f34b66175e802b459d615c44fc98df377d1dc89ed76e2db6edd9efa373e0842d0836509174e9a34ce9b59a462ff2f6647740744a46e55fc3248f78856ee3fe359b92591d5565d073e6040eae50799f19089bade019e1eb87b9fa8e70ef7046834a6d5fecc823b65855ce1af032a4f45966b2c4c116dbcc619136afce9268d0e57aa84afbd72f4239d6d8df5adce3fd0d688c7e8d97faf597c716e80c986ac45864bc41dc90ed516c28477d14356c7d4b11151f438afd03804bdf1359befa9d13b68d0714efcf46d3a26275574075eeea8ebb6d8da9cc5e624ec530516c0c220021d487d2921fd857b8796ca054a6bda72416c6cc6f07579646789e8a90284982e6c85b8ef760e753b54dc6ec2f0235d271d59e31c4d04be3e078b80b95adbc66bd07f174f611284ee15919476b8f292cf4c1a1b77263e08283017bfb08bbd66fa8e9865b25faff89f5e3ffa9e8e7e8559a3b65ed3aa34b8aa1101a5de07c7ce7ca3919ce3386dd5a9b85f29659369f66c963f28ba98a7f161d54d8ccd58d00aca3be4d9bee279d508beeb1234c50852769f7d083faa8fb3fdaf67938a331eada88f4658f3b8a1eabdb65d664d2eb0e610273164cd4dbaedae8e50380c41e1f6e71952e8839d544a4f1ca70ee21c8f9947646e28d3e2b4949bd1883809905355e48113ba97581c8d34762fe422e742c72b11c94b05a1021bc045a01b97b6b967ee67252eae6417479fd9ad4848ceeb83ad5b2bd217cd2b324c3130f2b000f7ddf8f04a0d27a76d87544bb9a62379bcec3ebc583804f0bf0255f77c3bd25fc4f54575e7a0f16eff0d4ad36018e29bcf84e220c26a38832887863d0eecddce57f8e48fb8ea4d7051a22a3e905b0a758585984c064e56ffb8cf00e444b8d2879ee78209c88487b0a0ff5f5fd2c370409b067a92b5d532db94879cb9567a83daca211f5c6a988d133c5851f63704ce0e1fc791842c8b26c9b7477ca3c09e0b2149de79487e2d73e7fd68fc76ddb6b1031a2c4a22436150a8b1c003d27a95e00cb6cf42803814439e4b59d25ebc686a042be20e032b78ce1eb4996699f5edf2803cfb60f8a6f002ed0c4d73b70be9cb64f0d79f5d16f1dd88e9b2a4cfad1532a2e5f58f48aa4b3dac9fe3eb4d26c951810714d52f84fdb936fb59ac20a7222e92bfd5f15e3a7fb3f07732a27d5231ba6651c14b3ee21c4f1dd277972b4b7dc48a7d7465761ee7027be03a8845845e10d71ea16254b301239b8de16ad831831baf86b636df08f5839089d1c6fda4cf4b386e8cd647cb8ae4d31ec044db4cce87c58889994f2faa16576bece3c9b066727c622817e7404706c56a131e4eeb927852b37611d0b992ed967b8314f6a2b21e552c5f35eb432dd9aceb9ff331fea35e48c88ad2bf79fa0bcd49273ed8d36c9c259d086d00ae21024914f6e8a70b86ec737103d2176494ee999d03c9a7cef72067f3ceb5cb6dc7892af7b59c608efb58b77f3aed810a7e20dcdfdb38f3a5b89e60e8565f15b7aecd9acbe611ce68daaeb74783f57f9e4977bd40d3ac9a2da22567a11cee4aa57a5ecf5c11620c2508b0a4e8ca3d049bf0a11ab7c032e30dc26309bd28dbf5a4c3db6aeb6a3acc1fd0da818e591165c3f7ee73341e9b80e139e275703eb3a35d2c046d87dce97cb050f79e4fc107b7c68ec2820ea48bc6d6d101b7c2f493488f704f02181a80a0421f2adf1b294b0e8d95302315c63949d0231345f361aa54ac6cd48257991a89c9407394dc52890f7e546100da21445046d26114630e11cd79ba972cb4dc74c8cdbced6da33c21154835090eaf077617b91ee6148d9e92ef4581f3d759c86a1dc59169e6fd7612de209d1d2a9c74e3b6f642b1099537f7a571aba0c7dc69172d3e32b29a6a58f7d6e966fd8b46e7f05c2ccf4ef768389e07205c66bbddef4716bbac1865796aded13a3c3212c8b20abcf7d70c72b722341cc494798cd546ea74d02d8b7398de0cc963e14366b3f5a7559c033dcf21921b72746b82cbe3ae032d059f403860c123aa27df3afab8e9650ae9f4f746f8db093e589dc2771ea52e38f57b6a578efb15f9856ae0516714d05753a725ba2a60a94ac6c4627a2b9cd5f71ce91fd2661a635663cb32c211fef9c157c00f024d37666ccd142b2c01886d1cfaa78c832a25fd1e79d28b2c29ce726f03d7dbec8e7b501e76fd77f1132139a55c5c806df474cd5343a3079533b163384c70694bde1637433e7355c075637cc15544efc40acd635b59094a4f88de20e7687690fb8c43701afba050c355811961fd32acca2c0724928a512ee1e15c5696836241bab0944a48b8bb22b466361c349c88d3d256b80975422a26260785cc3e71b538ad3fcffed95b9a734003591e5659c63722a6184d2243fffc25cf3377f507e72b3ad9c8dad5cf0ca4db50baa14a2e97b9e8f83827102349d27997827d2f24d2241df1ad53fb86bb0b3ce91bdd747c07a5196a099e54e361e741f0c7177bf1a6a0de41d3e22f7cca97d93119cfe31a8299e2a8019ddd0eab7512d31bde07ae9b3f85dc49bed59b970066db57696a930b934c48497de2ab67a0615ab9e79219b45ed384f68877779d50378136373d4f3f8bd185943d71ab4bc5cc25d665efc314a51068e50da039cbf13547db7ce1c0aa8a35f27fe815bc1dd848013e7a74d6f7aad2c911d2eb86c20b966a227b9a8cc9a4e43b6802f288ab589e8b0ca70cfddb45c6034bbdf2d95df9159e327e8d491bab77b2c375e324423e187e79779e95959ddd444ef09441d9c30383bb67ece45af7e567862dd9c668543a376b147eed0d5913770e2d56a5c088c8ceff9ff5fc7422c0081e94ab0ddba5a7028d09017f5762f93213a08d3df0c299128a4ead8542de18fe233e858007633abd156fa0d6f195e6b70b04b5bcc6dba178f148cae7359f9534757ee34fb67412373767343a9ce5307bcc98712d5a77db9903bab1ff04515ac58dab7f06517bfc6bc6df1c46b03246b411d17206236f48ad726df7855361069bdb3afd5fbede5f80114b9a137d5cedc02a23c8c5e74e065a1e4986ae4327f1cb6cfd0e538dd0648a544e95b1ec3b3b3ad18896786471e5302c7a82e9b87848fbbef18dc7f9f6957cd68be97e18c806e2fc8a6725090a2f90582739a9d999d2f3ba3292bf3bff2d9bfd28485d71f589d819a0b710b70a7aaeed0b36ed643f97420ae660ff17a531b07edc2d63b53f3ca86d883811796fdfafbaa6d4cbb2f3a7c8157c5d11f602ab7b903b24e739de2c331224b1df22a48a3400301d1b86b78a470bf80b26f60a29bf6440d8607a0828e4c301bc9bd921cef3f4ed5f601d126bc13ca616387e199e225c4b06fbb7f029bb0d04682c431648fefba4880c49e4ee25dec1f708c3138379a6219380243430c9b0187e98f014fffd1125c3f24058313549814ae855cd8e202ae48f54aacdeb4539a68a99063e1d26eaa101d5305df9f72bb3ed0778083c582de6aa8aade5427c3a047009d5677562d59e828d2391819a36a49804bd355de00effc2edfd4095f8dabdcf2ba9b0068414031136c58f6ba14e712ccb85256df16af71fcc2145767d3b678c777ed5d2068d79ba2bd930a15a0a6d7e2621617324ef19c7f51ccc5db27c45faf0eb9dc35135c7052e8c4b2333df9213e732ceae010e7cc34c7ad89876345a6c50a79531d1934ca82db53792d235655e383557258e52bbf1622071528e1aaa8c363e1764980e713920b662b58c26acdc6a639685cb05674cb857c71305b9830d7befd71be1a88e766ecabf861ecafe8bc1bca3caf27865a686c68e1dcdae40bbc151ff9dbef6b64a3d9633a8477562b019216828aa5f1a125ac6a844956d141c422156209f623aec026ffd098e0e73c15906f9b9af98e104139f0103440f009e34be0d1c65f04f9f8f259a17f82734de9d61a27535809edb193f795b1d80f0254b67aa784314703c050d3a672c31e6bd207df5c6202175dbf72c4624a30ecef4f75e5e072152a624855086906545f42eae5847d50bec23c44f3706547f227826b4b46ed0a56c57f0a21745ee23d775336e4dfd279af0b4911e02b38c8294924120a5460c6f416e1efcefd852308c94050ff69a7b34514906b4acddbce1336f50bc2caef317c9b26839e7e79e6f73a865e7bc86c56af6c0d257585caa21d6ea8673fd63e20302fa2c1a91ae917d385f52897cd08f485f1a954f0e413c95be59188c571cbaf78d7650db7e216d4814ed7e497c5b9e86cf1d2bba9e0d3415a39f897fa4f3f653e1e58ab1f98fa3b5fed4e437cd2aa0c6a804431741acc95506f6d81a537c9e1662fee80c084354fb54bd8e2e544db83b51a08b603d45050156939c9b83b649ab4fc23dcc3cc6131bf6f7f22c008446680ee03801e2f2b36937c4256ca46e4ba41d83440b38f61fe45a06b99699fabf94fde90a2ee92c30654f09d53251b2570965a07f34cfe3e7844c7b2eb5cfcc6f09957f821a9487a828e608511871fe3a2cab4c1ba5512aecce213b523d674ff4cf03dbfd78931879fc7332deba2619e1b4c969e0fba460715ce0ab361e83518a10b74c5a9e91a363cc44ff21ca75de7fc71414b4026f476e439d7edd2fc99eeaaf23c0bbff7a402c782f1247ed8bd1c4680e586dbb7a97f815bec601efc4f2032831910187c59267a71d4995f789c6ad1b3ef21030fbb0724bdab9d6fe042fe99b845df8c67dfde57bc4fec87d7f04ee857b19e749e9f207067f846e721fabac4d3f3c4e5cf45b948f553dc2938fe27119372d6ca47bccbb56efc7a1ae0d8553f2369984e5d98fd05e95c473bd960d662d743413ba6864437b0f78edefb9e4cb6921eb6b7736911129db5e4dbe54af048d2819f707ba7b2d52d3846e57aef6a37935c18dffe99328fa06eaf4688ab0db58e88f386622858c156ddf427a2fc4bde08f918908958ef8b0477e176f7b31cf44f23486fea4c46024f773cb9ffda8f43c0e60d283ea69406178c999e95ea492fdc6a9cdea1262db59d1e584b813a92de933b8099bc75347b0ad721736a6d9a9ea853935e5bd829e72c117372ed8192859a0dfb121a49376f1cd6837d4c2b4c0a60455e359baa59cd552bbaef1dca34763dc1272746d28dbb856a18fda888699525090779f3191940fb4b7e7534d6c9bb9d93efdc1c2515fc891ca1720294b310ec3702bc320284b28139f7247d19e6c2295f48d6936bf790c5e5cc3af486fac0d8bb487fdba3d432518294257f1c9bfbe2557b3938028c41ab05c9960f56ac6d563c40bb2ccd05f2a6bb5943bb76d74a631a590cbaf0af26a347d816f07570627a325d247f1763c3312c3ad8a7a6940ea7274f30cb42c28d1161528f5b78a4d10eb3319356a9f282a361b52e6a5f68efd40b864c5ba9b81637802738f9c19512178acdd68ada2b08fdd3f99002aaf38909fd70505fcb36b7ec7ddcf1c88fe4e9d396c6fa2a621dacf6380bd690965a4eee122702ea2675f9620c54e6488ab0937cb7d2cadb5310f6471a5af2433b8092f7d7471d75dc11f895552d07bf027205921f3211335a97de82b0a78d52be936f71302ffcf1def76fedcfddb98e9b8eef7128cdcae46e1f9c42443ade3aa9e581a522c023c32aca285263acd3e0c3708973d38133eaba9201884eb42e84586feaab17c19ce6bac38505f7e13655d6ac9fdd27810bac9a95eb1d4c27a80e2b3b6a221d0debdddc617fb02ba1f0fd451803946322de163ee4e2734aad5fe9f301d77c953e94dc93d30cb1fe6c337a7f87c3ee6b3dbeb323fc91df031236b2c9330dfa83a81e4cfd3e8d6e06bd90ffff4595bca2505594ef62f218d6e48f91cc20ecb2155e3786a96b8f0b23714743daf462b031fc78597cc35321c19d1ad624bc3e5c3175a48296addedfee24579903b26677caa9a27b6be1a09a6ff14eb3eace6b339268156f028ba8b46b25beab369cfbd510368ed81c0169d652cdc9c2af79f7a48a14208e52db83bb66ba9f31e9e04f0b906578cce58b33760b3954c77d35d2c5c3ec2816326dc0fbe82f13f89e5548c7511865998945e432e629daa2e2faa35ae76b9442b1914d7e35b51a66f40e153a7606aa73280a0b5281020d5c87fa2a3d931e21866d663a38577c30f1cddb40f745b9f686e321a3453122b8585807c38b5ffd15f398fb18a071f83391e331d9cf8163a50d1e244f95ea7e4317c729ce264daf3c8e9ed37deecd7e258123984413d733ba725aaffc94f034d7aacb8373321ffaa55decc18f4aa91bbe0fa4983b7873284733d3b49e5e775fb0818737533be9ece23061185ae73802eee5a32899467cfcacaa59a6529d856e0f2d2d3e5594b317be6a80431f6fe48416a16833cb42e0465934e3928085ac99dbfc12223d9391a8b98f834e555b5e7b4611f0d44ad896ff02df06c6ea2c3f44951b34a4629e61a82fa38101a4d2f26fec9004d863e19f503ad4181f0f1bb2314a957bfdeadd6df34bda93b73add86ead24bbea26565baf4eda8d3d92bdb4ff664d649398b62558beaa62e17f3af5ea1638e3eb059d0b61e0fde93ab62bcc52e08bcdf1b3b231d506eb021c8f57de18281968f35b4ed09aae0fb464ed18dc74865256570fd1a9fa0b6656540ae1543f786ab570383321d3808fc43c8a41c2ba755476cdabaf913032e883c76b494b69d3b5a44acc799ad6df40c843a894e3e2262f0956b0077a8d09bca31ad3db8f490286565bc68ffd0d02229043e621af59f23645771f97e43a9d2dc352963e4b3db8728ba73c0adf839328d2f40afd282f65fac7809a00bc7ccd2da8c7f5c3348ef32116934b62a5c73266e30dd6dab9d9c5924ea5d48e05bd80e7f475ac0063b9de9a6b5511621ef3d50d2d74472f57524d29743c39559712fa53cee22b1e4e26d0c86a21c083fcc348f89621c7b264e51b0778b40b1877f21ce7993055c9f9bb4e23f295fed463cbd6496d5116735421311358b80cc410d4f31c0d7aac6135f42141c65d928f0e0f6e01a9e5ff1e74a65727d0af17da002e2142d1307cf94550269a7ae4ba928a2003cdc2e9d6eb80751ddf75a7d9ab72c0f1febb0fbc80f9032996b0bf52d07e0c230c548ef2a37856c5bedde2b48dffd03d1c53b9d2da3a5e9c2b58d52737c70f5d1b5c311ded68595f4746121d3917b6738a0e32bcb06d69c6740885b2c684bced8d69ffed25afdfd2e4f105842c1d22a34ee18a9e98a9912848cbc36816315c7e71f1e5951d2fa5d24c2a341f8570f966815a9013cb8784bf65014b43ac6e541aa45544f952641469e81d1374a4af51a4d32b839634e2e0892dfbee35c53638f2dd4a1187f215afe469d18ce9a07df0a305028cc1bcffe8283200b504e147271cfb4e69cec2c3721f3bc0606e61e67d282fbf9d62abc81eb9c70e6006ed292519d1f770465a9e0ab5fbaa5e1de50e0ef15a71c7d712564af84e2c5c134a895c5909b60ba7bbd1e43d3169d95b48d28866805dfa8919c7fa4a0e05edef683c7db003d809d70fe099b000272d4eaa72ace39630c1fbdab04ca7aacf94e6302d2b9f6cea09a91d0b5643b80742ab8f38ba37b706ba05718bd1a6b9c5d79bd56039d433504a57c79839261bb36923981ebce24fdaab76744650905b7cee5d7ae13c3f975032aecd68b9e85bc979f38444ef486f8929b2d85e01b1dc168ec0fbfaff15517154b6bd392ad0b3692dabdbb932d48e4a6396bd56fe7d441750378fb1845472511b9d49c3917a736d9d1043234a5763a92711e4b209d7b91c2bb2e1299f63a80858faf289c481ec143f7bc0c9d586554e18e008dcc09ff1fcda87c1371d5e645a8f1bfd07a234766b81582c7dcb989a769ade7d1062c0ce1ccd2af58e4fa6ed687ad7ad9c45b9df57ef0047eca8fcd837587ec9cff20341e42c1b2ffbb033452ce6fb7dfa4ca9ccfaec47693d410aaf243226dd823ffbd4e6de07680072ac0e1c34a00deacb1fe1f8d97fc96891631d294f3bef6fb8646e51d3eb15a8df9d30f5e227ef4632ae36ca9e5fc1bf7137a09043c6297f31ab24a63c301e60d0d47f47cb6a59d7fe7b5b134fd8bac4664f0958f3f52560f92385b8ee07ff1911cd7a199a4beb6b841e62c620b03e494dd715b3fdece760d782a1722e223e7e7d000b703323b991c8b3faa6c8a187423166fdb78552541c1aae782a03facb96db5340b244ddc273af19206dd68bb1beaef751e53e7236fb775968a411bab22d0e41663beaa91e0277adfcfc9b25f2a6d7ee0521d8ffb5d2d3b2414fa74cb3824ce5cb7d1c9d2976dfaa7b7f9074cead5e1aa99b0029a7e22ff6dcb112741cf161698d0013943d1d639fb078c7aa9105bea71aff86804dbd8dc3f4c072b50cb435e01e8bbb81e9a2c6667458e19a9d03e8a885a110b9f5b3eb5a75ead937139d85a04fb357fcab977fe5ae802ced4aa18675f4ff0ee84d2c0f78968287d581ed6cbdebfdf35cc4ed4176e9b3d373af809d7cf94208c763c328af677222b21f2bb1f02853f16d3dd1d7f58d14802ff886a4f95465d7d904e1e60b67260719c6bd62d41152793c04cfb8111cd9795e6f64ce154fd288a494081ee2c0ab7b3f7519a0dcc6eb0835b2d221c01c4e57a92fc31dbb3fa682c93015755d67d4554ab689b6b5d7f37903742fb38369dec620632896598a40d48a371d57afcb9ca268344b541aeee2b54164802fabd8e83786ed147146c785e9d0da1c4b1c7e46946a559595203f1223df082155d7142ad301c15fc1de5e53215349b3c7c3a9ed46471b009ce862ff5d0298dbcdaecc78918993b6930bdb5a4ed8eb35db6b03f053da70a93a55f1504c864fff0c18ab9922a0ef2c0099e86cd474b6ac8ddc620aa38c099c5f734690dc187df368dd89a5ce4d80153eccf5d03a3514425fad808093815178a1d5558b511e79781b680b26e9f199aa81e4dafc477ed551368d9f057f33db2bc3477895dbd8e7e76b037246d05a7a02712ff46740940d44c698f2cca3c3c5af3bd96371ea0a3cc69d9b81a919145b735f1f9dd5a610fe3c3e4093985caf46ecea75c7b9940b4b336a4db33ba5f841da7a45794b0367d727379e46cf477602626bb742f2c6c281216c674be7ba00d0e420d1bde2063ad7578cfd3fd1ca48a7bf6787c423bd1026337355cb1f777dac53a1788137c53a4659a6639d7a192dc299a441b1f65a81a9a742eeaf133fc39f7d9826e9517b4a3e956eedd43cb24556b58ef90ac53521ec791306778e84a997283de66713aa527e351a92bb41854bf205e9e43df532377abfa3c65dc829d4a1550747dcbb5da61fab8bc244dd5af31590830389ee503c0ff93d12eaf09a88c82200b86d20f5f9cfdd828e97abb173f66652eae8e49b8d9e9fc5fa70a802c55e14bc8b29d4b54c5b9bdf49044a733f3c6ecdbd1bc23c0574bdebfbcb5ba43383f1340ae2b8914769097971c8f9e170a4c408cc226d8f4d9a42d2a1ec7239ea56cdc672397109b058929fc39df3577d7dcf26a325fe6954db6822d8e1642f3a3bbf31c4d97a18c1a64451c5630928844e0b11b1975334212ee206826e906574c3ddbd8eb031f5e09d8528a8dc8f8753cb3d244bdb886fb4215fd3d7f0180b99101d48db1d4517c4ab432ebf754cb8472088b4b86efeccab7774c61531d66232ddf37dcffedfacf6fccbbf45e62f82e31329e23bd7ed6784f95d3922f187a06e63d63d6b73f896763168afc99358e84109395f8457e2970645d9cd4a27c83ed0a4ee24a77eecc784606be88722ca3f000ea04438d625d8edc7bbdac42ad84bd190bacacc8ed810d0003a4f081228914a4a92da39d04f4fdc1df2b460e0e0401e7bb3ce2a8386f83c214361e05ea367267bcf4d8cf81e76abac3faf40e82fba52cbe8f4c369e245d4cfa779e605187db936e5067baf5773eef7046ae892ebf33176b59473e8155ebb7e4dd6e9a2367d6441993b46c6a2531a46838f948d0fc9b009063604666e1fada42a581","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"d996cd66d38ea0ada57b01f6cb8af855"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
