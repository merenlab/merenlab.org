<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-002</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-002</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-002">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fa5c5df28234ad924d20a155422270089f14fd69e077f577c3dd0d07d901548d2da6256ad3f23d8c8cb3f1419215974b6b1d7ef901bb4ac93bacec392caaa54b17d88e6a562bbf5d61cff371aa941416dd891d56feddeee198257eba424d303b3d1fb30254f97e177e1c56259aa6c5ff695a524210e7009639faccb18921cd6c0412e1363f086f5caf1fa9bfb1b3f3e055470b95f3b5004b9b672495f2d375020a3e1ea19d0f609c52f88c9bedda5af3a2b1ed05f23a9b3793fae740ed18d63e9ead860478a1d0fc678097eec646cefa3ab3dce73c2695d7d6aa84858dddc2589279dabcdeeb7daab3db61647e69a7be95b451dedb1645949a40ef172d5e5fa5ab95913f1ba8dc222520599ef848e55fb3e49a509885289cc5df49e20ef23540fac9fc4c240ed06c7febc03ef855a96d0c959d90514e88501b452c642158ab6c9789c094f3ef02408f1935c25435d0ff6211bce6f5cccc7159c5970ffbf9ed19671789ade2bbac774e6ac53c5590c95803893cb42fa8de2e037c4603b2b140762714035b901cc3381e5b384c08835c06b1d739ddd72ce44f18e0070bf0c7ef4b9e3a031a01bb92e6b6c93422432bc3a010fa88e4760f3a998900be403532d2e8f893f0bc3a07106674b2ea013ea3ca981115c5b9ba6fbb33b6c65acbe18f7a65c5a58613aea5a93e601e3bd89b754d054a3c8febcc1f506d1b71cef3ed6c922b104a91645fc83321102f0b44458e2b1e2c49330cf3a633e94ff6932bf665aacd8e50ea79f7adf4a9d01bffd47532c729e39370aaeb8d04b7f8b4768fc0d977641dfe59d8a4f01d2a677af98e5ef16a1ec0d99de6a763e241d024294fe2cbbf611f95d69ef489bfe443349212d809ffebc2fc74bd81ccf0d35dea5f8bab62b4c8434e0fd426381ae08b4989e3d3734a1c1f33aed1d40ffbfbdf986c31c524ab1e31baf79ecd9bd9f0c5c9d10e924eb9e1c7b5efd41638e4047a227e3166806b5f04051ad9cd3cccf7df8480abc11a20eed67949031b2092088b5d7e5d333c950ecf99c710aef67b20a556137ffd51fef5a5be9d5801b7f5664f812f185c4e7acb815ba6dff17285433a252af19b2cc06fb6846594948ff5929ab1dff27f1d8faab5aa0c084b1f6f887b489d0d9a92d0f3fb45eceade36eaf6fc79e25a5e6ceaf294167d9583e99be7b7d8607315f9f5fcdf3a0000c4486de25e7f592c37fd0432d2f003cbe0e1491dbbae5d801815e4cb63f070dc815928a090d4065419bd359b2591e6680d45c868f7273014414d0d224a96b1d5a40d9348da0be9e1f5cc79e38630a89f097a097e950233e94bfa731bd04993eaddc5547dedc5e33d23ac92f3ed140c70bdb25eaa6592070e276c439f3455a1a0cd8985ba3c6217ed42dab26ee75c5cb364942ae9f24fa034fa44e531c9efa7fcefb4f8cae3924d5991553053a683e5b5e985fd44e213fe50a3b6df1c987162778cd3841cabca6425982bc327cad8bcdcdd4fd84ea6e7dda6425b8430b6eedf021f4488e9e27acef52d671e1ac496602b68b0f7edfa3665bf7a4893c7ea17ef39c2dd9cce05d998a71a19844a70e3633da66f2a22fe10cc1912ae49cea253ff52d1b694be925ceaaa275a64eeb5e780b7867e42f23181467902befbf3bc3987f16bac54fb7ae9ccc870701126348d1752b39597970a7879c1a22ca1f69ebf54e44ae511cfcc90b8e21ef34a66a87d5b542b7ee913445c2ff135f672f2ba6c36ab07b7ba372380cd4d350ab3afb3c60560fe69f5e84c50d9795b2562abccc8521ff239b18cfd4aa44a0dd10e9ee973cf01baa5c215de8e67f59bc18307ab94de43841caed2a1bab978534787254fe80529812257bfa82ec3633103b7aa61c499f61ff3f34d9cd0a88f1be7adc9663ce652981893a6bf2e5106fcc6ba5b2ea8571888b4f3fecb3c929b4c2e078bfa697b90c4ded8f8ea756c3bcdef525c2c168445a84991c3884f83298d58a31cc4d0cb9d3915c95dcf04efde8c9fbb0b8947b8fe7154eb39daf4a47d8e950b202226d9a02622e7eb89dee408731746472fcd5507f593e56bfe6d1414d5412657dae029483165e05840a565beb7d1a361d736a36bebe3d4ac0853a81e092e9695de928964b65078d0a86787a76599ec0b01e351ead9b066c5cd78defec363e41fb2631a858b7030f2c6d9ba8510d5fea81cf7d72c11702dd225686865b6931d768011528554409c0009f5d8a54ea86f11633680db7458f9b3fb3d128310c3b41f7a90d71b583c1b19deedc051c3eba3063fcb6e59f45a067b47a64bc9647521562c251303470d8611cadcd6a4b509adbb68fba236aa44d969dafc10a0dcca762888e54e2c91d1b6220aa29ab492071d62229c82214e2969fef2519ddca8d7c9d1a94025fc4b28078ec53dc55b87a5e7b9dd32dd4d0ca65fa2fdcdaa0cebd51d93fcabd98ac2ed76e95bb2b0eeb6a1b98e5e48d96ea16305cc71f396735a0ea98b33f62b7ca304e110af40911631fe859e404f2c40963757c22749cd2f370564f7d55b151258179e65fcd11240df6e495428f31c2b068b4aff3a9ce83c8c1254801e7c3d5b2040dcf4bf0e0663867f1c59c52745ea77f157776aabc14b4fafe6633510f6aa0aed520e5f0cf8f6f8d1905726e337a63414b28d1e01038177d9cb06618af91e5d5d4562e1d296375779e41fb95d6c373b723ffa96ce20e3e4553f326f336161c31165c557e238f416f68a06e4cc02484e6cb539b06526d7b962e48dd7d8bd3fe5ebb41990c27bd00f2306f6496996d3b422fd70c30214247fe7721c4005b34a5407f0473f9778cb899d888ee682f87b4fa91360f7bc8157c78c56619749049765bc6f84d62dae4472fec645f8fc3623377e9c86b7fb8c4cbd06710ccda65ae91db07bb18c765736d239e92bdeca85758234cf0356477bbd5ef6430e739d32966f302dfe1b04e58b370e27af688685b6798d23b80476a9b7d0203d7f978f922064bed7bf328057e97e4e570126df9367704f14d9938cdfb4c7181f5e6f5848f8821f395652ecfe62c60bda614150a888446b9ea6095eae12ddea473b833f50ed66d6854245cde1d70b0f6f56ba97cd8fbf20d163133aacd18ffb9eced3f638c8b0e58fd9bcf144837007bc77432800b44caeeea68874550ad1273ee13e7517db46dc1575e72584bd8302201878dbc14d49d2134448eb5ea559dd62f280e59169ea8d669e561982b1c0b5f39107a7232838f66fa3053ac2590089dfc1b091478d5e8406104a875957f6b96bd6bda5046dfeca7dd286c0f309b54b7797464b9238898d93ae6bfd454e6b9434e307fa9a416b090cba66def67ac1c57363a42363179afceb3984cbaf9001bd4b4d6dcc8b449f2e7d7f16d30e009973063a0dd2821ea566727d800e49e28b26f5db2f276b0595bc9917c7ebaff70d2ddbaf57824f32b46c32dca40c4b5ce3b2f074469f84db83e0491a3acdc353225ba047598ac00b01f6f434aec1d4b8ac2d187d8187d14b0185fabd80e808986030c8d1ec78d32b42e6d6916a06ed4fd88ab05f1d57f9702133ff4821c01c40533b31392ca808d84843f583f2d6903822a648df5e034f89de28e336129121c49a9bf9af73f8ab95db2a75725e3e99ad4ea314dc6f6994686b4d452acb06116b61614bd6b08c4450796140b94775a305b83a84dd1e6fc2c378fe354375988e422c7613498a306740a6f0a31e43bd9a9873f14619ad3ba8a2662f199fd1585934713ec6256fb6c87e02adf5df5d3e8745d36b3c25e1877875580481efb1f15503c11fce1133b06b91c032c1eeaa67c4a1aa60f7e6f3c77ca04f0aeffd0ae3977856aedd9029c88c08b6c8e486aa46b8da5a7708d345fdd5c8a576c383a7865a3d48b8eb7abac7ffb28ad33377c8e824e35ece91caaf75eb080b55fb54d114345da26a6611ba9b32743f77528e0398862fcf554a6fefe17d63d869f04d3766ea312d3050e1590544505ec7009d5debbecc10bc574d75f4f4dc56805f9178af303cda729e7c249676c19d502b66eb09e2fe4c506ec1d5c5d5cdb0fe588d05fe54043959021673cc0a41b29d464d45cb0af332fac1dc99c0ae588ded4e6815d85a3a3dfd3e208be872e4389a5ea4cc8be71cde57bdbc8ab0facbf15f365b96a154fc5ef8a28aa91b0a269b81d6d368c48de505f3a2239056c9e921a3ae4d8a2ee1b813ffa79472898f73c1cf15479c1d2ccf76bafa8aaa17b93c2e473ff33c72e58e3dd8119f1c6ad223bdadaa27174c85b753f36b2b44f447b263a8493b49926e41ab0c14e498673aa2542788d4e0b083c806c573b1b0d64ceb4aab7eb7b15f9c421e30bd0f96f6fd4e7fb65cfe520cc5d02202a18e36effbe1957119d6c8b68f4330e908dae6d83d01768620b568321a0aa37ea97764ffdfb35bff690191f7ffedcbd15d4af262db4b30bd6a9a1a00b66c71fef8e64437491b479bf17b96641a370caa77a1eb5df26fab8bd8ccab593a904f37a8a0598a570e4652d34ed92655e36477c0606d8a6090f3202b8be8b568f21596c85d14db8d209c86af4ba9cab3d1869a80f23e39c6e1108fff95bbc7939f7e5407876ecbe2a45a7f9a4e6ba96455d6a1043cb3fa973a66e1bb60929238199c2c34c857e89997c49f8e6cf225956bca6e68674167a2bea973c04a890a6a3067aeb6262dbc03d875b2e4552a2cac04637ef064433bd634c946b1084ba912e5ea40ff102d0e0d1ccd2b7bb2c21ce0003d17fd44f942a00dc82cec03545bec99a14c8764a2d2d4c708bc85765521cd30c0760c7b8582126834b0796f7ec9cf78e39708f3b2247c4e8ddd9743b333155d03013c98fbabf490534c34489d23653ebe33be22651e2f74257c83a196b6ca586971788a4894baebc583ea3b4a48cb481413ebaeeddbec29be9e84705d0976c59ace05a5ea811f8cc68ba2be30154db3129b37bfed99431adecb6d638a8ce9feca9d8d4ec9e5b69be3abfb2d4061da25f85b8d40c6f0921f20178ff2502d7671c0c093c4bb5211eda9a9852dfc8eccb99a94e1ca0da962d7503be58cb51db3630940e698c3abbc793ad1590531b74721b59c3fb6ea0fed90a5908f546843b3ce4dcc4226308fc79e9b0ffd004f8d1ba4131160c34066d46ad924762779c779369d1397311fdd35b2cb1e92f3a7ef09bfcfaf484b2b738cd36ef3e2a26876bf909e7e67581e90391fdf079e7cb046a91715d9ee43af36cf1edb70884c1feca1695d9f727d95f99009fb743735468fbace833d3459da2dccf139d27bae237a3863cb5ce4fe7427578c4f2a99f56b66613d6894153cbaba055e57b46b7e8eb1fd05dec28ca156d61f072296676cd451d4724f98eb74f1f94a2b0bd61351a8aaffa3c488a68c12227f329eec00cc85d2ebcb30c8e7b59e54983c1339d3d851c28a7c7fff37bce156f96ebd65a06cba3ef8169d46454320b9c6410a0069c0cc0a4196b290828fd8136af6d4dec023e1da41a79e8866ddfc9dac57fa0f7e51b8172afeedc1d1350a25159eeb5a389eb1a0f118837c81dd2a1c83b8b89b71ff9a6962c447aa3d8c2b4bb737bd28c07c48a64285d40207fb9baf4533cd7f3863f200ba6b4b6bfcf35d0f7d5f469e53c62b66fac3ff01e0e766e53d5f2c2ca7bcbf7728fd0d618c4f8f12e1d2deecf0fffe12e0b0d61d1a16ee7476d641252d3dd333309e681486d81ecc175e7761d939437b859be552e923b960a7025785590e20bb8e08a26f797c609c866be214e58f100e2f341b527f22a42b64101d9aad4fbdef966f753bebf6151921b3c216c80fe1766b0817002da3bf12610e23f2d5d27a0b36894675a5c2ff04f60856d5f4eec1b49a4eeff81c3501a6047eb56227145f9bd24b56ec31b19ada38feb5b999d1e25e9afe25571bc63affc3e62becf05dfc7b934baff398b7aa8909a48eecce0c9d026bb8bc7637930868e30cf9e73e653479afd948daed24b56ef2d8f30af9fbdba2cfe00caf9781281985a7b55c6a219ea8a1b5701439766dce42ab14fb2cf1490dc8b5b8855fa833480f4ff2fbfb30111d6585629d495c9a9c2bfafeeee86ee8071c4deef95a5ae19bde0586660d14391126b2b02e71dbd9e9c34482a8cb186dcae9d2c765922823d1c9e1937af1f9c24dbf6375e5860640064af5e3063cbba6df36419a9ee5386d3c42416f09182e42146005e0b71af39289aa63d177611194d4d971a54c5db1cfe654a5c02769d2305209b4c3254b6a032ad325a13fc7b700e0a5b8612a4e19f28564c45d7baa99ee4a79ee07e1f4f5783481685ae3d646495f945971aa1b05ddcd3f325e07bd50e0e58ca78107c9ac9c068d4bc1ff0d2cf3809fe8b17fc8c84496ce54ba65948547c1306a89d152d7e31631b3734818d0679c9dc20373c1731e54b65eebf921395a634e29c6669ae7bee59f115a09f40711e450b0cf595835b65bec8c05c4df4f403260dbe8ae45ca9ca2df096aa93495cd11dfa49ccd32b91fe72ce85330db3f9846342d19dd864068118704032293873c1b11b452114ead732778cbd6252ff38a746b4be5e7443a349947c5104ee4e310e93ad75f7aba8b2544ba3a27eddcc940ca6b70eed1107ab46536b0bdc9d79f00cd6cecddcafa3004efd33795047d46bf334f93186ff0ebb534543191816eff7138664bfab4b8b66c2aea8cdd132251438cec31cd89ad8e1e3cee93ab1750b329a56a01ae63a12322082ed2cbfc3a3af21a9f25f64153e9333dda020a52e7e807f473841aeeb41047856c41d3b7c49ec760dfaec2f2a26727149c57e29434cc7b0e2b93fbfed6b5c7cf744968a554622df192145d750f6a2f53d37aac46d79b9f1408200c748bdf6f00890824319dc7b1cdfe19920ecbafb0e27fb250527228efd5486ec9a01ac4ea20cb8318f46436087e76f00a1bb7c3940d48e67846c06363414d6af2ca4762fb35d99b53e0305c0bab46571f097473c11bff939e0e5b3af90d2b0e04026915159ab0f62be3962754a6cd973f7fd3467af9d6cc7e7c62014bd4415d22e1ede4042229a915b47364888c3d570ca08a6e82dc2aacce6824be4b757b5fd296d46eda2ed19ad837032b84523f02334e05c507e47cd2256bf7f4bd4510453591fb915ca4eb84c13050394688cf65e5b3cdc5774948c0649ac11950bcc1df09a99b9ac17c339550e41454878239b0193bfddf0170c3c4d5bcb08130f68cea83afac5cb7d079d8159028cc193aa711e59dbdf8fb96a953030e21fbb89cefb8afe09e15d65d82170beaee38721b53558fdb4d6f50140ad7489e8e57744cc454fdfa0543d99b62a1fea4190625078411c70d3a86c5f41a20a240bee7d595ce5e2493205fff44ee098e8ec171f3c553169976ac9d621e8e627e399d6bb2ea0e15d356fc39947fcc23e4da0638f3a825c3626b47c5ba0b894fbcea0940e3541f030f49d095f097cba94851683e1e7e0612284820a7fb54dd31a97f66b4dccd665b197fb2d51fa98fec9c91159a1b986d1b5c01ac02044d8cc04989c6d4b2dbea630550b5b6b0cee4d6859eb980dd84296f1f4f83914333078f04876a13826f56856fd7942beda3b0491f5f9ee0ec60a27afa4f9ddb8fc72bbfb8bce0691d91d7b3d942fd011aa2784cf99354b17e2a581b38ceb45cc8e78b14aadeb1b1990d0de8a81f14a20c8eddd1c853dd6df228de348eb8d42e1547efab202ce6115d4f2cfa584d773f7a78691f52d4ea8dfe7f8ce0bd6eb595a4452b40d9840fdd4bfa6e758e4c62673df672e04c4cb1bb92e2af578c385451d63d055544ffe0d225c3d7b1f73fe92602cd26866e633ef961a22d33785058586d0e30666d5613d8d19d9e5ca7d15de05906e17d15566211a45e39cdbafbe191b2b251ce27dcb44b6a80baa32c59802607383c661ba94b3d9646b321a2499678d9e3f08f3fdbd86ba3eb6aaff4ad19393749fd5264c637b69f2e1c3767a36b7ebeb13d4acb2c1a4c51a75c0dbb111a0fb96c6870220e16923381dd345f7090216b13cd07aa7f02ad8c0627280c79becf1196a83bcae41d726d153d17c1076da678479431b8e29f7391002783977b34e99e52144017d9715438bf254af519405037f3406555d7d25cc3e8f91a67389d2342635c1a4514c59a5dbc9ddd13913a2a2541108712d561837592f3a540ec41a479a0516af5671ee969a490bead9f00c524369f9809244fb320428b36d70e5ee966a79040554d6ea0309a636069820cc14e9c9e6f75601075fb6abb4e536ae2cafacf5e19411c3e8c1079dff7182baf63b83b56c50b56ecd59f34257a5a79956320ad1c47b32196df148a94499bed025aee4f1689a97b0520005d73ad73c04bbce59bd4987d621e642c77e09a39738bd980a56bf333d7391cc3efc2449eb81c65dc29febbb4fd47cbef3392ffcff817356112ae85fa309169c8280cad3df756b0ebef5ef723e1ac6cb6e0173c2054ce9187a3f3bdf2bf066ae3816f2474d199b54c6b90e19929b23a68b7d0b96a3a854d37f1cf965a6b61f2f0dca0e9065873cfbae9b75b23af4fc11ec138d146c3540731aa4ea21f4cfabbe1e3c2a210881b995167c9f5310839a37d1797e42c25d275e470553a20e85090d2cf10d133983a37418b8ef1a0afb8e0f599dfe047ef9aa01838607e6f196bae817dbc9adf8ac0b705428ab992d555e0e9296cfc46b681f54b3ede990d3ac49c8e32e4d79f5e00ac292160165d9e718982ad80ab4dc7adfde0780aa51b873fb6bc1f57f7ac4e9913cc3c41f766843ebc2edd46c789ee8698b8743bb5ceaa4703e60b29763766b4c9e5002987e90b6ce66312e24593c0c22b72993357baec7d35906c644286a48d3153b05e73b57e0d24ea617c529c6288670e883c94c652aa0a8a06ebc1b4f4bc2c085f028763d64e662c081c6590dc1113c174a1a993424720f00ed1502bfa806df0ca4af27690bb74b90d442bb32f239ce78968b3c488007acc89d1fff08dee79bc31fdcd0b778f1f0772be90941724e344091aa93bacb95786d939f49ae7dd21b90f05a07bb99c05f2d7ec72369e7b87239da73df405ef55818c7f7617fe27cb70646bc53f4a2e8231c9466aac9322ce8843423769744c8d4f04bfc70364c7d37bcef062e0d05528794663dbe116af85ca8ebc18f469b6ac5b8d5b1b9cf68d2192a350461a1ac408d69cc08def313f1fd94b870cc083895268a674482dda255606f78148cfbef7715de1f538b5b07d38bb511aae8b72754eae1b48520acb72d3eea0b8b96d6992416b2c8d55b4192b99d49a266999c3eb6198f73ff0fb289e0ff80444453113a71d660947c19b2b553a354ca80613ed2d1b1e6c376fee11b0817ba79095c0959ef5dfaead4636a6e9519782c6d881338080524e4a297efdb3656e39ccbb10fef0b4f5a3ded392bed1897e73b4263528f02b10e977a1567810a142844e4527ad724e3111e8cea899c1a61681349143f3fabbb0b8ee962ab5bcb222611b3dd74176af90190659d74d792cb8835f6b0671c5e4f2d1bb5cfba7d5c217a8111186936302bac03de5fe4050adfcac274e403470c9bf68a78b2ab111c31fab53c34bbdb0b983e9f607ba3af4b1e5489e3cbdf9de59532de85d787d6a6d24b66413c4f37935e9137278b825fd27cc851c2941a53225becd0a63f7087ed43e9a88f70fa3148fe5c2cd5e60b5c3abe2916c090da95bc2c20beb11652357164f4cc984b22b5576bda2096132476216995fc44a3d28918fbc07da28f073b45a521358ce4f1a5806ef5585d34406fb233bfc0e7b29d1692597c6f364ae666869918f79c9fcc5db70955e0e77dc1834c2a86c8981368b3888932d5de22192172a9211b8f2ad4b32f1741a023dc07c1468e85f654bd4cfef1e6addf7accbc0b704f3d89111d645ac8c1d9fb5f8b64318bc762a86065554ab7a1c3d839fe3404fcab720aeadc6e593aef1551b82181717cc66e1766651ec947c42fbb32626b1fd32bf1aa5d47dd3ca91cbf423665bab91669dc74e58ab9f68baf3886bd46b09dee6dcc242282aaed0e8176cd523bfc86109b17c28b46914c1320cb710cf5c7ef0f26eda365a52c2045bc6f84642aabda04cf3af3af9605381cf17293de5a4d98df3e1fbc4fbe72d2901c115772f2ba697b3c3824bb7691c29c2f024994a96f7d69caef4b35456b12316b0331af070dc0f87a3d26ee8803ecca98a965167d5a1601f02de8736f8b9e209d5012b04fb137f1664de7a9d607cff368e86b06f4b8326a6ed0de49d7890ed8f541fe6db5dcd2595192dddf8c481417467e9a2bdf76cb85fdc5e524c97c6d11c3568cb077f70203b3c7130a13ef55acea5fbb22d4d032510687c097318184459517ef7a7cc43caaa6fc1f777cfa8d74a1740f7ae2d176e6bd1c09175721ad738b601a386f841511a57163649d990d6e9d2ca96a6f6f074cac2f4d5315022ca3792e30e5c4cf911b3597d4f81bbb7452a232798318248d87e72bff1b73bb19d78662fdab4f59bb3a5ae7bbf428f3fda60e85b940d3db8370119c209362428b01ca151a96e9646f50c9daaa4a09da549bd7943393992db80e8aa3a7cbc28be3477990402aa78d908c2b1b9197438644e5fd63fa6d05dbcb9d0b06fc87c2cba43977c19950655f053c32e97e59a4cea2fc53ba389486fc99a739753eeef71d32ccac63f2e58debae201c892ea86a835948c73b5ef8f1988e70d5c537cbf02258a080a290c261f6b3e7951c999400bf1955a617c128a926172cf403be89dca1341171509bcccc2e8daba3e63273acdac8c7cf5745ca625449995fc4104f2ea5156de787b8e71a0c8b4798aa0ec092c48fac3de74607bd4ac7bd4f0c3af8751a4878fc0ae00f2fce090bdd4767b2d6212e309966f33cbecd9299a970cfc29b4428574441e65124fd684a1f544dd0635715af6f7d14e6dbc5d0ef78237653e0aad00beea709d9a1fa5691bda699ee9eaa2ed6f4c46c94fe01cf36382ca303220203c02d3170270914802c9f083fc5d9a328c140ccb779828a3b783230fce824238e2f187641c2f773d21646df4d695c10109186ce90a308df55bc486be594623c087780113bf5eaaba43373584ea705228f426a90dbfdd6f4ee48297734dbf639740fc311c046e70a58499f4afa7f8b886868f1dd341bbac3488301318c19bc75a7690f84c6777763e5700044162eb3667bb200d6737011614e430aad0b8d4037437bf55cb5505ceb977b3e8e3aca112c3ff9fb5a11bac972d18079d402c077129b59af0b706eb989ba70b4407dca0964edbf65329ecb74947fcd6f98fa9335f71acc69308f0f21ecea526306df98f12b298df802e6091205ff153154eb982c2405c85e7a5b3b3b26c55760e2917ab8583035e9c3d792bc76e417fff05c05c6a20ab6e0737172067483d69ca52fb0b56b7705db57253503caea87de4e698e98a8cc5b5cfa4648070cd66ac53434806ef70231b352d47e3303106011d5c56a483f1a2526c9f63f4d592d44ad3cca34f45b8c221b0005024497d829dcf55da6985b90c77576236ee1db0c2a848ae52b35cc0c13f1f23d9587de88fdf4c00e85fdf34106f8eb7a9894f99b5b0a1be398700621953672a4ed70d5fb7e04676c4e8c172f869237150e4512d3f213f976f68d923960312a1100bd2e1735d7c86ceb1fa32f564cef4e34e258f3c4520c21a635edd922fb5c33f3ed01aabc3a4e987ce4b4a23d4d57cead2e82b6bd38817c1f6767f6e3b2dd06f3605e7b30c5ec125555048ac1e80e5ba036d3fd5390c3c7cc124ca780a0a59ef58fbe784692f18c911cba66958e6d3ac6d3d6be276440958bcac2cbca18c319a4f703befd1db785e9fab3be546e49b2c2aa955d172691106569279e988d2a802b5a87df50ecbf8fa405498c322e627018f61c4130fc8906b853ca54f886a2509968f5074b191409a6b9ec48a67fd4d6b10a0e7790e1b318dc04ba4770e7ebe55c87d1fac1f1917b887d85f193026d90b448b9ded9b8ae31fcac255429113231cb0bd2d1caf19afcaa07f6b9d66f24a1c9ebf043ebd340a7289c4025929a8da12ead347b05e2f183da4c0ac30f773170a1d9fe6101f7a5447c9a81c704257fd2629b010554e0c6a51e5716750b66bf9a700f6a9280f06b00f045e1a2bfd7119a0b0d4b03270d1d426989eecc7c4acde59b61c6f81f14be53ac7122e909fb04594380529abc906af841a6f508500083eb5e75a5ae0d60d24ada5d72051d878486294e8d894cb8a122a4d6a161373f956432bd434ce88af37731f90a6080642cf1a960efe53456feef0f70496b2959dedeb06432bd088278bbb0390529e23548bb4001dfd1b282f96bf9121e6bd49abff0b114e50003f75dd733718059ecae69b80287b135c28bf10599965b6e2e388460a3c0e18581a4007a68f2e2f128759bc7cdf7f6517faf50be5f17dc3be5433060ce43789eccfab48e2d84d92319fea4b5e7ce66d4819815f27b12de3e014721f65776250609cb36bca5c9df1f62f33988d2910c93839c9274f19d5c10244d5243badae7829000ded74cca10e8fb59f0b04a74c694dc5b0a7caff228f7fcce90e6c26705ef19229c38167ef80711aada6d58f95a7b032890eab85599cdc121c8f1aeeb13ca529a29f804bd0a5e896790034900496b03b56ac19fb364dea92e37ab6abfecdecbacb288973cea27c061f65b155e4a41ca0926693a730d2e7c20dbdb1bb2fbb2e6e19a653f7bd60994a3a826a06645a41c2b5801d6792af18b841daebf7b91250359343ab74cece94e0d5a1c7aeb909341c20326fe18aa194fad7dc1d8fed734e6d20cc9942ccf822177c409440801dc8222564cb2f7d61d39a0779466c79d48bb6bf1de18908b28a8756a954b467c8e1c40a6cca812f0c57d5e6a598a83e4c7aaf847300b6679511f32c52c16c455af148168dacf809a9e53a7c4df301af5b7d2e32e87a149d43b330dd9de5185e923832d286defa21bfaa5b4a26819a8caf24d5c0d8e8d8794954a5ac445a42666dcf2cc6012721457cb8e34c50bac2678a20a9cd113bf34c771dbc7819c3b7bd198f19648b2a3d9f560cb6205d26c6f08a3cd5bc354c3d05565b2ec10f8c1754fb270aa1f3d1f7c0ca0dbbc0fd6ecefda74ce722edc01d2db57db7b3c95233c95305c728f2a319a69e901e486b73df5f545d6d5d6fbabb680c30728b28f98734760d9a8ebf0c76df2eb31a7fd64038910dd79e1169e0f238bb4d6a85ae03f634211dc9adfd4c66b2aab3402b3976a2b9b612568c39eb7d0457c7851628215e8e693fd4aa06c67d2db4bf6af6b0e50af9b6a217b9222c417bd94796dbb180a521034b25accc2c62ec139aa46c491ad5d6980ae1ceb0de7033b46994e9b02cc9a277871768e24b82d25683e8568cbb5fdbfe5da30e71116b1d5ebd65e9cb7bca13750c857313dfacccbb22f27cf7b85b2a54b6b6cfb70f7f5e947b05f1f3c617e30f90c2d6a531f5866b942de601678e6823fe3dcd86904128d855888423c64fbebcd7b35d3db8ff9f00951a13d64ee0b2c5f3d2b500ce9b1317a04acd8ce90bddc456893565c8f8276833d615fc0c6f5213e641fb56a0ec16b142b6e5a4e3d7af67d5c7ce0a918093904f548e67ca47f680f98a58758434c7e0f15b915e5058dbf4c7baed3d02130780f26d2d1c810bf029fe0f73efac5135be29577e64d31052f9a54d39490d2b361459a79eaef0a304b19dc11d6b3c62799ff5492e108cabbba6ffc546e5e3939c87fffeff5d48d1166b5a2bae046b2520749e2b9ea219e659f6f96d5415d0cd47db3750ec102e886bebc17a434516afc22f2743951c7599a89aae8ed91b8b84ee6a681faf25bd97e52d49ac926e75cdd5f1f35b7c70bc97c90d3eb1a932f0e46d5731bb55fb3fc3a7121642a3fb95b2ab7e9d9319d1e4356dc0c3f1e36bf28171d88950b1afaf05c33eb057198ac806d669e4d7fa38c52511ad96e2fcfe734dc601e2d4193ea516e6b4aa0e22d9e02f1e0a9fe71ec270ba88695e92b65c824fa8dd5a5e8cea413f6845122017fcd50874e76efd5ab32677ad290111d0aa6b566c840dded69d523b1e40a0c1ed57b5a2817c1a85ed84303fbb86f6f08a7ab2e40a2c6243b511f81f450c704557abac7f1500432dd20a74ca375db0c60183627130c8f8e255357e51baa6afab6860fc3f6e2f3bc5c61918eed1e0fc910d852834ca4ec8192195d62f957aeb48122ce5569c7748a52c60ce18ed482fd3405786bc479825da227751e5090871c50c16803bab11a89f0b540aef66f7b17434197a6ba27b34eedec56fcab0ef49f2df3474e0e16511be91a3019c10bc584e060ae7d3a6f1ac9fff4419a38f4ead6b","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a105f04d39d28be32e14ade39c3d8fa5"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
