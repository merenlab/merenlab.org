<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-002</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-002</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-002">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a0578bdb98f96d0d971d5ba88bae35017bbac887eddac9b3e2374feae65fe2ca03cbc23ccffb53fcfbe91d83937026862194cc9401457dbd7fdbd4a278f4b77735b5a2c788f804f0ccc174b3a0ad0dd66a6ea22cb1bc72d640ad69a2c68799b5708aad60b58e2ddc1ba02d1e189e4b7d98b2f1b0ed0f6a179ea9f1728eee832d85e10959456078cb6f96cfc35f5dd63e533e3426a9838e495980d3e42288d29edbbbf9ac0113cb661685c0c98aad872aaea8d9c5cb3bb743b01c3da151e62b57e873080fc8593e64789454be0f9e1df411758fbda3a0f520e453f885f80ad25995a9e849a182a9e5a7e6691a7b20d212a5fe18ba78116a08954a65dd8bed80c601496a848a176c3fa28d774a55a3d86a500e7b3f4752027f9a38c02730dad5c9840a7065c53dc6a85856fb7d7b9cc8bfaf11fbc9793e0a4c316dad9d3afd855a4a95a3e5cd36fd9a023884d097bc64539a665d1e35ca5249aca634230e20e0c120442c9bc494be2edf2ec8000847e0e1ab45ad3cadbe334c5e722b36dc39caa820150afc613ed8d4b8a93cd89263b0ab9f1b3ddaeae2c9ec3296758f32e92a2ed4bdd87436776f805272ea1713c96734a160c16dd7ce5cebf94ce9b35644e5dc3e260f484d34269a10357ed42f2b5c7f9e80cf0787d25d0ac95c84f4f4d9a43b7430b0d55633023da5322e3f23408f663e5519c62e4026594eb1777c9cfa6cfb339665fbd136d296f6a5dd453be46ed9cf56ee23a158ecad58270c7663f1fa2cc74a2e6c29d67e1cd86cb9bec8b063f61357cc47d002ad6723110f7fdf2087f83c651b7bd71a02c6e05fe606325e102aae0c3eafc47448df7c16b3225c63145ddb473dcb028ab7494011caa723293c6caa97a1c6ef484335beb380f75a3f4983faa3009d9d84881b9e9aa3090d052929351089da01d10fb33bd9c5f50165adcecebd4af5e93d105f17b2b5f3c3de3d7a316531c6c93df2471288cbfc2eeed3964a329d7ec92a62452099d3ee962541203dc838458eae616f4c25aac7ddc6963e639a7ab8f1c4dbeb2775e7cb2c111049c830e345694c683fd104e2ce4a83c5bf1eb8d701ea5de617f1731f1806212c7ebe3158156c8c3efec99723847f3910fac3fcf89b4d070b9a9e6ada81dc0ada861898068cfc546969248b96036e731e06d7398a8fc5f939aad64216c470e91524d528c1613f3792c35d07355e77befb09b55ef753080ddae2babd188d0202e2423b3f499baf504b4d82c7b0fb1587aa9a847ca00926426cd4d4413835818fee6295379963a7580c114439d320386df5d0a6ba8fec34177bcb13af6766f13a731f5bd5ffde5f4c79e4704dd39137fbfdb05a194aa9ae3cd681338f7b71a60827b78c53c72794c38af4522504251c4109862deddb3962a4f14cce21aa8ef55ab19233f40421bb388fc1147980270ec9c29ae8b80fb86e1dcd79f97d5e2918dc18894691da2a9fa088a56896c711c9ae72dbe2e849ac4b979995546dcfc42d21a0c68bc5bad3db00cfb891834d232a6d6f6478433e934ac1678dbf012ab7227816f53d6de1775830cadba91f91500bfc1783c475024ffca931681e911d12091c1a10f6e2557fc81198e9a3b78ca82d7144fdbc6cf207588a028d99c5d191452b3d1ed7c569444f2c02b762440d5b0c4c64b4478e26e0772fd2887c950228f16580cbfa96791f07da996b5f1c8fd411f94264882b6a204d72d21f1ca55a66ae7cddd1e30b44cfd3f5782e0c95255f9428ef69a959f60cbea7316109f207d923c5fef63863e9ab66f067d77badf25ac81a4d0ebb4afb93ebb01e9cfff300a9636d924e487afa3d946dafb74c3deea0cdc84130704d4f0c24b562df3c8b118cb29894b32c2f15a0b9313bf3f53baed7ae58c338c5fc6242797df39de512a760b1a64ec9d69548d2837a0523daf4fae302ec739b47baaf0e0a363d07ff1fc8e8778e146ce068c5ffdeb07da55850c2df33bddde6ce95a621348f90bde3d311bd2ff15fce542d759deb9efb16be8a2a30cb801fc19833b77ef66f985be6794a851af7ce44dca48727985fba3f862b94fae3109e5247b498a473e6103464e857a2813f6704f53451c303d2eeba205e54dbfd8c6731820c71e93e79624ac3ca1fe8b56bebbff879a9df741354d671acb65a7d0fbd4c1b4f8a4c25f546f0a3c94c51c987e14fdbb8f2021db651bf14e7aab47d1dda21dc2f16f43bc20a6d3ef772e7e947b93f47150956a10adde2d6c5682faaafa0d2080bf9d26b314c83b644b752b689d939f8dc9a29625ef4c74ea84e0eacf2835d7571089f880ac5cbb9cc7e578d4e0b1b8a06ce3c9bbc12205aceb337761e5477f8d043b9b7c3462a579e981c9069d050e31991cb4213fbaf5f221b36554b48b10e53faf3896c84e14549ddaf38db7a28f1f0c2f1dd5c48306866d20b6204733480099c954e6f6444818517b639d4d438eea62ea7d5814bc79faa61844d89a7e9e2224f0e3cb983ee74459d0ae10f5c49ea3b15a9f19ca0441323b7ad7d857fde8dd47e0bc8ee11c4c3b0d39d683b557ced693d328ee5d1367736e6236ccad675c8f6b3edeeb113ba107b98b1a3b812edefa38dc65cee8142656d0f92e312f2359c426eaf6a9298cb0333bf171bf1ae561817728d0323f0bf08ec41fad56721f1fe30928943cbe910033cac3f76edee8225a087b8c73e12b75d94b925715e4d2c81614ad35910e2798b45cfcdd2ea4c10c48963628d078cd27a9874a0401a0b77b1632fc598421566fabd8b513d5831580093bbab2ceda71273f6fdad957e93b08ca50239f8205be2356c5ad862df2f1acf2ff6b49be9a7077233c1c2c46dfe8fec9a45552810a1801c962d42ff56bde04672157f07bc183c0050c5f46c5f6f8b317a88321d31f4692051f64ce3b26a3910ce100146bd2b3f1450c6d44b927df289cb49df3bd4c5ac8e5554c9d3ff91c801c8cb59517eb5d80a4e6ddcfe7702162a8ee430f42b715cef9563df355589392e1560169ecc4348c11cf42475f58d18b3de8f0ac787da0db77e6b305f85bf323c049633f5ecdab4d6cf20f23bd38c8029be8b80ab5680f963ef4f46c52c8e577e8422cda69b60c9d57493df3198ef58668fcc4ef8118c049b8e0298c0d6dad935b54fe4c19ee3b5b3261e55c24a35ff2ff680f72571e8450309f250e0d0f14d42a088bebe5c8ea77d170852623b4ab7a8219029cd486a5878fc2398a317ba3bcd5ffcb13ef4fe05cd09f8678b1136e9f9b7833c877e98b3f59839b1a4a2e477ecf8ffd52c2ff39a1e141945cce7e2a65d0c31c49318e4616ac2aab152e4ce0ad8ef307bd8e6b1db6d9478e0fceb3a71b1aabfe84c99eb6ea3cdc2d645e304187b17c224500e676fe130e307ee64c5fa8758394dda219848ab7fca1e5d3473af6baf94c36193e208a2875a31e10389bc39a7207c94a2015aa2b143a3362de29fa376704d1f4a63810377bfc813e6fc1cd928bfeeb2a0fb96789f465571ff41804432da735f0aafd7ab34fef5f0d786e7cba10a001c6dac0d24b2a441368345c84ed5a7dd25ddc666b72dfc7cde1ac554458d8b631adf769b1f3f359df3ad3df93c6b1089ec8e9613758197336b9e8db9019d584a2a4b30e42a61e98c7779f2fb21b082d3aaccb6ac80768c3c966af9f48d99663c433958ca5c819bdeaf372846283b5ec4a15f0343ae9e6f1ad0efbbac5f713643ece949eccd0f41d80f62960670c39d8530d40d10b747dbf7aed579a433a0d1a511fe9489ffbb430e81277d55b40f578741237889ce292276f5716aebf7003ef76ffc958a1720338fcf9bbd48f74e11c0b92fb97efdf8281fd1036aa56516e4b7717f790010b1994711eff21fbde00db63da1057afef7b9ec9b946d586d1e21773af796ad355869010045274b87f1378eeef4261c084f0357c015a51bc1a8ba351327e8a65a2b88c4bf06b6af30e175824e21baed8c62dfe3019d9cc94d4341dc736ecc8da127a863818a797d4a78b3b8dff07fad20d09fe36085efb3037de6d2862e5e72b5fb7bb76445cee7a361585f9b8cf4e844a64863021f91942a7ae15d1c01e4beb3ef4c4c22d619e3af7ca76e90321e03d9b2c76c8f986ce1dc7e3baeb85c4166c7935f3787d1ecef243298e243f8c12f16d89ce74173ba36312ce50efb9b1c34ad00504be3f2975407ca4c78aba6fe87b9e7d15896f741160f99a04a3791690f874b7870b5d230a6daa5fba83520b1968e1d47b0c0695c47c451ed59ead9749ff8bcea0950bfb88aa44d16ffd3fc8a40edd7b3b32296b54673ea78ebcdf92b5e021fd458a25111515f7d43192300d2ab02cef97f23ba91d22d9dcce6747f767bd8a44dd42fa92a88dc3934e4aca655d41b811614b21849f01cc8498ae8917ca91d646a3c22f0e1207fee105789b25b7a685267f4f4276b8f8c4adf86df7790d49b1fa24227ee3d164c43272bfdf11f3ecce71080581ec46eb9c6da75fc39409dc27883ec11a9eddc8a1dfe808305b103827dbed5e3edfa403be54371c824fa21359da32dc6ddc9e95e9a776f5045f300ad9b4c2a393b00e266a72a3e83b46093c1a3b516c6097fc10bb49a53a7dc5b02c003caab683cc17785fec1ac4cd6b6c38ffc847a80a64eabb2ce07538768d9984b5b40b0a42c81858b16835f5125e0c3b43a4adf70ab7272242853511ab098cb545285ba783f2f692661a6a3ca70af4083b394e8b602d6f322c0084415f2e4a9560534b72a22e8e25c086860937f36b3803d75a1b92d328b83017fd64988fe9d7f5e52d3c33d561076efdf489e7258105693552aeea327b2da31b02edf5db66ead15380394fea4536ae4bf994e5744928466479e2bd1abb25d2abb9ac2d07cea6bf4433bdb6bcb2ab748c9aba38734cc24e6aee0f6fa3b66d15124defeedc11b88f2b40126523d69b04c3b0e3a847959dd3eedeb2a1cc95f6012ef742539a4efcaf39731b2dbf77333095b28ec2db1215ea7916dc550c4b7f9a6b87f42912ef352cd289bbb119e0707f423a517398cec6ced7aea0783ac10ae502e5819335431082cee9f8ede851be0021ad398cf3d6ceeebb667edbfd058452656a68372d7c85599d4599b2c4201cdc8609605901f4efda9695f874a036eab6e94c7bf683b28fb3fecff012e521ccdfebd0138b5ed9f451557b0b89c3452f5a043afe570a13e950622cb0d2395b4649b874cebfaa0e4319283fea4b668e632bb8566cfd350a08d0d3be63903942103ed85bf0857954db535c502f540c8d05814c099290d68bd95c61322e4b314958cfdb1a221fc12db7e8e395adaf0eeaa68993908b70424b8b642c027a10004b59ce23269fbb20c433a7cba0fa7b90ed5cadc6aeefc8fae730898a40b4eca2d2e9408c076e18181ac1bef6ccecd7e2b50aa83bb9eeab080091fbed73740663e8d1e9dce20fb98da59602541d8b461f4dbd90e7733371976b87d66cb7cb542c62c1faec0ed3f604c42888b5b5553c95943c3bfdf27880eb061f134bc57745412d888a7eea04a76f4d78b8859748acd17bb8142c46cf4d894fd75ac554317030e94cc9782b2b1d7214ca0969d30e3e6969e88f9d051c68b162787ca11ccc8b83aafaa2d2ca58d53aeea0a806119264728396153ad5b40a5e6471767ce1c9df9ececc88837cc182cc78d7be0346435fb2ac78c7cbb443903bcf37ab5070687a388dd5ac6ff3692098a82f7ae641af878d1c4c0267276bb53d4505d41af830c576078a21c97b593c1f613ee39399924066da5b0559b913e69962248f47dcdd94624dd395c1251722c8e81b4080685ae8a2017c3eaf172518e0a44b6b2501a54118e326ccdc8e6653d797abe5d849ec9ec9bb75812dfc6fd00d14edd728fef6b957c0f50ffdf19db1d871b8952de47e6cdda2dd3f7e590aeec833805c40c5e513712d7cca19c9e27d52dc4bffc66e5e27180665b4db7dc059fed2e5a65cad51f38cf6b13a90b52630134d60c5fca9e37d85ad1ce8cc982fb9c96423b7cd7ea6c185765cdf8f52942f495946f8129818a3ed9101b273751ca4d078cfeb541851646ae16c488d2dc414a6f0247f70c44e6f2a21b7be56b466a467de8afc3c7d5087c789c9019f60397f1b2adf024af77de23c7185f1b076e6a3e146fff19a222f0053802963ddd5b0dda8cabc13433152aac9cfd08a674081f3d007e848935a7875cf81c8eeea0cdcb3f20377688220e033d249af290cc28c71c3a9993fae5315cb1bf171b36732ce8e51b69f494b972cbe09844222754d47989a52d51a9da9fd857b22733b8b7ef9e62b2a1c9f609f6f607a36f510217a0406bd9aa09f29a2efceb1b5e9126e56689f2c870928115fb01dccd1148163c468af139c2cf48b02200cfa74c9fb336149b7574fe7a44e3c34091b57e0e51556e7421016a2c9c7ff0ffb01d4734f40c5fba0f5580e4943ae2507d365cc536abf2dc0675159264f56786cdbd0957de44707da8b7daab059e8293623a1842e8989776c718c6715b006baba6385072f0bb18b62416af4ea0b20e4a4418f370bfea045d61e9abd928722b512d1e5904e1eb60a61bb3745d28308aee0837b6c300ceb98b71e0b95c136dde695acd2033d8039c72ca8d4279c397466f8875f85b39e3486d2f6b570e28dbb2090f97fdf27cb972e21a356d3e3fa96ef79d23501b031f4de5472d2714681f5c9a2f8032a2570328b402411608949a515dab8c8cbb4181f42f386b57458fa954b8325b6cc3e366ee37a3bec00669885eab9b3e784db83dbe00af4bbd6e3f29e5bc7647674cfe24ee65f245ca128631e746fe663327290890f0d4cd5354b89990449ddaa04b6d99b0404d5ae96bd93b922ddb41ef5514e40d6829360e757e209895daf3c561e75309e6eb22e16e7d360b1dc94fb2e06f2048cc7a4ba3522df888bb92c4d6b4aeccc9f48971d9f535db5418e1a3f381c2957ebc0e20334e837c01faab328071f8a6e85db55d6e446c0b933fceef0d34a7dfde68d036fc0aac1858fb28e6a4aa633c958f21bc32b7aee6a318aa784084aa2b10312dca3bb1666a935f1554dcc0c469c6ba2107caccc55d7cd69174b808d0638a9199f5046f4a917e15062177c7d968986911e419a559a96fe0ee0f88c9752d36ec06066dafd8bb5ad9ff99e23deb8f3cb0cf239c2a98d6973a30115830120b2816eebc6b1e72f5265a379ad0d2f38994299637fd775074433fb47922b3bd50798234752bfd51e4126d4960a32773d6c6e9e4eb194d0c9f7752f853f01c54dcce0d1eb66fdd65ad604d863f801938e1deb0fccf8d4b1b017d2174847717b47081c791780ceca554223d7772fae8554fb8842b45a8398ed604ea849cd69984c848a01f467446f2934dafb6027aa8c698b7df3b35b6ec3fb7813d2bc8e1d9dbcad08ed42c33037641216e646260fbfe74feede39ab5b20bada0e8a8208c864bc32dd4e3adcc45c1c82b64cb6f2ee60a4995d15d310310ff85703a19d5425bcdd7877a5019a2c08b22d73d54beb00cd1e66d7a1c55fd35a8acb653ae38cb0a1c4ea69828adb1f9dd82a343feec676c2827e75ed88880819b247a993ea82a82c2e963abe7470d071def4d7d7a7920e52e08b470fda249e846c4a657bdd83bce61ce142244b5b239924dab0e5a705b3143569cba182919dad3d313826652be8c1095b850970b8df7c8a1793bf9295dc19da2cbb04a00a23edab5fd5ef2823e3052ab1a88b9d4ef478f5afd23f711c11d1ac576d067dd471ab54ddb4a94eb8ee53d5ef01aa9512bd75acd55e623421ae5cf92c149f93e42fdf2626d691c575bf1ff4244e68e3fb758b4eb710993dd9e39cc5c46af91c17973d65ba1a4899b5a968950e3cd085561c7d7960fd459e89b66815b4774b96e812cae8a169137e1b787d2ff5b80e23f8ac5f83d8cfe3116e374898197781a98b6cdaa740c1fa7a154398f3fb5a3becd565170ea968e004c84e3016eddc327496ead0ec798422bc8ca99e8be2b563e9df5deb6a5fa059a6ca4ac9e526063c8b869cbd7460fa9b91b4dfa4d61916b6e97bec1d4cabbe915b28dc0514b7e91dd0465187c6019c06c4c1b6d94804492e920ee5dc501426fa5cc940f271391b804bdcfbb3b986a8d0c5d7af9d079022fb3a5994863b1f963b2f35c9ab59eefa38f5fba4f43f614c0e1518b4c62b8ea5f074884adcd8c2fdd63677d3cc0d40272000aecdadeddf88d368b40ab3d4f2bddf2f992687b6677f1e4c48a68733b7f4691b62bd732e40a11d3589cfd780eaf9ec94012d57588fca73bcb5f46343fc863e2f2759d92d33dffedce592bc24a893782b95aaa71ac34e70a3fe1a8b71c7f8648e99939371d2b68f20d6905438d92dba746c0068ab0d5d50595d5bfc5ff5477b55e14e8c306c996763acef312f58970f333c24ceefcda39d0286fb71f6fa8fe12108f01f0d76bada57049305a5e8fa42f8b9d3a2b8709a52af0e257f57911db28a74a57437cecf5d09c7490ee01ad3d1ebcef5227c971514a727ed119994c68004755ee45d32dcec701d339e67ca6f746f77df7de25b089371c356eb76151956e37d845b7b92563ced5637b39e1098c0ba3ee1b4f79ac49d903c506d791df9769321832e6fe83270aa1c4d32d588c5d73c80f4de7df904f2a4e8d185aa6535eb0e2a7bbeb841424f312e7aa976b9a5e7c9b7d1f2e63d5d784469c409b1dc66f9450ceb2e178a79a96893653c3212ab0e6118e408524d11030ceaac005e6e0f2786c05ad1238f2a9406e98f753d63b17c8a6e81398ffdcc9e3b0355f9d19491ad4bb7113cb9a8d2803b760465b2eea457735b98969bbf5b7baad9f8703fcac31fba52b3418faff19a7803f37bb7d4b4cbf76ddf79fa2396a8db707f52eb537b5bc85f3d525e122c3e334ff91145b81f1b63f75bc055e3801609b819991dd3bda33b66fd4856f14ee0e8b7173dc4f69a3fb1272ae9b491a7a6e345fbe0568e1fe54c155c537f6f4b38c3906d33d69d0434e730fcae728053fb59123fe6fbbc322793ef06cfdf4c3954bd0257474d1a0867c488c8ff18a499dd443a60da65cbe86e8c070edf148ac68cec96025818c499eadcd8b094edf8c1231711e3993e824b9762e0bf32398aa8b69ccb5cc56c37a246f31505fcc1ab8caac4a30957efa219715f650ea6c5c7975db00d3804b21bb3b4c26042bd722e6eee6fe5d94bc6f42d41263772b1b8ff283b4f103864d387bc12cb3dd740b6c2a7e91c151f2c27838db3976958480331e9f605c2383fc5cc78c79c13141eacad29fe9ec512de789b13ce545b0958a902b03bc01eeafbbc1d154cc78241a40c348ff78bb3aa8d18bdf2cf41709c9a03090d1b82fd62854f51dc4d2211032ce0e13a72ba6930b0bf6187ec2aa734750071634a6a625454174d6870f3a64d27cf224a0e8b5a5be442e90e65f78a615f07911fca00f96a346e3be28722cd915271e48fbfbfbbede5edc4c57d3b68034c9e6a3978f42378f967b7b5447fbc31c2272fabcbab8530ee2fb6914e4a808d0007560af98c4e4cceda72ec2355e359d884e4f31b20f1e8614a59ea08716e96cfb42d6596f4b7599f50ec81a913aeabd83dfd0440427d6803c6963fe3f50f6c80561928501d20da6287dd532ed6f96c0bb39659fa66cd50707cbfa70c18283450274decb63d17c0ecc73da30141235fb1d0f29b898f969f5245a94193ea0e73283868d841da11934ec414b1fc8593b2786a00b0b7b9984755ea59e522a366354f05bfa1354621afa15a80e0c3e4ba799cdb9965513dd5f84cfdf09da69f1c0beaa967bb7544ccb9dc78dc083fe4b3cb6ee86fdfdc9419d28b2521aa33761826e2e8283d865f65df3c6480873b12d62006d2734fbe92c7013cd4ebba7b9b988c86c56b48f89ed46391e7a0653424299dd8d6ebfc7efff1f92d66d2459870e93969594a12b86280ced4a8a3944de0b1192e8d334d6ee1d37fef6a2c03c13dcb58a2f861921509dccb15ae55010e0493045f37372cca107b1851eefae6a32fcc814185540af8ba06e6dc0e00ad8f7d0df9c32f7001dac66154b098ee8984cfedd76075046fd3b63384db6debc77e4d4fc818a8840b2e76d9bd9a5f295669d530400ac38ae03a2f747037d0490a95ec2b1acff22adf216c7ed82fb0b2dffcea8c1c9ffe91067b460dc4bd37ccea6b0645bce0516d93f32da6f5b7734061d3aceb4f735bcbf74e9e06111604ebac63892fba9cc236d311b26c089da475a4ec4dc84d25b0c38133a9fd11ad4268faf0c3a818aff44a611e95b2600bedd8110bd43ebffa9f93afc0e570654b26fa1fb6f8c191d7bc3b830d05b9e224400c8a86dda5c61d8bb00e4b381c699cbef45a3ed8eae9d9d3144d5b5eeab916c85f4eaeeddd7d3075ba094185a41621fdd7e7099432c186282fb043e2fc635f4d8d128be4f9e4795bcb10824f49886e155e2e745aee221a5b6f5fd7fbeb1e9d2b0b44fbbcb19920a8780d403766344826c4c05f61ce4773bb587dd6dc6cb719541115c5afc9b5955b1d566b465e9d8da28725d4d5f1467eca2ff44f7828e549aad2b288a760a14ae18a330209d68c68677e3a32a867b1c09224b10d82e8111fd57244c7c5e271c69d537a94c5a13f94626355a2acc36b90f299de2bf3d34e6cd1c2d10d7ee04906a13db5444c404f91a762c7471bc93050e21aac32dfe5239601fc9287a68f2359e8f2bd2b44c2c14fdfb65147d1bbbed5bed6766c36d2832109106fa4582d69aba4aac6a9fce96ce12f442f11f9fec2006d45941758a3ad950c21465983b3061fa5e0d7a63ba6bbac12001577335a814eb64eafba74da81a616e8e17a31db4aa58f592a38b944393498c85204773dc6204e6697c09a927179dbd33cd593aff2f66e3f3a78ba8e5de3c5e4ea9cece951ba54afacfeb9a56e24675b21ca124693d3d07f86d2d7f2f1a82011a0302526f1081fbaad046c6008e8ffedf81d7e5e44e470395efb599562a25f7d2b8c4f040d77cec8e02885e93395ff184cdfbb53a77e6b4398053af47f66a59ae931a79d274f7e1ff2f5c84e23b1c04a36be24aa34dae7a177bddf59069f9fccb8a304eaf28f35d7c46e89cf0d67455d6f101a2e73a5e10f1c1550e1a6e2efe0ccef3c899d9b89010800c4256a1f2dae97d6d133294be9b50a7edcee59941fe7333f6c68ec7b1deb0a729d9e4cfe0118e75239496c2d852fce5321d279affce484ae7849131210716f6f427abb64476f2a567db2a8a0c869537aabcd313dd17edd7fca1a276894c21353f7b46407868404760472f6de41fab52b4456cddf9c7aa7167a50dc5ca3eafae7b467e7e9c2a3cea9e312afa65223040b9b4c7dbb7b7f9cce904200729b350e4b75fac5e3671281a3a2f0d86c623b6fe5d5e1c2f9c783ac2a5415ce427bc781dc563c5c8003eef235c3d3c74b8c4a20ac401677c214e77bdf0632b344e3a398a01b74a0e1a41c45090d66546c6819e12c42b1d1107282f0b48bbab6849ae63079050ff640fc67f75f8be7ac1e34217750720e4d94d95359a3b187a8313a9729a6eb0305fa31de56125b3d27683a526f0c842ba3275c4876a7315e8eed4d9f9d2d94bcb728c130f78967e3ea7a056d70ca93dc39cb93e9de323546fb298194745619853f89cdbfc191f6216ca112a1a748cf7c00f60c78fc89363632e64af3f5c12c914c9aa70fb8f753496a942add1938cf78aa3852f741ca792c93c08870ef916de266482572437de773dfc6c110c3fee031a1106f11ae9ff4c508d5391df7c2c2ffd45532001f87ae7b35912e85905aeee940a4dae23364401e8092b107a4c684d3dff73bd0ba1ee1d97c991fd298125bab0d608160a558995434dfd5d132db6a68037607562f6e3ac5dd02c6cbd3a1792bf096a3b57274c4651639aa657914fd2381f124306777f3a1435c460dde0b993c8b623155bd428e725d6b008c6f9cde247c2579850df1a3da578ad3688dda7b71b3dce3a27501397edfffd52cd0e8637c144c2868529e79c12d90dc68d2a47c3fabbdfd90173fd338b824855cda8953a3eb122c0794232f1d101b016d3fca72c339c034c7523cc8b589031ab3976b7824c379fd75e9a0c4200bc355afe9a43bb4b49a20b745977c89ad2e89f577d0988c547eb7bd15f05d87cbb5e37dbc20743ccac341094781172ee1d76ff3992ab5928e1571238d5eb649e0f48e69c0d4d2b9f98caed760c80a9332837238433a9c0821f126686e2968a120cd1dda0f77c6fec957e87b13fb82f6cc85d45d2f6d9235d544daf4595abfae04513dc921db3ece751cea232fa987e4299600481b2f2a764b57a7e88b4be7da45da4c4af8ef75633a76c1d5bcc58263fd5ae8d93c82921725c583e0b320527441ebc304a015068f8624a87df6f29ba42066ee4b891eaca420dbe291d8d1d24237d1727c332b008f1f6bc5c4148d5bc564a5b7a6a18852d2e0cc27e9b6dc72daedef2741ac10fff6726377d7d7adb6bd371882504e955518e19272e53bb32b94e71122679327cbb588e56557385867dfb14cf99a6dece0fc47b3a1c131f2eb5278d92eead563705d49a378fafa092b8c2ca81e8d8659524198dceb9569ab952a52cb83568d2bb2ffbfe229c1eb1b278829fa9129cd3796812603a29935c30a1074ecc48f6e4345464959ecaad677d68e521f833b9126d51f3080a3b7a2537dd2fc23eca900939f3ae1c100a1d9b6c21cc39b34a3a429d022761c613d498be6f8bde3657663a5b996bedb2069520ece709b9281cd85eba9452cb83aafc4452c0b379ac37f57a09eb201cf743510fa352ff832cf13aae46248d833d0f10416f5c5be5a9620e283dee00e9751aa580d792815d66086f342ab58d127d1e3db01f0b38d2ed894602936502d3de1156805c531eca059f5bd89a3b4ee01b1250a5a23c38035ad1250ab59cb515a08b64b42274c0249235042171d903c2dd3e29442a3ee1ab04ddeabb87f6d12015eb7fda62e80fae5895081fd9ba40a78ec32005eee191845b0d8a75535cf316132d63dbd488ea978132e4c95e3f1831d6349b0de400b806e0f7c550108931763750021fad187dc44f6d93e0a1fea0a537aec88d35a57b07fbaac43c914d370ef9007d08ef139d95eed547f53273d7809c73550c6974bc7b0d02f1c03f10a8d61473f39cfa47e8ff2dbc4522b0f8e4c6119b21ff1bd9a0dcc8bd52a5d9cab4f54cfa314088db6fcafde22650d8159ed1db62b0fdf44650dc8a25b0dd04732e7f13dde7a3c887c2120929d4be4f096748fbdd4add69516d14eb9d05a8f8eced4e06a799e6ffc8fa76244a3c7467867a699a83f9f7ee71141f292615d2c763ee67bc31c315bed38401e3cc22d3bc2dceaf8c6037868dbc7b60d9eac33d99c72265b52f24979421bbd780f7b4c9679732eb72712d344be146e51378bb0c5daf28f431086613c8c08060cd6f2a939f549e4696b88c810d5ce140933003eebfd5e4b4125860284acd547816c3b87930f994c52d848599df5a81761309dff296fcedaa7bddfdcd8f0ca628b820cbd0b4e29c7af11d39c8d65cd6f464f747534c806e7a0bb7995b38b7ead23c8d43fca95e139fda9a7af2d30d34427e6f7cdee7ab5f8dcaadce55de353ed6c9c870d7bb68788f10d707565b9cd84365fca1d7fa3f9b940f6dee37f7c1505f85dd2bf74315e0d694b6c2aafed33605a88cf4ac24b29a96b9c662dc94f38c4d1415383503f28af6a73d47f1d65e4b41d0be9512de657e8312a3fe481e6148c359054c8659d89257c220f70ecef7a9dabfdc3ec34e4f0b0e83eb0b2ce8bca9384544cf64ee577064a7684b0b940b44dc3cdbb6e80871228c68910a8b0df911cda963529da4ab66ef99fa808650eb29e4b24d9926dd9b985c4ecb216458f64689235574d4ea362c54c75f1b3ab0a5f0361cc0c59570d010177ab966417c33944ba07a02b36c425690c2e99d29b266c1f5272c82355ec5b10fb28d0dc9b818ff4e90a5301e02bf612ded690b363175783e37ccbc83a37812059bd8775749d192617b2c463ab6e36ca7dc5e6c14755c6a1db0e49e4836f3bd49df12d256ed9cd00be4fd157a9dc3022b6c16c48499f205f8fffed48c8c0d3f9fdeed47f4b62dc51c60d24c6f4bb45dc53f6ac65b3d817239b1a1426705e740d8a728041dcb09fb7f6b11c59936d77c3cb41e5400e6ac168382eb08045a295701f89e7a7863e9407b0806c168757c4cf94edda2cdf07d0dd38b560457c4be814d1356cd7a92c7c40a9605db25a70eb55a7f797d3b423da2f085792e99a5b5bde08c00923d9895c567dda22552d00c286a5826544559014e9d9af9f008b50f50a1dbc9993e46b8409c31dfbc2ac4b2ca","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"6eab1f917c5a0672ddc9c1862ef67c13"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
