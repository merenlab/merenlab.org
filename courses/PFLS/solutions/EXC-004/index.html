<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-004</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-004</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-004">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"be9898eecfd934155463ac888875223c8e8070ceb446fbca4f312840fb37eeb57a56535274d7c5958d39eaf8db51400268b378c91c7a494dad3fb5e1b674da4ec562588e74c7f2fc3d4e9e83febb086c4010deeb5814b1d0b64c37c824c4b9bb636646e2c80b82ec849a42286c2fc70a745bd5de02956badaa128d170d54f3605b8c26d5e856193cf4fdf71c0766f573b6568dbc418c7ba7ced8e0bdb56198bc002778e8689a8dd3a100133fdb351099e0c05b2e1571215f73d1630eb81686f61f88160c610600ec4d26827cda691b864f699c89ff9e66bab209a8bbbfc66e1ba3f0ee61da685d22006eeb35c80ad5cf56e91d8358f6cf79dd7ace80389d680fce6f99b5e7fd39b3dc06cc05283fbbeea52cb6c88cf87e61e5bd7756f573bd06eaa014c43a991674b3e7cf1bcd710a0dc641db142b4a8c7a21697463646cdf383de5faf95b770c8825f771e7e20c6b6626f0628448c2e33eeed8728b1d7fb85785de160e3fe1a2d23434c5fb68d0d52aba9fc11f421df30135e0964243f4b5b8a25f4d36b058672eee8692833bde25ba88ae5c1ddef3bcd11ec1ad79dc1c815ac006618a062590721d4becdea3ac3609e03526db0e73c97ac0f3589df6407140c39b0d53af57599d2de4c2aae30cfef0dfa53e4ce9623f2aecc050516f4a9db8473f74c9abdd9478ab88d77789a543938b15c240f1c4fe0fe48363fd858aa1a1f57d9b23905a88522006d4d2d5743683d7424373ab4bededaaf7e214b6878b5b9d21bdc942308bb6c82aeedee52cc33c9df0a644c7cc0102b0ebe3af14e0a2490c52f6b5b2d1268065874b921f770b31e6f6c75a1556f75f8e7a32e95b5bf107e347ce4904090400d59856d1b8a7644b791dee75946e8f870516214072dee33889852e392bf266bdef620438a8497c5ebe21b28b11f60d5263f405ef5de87a52e8af57db4340b3097fd61bb7e9aa1efd761a9cf594bd3a05f6cfad94145da8f9f41db38d50f7fd8fe949ea46b08094b2a31bc78b2b21239ccedf1bd5e494cc80d734da9ef678ab4d8d2156c2873acda9590fb018256b27896be785a22f901386c658ec65c55879e0b511755f89fa9b237a9608442cfed86c6980aee2923f4aa5cc2d4e57f9e4ae9f795d35b2ec92a34d880b9f47ce442d21472d0b1cce98afac067fa547c71daa5103eb78fc70a64017a9264df88e5694d974a4c09259d5f694133d4bc1079b91d625125df2b96361a8a66c9a0045593049e9fd031af0682034572acfb9c93c23f4fe9ff6b60f6a62c0f80b96039161c8db6852e2f1c77380172509e7b5d7c82d5c31a16bfd6ab8c7a7a55f8e498d81f776ce35a04db5fca96fd4f306822386f62039576a9b3f1f5ae2467838a6f73d608c85f9f1630ce8e68dbbb5077606dd5cfcc63b5cb5e0e6e20a9781c1f135df7264ad15c502944cc7f2aa578e1ad46681400a59e10e08924417bca99fb81749a3fe60493cbbe92718b4977b1dbd2da2351d50cd44ee05e237c4c3d1aca177a84d94f13f0e6d74a81f9e963a23006c8b015f390a6d526adeb44667ec880a0e6b4ccd0123fc25c1d9c3f91323321f335bd1cb06f21f33960c24d282735b7d0879aacf49ea9e109e438608ecda793a2a1dd9c66f99b471f3fb9379e8159c9cd42872e91dc55e41e1b8c9de476e83a717cd1c0b2eb87245cac79d58839fff251491fc8fb2075965fc795ddfd3959bba52677d0952cb4c4817d15fe988e703db4d5253e8780cbb210586e1c32c0ee36d49ffdc60323b3c25e81fc932d091016c2d200e4766d8bf63c6ce1e6311aee05dcad60804d83b5099acd7e994436934cea2bce2f3f59dc1f86e010b9daea805ab6dfe71914e48e649b982fbbf4bdfa8837d52b4328f364d5c19e7f1cbdd574ccfba9ebab8b1b3a723364003988a3ebb92191069344e1fb8e91ae3d3d88589f2bbd332ed807538dc60ae8c33b36a86c35374f679491e0ffbd4b249d8a170d7a51b675a404f6d08718a82fead8ae6c3df26790291f35e8496326f9d697f7474c5fef8c0a820da1542b5a2e3e3af4eeabdcbaa56080e7fbcb11f94a1c47d90a793ee4d0c0307492e39647c34fba546463c7f3e5f2976e554c27b3a05e8beca7061d0ffd8b9b9bae3c2ac2caff7f169c02723502ce29bba463a0dcd777abd7544cb0a4c709822f2d7a034df6d3f62078a5caeda1f8eeb8be8f302f6905efefe7ac76624b11d583f9e41a0d66f05ee0bfe2f8e014d149ae80ddab420497d3148ef1f7d4b656442866e847f431b278f70c1c6b167fdff4c1e607d7b459723c61db4904ecf306ad40adadcdf5601b016395977dbed95cd069a4e35aafdf29fbf5370b8fb6140c077337e820b43bad98d3aba0d92ed7ae9cb11449e813a81c45e7565a9ab462b5df92db32fce4228018c0ce784289f5c1964e64d006f722f73d611d83c73398bd61711f0858c502a0c6bbe47926898b85c5d833238d410f7c78ee794e7d94d7dc29d4f0fd104c87b6df61da5592d8d2f0524a9553cf4fa2f298223b2bc15c0db9e60de956e520d474f26a409fa88aa1b5f262296410ab4cb7b661f3299ffc6e34de37bfe7d498f652d2eaca695518133d9e55484ef4aa536539573812b23f16eadc7cefa2c2c69b68625f67f6ed985eda46eb37c43417453ae90fb94cb2448346692ce91bf9fd7e63a82c2e3726f74b9a8a939884bf4a890b8f8418d53174a92c1896b4b107521dab684e679832de10d27c3e7391c06b6623228b6ea5b53a93f1b81e24423a26513e00f8a5f3c6343189e9a49d73a85e6b4eca69ffb78ed8d24e5ff4e5eabe0a9f884c4a254cb17aaad6cdc6d147f034d85612ce1466bcc903eb7d00af8c9b95d85d0938d6c0c8968937729190ec5ba49e304d65423bc3035554a39cae23945672b42de93ffd48b5b64795ef4e693de49fb48457207d0b8fbedc48ad93e4e4bad0db5acf24c2653507e9172a3dc953ddbd271c61a187e450de701856cb202bb0be7e28c9d9c29a2d2465f3960150e939c55e5ee44b1305c45a9686d8188009ed08ab466cce5928541ae36dfe0a1e9ad2a97a157a2b3686587f84e939b5a08bc343ed4c2e4a8b42c4ea41232b02f51fddb83dcd13cfbc24b2fbe2481a4d500d2263682e3fe2355543e3a1d450bad80bef807a6b332afee7841f7f057f6aa93f2f64818989cfa9dcd5d102a9eb645d5576c965fecc11ce0f454b5607afacf43d270069cc03fe6f7a9228c26b39213ab76f3de75404f2da28c7f3b359ea81c50152188a0bd6baadb24e79a56e20e3b5bd3abb1a43c394c2bd075dda027899bade820edba24bd49223c141e511ca57f8c1d4e6c9bd03498ccd55447fa4ac0510cabd3ba5de69f0e9278569142bf37934e90e9a2c8ca2fe32fa3b8c709fc77bf6e3dfa07df093a4ffb75d5e1ce8051ece5dfcc3786535e2a3a0585a9dbdeeae1faad5f4a151dea01f74a5a4f5e59ab7f750a7233d31ac9bb2a1b7accb7f03b2a952c2c48f77b2a481200daf27711f6f3eaf82f560bc7d70690e4cb2df36eb6ee6d592259ed984a863db599efb2e1b4bc04602073692058df6691b52c1a7827bdcc29e0721cecafc81fef98c82a745ef518c5bd60df578bf4fe3864a539b5b8e8c2fc1b7fb4b50cd4300bccea7392400f9e1da5246675b9d89a0cbce7048beabe8f766b08d34891baa2bdc58e72b95d695da275773d235ccd9cca4350087b4b792a445e845f7ae5370e492d50cd22f2e2013552bba7303974154a958ec9ea27fb49a714a5d6a14260f70c4f853638e64e41d0b1d5084b3a43cbaa1550f3102874599698ba5588fefd178f49dbd64e321f0585db160bedb9c5504535ee84528dc1351e659db4efceda0f1e55290128fc89e4de8515571df8f49fe7d9431416aad078ce69ca68a09c0dbfbd25a445e0decc81837b72ffb87473aed3c419ba465abaa734e7d1fd75725a5d5dc5258cd400b83f23679b00cb025b2ab2b1594660a1e9f5d28f41c2544fbc625c655a85de79950065c22b3c0383c077729758a5bc8b9bde7b5009a5b6238c2a58039dcfd81ad0894b3fa14d1bd14105879f94f18fc49320cfcf5e887cc5310c9e7f449578c86d080ebc4b6822e2f07d2efbd9f2a4774ae02aab8c02ca80d6860f1d334044494a1e56c6b467c674228ec99dd5e1942ef188232bedf0ec933ad0c333206d9a28aafc1450440d37c86b1b5c7dae633a8ac3378dbfb95b44a169b2a0cea5c479c2997f5819e6d8279c34257ed8b82a740069bc7796c62f6c578be13790f8815ff68f798945a01fd50e6873fba13bc634ee5f179353f616cd9321e06daa57cc312fdf952167dda1bc447ffd2cffe04f57be58e8a4eedb74d76ca4f835bb7470ec1bcc43e5911e4f6896eaa696e8261b72444a48f62264ff854c0869030ace0739570538fb76e49737d92ee7c1f56842694fcdf6a0c18299653c752a3316908732f8b09d5c372982f3dc8898e6328726d3809ed13ab44d492b70a9cc517d30a37b103082d1d573f168b84d542491ed266d11243fb222df501aeb2264a58b41070451cab75be98e46cb2df85b0bbb74d8e361fc2e05e4271c918108e7a89fb1220b665cde14c223e51231c770e6856c3ca87f7ed429c9afda8d9d39121a2e20eb3c03c291566ee1f7d0c663bffc2fddc45c9ad1d2270f6e7dd402a6d834c8b1609f49aadfd40d76b87da7067e1a2b5e2dc8290cd1905646aefd901b1f063feec42090c059a55b7058d85c3094dc58bf79030cdb9560d2456d74436c1f50479f40d126fc1fc5ca87bafa74e49f77545b8ced2cae37f7d9c4aa3eb9d2bdf6d675a7007ae91a49fe2195b71b115fa4406c7c908f5be24027e2d55498ab6397dfaa04ba31c513e3bee4b4475e92ac99d58d8489bf32c50493e29466c7d3832afa7d6f2329b5175226e7f407a4b03676212c4e93829677979a6e1136e24c421023103f9332b5dff57a3d04808de1de2e6997a1ea0c7d09d32820ea3a23c011b9ed408d5c8169a3d32b047e00aafa79cb6b02c7eaf54e026f8ffc85eea37f774782b885de0a7807efffbb43e73da2aa1b7f67398d30222d30206a0f3cc77f46389e704e06e4857a174060806fa72c6b7e5eb8493b273140b3f3616e7de08df81975e457b0dd384a58473c49a419d3487d3f15f56424ff5f60e717526763ddd50599bc783ec0e7d992a721cc1f883a0e9d834949f71064465e40b8a774799de3ebb05f7d4a36a9857e525adbdce22e581aacf80e4419ae6f87942743fad941286848273327552fb8800ce3d49449f6565c84abb93bb4d373e596f4a646593fed7a9cf627db5cfa5a1120d690e7407977f9c3031da0d59b0f89de28aefe5f1d36e1126839d2d39c7853cffdc423e838d0fca0e93d30e96c33a4dac35d5e1d1fa21fca5cda6dd2b2fa2ca9170fee23a64133e7befe84087ad1ec9b3f0f9d3b898717a40429db6031763e8c47ec46426d69f932596630ff598e307a71cf835e196e6be252700af5bd174201a198ce94c5bf71be754c96546f3c7c99d227ad3072446c89b66a0acd1edc4674cec09e7a71e28c1497a092d34fa3ea2e94f024f14ba1273bfed4340c1446066c3976a59be97b22d755a6dfa47523fde6106d042e97ff99dee5717b6cdaca66f4e3cd82830baaee783c5c2d30589e65ccc29fbf2f9df42ccf35c489b184404316da7d324b1b6bc899711ff85ed41b6014ac78194492100db6f59859c5e1dff940df060cd67427c4472d9ce5f35efc0844623646a81163fc624554b1ce4cb264190952ff6bb307e1518832453567a7d028c4264b82cfb4a10ef6b48db71ce85138d24b509982378a8bc8cb2b7a3dd3d498bb9f7225a77e5bb964d1da5cf17a4fd43316e263cb4f94a8af3faa8ab37bac9323eec145ead0a29b5b24746eca2ebf46ae878029f54962396f2848c04a2625d5c127fcaff9d920d9828026c562ec623e09a64c8214e06ba4c5aeffb950a424f915ac4f1239dd2bd4723f1b10eaab5019def7c233cc3f46132fd353dcee8df24d58a71fb5032ea0f7c3c7183436f2a5e260a7fd57da4b1c20cb8d479aa33ef5a7f35d29f604612a49953d6c8fe0f17a0d698988e43249ad9b3d03cf9c28d8dd9f4e352f259e68d3b6ca0f9002fb5d9e2026aa2ed4008802e81794a2de7587e4c48c038128ca1cbe5f1cead32c3d95ecd958936ad2fb2f0f6c1075e7b9f588c7d19cbc291f8d5277cbb09c91e26b3aa6161f6b3166f88a5b191e612bf5d2550aba50b668a777d3673e168760d987014b5408b0bfac47d9ab17c3b5cfcdf63e1478c885c7f2652be1686740e9892d7246ac3ea6588a96cbf267149d1033a3d4cc846e23f2f595cf7bf55e21b8c504f4004817bb49eaf8c0a5a2d6af4f16894e968da4817f6d9e0b8e173853a4f4b2783ad69cc3407c0157b8a558198e486e057c56f27ec6f8afa315c7acb01746091afbe70316b81172842ec9debca1d1772d6053a95c3ddc4d2fbe0663364398f9b48e45ee998f61652a653a43ba15c8d1abee9f13c726c27c654b9fb0cf61aae366ca9f204ca482fe581165d533393c0d290b3443832fa76ac2f55a9e1c99953b9c85593ce5229ae3890d48245653a92a3a2cf83855ef66aa21ba61bdff3b3f1cde5619dc7fa692f8a6e70db5b1b56de24bf06756a741e17e580d39e5acc920e52d70bbf8c08b53b9df482838d618fbdd451c6673601602d5277fbf114c039991e8c6b06fa517e5dc7eaed32b4c9fb40c955d8898532a72ddc3def89029143696ab46f35d66959aa0d4d95a7edffe92c0541f6f921f389c5f66ec077cd5852cc8739dcb40f36f67823d08094b86a09dcbb7b06d5cd7053126bb3573c11a63f3e181934f1325fd7b1ba7740e9f495505240013cfef4073bc35941594284ae742ddf1f4be5e90cca0cad426951bcae95e2cda0cdded3f6e1091112e112864a84b0a180e3735f59aacbd4771c5b8a9db2b68d156a7718a5d25f61c326ded393242cf2ec996e217d41ca7a197f216779d63067e33ebd99bc36d2a859eeafdf835a6c066ee6bfb53eb58deb587b5a514f077b730dea8ab0927ea4601f91db39334c444a1a5913d952c279192b5611165b1a8e363663fe4460b454e71ed3e8dede04ec00b7673935a05280d4ad1d5d2698690a1a87df2a991622aae3e09eb0885a25b32a3a6e7b22e1265e4e1a648b9cf41b7e77a2ac4ab22b07fc2e2b814b78591b1c128b6bf5fd6c5eaa7901633eedfd6b70b2b476b2c4f635cc90e7bd1c865f7c8a3f28d839c5dc1018bac9f4bfa6820ed0ae9089920ffcf933159072251edc81c812a80fa0aaa7baed8788d06f6576f4c6ddf8511940f5b3e4154c75d2c7e96079b711970cf25ce0539e2ec12ff1754f5c10228e057e1ced2e4ad864021b2aa8fc674588d26d25f60c161bea3d6c6b74c8f871fdef3151ca1d69e0481cfbb777fed54890908f58dab1ae067c954250e88720aec4ad3ff6b4d7e62ddfc390b95c49efd9100044fa62e10e4c14c3aa79a9ee82a443ad53857f8716c1fc8d47c552c6cac30549c5c8bb4559b3e2c4e2d59d48c78b78ee8a483aaba38ea809f41c36fbda1c71e04789e8da598cd3aed1df4d46cfa0b5c38aa6d52023eacd33ee764c28225e89144cf617721766b2e0840b0341cad00661ab0bf3913700b69c2f7ed80e5d94dd68084902ef895214561357671fb2a5ee443acabae9bf2cbd143efbe3c550c0cee61c88e12d7b61cf310d1a0e9e0ac4ba87dd321e3919edf46c43a9240cbf8319dd270373cf6f6c589e9d22920320d5376cfb121e0941b9a9f941975882210693799e57613dbdc7c9cac574ea7e43ac9eb25409ea23bf7d0a877f5d6bee231acbd335466553e87221011a9d464a44203f2f66b693b7179831b8f42b166ec712784a811394cf8087b331c5afebec187840302f000df7d61f0b0cc00cb2a2838a19968c1c2d013ea15e63280e27d84b70e4d31842f38e0f53d37dea0a249a1cce81936bc6ee56b4431ab484ef0379389e6beb02bd4d79a13f8de9d7bd580147d8d796b1d1519aa626602e05b3c007482933858a52c93ecc3ed600b935f928acc78f4ce3bee4d05a58c1b3503c42cc920ad2231bac58861bca3b95594d8131dd0aabecb9118542d661cc9bd35566f7ae8601af181afbee60032844d80fa8fe9eaaf6c82fe1974ee10258da5804a737be71e9cd37f796aa5a9305e3408969d507b619dadd0ac5fa23d774ca0f52a1d238471ccb5679b2a6ce3bcfb89808271b989dcdac47abda1b8d1a80d74eb8f23cba7ecaba523b3702806c51384bcd9d131039e20c6a8b93f9c3b15e01567d3a273f73e7b7f8baa8af5f290451008f1c66fcf4abd23e86f3210e6eaae41c117ab672993ce9e78b64432e1dec79b9a7c154a08b7307b1de7cc4cc08e42d8f97ce142e75fd420152cd3071aa1f7e5f7bb3c9d2a55105b97d1c7ba56f115576a90434008acded4f4432cb25aee51c8fc25b2eaa7ef7511952cc78ca0dfa026478d8649ea5237f1a2c60c5a3ebebb79c6dfe8002676a9082eac10745d863f62a81a59e8adfa54c44363d15700e2209f48742f5f60b4c6e3f3b653bfc3172781ab64cfa1f9c668d92f93988d415b9c99b078b09dc17648fbd98d0c8b05e82474b9962fc81b3b89be69c3eb8417d00a2dc292f48e27012f5c48b923061d10aff6705060413ced231ac0cd6115b0208d3bba2e128165d01a2e27b112e7d354316f010fa3f9f569581505ef9413d506e5f7c0d7e7de166b6b690dd4c93b053620e121ff81fd96873ea37cb8066732096ad0389f2fa7c93d40d51d53cb98aca02ffe166bd26fdc56c8f2d5286343665edb3b7c41160c8fbcf512aa34d74c65b70274de90f0be6e9dfe6ca0a50c3da6f018ec471827608344faafe2b90bf1a1cfa8d7eb6d27063e0e28a5c14fa460285950618217969f96f11f3e88220422e5ac4e09b02ab1062c0a2a72444edca433282db5c8895be3ce254bdfc92b2bb6ad4aa6d9c727a89a8ea70012ee1493c6dd77d8588922c1d15b0ff8678cb5c1e0bee252e196774f38a65a6e0a3ea2b9c5af69082a61392b66bcfb3f7b3e862129319a0f24addb0a52124e3bd40a04e350edc90c78a38b72da70db9f63193045047395f92f65dce0be0bb89dfda12ef4a139d610b11357ea3aec75629eb27bd7621ee4bd38fca4120973c287bca41062dc805a81dfbda077b985d82efe7445112fd21c44202e649601ded9c37bf9037937b19cbd4515d7ed7057e296982c032c3bffd13413e3e5dbceff004fd6ff61c1b099ae67decfc7edaca5c399e6ee1bb68a85cf496a0ddccf3b0523be67ed50645d47f5c6f582ce3e11e3efc0e8bef4844d7660484fa5a0386c46cf27fec8eb7833d2535cbd297ea360b7386a38025a442dbf16137d44918746374b8e7bf4ba0bec145731b481fe63190d2a9d46d97acd78537be6a89c941061adc5c4cb808a3589ba8e62b3d7c5016fe88eefcfaabf679ac8338249a4f916d9f57a99c05f4b0a295c44e57a0cd36cd07d6682fb3ff094e4b733863992a754a2d92ea47059f60920b433bedafc54766befdbf382186f24ae9399c93698f0cd42663f6c412db5b098bc96c07ce5d6371c104ca8ec70c29468562281803dec20f7ee8b2006a0f17ce09386c50af453abc7011edd90c583748de50061c78051e9b370ca6663274ef0268ef7b038b806c18eb5f0844b099493360cecd6187341276633a8a98464dd3691fe66b06726c2f7814af42c1cc44f1f582bdd337f5f3b691c84e15fe439d57d7592c0ad774d499a192c8eb5c885e12347036cdb7f5ecaef030aeee2414f456a57444159f8e8bb7586785481418013acbcfeb4d7c147f8895929d6ddef4dcfc75653fc8ea859a1082baabe6c6a1eb1c58a66a59dc340cecb7fbf5d61ddb3d4f7c6b312625f64d704c4ae3830095923be16f81fe96cf0075b67702434f96348c6ab28fc84c14aaf58dd10a6b0b08cf9a27f2028977dabb77c12bd5e7809fb148592fbd276ac40a8a97db17ae20fe9505de014e8ca24648ae43ede90acac963787c5948d15f5d799825ef283cbe9e7572aff88c7c61a49153e2be7b9721e18792c536cd30c7d4c9b6fc6373af87771b06b66df683992c296cd0d77b88428ea82074687122786a1f04cecb93b86621a4c85ed92af10df1adc08b4ccd03df38f769d79c64000c9f963b3cd458d507824b9181c8cd728f69d6f31022631195bcb1ca06524065851b74fa9ebaebbac02542e4a6a7c1813d6d5ccab185fda4f2944eb4817498967f8192f7a8f89524c0023b7acdaae7b7b8aa209b467967b39caeaed3e7840e229e168983c620bf7126540af89688ad784743925d6db7a851329f0cb23aa60cdd32a551179721baf8ed5e9f4aeb660d71f937a5357cf692097742a3fcd1df713221048be09bc212a417b8ba7dc9d0b2bf07d270585a068b58fa085f354a535ce8ca1c95340668c43a22877a32b71dd1feed85d3ca0cc986feb9735d1f98e37e3a246084be790a953c73aa0b3854489d09145dabd3f4feab6863ed9dd255eded2263afd4eebab645b63642a04ca2a7889dffa5f1a6d9299750ee70f5ac23b2669992c21b0215b10096978ca37ab389edb47a2a89ee5ea16b4a4d42c6d283ed290d934b44d4dc0ce07b15b2a4f99b463c4445df0248dbba6595f655576ac7761212c15236cc71935c549075f7c63eced40886e44da24441a711d004d23f90d12971dd52b2831bf8bc8cd82347d6beec5030634ddc93d1c839d26d4aa94176fd1590fb1d044a415ec400e2caac8510c6e585a4f59c6c2a8dd7e0abedece981548227e9607d14312cf3afaeeb7c839b72570bad0e567db8a8bdee549be5a564a9d68b926a2561a2cf28d6898b02276af35991d351c03abc8afa6c7f65ada30677ec9fc10d0ad63ae316f0b144d578500653d42d0ddba62b4b202b02c9570259839e1c47b96f1ae53d60ad44f183ee7cedf6e3de9a40fcf88d8175144d841ad4c3c6af5b0ab2aee9503a16182d10cd06d24ec170e35a3f1e8bf67d247342eecca92ed497ca87f4110d89ede899b4bb1f59990b0479fe6791e2018879daafb9b20a8b20ea187aefb50ae6da9c2750ff3bca7b78f60532115db34ed66d3b22aa714e39ee30c1754c87327c9e9ac6b6006317aa3d33148adf1592be87a634c6bd364a50b1fa4e1764cc2c2e4fcf333d17f48041c787eec9d394f3f47c4ca229ba035176526d00052305a68c11e74bd694b897a70738d31192e8e49107fd066f43a2a1fc2a5c01724796c9fa3c054118d84ef76683339a407de7bc79a231ba5848487824ea46eb4553ae95c903844288c59a1ecf18936ad61580cdfdfc4b49ec2c97b670d00b6b5bc6ef4c856d69d6b148310c9ac6db39600749559d09ed325c37201187d3cd12eb03e0b8474975dd65daf7f515efcf5101827d5f014f2f2956282f7c84e163efe4ed28349e2a43adc7c369869d8248217d7e6bf9b46369da521b90177e5d91faa6a59d84bd080da66b2722140ec1a33849ea323a4b6544ed8cea0aa11880dc762135a549b8f729a2fcb9886018f032428595310f07ab6351ac75161ce7941982b3cbd967d960071ccf1207ec23111fa11c113e47ffd12fa58f49e9f237a54f75cac78494a88557d723d863e4acabcbf1eada04c4236b5fb7059f29e4cb565b45ef8ba929f328fb82fca1df2f45d2dbf78dabf1a72befd46c9efe9566c91f52f0c5d3b7fae685860929feb2f2affd5a19a0e61f641b8872fafa34a828b1da20782d371c7524838eada8f1bb7d684b1b243d0843b2aebd045196942f590580ea538da3a815efebe894b0d9a07bdb3c1a17c80c06ecd7f99f959ba0c9e6e921dd8e30806ff5c8a63bcd75a4b5ad6dd2608d1d144acd7d3b08f2a3268bd6d11869991e8a7c31c4d9397d6e69033c0086bf927c5cd2b5c8dd32916cea37e50920866bd859c9b6d929041f8e29b99f992e76cc6817e9c25c2271fee55a6a37e544b8810fbdc76613dacab892e7868b1438799915d574a23927c49db605ebe570d22f220475dfd36665ab484da7fbd26ac07c1684aea533942b99f60c60f36408ee3c33785ee03835779f15b8160c41073210cd1707018a37f1077a0aa6830908a2fa2cc8567d873edc8a346ab9220db599b9ed6db9938397a8e1983998069cfe65f37235152e68a1834cf00bcf33babbed5c194e99fab12b972467b6b6a6b6f05babc5cb019ca9bad20c537a965cef3a271b9e893445ec49d698d1122df45cf7f8dc8338270061dcc89c59e3a2d768d1239e774c649bf2b4ef47feab5e1be885fecb24daf7d23437d647fed642068bd9d5155e835fcbe588d1a1fc00746dbe242ec97abf95f64ea5687b1fda1a82e3b14de06e83189d7becfc8d39cca6bf4076aee217f123ad41efd268d979e30f329ac8381d20e83abba0bfb7684fa734b9faee252faa1f79ee8e1e2241a4f4ef7f8ccb4fcf19a42a45f5dc92e1d3b60c1dcec2f9ab4971a6275ff3781bd3a94841bda08c984b897bfb6a25047a5b334293593fbc42f17df92e5e660806556ab01638644c2d0b706f0911a9a314f18979a93d887fd112e96bcbdbc63817d0fa245a64f717d5fb6f02d44dddb1b6cc209fa6c70cc8109acd0b1e8516eae39c93b36a0d4db880acc167bfe80649579dac23383c895d95ec064fac6a0f83d053377862155b94bab93c2a6747f14c35a897ce1a71c27da8f1bb200e9ecab2c292b31a2de6eae941e5999822d655aebd6dc81a69cbdb1caebb73d93a5fb56750ec8566a9c45c817c838e9cc57caafd2252bc2f9b6c443c0a3f1699afca4b3ccf45ddbd0d19064b12e5cfe592cf5df9f20eee6d27bc13459fe3e159e0cec3f27403126c12533d9dcf1ba2a583ee8418cd19621ba3058dec9f6d4b612e1fadc0ac7c5b7ae392c95e5e1023b777274075e473511f836c8599479f03889d721e8fcf7634f33b8bd5c500a2e13b233a2f2ea98bd7106b74fc3445eeb4361b217f2540e41cae31943dc43e293208ea95925822547ce125379188a8fbf22e50b7ae7ba5a40ca84b7d0b7b75418cfac445b738e4be95db0c22ffe86f65c41eaa3d0b5822e167ed6bcd5c7ee13297ac22e16c3e2bf227c57b821cab69d152e0dc8a1bedb41996bd06cc2a1851ab7cea40b52286278393f29f1471d3bf99d38d92f3e0734e32ca9cc60692aaa3505fac5a9bbd635f017beee6bb4a0fab1f92ebb7b4758bdfc574230d55357d41a3d871b51deedad95e00529f31d51fb5cd22acf7c577a7ae61a47d5699ae4f219181d5e592664d5da49c7117611014230a27ba8780542fd2a46fd64f2c4cf473808c20cf8ad4748d0ea54973c28e50ff845abd19a39f9561b662a80b4d04d57876350fce1ffa52f4dfd2065266015e24d62ab919c35fac0adc79cf097aba217a24c4f6c2a5ea11d287aab3ccc25fb5446a84387af3cc101b2baa9687d70cd9ff26983e4553c71a2b3ce8a92065f6d9953228367b0e2789966982823942c2c2582de4eaa33547d3c8989c20c240c09452fdc8ca19506a3ca15a79d02b0fda9c70114246fa7d8a4172f06908b69f8cafdbee25bc864e9f74d8f7dddb23d1da6c86a23c587a9678143b93ec69d24c3b9de045337ba2c97ca0b5d18ddea0b2ec502c6b1fe7ba29d32660f203f5cfb4edb9ef514b36cca28875b729aa40edd55e5854c19580e67c90e8b6ef4d2b3ea8ed9e67eb6be9e346bbb7518ff123ef926ef9ef2edc6476e19b4cf07c0904d6eeca10287407c451d65396a9e5c7df08198f9e5ed76451bd3fb7545ce996ad56fe1f02750041bdf6aadb2b6e4c643a7c0afa0e9972140b7e37ad59ec00ce880324b7b083d5165aeca69b8f5ecc8d32bd5400d03bca8f1c7e4f53f34075fd030051b81306a09959322060aa443a7520cb340a853adc99b55daf85dd0a156245a490af9dba772476ded8028b039e0b701dfc3e186eee310e490d37d486db63372db26f45babc646fce8faaa019c0b64d1e1af2354d7019caa8363f8b1bcaf27f23a27705accda385bbf0ffd9cf5afd669b7a4ffbaaabd170c857ee09367fbbd040c575bbb0f384abe8d12464b7817e033358c5ca20f7c53090759d221f28c3aee6fc09db76d4ad5a4370a58b368743fc8dce86f18d6c8c86fd92dd9a8d0b74bd9d4f6938c89cec380eef98b932b44584832f71acec19bca210752e33408754c59242558b072a4c6b773f1f6464ae73cdce5d80acb9ea9d451b6fd17a44d90d30ed503aa285f0fe5b23fcdb162826fb97bcb9df3a1b43d52dec2dc0b8142435e7c7d0fd9e176fb943c6351ce98734fdf0ce3958f9ee5a8c8cae8ef81e9c4615d5046bb739f53b28ba3ceb7db70efb36e2d10647c5d4551abce3aba47285f8cf21795c5089c4858ee43bf9b46671eded1722677611cac5f1ae84343e51f44fb219d58de02339ba2ac0d52bb03c52114aaa7c52bab6dd6accb6b85247e8158dc5a2ab76e8898622c2233e9e5f8ea07b06c768eb0b4ca33544b77d45cda5a39ec02f15d56cd2e5fac871256982a7d71ff2c6919e49ee2a6983c3ede0bbcea70e17d0ae55e051e294a5a9a1719ceca5f67f0038f975811b747f1b527b8200c2fd07f6843cae025226c732af096b75db626c67f88d3ca73e04de202db612e5fe38ae975eb1ec2ac1fa26c668f97de996d3efa8aa16990f98688f9c559e807fdb8918ccd97a5b4e8abcdb433ccf6ae08a74ea0ffe51cfc3efccc1ba6a9941510f08c623f92a0df6f0f32681603926c3bfc40a073b15311b1f89b8b5ed8bca61c3dcec6dfbf34579001aa91099b21f6d868df796a15a7f8a3d43232a5eec0077b4d4d7b2a4ad781b9fa95374711bbf94492c7ca54d7869370a24e52c8d9bc48871b222651ba9e7c1b9fca5c5b7bc41f24f2d31221650e487b3dc4e4741b63d0d2c0536e67915ae07d511109cc78bcea23b64cd94c42f230e1f20666ca6539e6c81ace3faebf9927b4a2faf754f8ccaafd590e6c11861b4c505ae0bd564afd0694fe68e1feb68f1e48ea02c54836eae033234efc731cdf695547d84314a3df310006fa9f6bd231f1a04b5363331049adb27ad536dcb903ad46faa19389910278c3c48b7bb9cbbdc3c5682187151df46738577260dbc6f4912180809834c87e73bed3163a9e161e4d1d23b85fb65ab22f375adfc673324c993bd2cc0681cda04bb7006578d905c130a4aa8e98c88dd5a27a252c7fafb512c48fca3b4509a54470e940c1634fa5056bffbb84dc1b2e055098a79a2a023da208cde0f877e77ec32052f96419ccd508913557f7d4c525ad45354d03738bed67694a590adecc71b0717582a55a28abd7cd9dff97cf1d453ed71c4840ab7a66541a61f91a00eb097d09ed9c3ee67da6d249ae9366c031bf008af57f403e3b483ed742600e4b0ad85a85e4e2a5311dd098a93c065cb01aff774bcfe119c387783cec5f015663f3a3c7d469aaab20b1e476e870ab5001e18f57851215add114671a64d5204b02f7c887c71ee8d1c0bcf564470aa0f9014037cb401c87695c8a9166e54d96a2433ea0df4d34daaa6ef1f6f7b84653a74a17c75d928039ecb1fbdbaf52a5e3e6dc35b55a89d2f847d0718d0627b9d7b46fd5c28bf7466e3fe080c9f4abc6a3e51b74799b30991053c62029f4e83714e7e5dfd76e8ed8a40bda22329b098575e425f2140d5f8dfefdaa8521cac2700910aee11603b253825a9cf47035996dd356753a2967eb3eead9dc2c8530c91974e629f8d6af4e554bcf92a3961d2bf5f25408667aed5cebc5d85194b0a452e5d432bca322db6b175fd6852c98102c2068d673d61ca093f81ee991573934c031534ec9fff5cdd725563f4d01180cf2366dc4c4bc350a68301ffb4f6a03909751f622186aae950a73e84cc3e0be7afd94f7b7037fb8cf878e3646d10d165417e345859d4729275b781b7c7ac711b7c30b4d0d01ea2ea241713c5bd6f7e1038d80ce0048a8640d3ace4a62652371749e2fa484781b9a3fa92983ee53bfd34331692ee3d5ced91273340e99abac3999cf1aea49b66d06da77876211cf0f4fcbe386a9a973eedac5a9a954b6313bb1dc675aba079fbf03f08fcfa2504a16c06d0e644d06014eedb52b8bedd1cb07d7a79536d628b49f32db6f32d0bb3b8f3823a09e1133e4cbbad337d846889b872c5633516316bc319e69a8a2642515a0a8b67af79e6cfaa9d8775885ec413e94ddfa7a9a34a4232549f16437b744648c0564b7ca997d5b21f422ff3caaacf93922b6de09561afa256354ecf9479dac818702079ee96013063a833a280c60ea273160f5572fdef474cb2a2e10694e05d852d691104bfade25a96d418bff81ad4d258bd778447c06ec075d53dba564f08e711e258c1a139cf34bb6580f3cd0d041c6f942a924d1eaeca186f82192e1269ea9aace57aa87fa3cc4da40566d95250716bca9868be0523f9990a8dad09b8121983c78c525a9b33ace3af4f8e67195ddcc64da778fa092ca23e69be446fd3eb43bd80e40d7ec3d849dba5fa731217aea04df1c5489d6d1e1f5fe9bb123fad56e0a09f8e4c958438e3e497dccf54a532955fb40fa8dc48656d3e9172a8b5a71fea6946fe9439451aa4b3f20c6c5371fb7ed6f0b309ea6599cca93729085974ef4d0c74323a45db99e5213ff331366428d239dae26f5af9dfaff4160a71a67d18504f7dadf2e2e6264d1181309cccc9f46fa496c67054ce7b4837c03bc9a3c27409866aa91b6a2cd872a443a7bccab2b4e5dd2df216882570a5c7e0f13b5c02d224b58387f27fee3167f57caea20997ddd53bebd6318d227f25ef056af423a03d9465450b1b1623380b4dcc0ef4f29c89ad76f00e1c3e534367555dccbfa64929667b1f1c4b5381f3ca2c2dc7cedcad12f8a6131908bbeb9a97ca444c0943ec1bedfeff62eb69ea4dd256d2d6d410ac169afeafd912e00f672eb69191c6893a22b226098ec2370ff63dfd229d2628f768612f6800a97d271f5045fdf196a717d6d3067d5697c341314c6f8c60a0ec3ca4f15aafa070a90f665cecd2866b50d86b727b40adf168772a8c2e7827d83bd7396fa933951b916e09c3c113947ba70a269dd4ebd23c044d39d4e0b100cb0cd5ee01ea8dcd9750ae6356f5e21ccf8dc2733f30e0c25a2107dde21cf23c974bbcc0c18c2838887bafc653486e4ac9d80a842e3756a6d18579e7492471d02d9793c3885e8a48965ff1b8ec2a4233d762227a547c4686d2a643d6cebf8a7b2c53850f79e8899e7abe671e29c82441d8c20195ea143a9d3b3b8d0ed93f61193bb800523b1f95b7856235e30e8ca2c82d8fb6b318514384fbc5b4ae357959056830663b3210e0d38b1b70e81ce636efa622cabe34beb6ec874cdf2c6a5b299acd7028c7f42861079f240843550e25a67af2c3ed4be5992f27ee7ec7fc7634711dc80850b8f12cadd2b047fcb7b65ca0ef91b5f4c5adf4d666cc9c54b32c9aa3ece37550ab805d906e30d6aacfa1c437df1dfffb734b6a6f79afa32afe019c8b57df95ac51c5d82a2624d85ea867e52412444d9ada0e01905de529a85493c6ad7ed7c3e37912210ee6f7dbfe90772458aea2a2119aebdd9b462522059fbbac925bd5bc596b2ccbe152d099a1f05023b8663b960cbb62aa621d181157d2f51addde9d119eb38d31f013923bfca84a5ecc72cf830c52ba8dd3ae7e5d22af838f989c4cd42d91fa142450f1c3aba6766ddd5daed6f060240f9975ecb485233d178d4b72da6f1f59ce0c12334eccc0f5bc2f680b985a9bb7623e930404b270fb6c907df898b8955b0b898eef6bacf69855c8244353e17e21938191c61988ccbcbce4b1156aba541fe713a0475467bea3a01cc695fb713a5b9ad11f8885288a48d450f5f7fba7c901801e7d2d39484d5685af7457c27a752aefeffb3f446e46ee2835997ae9dd7ccdd1e55fd6907ca818a95051b6b943b5452f2699aceb716d1e8eb21f66b136815365435dcc1dce313dec97736d2e3998fb3c59e284c0051c65002db997a3684629cff2202f9b087aa4834071ad92d18aa5cbff263ded94ac3cfc30adf323f40c226cf778214e891f800e91cb8748e42623394d1cbfec1dc9b41a4cc77de379b9f674a0214e93ad8ecdc73fcce6920d34159d598c0bebe589fc44d2f58768953efdc365981307c7d82daef4d689d20ff974c4b44927680d8b7a24b39c8fc6462eca4d86e5d8ff3d6f9a0f5299b2c3cd7b825ddd5f6c74b1a90d72c3eb943f73396acb926b09a662b980a43598f52d34eb0bfb052a97d5db87f854299e3e885c03e918fda64fb657e2ff90a0623d8079f2d47b983a4ae72889a796cb495664cf14a96a307a4669b6b0b70ea99217298432daec194be007f2f611b1d6e5b88d0ed1194faa7af0e6d0bfc807889fecd6c1d8fbd2b3609c0f3ea1decc808e6624d3042662cf2bcdf59578af9de95f30214d6bfd24fceb8d287fc512c9c9e395154911ed61a3ad1440c727a6fd8e152624eef95493cdfda321615f0c70dbb25819c9a405fc1f43153b5f34c2f07bb790e555f4eff81400d345048c4bf120b3e22cb80eb5443316a041d17cb8a2f24121211153b40c9c507d30d9a948eda05ff5877787edc0a8269b2e30120c5938ac7157a9c211b35f1edd057cb02eb7610d28dfe5643fb930c5b64f3fab5b64b8b84027052e0616f1999891f1b22fe81d62ce73e3cc26f432ac6f981fbccf40b344775cfe15323a1aaf85e81badf2b42eced7e04b3d63d4d841e571bc8498df64dbd0ef1026921d5b85fc6c2f47566a6fd6e3880c2be9ac867f4c4724768f8df1f26c0609ad53c632048863bc603bd31cf59611b9ae9564f5105e8a9041ebffa7512417a1d8b9f7e5a64b06ebcf7530898cebbfddb6c5fb49c4c7c441c756d8a5cb79a8ed230ca4549c12ddda0ab53f18db189841ed87971215c83b5b599b6c72e14c7e100637916f45586c7bd7255e6ee6b9d33bf9cfab462ac0405115fcd4f41dc6ebbc6b362ee3ddc620f491df4a866005219e5abe46212fabd5ecebf351f794c38ae2f0af1baf6069537ff9cc077513dbe9f1afb2656f0627e42e586b4b147d68c6e97b651924de70ec047c291aea913d3b1e5d00b29418e9f3396338d16f478f4de176491b5966633853c1a5d262a4a1884b48849932bbbbd84780afa3e83da2124a5b4fd4f6f25749851c66ad313a517691434bb1e493cd989827fec7a1f3f3c720d68ce806689e571bcd300fa547d50ac43a22bdbef354de916c6754d42dcd29f2a6192d6671665be290157e95f1db9507bd8388fb9df6ae4bfd8cd665f19ebdf9fa995ed03a25e63a0efd74b436b1966d9c6243a5a490b95780d838c681f26bcebc427106b48dac4da7901e2fc941e6fd4c09dec7e5d63906d4e4e2d34a03b8eed154ac36dc4aa1bf96aa6bea9a947b43bd1ea23ef5df1c71d17cf58f6a77f76f3f9be5057be1db055aad45d5d100fe27f9a23987127050b677a385ffdc597aa969e7678d72e90ba09d823c801efce4f48c13e1605b933a83fe7760e8e9876b6a07b50b34dbb87f08ebe11dcabafa70e4254500f382e8fcba04cde799de83f9d2093e8e4072e9247b52fa05f738e08e42cfef2be51ecfa0b14592dc9d802ece0ac31bc7060f58e3e3cf032a8d03bf7f6d7bde9a8c66cacac45332c74094d32a8f50b4ad520bdd691875c8fd8884ca6883609d2ffb34df8283aa8ca021c573e3b60f7f71ac2b47f014f8300a7dbadf6ec360ca30349bbfc348df5b215d4ba260b7466ecbb1e2dd5df15e14b358dfc65d73705877fb116cef568827f2b1ff1278d4fd8decddd1e4f43a5546f3c755f2d125fd3209956bcb78f9bc3f413219e7366e1e09aea8b03f44889c28edf77367e2da569d02bbd2a2e739fd155b48d5869f1df495fec93d03d553dc398d5b16c64a0a656de5ad3ab48e1fba4b2eb625c98d03ecf6dfe7674c508c12ec874a1652abf612e17c692831d1b466bb15be2054829a96924b79c3e20e20d2caaf48ca87f5cb297e21a0f72f680026582bde608f75c29d5650bd8bb2ca35ce93f6053cbb5ceff108bf0123a30b92d3a603cc1c05f7f094b2c6da6506104303b5a97c15e305b43f2d36344111d8827a3049ab281ce72f6ada1aa0185ac1548ed65e4958911670a89c576eb19f3d5c90d38e2516cfbba98ff03363158ba35ef2ce6404d97d37dac9f96483d7c7e6698d8f618933e2296153dac156dee4451e2e9ea72567881c96c392d65c511256a7ec7be8fe123c9865f22a76294ae6d887f00049c517fa3e69061c167e0c2ab849b5963839546421c676000b4761501ce2c2b7e3a41ff8b9b73260a25e8a882f85100167c2f96d8b513bd660b404e3437c55a80ecab07a3393d00862d4a4802bdbdf0b9308373e03f278aa0c6b957bb1548bb3948b7ee6c3d5c70a1574893493d3d18e3189135c5cd889fca19472b77c45a6e8a9bc6a7ed93c09cf49f08b76f04446db94ece432b2f38a9c6f0e449ae20ed21979e378aafe056bed42ffe59909319745a598cd957659cb68f01fdba8b772d22f53324249f232a294ef022eaa63c6465ea80e40cacd9f3cc846c7cf658097f8b5ac4d9d6412bf49a2cc7462116fa22def3f74ed5ad4b06bd8e7b065eb0043bb4c7ef02bbef1207f034ad6901002765e0b6b2c3c7a9fbffbbb1d63fae69b0126d2edd3acbd3db304cf11be81f8a7373d83cd5fc36c864565f9ee1386232933bf4f4af1a1526020ff3d2a0de677dd03d23bed2ea896761bf62898e08552736f76b6bc0a14e37654b9045139bc21bc0a99188c221911dcc5e75c3748e66f6e940f5ad909e549a2025bdb5c28710ba635b7a09a547a8e03b34ecb9eff810b2b9bd8a01799ecf3b374b7dc0893101887be9b3512737d5dd39a0e3badfe657260e2782082dba90367e57591452699354b28491cfb0498c8de50fe6cd5234b7a1005d232c5b2a7a2fef70d1c8d699fe8eac3e963319b32f40079bf86a919536548be6cb05310d61cc0c12dba95cc5985c88bfc1dd139f400303e21315f5e189d3f65033151c4c52d7e73672df057a3832e03e4a8fff11e286b839e06aceb706d6a5cfd5d079d48b012cb2a9845ebb83c35aa704f2ba08a60f9157195fa1dcae08422a0f98392ef1b0dbb81a23495de878cccbd30986fe50f3ce3f19c5fec673d72e44a1441a9f7671339fcf8446e3a06bf0185216c6afabff968c6833140e408b6045684cf41892202ac67aaa896b867940c91e9de42bcacd8400b88e9fbda33945ea8d2eb4035033da9b74b9f23bca9975f99d4e902882e9f26ed2a376d034bdab3afb4084c067447bee3b5a33d68be02e34c4701a3c0efa621c919259b60e18606ce1beb0a46d55ebd095d054e8f211db7032e0305728adc9acd1e54d6139486e1b825dfd365852cc3e2bd5f14bc28b5fc56ad21c9032bba017158c7ebecaad4c75c863707015d791fff888b6efa29e28e3667cb88a0de6d214208827dcc93c6f7c26df9b53385f80f5d505fe105fa03da7d3c4bbf6ba6a760a724876e5353df2aba05eba5e79eeea6397a913f191baff70ef532f3aa74145dce559d0ed3d2c3b6dfe764d2b8d60cf3f60219e52c3460e9c1826934d7fa9104b1b587dd5905d6299c9f850bdbce728ce5b6ec8ce36d95fc19862fdd8f551f446818c10eaccb9c3e0897d3fb3cf9007e97b9d777563d2ed1bff00e1e99e531fcdf77f721ada386ddba4ae8358b0dd15e4a7ff100bc9d8fe4bc08a1afc1139ce64d0852f232f1ed1e6349b05f31200f18532b6039024c40f9acb12c372b364bac3701f8b30b029eed4244eb7564ef948c01db86d4c4444ac5a97f61183c170ada01345541d38307819f659bbddab2cd5d8bcf77b7987017e3f93d6265e086a897d4b43326f0fbb3709d9f14767e56215c037ee03e2b732cefbdf73052882c9acd0babb4cb9d9a5067267617604bcdf6e6cde9f81371c485e6f0a5fffe3499e27bd6c46ca92df36ee802849008ad247bd0933da1e321b3e1612d67b08542d7626c251c22745512aa3902e9ba348f797cd6cd8f37c0e6e1ee874feecbed863095b9b1218852444434cf42c5cfca210c929568541815db53de9d3626ca8e3468fd61e6d6bed73d384c74b54ad7845e5e33565e3df22ec26833134b6fba3b6d4a61ad4ad31dd4aa0ceb23886084093eb9d0642a656720fb0f43d760c0d02712b7383f312b099ac94cab85f35d702bd080c0a9b485ea13cc46e73d14d64523eeb6a358990360701657b545c9f3a43c549543c93dfc45017114fe3c1f55d961521f69b4882698635894900613cdd9335d63cada118b4d6e74e49a3d44de382460fb91648288dbfca55fc25f96bb58b48f44ec0874ca6ba722b4f217a1d1f62c5821fbbc1098983b9a7cdebe8429accac0c59c7edf1a5d8c2139585f633e27911b041f5667ceacc7aca8d51115564897aca448da4d399767fca2ce695c3eb7565e8196acc0f853a47cee710ddf7cb9b5d0431bb2413a70670a37600635a31e00ae9efa354a9cfc42927220e2c17d25b0930fbf90f7882396ac1e0e6bddada006ee7e3fb6616e4a03b7742e31939eb3cee3c0509a672ccd8de6da976f698a0f43dae70b0a0acbbf5728830c1cea2d358696e6f590185e682a1262e5052bc6233d3595deacfe4d00f302a53adbcf704e26c0f73ee2b766dbb1170ca07e1a8f3324eb42d8dcbbaa6ab480e439891583e50c370c2f146ac7f83c34acad5f2a8323d6121d41aec9fa0ee869ff88e82a0b6f82a73dc5421daad9091c8f57ac53b97d74cbb3beb5f8d7d4e13201ca3deefe8d62e95f3d2a662b310d26408a27fabba15d1950c3ed91151663073de15757f9e49d7fc54c88be48f74306aeceeeefea35871bed756b0b5bdb5f4861373abde5b2c0241112110c0effc96d7afe818b725a10c62426e4310b0f3b07fe773192224bb05f2daf09c3166b413981c97a6da08106a16f865dab6a7a96549bca28cada2ea3d54b9984dad3de4033f5fbd6021700f064539445976fcf0741e37cd1f06cdca1f26bd1b166784f7c5db4da3f52cfa1ce1cdcdd8fccd89b9f44183235fd28a34e693e4cdbae993196fe04a5a032275efa081af0115e3b388f5b8663151dae689c3d21b39d3d4aede945d9b82cd3453d7af95a845518fabede8cc2b9fdd0cde84a2672b9709fc352dccc6628093ea615d94430e5b093da6a17a92d2008cfd59e76cca47e0d5b1e6c73200a3d7352cc08e009080b42bba63f637a636c5ac33105875c9e290ab4f824b801ab679e7541cb20518d6932888cd5fe345d3db962a743d85fa61619984559dd99cd748e2bd327065b3707f2b582a51ff861cedaaca00baf88d7ce18208db36fbfc989da9809980dd32ad5a7aa2a00c3d8bde5979d6be69a49b99c87321725bbe151d2518689fa5eca5a3c29058fcbe7356786edc623a4fa93902f8204e02595fdfa8f54fe7edbcddbbac158b4b4581d2e3aa0c2da21afb748188dd3d6ae635934d757b1224d1748b18689491c3f61ae3ec0ef0242b7ba95e668b75333e27e839dbf61e76ca90e0b6545707bf2465a06b78486802373ea9051ab4ea9cfe75df7f754c29a70e4a5083dbb7697fc8a9f90d6950cf790cc44850f407398838e4bde0271b1301a7f3a4b85e0256e14f905186f5bc76a0a20529480ad9fb0916fabc859f9cd200a2e5db856a311ac0b4ced97a877c0d8bfa92696ca5e6e3b162674daa77385a78432387b5f8cd2f011b1e9496eaa3e58a8c89be722657154d20785b4ff01eef7ce8238b0f91bf778e9695ff9e18fe682368036d580b580c4fbeb60844a3fbb99363609adbc23a598b2cf59a1b16ef1aa494bc3b0a3d3ba6bb590ac80785329297870d356b537461239566f1a71e8d80c590563854afe23dd1d053bc29e90bc54ad5ccf12c6184f96af8cb1bee7baba4a814bc4d76095891632d77b84fe82fc95720c2e83db918401d6e92fbe54a230d7a43c7c82d661749a16ee4776d75abfd365669a4fc1c57c95fcb023754cf5bdb80cbddd2be6d955a0d73e0049abf3949188024cc160743f5340cfde5e2015096ff7c07cbf2c56754e436751a662a90af1dc37b7d4b98185d199ab9b38051da4607a88b7a8db7d7d4326d298eea9b14e56f27a29ebcc1b20b65a7c7f1b6f6816ea6d9489f2e198f32f19d26d2a27755e3e87843d1276f7bce60ac523cacf5f57ebd4a9601de8bca5152a034cdcec383fcd00775bb65834b997414c118b1f063bdffa9d6da2980a5c29f9cf3dbd55d3e1e0bbfcf21bae7823e06dff658227bd89210be4f0b70bcb6c500a53360dc38b0ff80ac4f3a19c12d41f59dd13b10dee07e4e6e7bf75cf18c99f8f2c494becc3e943ed2f308756c53aa15af8cd3e046eec264b5ca9c635fe185fef5dca6d581efbb415039ae4803e74d9a3d5f2f5f22bf25291dbb41baa4ad4bb33ad4013f09a1f8a9eed967b553a28f74d066e06b2a742a66c210884e837a4b25c56698c184811065e6a89b49d128c59ece0dbbe00f2be6a2cdb985411a6a7065c0d53d2d23d9fffe812280251bcf7123722a073950e26166cc0a26250958","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1f03d8071af3bb631b1dc2a99774a939"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
