<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-004</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-004</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-004">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"00935f5a7d7a445b4692602dc894d29e51b500b180bbb39e5cce2a247bac9aea84ce78502832457d81441aa8817645b99e0ef8624012cf93a88008639e231fb7fc279637fdf0fb352f29bbd53f83f1f883d6ad97a5e61ea82cffddea644b3509df269bfc97a8b2c1136195da707b66e34fbe30de3f01b3c236a4bf7d57d6a12dd664a8ac568fc82eb9c29aaeebc6e95f32f6baf93c61df21d0b5699963725179ba3dd0a2322ae56c9a49293288bd27ca18bfec7cc038995f6aa1d0b5b0d36c42d22d234255b0a930c640a9af80592013836607974883b726ab62c05e5f5325cad823ed77a3f4d1f489c1eb194773eda645c255c410817939191ee23f013f1d2449236a2a4080025ce6225c3b00aa744ab1ad44c516848e7221d6658901e908ceb9d56cc63a1a55b91b77fe4f94a68a69778f6f19466e7e50722eb36b9d1aa7ea932ea46d147e5f96af5c3fb67b2a9d5e2b777c6c0462665eb3ee0362f6300b9f6bbf22aded339ca4dec1ab64d8b29cf8d2683efa6d620a820d7f95d3864777f924c658bd9bae4eee11f8beae186e07465a2171636364842a985de134622115ef3ff115a1625398ed50ddc1e2f5abba2b767b66e99f94239fb5922e3bdd6e6427a730b40ee7d57476cbfeb2dcfdc73842a09f48c3ba608c773477fc165337841294d2d224bda90aed6e5bf13c1131d4290a9b42022773f2e4b61c8bc9f2a60ed7574e94bceeb6b6fbe26136d4b29b270b5cb3a2914af673eaf23b58a43a19b5f0ae189b270be9902a66b672fbacf44e7ee4f66e1d3fe15fc2fc9f8862699a1f3289463058ff505fec311bdbb00147da4a02e76fcbbec5372587ae8e717e69835fcac147a140d151ef0e8317b58031d36b31aaf40a00114392f47e2d6b1b2dcb70cf8ce11bba6fd53925567e563bfb11e283c843f86b1ceda368c1ed4b61fcc5a7aeaa26a809a50e8b8ad7ba1073f245d0e25c58f35d8b3cc2765e89370d823f3602b2f7aceca07a63cba3815f6008b05e19c993dbf8fe88a567533488e4d13146f4d21d8f42c79299889884f0089247d7a4021e6097b9893af0bffb4801d36e321d5ab39325503614dc4c67842ed3b81bf166b00875f0231c650a22e0ad95d418d0ff3fa9487d6515a1fc4d9b9e3f01a6aab68caf5e01ef2090450adc41223d06f246487f24fcd97843f1e391a90e4a7b723c048f8585167647c281f2e01728068c3dcc0e3683ad3a9ece209fe7d14147677ef6d50eb79e7d589703dc783d2a1d35dd784f388589278f128d6236b41704fba96725e2d606007defd2fe8b286206124544a4bf0fa6a1a92c40d85d58603cb7cf1c4a12242339a6790b4a55fbf97f98ba97cf3f0aebab4b17483e57df3a9ff9aa237aab93ebaa37becf6c55e738569701a723aea1a699b6fe346ea8b3ef173ea07beeceff86b824dc117eb2b4b89667c885c9f16b7985ab0f6db0d8335bf49f0b44dc8cf8d5aeb671d859e6a958902c907c29df12864d092570788fb3ca04119f65753365ed0c9f6e9c17b486cf020983db6014f93c4f471e0454fbe7b6afcf0fb24fec5ca1022a765f03c708808a4100ae34af094d08449577fab487491dc6fd9fdd3b5aaff648899b21f8229729f2547695d45e70d2df8936b43ff25c9e55eec91710afa85b258b0182a7478b7e8eee0390731e4cb19253e7e8cafdd6db3e3607f551130d4c3fad037a32c1399d6bea25b43176b1e9e738a09a4b55328d033c58d862b1f3434bad30354e7da9a297155555070db9d5017eb40b84e2c4ec9edf56bd9fc488f9b38deadca27921b593e285b7c4dcfb8b73702cb02f625035ffe7c20b9f22064c777fb8581989d1715ee289a9870a19ccc0ebf3f3e22f80625a91bbdc92ceac36ac66f8f1655343a5620e55dae3ed9ce888341e5bc11cd9483955b11314c0441f954ccca31403236bd03323a3961abdf51dd4cac587c465dcc68ad5cc365f72fdf817b5ccd68177ae33437fc75f757df47a7ce83bc1c3cc87a6a36797aa36e19a7fc8583501eb92c71475d820a937df203be992fcdfa1f1471b95acd53c57ca51433c139a01739769e0cf2ecff0038bf02c2765e357d4bdbfe279919b58d9eee098979fc240e3308eb6cc01d3eab9e819b213ed07ece04aa450ef0f21cfb140ac4b4d44412e9f48903c13f71917dbeb873770b936020e435b5832c31d2426a0fdaf80e86c978edae0e80a82d2f60b5d00b584707f7e16ae299af8ab4327075570a29630e7c97e7f5b93215c739b7f26363c7b3a562cb66c59896c2d03745cd2c4e269752dad6a8f845576787ff83877e66733e2817d2e404a2d16d6d430220d3fa72ffabf06b219675df7b9d0ad490f8b057b86fa2a446e29b821ad97a34519d555436143dabf77fca3d34d7d63c69d151571d6982ec3a954aeba25c86d30fad3e96369af16eec3aa71e66cfc16eb62f0aea95e13ebd568e9e953c213eadbfb18b929a66399872ce1ec42d952f10730889d38a2bbe2ecd3d53638a867da6a82bc769978892cd07a4827f4d10d429301362904b18b1fb96301642354e6f425410e7ceae3d03e748905fd8ace4ac27516ffd91c6e55c91a278dc216a111fb9d7e2f148886b63627f1beb65071e2756eeb52b36cd13d2b8304bc0b1ebcb2ce6b2413641b53de89e8c0bbc17478e955f466c42676f39ad6550d6ff5b588dcf370f3ae919b555596c2f6179172e2c6ddafe8077becefa4be7b221d7be69f1f746dfcdb94c0ca7c5aea7a7e3316ba78901c50523e4528030a937d3a96828d5bdfbcf731268abafd8bc25f2dfb9f23c8bddb9687ca77318704e209c71771c5fa45bf5291d7c9b7ac5bfed97a6cc3661503cddec2b317ab8a371d1443133fddfb2d3f9ed94224e1ca7df4dab3c60a525ac6a5c3a270e1d3be90e9d84276428c3bc31292ef8ae9c17b05be2c3d65996a2a6c07c624187910873ff4f81911f578224c8e3d17b1f9e34ed604153e6f62ac39f555b9df3aeff16b8c8803af323ba737fc18b8f9555b4d244e8c97b16fa1bec811f87b0d8a295d6e3aba7cc1ab8fc2a29cbf78cd8854d27510383097467c884e138b68b19812aabfb6078ea38da4b5cd753722fdd3edc9b1c08a693253099d3662c5311b945d7205d11c075723c4a407414f3c2e81e516dc5ecb83d95578530a05138a3462bf637f25989368bfe8b35b9767a8f720c14b40c9edc10db6e2e276b363a8aee9d711838d62d4b9b9a85f403b77c28a0ab833986984c9cf9f8e24f56579763ad2177eacdebe19842bf55da24234f6d972e1b1e015ad2499b449603baffe77298157f78796281e5871799dcb702d438c8156cde29810b900eecd6df80e1ff6a0513400a7b48117c185c39dee31839d781325a5c92137f5e81c58309d006d3a38fbca7f9df7db7e8442fdba55f7345d377e149fd68edf6f36cbfbf8c97b7390fb206d98f0f38b9725ac53ed05b1c59e80f7ffc0b7bfc947c80f3b9e0044bedb5952a995012f694b789ca28151e42fddaf66e1289a765632e357791680b30158ecb5174010062b654963257cb1d0d7cf04e4869ed6806401cfe95bd54a5eb5c452af2b58018bd5e84386680d255809f8dde12d1ede703fc4cc8ba90d8f7101214c43f34805a41da03d0d50ecc464dedfc7e9b2a6afd35c0ab42f75b90ff8c99c7f2545a2be61907c32531edd4f0d0d47d991e31a648e12276044368d15577516674210c934ab0846c4544fa13f2ef1579f7e44030c33664256d757f35487974ef8e7db6ce6e139c6e91207b072b7b4251be74c32991ed1e8966d86b14c654728c1e67c71b8fbbbac15454a73f0c6d24465a86d41a8f900595553e0957b0d5866878546ad1e2b9c90ab240c3aa0902ecff50f182587918ffd10b5e031e2b130148d2d4b8461f0bc8fefbf1965aa78288d868f15fe1c058052b696b37104bfaa7000796d43425e2e9aa2fdefbcdc10f580ad6d14b6c045688ca6171f1ab9680be0f17fe3c0ef50b902ae749cafa9904a8de55a8d164282fd3253408506e60ce27840a8cd52f8bf1132f74d1cc56ef2afcc7093ae018cea8904fe8e6c67eedf9265c65d30a2c95c4dbcf6d4bec06762e33c4fccb58161114a1cddb1948347086b968f660978d346947f6ae170e6fa1b51a6528b12549efe3a2a66078a62976f18aeee0c68344ebde365539e8797000ed07da7f818d55744237b4d5bdd7063e356a14a201574231d7681c9ed9788d52bb781b8f38a8c2fb5f185e871dd6a9c46a31727d0179b0d54f41bf415979b86a3bf11b6cf8dba68b445edb0e8b8e60cff3d11f60142fbf71baf17adccc5defa329eefef0c40156cd5843c7c4cd9620ab083e4fda427ee608fea527816409c7ca0700c65b8a79faf8f3dfd9347f48e32df8f6763e2f24ceb8e67f57e3a4f9e2649fd06b11cedc790334124da5136d2214415863d1f00d9b70ade3fdc8df54dbaa8a9f1782798cd23bc1559f0642f4cca3243d7c8e1c96d7ac6f53fbea8587273fd17300e255ac03b58ea5392c5b09d9fc91ad552507b01a7c838965bf81b028077a62d35f2ba76f9625a163b64f9f1ca368a193b8ef90cf00b5cc11a3ecd86ee36b9f24634b4f5ec82d5aeb04d828c207d01a2a8bfcaa8aee5c558115d883ffd96698d707ad3c36be09004cbd1a63f024dbc05dc6404d61fd951fb98cf53cb1658444baeaf02559d2792f13383d4b54f8a959ce36f14464a1457f509d23491a577848ac0e4d5e565126701f1a11ddf8644dc2474c8a4d8068510c9f0608c55c70cb3fe03f97b3acb476f326a2d45b85515182340aa68f3da539870a11b61a828d98360d47747e6f16a585f6abf972a4d93a70f5900c3454e92bebaf24c708feaffb404a82999d20f1778869aa558d40b8d9fc0ddb7ad685e757a1b0139a684436dcf8ac45591ea00f1485ef909c0c027a7f8a511e167e8ecb49a34ad3073d92546bf5fd02d4bc81424b52ddce96c3338f098cd981100e9fbe131656efdcef35d5f3156afd07b86329d780ad5adf008aacae06ade7f65446a07b701c8c2d8d00df8016d23a9700ce7dd53247d529f0af4b0c4f337bf60ae62a7c59aa3440498950b42bda7e79df667bffdd5556c5da52effca7a00968f62581ccea17b7fe5ad93fb0caa86b0e7fbe397c1501d0f16fac7d01e36f73ece702f584d529aafa12332dc2a364ef150fcf64a9d1c09f21a27f8643e41928154fc3278d38b3e5ec39875b40505d77b441b0b601755f6e409c1108a4cba84383abf0aeba80dc844e9ccba8b2e649ebd153d3d75d6730284126f4feeb3e5fbb5220517ac3c72deb9a6a95c957872255ad1094bbac923467004822423053b47093d4112d81eca09426e3b8dd18e8608325a946fccac38543e65f18a054e9aa919e0940ffbd0daefe9a9fecf20f133ae39b4192414497ceb2308c88c5de89500a6cec3c9eb9c377454f08fd611789500adcbd2a3fee6e42b6c0c9a73a136772f6562366f9366f91f6ae96fb9c917fe6f58fdabce454834b9b6944968f217aa5c1fded721c090fec86a0925ad8b955aa877f6ab95b4aee13d01a775ef28727c3195c510c764eedbb395e60c1cd04a445882962e69cdcfa7bb4743929ac81e00816067851c14f4fe57ce127a3b796dfbf50503f02609713e389d5794d96d9cc435031f001f5127cd68a1c8aa429027a5331466471c7fec18dcaacfe529d96e6669f75c436939c39e1dd9b32a1a932c7875a5f24e1fda6ee57165a0bc8772bf5029586ee46caa71a429af3afa88b91d4326d1050d87be15c7a1fbebc7cdb47974e8bc9e7435e65011eb533d6aee34eaca69ae8b1dc34b43ee5e630fbfa699d9db7775bda9e95bb1389ee19b74415ee272767108357398f5803dd7d6a2eec59530051a5a66aaff3100a450f37bc00ec98a8febb1ff6f89616a792a6e7c10ec0cfa703b3d9ec280c561eee159052d3d9a69329b622039523dde5c0e7a0572ff28516aac0a35cda2afcb3bb2d37de30dea18576bda29763deba6d8516d6b97397da2bca39b94594a62ecb8be8611ab0a42cd8e5e0bce63b50d0cca0cd00cce01395baaa23b3613d9f43d57b95f1f7375948112e76268bf335c07bae71c364cd63a1d37578d53ab03ae4a1388291c5146180aa9fb7e8334660ef32b10565459706467cefc654779b4e6ea6f8df2148417e59fb5bc9a94aa208d2193eebe3610006bfff60d90d8f900ed7f4df5d85f1f55a4217489095286b5421f15776a0319811dffc9d9ba45277a2d47d2b37d26d137965f2947830ae975a3037aab2d7baaa516edc82cd5e77b9947d67a8020c608fab042c9b772fad5fdb726ec73d4d6554834acc6c3f59237cede63b1311d6d8fda72b029c93b9c1e4324e324c7ad721450df970c19f9d43d90f244e2bb956ef2714ba39853441b2c98fb7830f6c4a59d82da2854b0701140837730d8c53db5abb88c02b5fb29e94e6b05d02814f7165a0e175ae9f2aef57891d00fa654905cc3cbd153bc8a477dd30d4595dcc6807e91ed1e1da26dd80c527fd6b5d03b37cf550b8e52fc3a879a3e9d768b93afc863c81c3fdd24fa8240ba6116f3a92971a09ab005b0ff9ce1b780e32ec0bcfa4dd795ffd4dd4d8ae513c45ba84a0ceb83003fac939ecc3a6672451cbb46c67de23ac6ebebb5b9543910cbeb2ec92e2b4eb9d09d001d1ccc9028233dbda6c85abf3d7296911aa23061ae1782a678cfc18f4cf1304ca0a97455a594da5c9cf43ad9432a3151aa5bf4e376a685af5c77e0d6a1fbce4fbef7d04e3b31f0811c2fd6c343ccb502cf156f639f3138a43338eb2ebe98cb31f656580389e17fc661e331a033a97f62afadba39908d6b8408539fc2bb9c62449cb66ee3ddfb6a85e7b34915b6392ac467c007b1b779fdb396d3eb20597c81b51d2d0e322117ce33f4376245b871d0c887685d75503585bf7cb41aa78a10ea097feb4db5e1cde57be94c8a3ea88f877a39aa373573845eff42ca23f9a45f4229937368cbd41c81bbd461c406a03799bf17e1a05c60ca90327bc5f174945bb7f07f7737f7e1a5b490c3fc3547758c1ece031997b875677af38e62d771930c8f579834866d3d67e5f95e1ad7d113959dce1434fcaa4a6bb22d1ceef0fc23ca251201dac0f50588655986a6eca3956e17bb0f4b44cb2c948301eca241f4937f36cc72ce3cccdc3d99487554ead95ebc8922dfcb80de8901276093f0d239bb027784d9ae7a91a5f167c508685fdc1e4144432bda211b00c53e9a9febbce7a6481212f094224f2abb6587549e16fae065d445c51246524646a87079d86d758c7ba392a474b9fcce756f6846ffccb7fde30f54534bc7411791707e11f42c35f5d8f6da28bfe1b7084b441992034efed2097647dcf023c5dd6c7049744ed047ddc526da11d758de1805869ae006745b9085a19c30ba2af77ce039eb7715fd9e564ff5aadfc4bca63a6e69ed4aa35e2c422869160004a64c64aacf39b7f4c41f7b734cb990d78dc8f16ebaff307bad16a0d0aaf2ede842b17aa0dfb4a90f3f593648d5845df4c18b4463e32386423e5349997dc6055c8e21135951c39d5833d1a5764f9eb4c49e74e046f19cd1f8a3d63405824493bed856e78b0ecfd062960d9341ace104919887daa8865e2a61a0c2ee88ad4e5d177adcc39c229d1f0313792b40199a36a9f6f4e9e1f28ffd05928f7edbee2672e48766e408cfcb19f77a53a8b3e5eb8724e2c827a6be751a03c0207f310db017b787c0f665c6399f3e644130a9b68300c1cf31e6a543051d15d0d05c8b6f0939b01d2b01dde747893efca0bd94272112477631ad8c3ca4cd150cbaa60b4b7a895cabc2ce3dd55539cc265f89c2aa53d22bc8922577a52484f71b1bab3b81e07a897075b0c52ecec04d3baa40e5b51bb1fd9e0090f1596d40e23da9ac3d23cd88173617f6eec0369e3154b7d9155e0db868b715948ba99a2efa4fb37646a88ea30f4f993e548cbcaafec52885ad67a6497476372214be5f550f8df93ae4ec0dea9d4c0ddb6cab734d31e61f8e8ef92e562e06c3d2a905621ec3590856c1fd874ad5c9d81f45994ade27acb8edde2e40c69ef26ee921f5edf28a35abf5fd499b3c32cca9dfe5a50200b9664c3b369c3088438b76a5836877ad7830d75396dadfcde93dffb9b89da26e9fe02360492c67310d643ed68b7c55543fc9604a9e36ee562103be6ec23f8d8e6e7cadff5125eef52164000c06b1df278cb1f4509555491cee6be29f61b741f0e31db33870f77e913ad12bd1a1f805c7aa0e105d23220292abc89e72f18d3eecd6213f4c1eb01455e874af6745493a7150d51c20714cf28545a148e871c1a413fccd1c6ab0444a90504174d4f627fe9f19aa8a5b1efa4554060434bd4c7455506966bd8b92c7922e1db7ab0f0ad15d8c390ef8de52a26f4cd53c9a0d8a42ad94311ad0ce66c2e04173ef3b02788a41e4d59e0e2da4635d8a4bd5f4a57015ab8676fff2b60e2ad314829df72ca60f4b21d2f455fc0d48223c998e51ea3e691c39edd25a389fc7a4362c378f94a0e7aaeda1d0e87d7500ced8127e54ff9e195c5dc4ffee18d492ac442990f73c27096422600ed286aa82c259ff94650c20b7a198de6178b2457f3f8f05a4be53c9a6459b167c06eed56f45afe03acf595100a8b779cf0dc4eaad896cd84753c06557b89ef572c07ecb1ab9cbcdb496100d001fa3703fcc49c249a88951f59df1308e8e01b12311f5d3afd5b05fff09833f7bf03eb181e4cda367a40ff775c29fc0da957e58050dfd5eabc83926049e0f01a4023c0f42946cd72088023d5221112692eb124ec6bbe7c3a165eae9ee7bd563caef1a2b1bcd25962aaf8b2776b42ed0597854c05c91dd33222fb02152ea9cd0a33a437d685ff6399924bebb3f333a6547287dbb6f5cdbe1a0417a9aaa21588350f6ab0e3acda3ff7dcff386b593d136dcc9f206addc6cc3d42ec1206cf1aa4e1de7d067890570db883e2cc4d6d7c67503e5bdd36e81c88b44f2ef105ce55f5f29014e2221748fc2302deef796917420f135091fc324f8fdb4e614d84fb06493e61e7cbeaa238e82a7bea6e762770ae0adbd406914c182180d28fb2f118c4bf89021e6dc444113d68d6ef77d7761a8ccdde596f35a4e3e0afba2609babfb3b21b26e98b4f05d23ece88a2f0c36a8f65de3e9f6aef8a016ff6bf68cdc38fda02a7689f7e5f280f7b9a1d2991aa1855d4b4b3b8afefdda97c0143d84de643431e03ffb4f5aa4981a4eafbae494d3b8a7acdf698d4dc28abb19f711f63460e188ee29c75d19972d654570adfec16685d0b0446472920bc7c52995cd13790f08aa39179e1ca5cf07277ffbd46fb3dc78dfd18c80d3acb8b3e4b3e53f25f3fafe683fb4b51e9f91d3d22fefd5c7468814f0de4f80c1c374813890d37b8ef28522b4a986908c1c26bd2f0a85987941f36faf00a205e1a4bf6ebd09620a42278be5865f7c554b65b6a5af100b5ce286c70a5d0ba2741aa82a9eea5a61c09516e03044c3a1bf26ca6d30e673420368b46ff339514e5bf4785bcffa124f360b6ffa1a4ee1623c1c8f0a797b6c01da7cf84f7123400979b345bb3887f6ceb29c9e65b4b7ac01924750493bf1c695341d30f961532764b155e46592f564d8c9d7207774ed31ea846d4fb2cfc28c257fc398089fd299512ef1c6faff68c454e085ddaa17ea91da3b1ca7300d79f100d23a75581d5629dff39763f64116d5f707527a81d68ef8d47cd9633fb47f286a4025e763fe36d5b093adc9d6641c168b86e996bae4dabdca40dae03c8905608a5e6d14fb28e2468dfee2676f8b3241cd4ed137366c10e6cc160d6d10752477828bb0bd2d3cc61473aef486ca2252716dcf09f047acda192eb66ad9a91b95f678d4bd295531c545b1c672acc8305ff0188bd458589f8989963bdf7dd899b370453a712c04fc0327aed7d6383e1dfb2cb2e50b36c53cda97d576d0441f00996fe419f0739765ac1cce163f3c12d81e0fffdd2a00e8b9414690b1acd20c36e050ad0d18795a4de6a83eb10f1f2e3534910f1295f225abdfcdd735c8b7247cc6d808735141799aa0a316d157f33e34be645d33aebad3c6ee38d8e7156517e98201038849bbb1d52eb57693ed5219624564c2441d585375e3b5e753236e7cd49ea76e2cc2c2f333a1fc57e5516e9ba377d6a8f3349218daeafdfc0c30a50e5ecbce2ccdd9d4ee2ff7c959f4ee7a71221471d45e54e163a5a98e7064d77a80c303a21c6ed8f5c66535d7dd10a2a6b0d7acccd092ad05d88bee4479b558fd5de953d2256e4dfeb6d57b76a743396f32806ab53ed0cf7fd4d5c306814105cc23f15e89f8794a95cc774284ab1abfa66ec713b880a7668b0eb9192d712d5a51c5e6e6ae4f4592399166292341baca0c23e4259f52ec4667881aa0b3bc04eb99aad2142bb012ce1d6d3fb17341595d13d999f19824f3dbd485ff3bf3de2d903ddad2e0996d195c331e37ba0937b3fbfc60d2ffa9be4d3d5d7b606f431ac1fe1b01b27078be6b233bef1871abe3c6ca066fcef7dfbb9d8bfe49becc46fee22d8ac93e8332254a710c41edf134641050cbe67a81fef0c8a7b57393b4790e69a5fe3d7b1fce596432bd078929a9bb8a6a380493cf25d920b6fa8b0285dde79c49d4caeb2219b168a8089dab110eb5ed1ed7b5eb05c661d14c5cf5e8f38d8f3d35a4c5f1022d96a7fd5d9e4b9d1ad9d258b0752156b8c1a29e9c6c6e400418e37eb021d90da20e3c29c2c80d3993de66be359adc8608933d53a59962f226c6ed4745670b3f12520916f1ba6899233bef834bd204d44c9a3bc7666564a86e09a389adce0ed19b90d49b856e2b26431459347afe6d2064ce5d57532565dcfd958fcb63883bc308378abcac64be6570459c49532c47a93a349bed1a0538772dabef5bd5657c67015e0dfd1e5500bf1d366f2a2ffb58f3082751f9504123ba240d1a4d07a60124fb204c8bab6430e15826619c86cb9c4a1f38cb9ae55cb78e0d2a38b758dcb3e73ed293051fd5baa11bc8aa90db5518dc105b8a7319863524d013b0a983622b15f9192bb7c48e761b24c257b014941fde4bac93f3edf9740b0adefaddcc6fa47d2ec9a8f75e926d38eb22ae10f5c0ed5200350a80ac1c031f578efec3a4770a4ca784ce8b0d5543889b8448665e0738ee62309558e964222a78d6b53246b234a5108ce9cc858080c22c978743841e5c1568abfa73604db26ac2b32e2a93dda59ed98104370d2445e362e5fc86b9dc32b7c27d3cf4383bf10593c30ffd900400cb907271dccdcaef2dd0e20e1e8d3c0f156bd0ca68d47e8a84ca9915f7a54938754f10a366d069ecd2d4d097dff391ee52c1f1ec8d28aad7da0c13afd1b58f59d9f4e502af39951f8d8035de5d2d4b379921f0fa531c4bba95eebe5f5bd7cca986004359f0de62394c96c9ec29e42a97e7983434c7b0b07cf987f12623ff9071adb847d04fffaf362f74085c41fc864f259798c77caf96d6d1b3098341f8f61220764ef90ed30af78c08a2ce4032f39352dd08c62b37d2b1ef00ced695a2b422453ea29fb76aa04af0c254519627eeda97c91f66483b8b4b89c1796b90d51a9620dba80f885bc7a7ce653fe578c37f4ffdf2854857f2254b68b00539abf79b2e09e3429436cca321dac86b8957f56e1e0071fc1e072254457fbc24a2438b48cd81981a9348d2283506be5350f1f5c12f85da9f85a5c7445cbd2c494de24da1f80c1eaa260025f1d2722bfdd803a8553aea4dce8333781047a83d97cebc4a98a46d6c287cbe93e7c5f1619201a75918e0619c6af84cb66ff5d539de35a82f95fde22075d0673dd9c89083a5581bf138fda47ffb6d87cfca8aa15939ddb9a891892d4fb0e90b5ad4bd3c56ce8e5bac4e50acfc247bdc8de45065767c091c0e43d5f8e0fb834b4cf45498a131f6dc7ab9a5c441efd15cc32ac4c8ec194ffedf520797cfc76719f34c113703a03c6aa3ecbbfa293122eee3442e12285d0e98ef2334e24071327d76bed130624bdad6accf5c64cb28fde853fc9c4d14950df13d8566d6af497df085d39d5d69960bdc3c96af6a9e9f58be7437f0753dab8ef397988882f2966999745fca4d59d1cd4d9b4e01dbc8e2947a5ea0b97de672a538914abb8e881c00d278ced6f14dc70f7c869072a10b03811977accae6c50e088762063e016b5edc59bfa763c01fe86c0a77e99a55a6b8edcbe245ddb7b742afc521cfd9e9990e491afb50fe9616932452dbf89b6ae7c8526279af0c5500766b46ce6aca78f99f594e91c619577251a4f2ff8de11f927ac4f9d539e2aeaba90a7e220fddee30c8e918385fb810d07c6ddd2f1cd19eae253c32b427a0ff29a12cce0a9753800e61a6812dc09618a795985a0ed1021c5eb159d9a7dc90bc365e4ed7de035b958c7ecc13a40b06484084d42b0e554e24c15bb6c4388d91a8deaac9f84c3149e468974412426cf7ad1122b45c2f06b40942cc1b2aef185b9a10ae7b881ee4c0ad79d61c5da83cf3b115010aa79a31776d7c4623696896129e3fd9f8f178d498393d6104ab82d7a2f1d3aa9b1ff7cf4c4a54febce63c3d81bb3d57d1cd03398bf4e4bc12977f57f98bb13c58f853a97b47191b6cabbc345a4fcedbf50aedff082a326240739e7ad9d0241532c13bd29a8ececed02bee9f1772a92f04b8c04546c266ef425cd2709ce1e391ca02ff995f21d10cc202740654432bcea7cf1ceea2f63520fca9de8899b0694ed6841066408e1958d226c142c83e9513dcff5aa14800835af55f4355eddd105e8689af04656a1f3cb11d7bae51c472c581ee4cde29f44256292144df748e46f8282388206e8ce080570203a7825ed916fa539c028f611179f21b56b4db47fc96d964f88d2e2a041d6edddc6f0b40ac0f92822305c98713aeb254a3f5b8a7ed222f402aa1ee021db5974261b270e655c350b5f1d1a8f660bed7a864af09c6e4ec0ee9f090e0b9ef4c7990b6c1967955fa7f08937e99fa455f580a54737ca5cc0d4143657747d4af2298a954b995703808e77183d84bedc98cddd8a522e2c5a0669a541f206747d7b8e0ad9b6ddd65d399d01cad3e306136d3d591b684c1aac812482fd87c36873eea2f6037c01d333c9c35aa866ca404e71065ca5f4af77b6e3c593320df88998a200860d7c751586d50907837d5f6b237a69eb26a0c84c2ead6e50d9425847dc49a3975a195f480f52b9468504649f16b6a9c1932b7ab1f83fb94cebd836a85d9fe90aa8c4bc4f3b43c6879bd9c42e7c841d2689cfd6d6e08250430a55b69d51fc2b56abad9aa59d7c0b508ea47966d4fae1defbec4392b300977cf22514f04ecfc362b4952976c797087690cd58dc67c57fb8d2e9dfff01419c25f452253dd8b33bdea12a6537d8b5df95cd7e35e2fc29462dd7ff39e500e28f3123e614835395175dbf6ba730ed4e5287bc0ceff6d05696e74630f7b62787ddff2c5e94ddc52ef64144f4656a2f777af0cbc974194bcb867afcf6ba062c80b0b6e32e4ae50f2dd732366f80dd26204f3153f65b09326966100c8a55c521c59b2eafb24de93b463c7c8b98d6d044dd50a628700311c96b1b3694e60e178fbb2942e3c71d24c50f5694f0f4c49adbab4783085171ba6a4d6128a1223ac18c226d91bc7aba8b9e0e16e62e03c1f4c9389c21cfed0a49f84b58de6c551d5b80964019b6022107ccec58d6c32968631a863dd94b8ee5e32b71f9e03498a96677584cb31de9edee88be9fad4b0055f1579e97f3efb93b7e5667311f8067a3dff2ea0c0f2caf724b802f9e4fcd25a854ba2ba8e00c77489774e3578ad375acaf10f7d7417f67174f877c2899a7cfb6651cf2e60d6ecc7278f0cc29d359c54dac790fd6e1e23d5dac1aafa9776858a64358d080ef8268326baef0820476f7c3918b271577c478ec632103e9a574abcb26f2655b95a4da1fc212f2a9fabf35a8cac40ed31e2ba3e45a45245ada5b92c0351eb857b28c2d0259c51385e4b985ef2caf551f8ab03e6451d9db21eb2b14b0c9b334d3ac38a24b3ade1379c18187f3eb333d544aafbd64ab06729c84135b0a43b182b2a30f454e00da076eef037d647cf8db24bd45759b90d07d99fb11ffb842a0e3e1cfc11bf33fa014d08ee2a4bc748a15024e753e24142c88a4b5b89c7bb9efa45621955aace73956696cc309bc9b68d007e4569ff45552e7ee9f2656a21fae94554f040d8b0faf4592bf810635067be6c9d3496682dd3963bcecc88f76879503e06df19955df26e565ffb80f0b47e18d0562eddb3eeb88f80b76d2ee1cab50921654dd542f14ae9a81fc9c9c96e096765caaaeace5a94b61e59ab78d8692cf9adfd238abad12ee0435250652ece8a73a7e6097a50e63617d823dd7e67e37a0da81920d78f7461e3904303c9bf609cff32979b192b74a8cdfe1f57cd275235a203108e64b60ac9d6cfe31ed0b4cb905a968d2894b53a6fedcc30054d02b35a1b41127517789a084922c18cd0c49d1f2b91fb96ad0bd78ee4790859d390e75ccc4a27aa9e4098fc43119437d5d1e3c610fafbc48e02c7b863a3bb6bff9d58c561fa7fffc3ae491e63ba1ae095d5bb434123e56b2f39ee0bbeef1bf8ae446e89569bfe1227ad9e677bb8445c2bc243857548f6631afcdf647a12e597c42dd43bec6baca5af4d9535db3c1e275776ef9612eb1e5392cbc742cf55367e4cb0b3079b6e026a3d09846d0d713efa562c7368ab2018a412a5cdee6f9c78fc66586d2774eacf7cda5746c752c86a53932423cfecbd265677ae215a556950d2ecb87082ab9e6bb4474bfe916a609da5a2c82ca128bfa165fc891662098b5a1344426ddc77b4e6966fcfe85dbb34ebfebf0843fb5dbf421cd34e63c6085b908c6f11d8722ae3dea656ecef603a64e215a85da66f885fbabce4f8aecff2aaaa68d05f97c784cc77860343a685cee2e2553264c55e9277df6e70f04b8abeccc63d0f83515e1de6968a7197aa85b0c94acad77c8761ec417839415e0357f31227e88e0e2b421bea5705f028481445e0466aaca479d6f0b2dbf815549e6bd06b66456208ef027389aca9a15867e14cb3a28fa5293d4dc195450ba1af01782a45902df3b0f983423fd9ab3706d05d15be9b52018fbe691965bb6a00314f2c30a8b9e569b942be5545813d449949c17d55c60d034d88b6c5e31178836d1c86f0c05c2a7b026006329a0d19606b995e3608ad82c6b84860395b27e6f87c9e6fd6442c6e722baa356312bd7aa8f047d4eebee1afaf9aed827345ac50b9b8f9b3bc2c32f05fa6b59623184585c80f49e26b9711072c0b198b24e41190f24fe9f49757aaaa7c5576f997b0cad546a069d0f175c28e7e15a9856fd481f490451d2792c10c787231d9d08be0104d1b363df465b3b3cac057fcc07728081dfd91b52740250ca5e25bfc9450eb2cd773337c3c8918f9372bb806d8bc1fdb370e440950a51f6f9ec855c8b3eabb9549e5461d92edc61d578ed28f9249bea93401d6e326b82376fe7eda52a6c209e7c656a2ea4d8bda5a4a3b268b438a689abac9b69903fe7ac7a72a0135157fcb515c6405f570515f383e29e42bcb7c53db50c22f1b63278846c80851e331ac5c71d970b42bf42900389280a54d1c8685f8289b3df9fdb3b69abaef64830e9eaa31151f3de5e2f0ee24f2719336d6247876bfecbf8e4baac6e7f219428167919568617aeb46462c5c79e3ccb4249d0264b143d9ca164cea1534e43c8a4b97447dec68168a59237631f46dcd738990e7a472dc3b01ab2a1085cad4f09583ece0737069ee76d6c04ece52bae81bd43a2277db026ebc4a8e38562d018f59f57b4f947e2f559a275204a2984b11f373121aa9a0b1954d23353860f38b4bd57674f1cedc561240f58b4d58d0eb36b5fb7636ba651edd87b11455c94295b0cc63f714f40f31e3044be1747d7457412cc54ef4ed349e57e15915e1692d73e38e9db46d2bac5a8505c75b0289b52e759ca1d40246252f9bfc9d29a21bd9d95b0fd16ebcf4074fac03bfa627f12670d90c605ab7c1af7034458053001c33f356cb12916f6bdec6319208db39514261d35b612001f5e3588f24e759658cbaa079d4833aec3824aa0e3aa70f342e0c5c67fe3e9d8212d6edc44f917558b982e33e73ff5c57ef31de6a41a4389f3402deccc504974e5310d80d1e0a4505821b7afff630e2da518cc75f9f3f5eb5cbeca4df18a2d362f4a4f437e19e230e7ea0e6cef0d25f752ad0f6d80e692d6cf15553117dcb6344bffd4284fe5b58b214775a03ab62706bde32885288bcad6e291c24bfca5669ad0bf683dc4a8c8dd9b72a410e68e4bb9510a67052781eecbecfbe391c20ab25e722fcc631fb36ce03fd78e045a946e4d4cc6434b6e2380948cd500e6891b4d5888915bbf4854fbf68f98fe6958883684cbab7e0eb8b547b5a1c94a52dc0682a0b7ceeb765c0d005c80ce4e2ed8dbc9bb6196b5771c103b9dfd23dfa5a3ee5f4b3494c817d6971b96d6ec3b57e22b942802f64e8aea469e4301fca02834d2de10764f512e2ef90344afdaf12678be11f008ab22b354c4c632926d92abcdee3643af06ae1f9fbe8ce216aa8ae5831068a3d1330f8fe0725fb747b620e04d8b4a92d0e7476eca1e95b934263abd87ee949fcec63c6847dbf3a1ceb25ccfd6f67d61a71d6798cbe9929e784b2954450fa8b4fbddacd0422519441962284d058db3b2ff531fa643ca069875a13e5907a2abec43f40cc1a7a288d73c4411a0abd74435fffcd4f64608e242a5fab5698d0820217613481304c3989583f86916e0170137107fc525315e2205de39aa1865fa8dc8d19afd2a0126d3ce72f50d3539406f80164c8f4d2090c7fd290c016026187e379b6757f366e85a662171fba59dc23d209030d3b0373812d226b60553a964770eb3f40a89353e7f1075ed8f7e2ada93f2ba4ce8427c5159d539dab731a9b8bd2d9eb270e520ca942dd8bfa098500a1f5d831399a2a33138a4c6d6aa744e6ddfbf2f31b15f0d82bc877cd3cdbf4d52c72ae3fd66a6e7b95426f279f08686fbd63ee3e440c3faa0305bb4a6ddc364314b2a6dc0c0cc0c71caa803967427dd0fc42d22c4c71f8ead5ecc715f75149232f63a1fa4621ce60c11cef0931be68c304423d2fa5991da61e2e1fccb766a306a38aeb9a5dd58a012a99d09d7cde0bce1ca098e06e2f222af0093c40b08b41388b306800b40cc5fa8ef4a95cc4edc7271ce8d40092de5d1b4c6bf97e32093902d3283bc88be05f11bb6e4239074c4b906416b36cfb2ba21cf93e64afa0c064f4d80cedaca554f5922fb7cf4add38b55cd5bc9c65d637279f2b7e35f19ca153b9d79f4c6c4bd9511d2450dc50701b9f4d29d16af088dccc7604f3eef1bfc48c7c835dae8d613bdd97e86696ccd276c9a0045ae73029b7d887c6ac766b9f3f652ec437bf3d0ae5d208d1522c29dfa64fa2e42596302d4c9cf98a57ff748d99f608d09c255d82dbcbec4b4547c34aec85d71da84bc6bf04aa11dc965d469e76698fddd91fc55227075ff9140e04183f59ab8198c909546c15930187c9f4ecbe2e19777e89bbcf5e6b8de8b3c6a23d301760360a6fcbe9c25a84031bdf7170e901bef0a62cbbfc7d8e442c4fc0347f5fb14d8facbe138c3f0831c101a57e45155ab2b4396c2b916bdc590a626a8b9c56599ec882979b034a98a3b1c1bc7c16dc4efcce54d435cb5b0af105faf34e745d058ca84e0fdca53f88a071f9477c822539c7119b32ce5b63b6460450527745c5ac6ad2fb748fb9540a2dce486a607fa5e2e2ecc371372703bcc503a7f27bc9a1e36690fafb23ddbe354a02e3a486c3823573893a28e40359448f2cc21d92490b8f1741feb1854621b9d3ae59f85cd16c64d9baf108386d9868360f946285b14a4e4080ae2e2636c26b4feb7311fb199a7319336fe10d3e72d1fde6b999c808eaaeaf6cb7bdc2bd95e187f39d2dc29d6110095c0fe53481cbbf830d6af77d485827690b848ede33749dd8684d755ad45c84949d7ad0e3d9f6cc7706cb43fbf878e4f2859961eff0e076497628ec92a47d457eec1c0dbf848b1a0f73c94f20e78ee8bb3a4b7ea6fe13ac574d5890f43f28940311e5012944f57ced26fa180f12711fb8435ab174a8f96effc99eeaabaecdde8e88b105cfa46ae3d6c61b4dc09e39f26c5d13cf866c0470ef92e644f026a37a8e1a3650c75105f11ab8627c4eebb0c7ef6fbd32fc0b8f456f74f37b0547df68e3792af2f184279f864770dec70eee5b910064c9843ca53aa2ae9ed7e9de6eb1358462527e0d4e693fe8841e8951cf6ff2eb65ac9754439c380db517f9e50551e495b4a2933489384d1641db2d602ee8699a3ef43193df55aeb5ffc3a121af641a65afe440524ebee6a053890655371cdc9ea8b00ff55d3b8216bc1ebadf1f1e5200ba38476f560248c1f16815be68447f3a95e3d9f198193dcda5582d7c6d1850751da4127a658594857ba059a946a5fbb2015cf35ea9bd93378d7266b680a519076c23bb6f06572ccd2989616f3e8b851bac7c5563cd3838e9d9a25d300982a445e566fdc54abe7c1ae2cbb155e25938958d8666f36fc2d6617079384fa955c0f9936b381a1359f3e85d1295d8769cbfcdd33e0ee7a53bcbe7fcc27a8a94362448b14a1743cbbd6a7d85e5df9a3c1bfdcc605f8c3c48a00107f2f1d49dbd1163bab6e1c2f23c3b205f0e5772690631b2076a9fbf0e50e45a888814f9d81cd87064432aaf2eb2d2e1ed1c6abae127ff9628e24ab9633e872db86675b87c18660e90b263f70efcf56531e198212ac5403095e1f794e98285ebe2b8129f87c2723a9f2c036c7d3fe27636587c3eeeb0073341883980b143141360c8757b2a795bd05a29124849c871fb46787278cef2afa8d868797c4eef6edac501c5ebee612e869c2a722880d6dd5d0e6315b6487908c5439a3a30939ce083fc3539ef4978a2089bcb30f2710167d43c1531f11e5ea953085cff90e4e1a151a99f49506384e82a94f090b8a0bf7abb1cd1288b59029701924d9b8f33df909a8ac04c314f05d986d8b592a4c6627804a6b250d0e1a54d6d73422979fb0be8cadd68cd1e60b2bc5359a61fcc4b3fb5ca13f934d6017c589b52d1a51ccfe2a0b99b06c2fe28376ed44c881244b1bf3a3a3b4bda0f71de9efb5ddd344ccb6b1f6c2ef28222f6eb551b8186e747029926050673949f389a4cb07493f585131a5c1bb6bd5c54de0a26e9038008515c6bec2cf82663def34617f1d7896db43db5bb45349e89bc6f030afc0d7d9b0fdc92dd11ee0335e2898f872edf0c81d71c06933207a95e847a5ccdd8522a6f56dd553473c8241b3ba4c486c853aa55dac17390c12934d0dfbe25b080bb9fd6f42fdbcd8c57161b8af778a2d3beea0f2e90defdb773ba0cac2644fa4c88f95d7d13456947234135797f2020d6b95c5f433e5767619d12a3b21c3807d5a822e176bb06e1e5624a5e3ca9c77ee9724e7d14b0b7fe3ebbdb6e5d9d7cc611872d95346733c587dced8b37901a4dfab80a3c69efe3f0fc4d8dfe30f2c4552de5308e0ed7080578a1fcdabfde0b4c8076866d916c46a893c9955e30c01865d08022a797cb61f879a049669bab02d12fb3cdd10ebda677b622e54e68a4ecd3710b8483bf87083c88805d43aee1c799cb6c372d8b3c4305515e583701a90cdd754a9c547decc82bd187bc1215f2f5606896503872be654a4b39133a1531a8523b3c9df62fa7641ebbae9cbafbdc54c58325506bba9027342f8ae40c4a5c451b11353eaca0d60db8728e6d0ad670241059b1386e085fedf0379e8efc9a36c99fe3f5d4865dffedd5b609cf265ebdbbc937c51ab4e05552147cd6e89d2e1d49f9f04f82f2fb6f5fe793ade69fc54e6bc6cf5cc3885e5e39f94ad870aeb4cb30cea45bdc0d734fe28405dea22f0acb91109f2d5dcb4931748a95574d33b8063e4294c59cd661b50d60d116fbdd5b3017c90dc1cc302f587b467bf3420d770a98e026ee5fdbf99915c9e927ad1f07c202733e71265863629f08c18691fe1e5a778072e88fa99253a4274db6cc4346fbc7e22f06967354c773918e0761882b043ac26c26e9c62bf01c17978b36945c0612bef1911d33be44e0e26b1fca099d8f5b018cf34ade6950299d8d9af3e3a8e9ab485cc73299d048a54c81824c68f56c1321730110ffd9233b1b49a764cfc40919e6572726dc9cb4d601c9c8bb88280988f0f5dc6f823e61b05f2e81fbabeee9748f58926bfadc6cc1e09f1ec0e560be963f7fa60049eb727f3750f86ad95136baa25fb3635429d3f84e35129e6d642732668f5d52ae3435f563054c98c86dbfd9c8987984e65a956a7dbfb7dcd52ed51c99237e1bc1166b96e245b605ec23abc120b8ecccdafd8b80bd261d364669acb7220c4718e80986600224279ecc863450f7cbc549a7e87508a36c54cec9f1fa31220c46615e608563d20738b638714373e630be1d0662fead9dcae287a8f4b8372314fc26369be95519ecdd5246cdf98d3b3a51bf34db9c05063435d007aefed037f65d232bab5e5323b70cf2cb4b12c316c92ab23391e4ea16c384e51bb7524f0e4f8e19bf7193b64ab6779666cd5af393cffb81934a30e35773a9b7e5037deb116e7284866eabecc95ed7b4692404e772d704636d2441974d29b7211f0bd64f2be44d00fd41ae1a6455d870a5d7fff06c1f922a1b4dfe31de502032fad33514e7147bf0e1cfc6c1fe05d32baaf7bcb7048ee8f59fd7af191cb9af935a0695a5a1d161fd9ccb4d086384b748ca48244156b20c07f5fc6caa4f52bf0a4545e88301a456e73c4073b671d0d309caec38f1b6e293c5f86635a060fcca53d7b6d01042c24e73acf385a0fceaceb2cf036d264c7f886be1cf80a96a7166575ce7f6caca0ba88ab212d4f5f82f170a47795ccb1d9979b21e8173678eca09ba083f1d17a110c18faaab76e8c03bcee3375613ccd8c69cbac7b67e6c3ad2ca4844bcf310dc4f9184ad9ad2704aafae0ee780bcee4d0d4b31de8aeb129ce6508e7d4b62d7fc07d31a68325d9b1ec8366b39bc188d78d725d2b0e60554447387c809ceddfc9839ef1e6144fcc23aa1233aad7fe15e91f8b19fd0abef1ed50e061e5ac818ef2e2cbc588438853a2a9b25427baa502e2b8a0185e2b9af1e7cd9daa699cf53b0562811c3124107750f9d0fa03486825bfec6c9378bd843a34710e62061037d8bca5d1b33d3f39a3e7af2c3bbd13546c3737baf6643f5e95914abd8d36d74c6c30dfe942fe512ee3471ddd1e2b56fd2f68a89667fe22c2edac402bf3e6b0076c55139ae0fb73b4ff347b95e121c9cd408141133a95808a52e4a03779e0ce89b2c67b2da23cf3e944db41613f65978a1558d5cd185b24d5d7e75e399dbab6a1af8001cedc795db88d9e1e5c3bb54e235df1d6e0d415983913ea22e21e174b2344ba4467c3130682e36efa8334c867ca237b65b2ca42c3fc39b96b8fb3e0dc6bc210db8b368f2206e8d16a1ddaea6fb21c26d43a2daa38ac35a20a24f9d712c3995a4deaf9165b789ca7e471cf1d35da3ca8b99cd6975139d394f6c3d52c6ff3d805c77c87645bffd5ed0bf61eb0d47ddaaac463d1eb089d12c1b38da47807ef2042703d74b8c63e473e1f8b617056a7e40b8a610fef0bbe7399c903a5db21cd943fa673d264f41ddbf506fe9449c1d63fc3f3e298819a97ab2cf4bc4c4d5ac020f5c0deeaded229f64ae83743e2df7f3729050863896f6e68d95b68ef70dc60a58edf8fb1fd9e48f644a685ca3b374e6cdb54349304847608260bccb3e7aeabb74cba07eedc5a3abcbbb79ede308f1ba2f56a16608f72ddbc825667580e668ebc4c8bd58b7e15ed2aa45b14532db6ed98ba48e17fe8e73492ceb144e13271ecad6e588de62655b3c7c2a3a9e4c83f56edc4e3c7ddf7c4b396d4095dacaa3961153e22f70a7ed66bca7b00f90413d37348feaa4d225cb8f5e4327ca71983328465f404e69fef0cdce7559f21455235f746bb17c69de34e851a7dbde132fba1cffbc785a2d8b09a83430caaf74129190708e2880bfc56b17570b1875fd2ef39da1c04410888f4654846960c5dd10f12833b833a6b8e5bd04293d74249ffa1de2766dcab04a097531b5b136fde92e5761c185d39afb4a93bb32d70abd93fe1e2c955f4e790aec35a35271a6bd295911f3839c686777ef2537c743ef88c25474252a4aad256517d71cadeecf0edf958d08af81aa61ad1b7ff1eeda9f7200a8a82884d6976f71c612b9bfbbdabb0e29e979255710c438d3a5013784aa92bed836cde6a8f3cbaa41ccb396298b4fa0ddcadeedc2433ea11e9d62aaa04b35a08ff3fc047be872d3a270e7084bc8dcfa0cd7ff3b7596e484723fed74e85ae80a8ebbc7b582ecb3e8dd21054e3420772097f7cf3024f37c676b32c2a0177fe65c1ac5d8d8a3534a5e291f18486a1bfd2d254aaf7eb4f976b3e6e4c3fe1925cc89e22e4d7dd6d71c4ddadf8cb1be6740a3b22a1afd06b39eb6672b89853c8c49fa77dc0a2ae409674582c9780f3c6df1a60706aca5a08ae9b760aa580a2b34e3056bbb7bc0d6f7e08bc3babff8b9e175be22642ae9d4939bf4fd7e881f1758d9d8d9e84db9be88bbc0904817a0dc7907b9aa9e30e5e4a3b5983465a38b83490e4ed98ae0f134892a398d8ff7b93c7d9b241df0ad5ca502d019516f8cc6b799cd5605a2bedf2f83c56fce9df5a505147dbb2f62c003cdca2e83808a19caf983b850add2344e8489b9095af9450cc18f703df853546be3b00a6675514610e44efee07918705a55c106e513d0433333e073368cfde1bcb04186bc2dc6cb8b203119dd616a33890389ebc02d367635f8d6c886442b0dfb45ca111e41c4388d8848a8ac5649e9f5298fdd38ecf1721c376d36f0adf1ddcfde104e0bdd79a2492a8b993863a284d55f5904a354697fc65d7ca857ab6705a4dbab621b91188433a87c734579ebbe944ce4268cdae8d7db642b8f7587ce64116f1925171851d05030d0c1471aeea750063a2537d9740fef8bb3ffac6d47764d178e8d50080ca0d38d91111bd02757de543f34d76c547067dbd795a1eb2b99930bc7271815c96fb7775ea135123b1ff6a4e7f5be39d557c52c1495c41752b876c93dea5d76dd4fd1f550932e1748b14da5728eefdba54b69419929c6707d2c387512448f7f9dfc64ec719ba03683f7d1c3c7ec0c380994050255254dd7ea39b6af327873096e8c9de8d2943833b154cc5bfc82d386ea757f4390a7f70891d66edb89714364a147a39bab41dd08f2c4d28f95242bd1dbe454f17ca43b04f14e78eed050a91baa2ff076e98ae79950ca13478d01e2db6d2fe4e2362cc357dd4f6ca29e0aab0003f1d9f8262ba831bd9e88798e7c448fe42880feb8abb56c5750e83e6dcf453fec00d2d7be4733463b68789f141e445d1ceb0603317c74ae2d34de6bcd2437e7b1985651dfe410fbad70a10a050b75b20a529e356cd8a00aed887918fde8be3ffa667ab9574303331507c99157861a19ffd663eb873556996d33f42b5579423cdb7b61d7856b9616aed322b4be02538ce5c9a4d57ef1e00042f59cd0cbc1d5240cc233eaf3984d2d20a6c7f161a0f3481a73b6ac6322232cd7788dd22ca262da2dfb98871ad884b7638bfef047a976c8a1c4142042e05427297ec76eca6c6bb2cddee45fcc9e4d0565c6d3cc55e62c6ac2ad135dfbf9d72d7cc7580cf46d97c7d6b8b4b3817d489946297fe96e5f220e688c624de7ff37258ae70dd4ce24614bb198eda3666c0172b010ffeb484eeab4d934f0c673832b1164b2b50debf4835c884af21862d5ffa4f3ec55222e8d4158c0285e237e0fcbb887d672dc37156209b03ad8541cf0b296c5042e9014e30882fb9ba8da8ce47c7c666e858c3179547fd042110f1923633d38a5d8c7f39744756a6d59fa2b4242ac3b1877519eea5834b50408a8daa51d74e3162a0ab07650eebdb0016f6521a18ae58f1bea4620145dd11b5aa527e179598a4098cab32d9f0478a213ca0630a9e7c52a8c679fd522fa193cc93cb6bd7714418ce74f8ee69d9cd7099cf5df45ab0387a0c0d7daaae2dee510febb5e6a2c8c2d707e884447d0918bdb36b88933a0dc43b2ccdaafd9e456df3a6a27ffd2f0d2ae7f9ec6a8361d8044ccf5801b61052d386be764810d07a6c3357e0e543c150a56720048ce0b85171259e2896bfd5c676c6891c69c8879e948b6d4c431468d25681eedf782e863c41dbcbcfd0ea817f6ab168f52d40ba5bd15199f3031cd792491eddf8c780591b8ea5b4fe033b0229b801a5f6433fc53b2de3419148a621f74d0eb1b1ff0a8b2f0995f0155481a7f72ca2283a8822ef544d63101de14b5a4cee90a70038cfa0d57dec8908a02c43d6d3644ed2e3ca6e1dbfd708efe07cc0c0f1a4887d9669cd3589f70dfdcaa4b9be7f1f288c12e4758acd213aabe154a79333f434e48bf0cf40f3b8fb34cfb9c04b94d50e72b6156b8d948e564a7358f1c78fc4d91f9e9e2328f7063d65545d248fe3433d41e1491badc7da64efebe26b064b74cad368729edd593a1bada69","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"b1ea2b8d4ac0ad41a636b1429a6d38ca"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
