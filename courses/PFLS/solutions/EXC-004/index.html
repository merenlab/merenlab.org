<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-004</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-004</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-004">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"37edb759b49fd03342eee55e1876bb9da21f73225ce4eb45e5974c4d9518cba83cf5cac0d27d3c37113e809d5bfc9ef37b6e0b740958e92c144e122968ecb85bbaff11b50c56aabdba82490d671232468ec1aefc7bd95252c3f70f56b6b122ab5c357eda9910b6cea0a9f01e29e18a2a361efd95bae2383096d6a17455c44e90b343c95f5a9566412f877c60aa9aac3a0cd614c57ac7f9d48c105d9fed95a1da3a174dc2566571b118fe877093bf20e95a792f7a96114d5f63739ce72b6aca4f441896a174f66e53746a950a3a1f9e6fb7e990205c7e035cbea0ea61eb70ab7f2ef9a4b9a3b9ba6a7b4c541d6c35229674087eb04c61b7c32d759bbac934cb9e15c214969e457cb93137ad914763c96f72129517f9b9f826ab7729e345584b4157e521877189590b3c77f6dc64f988d4b4b842e771e9afdcde57cf624df174a5d13a27424c95c4e05394a3717da891741a9dd5bbda47227840e8f10dd3ab4f12a05bce6310f72eb4eac1d04d194bb894d82b28f33d8d83bb7a6794da7f0042c0116df1ee9a916c6b12051d51344c68c55879a11d03dc83077cdda8087d1f01573388f3c609fb1f08152099ab0e73f2baba463809b7d8c1476d68a7c861be6564c3c0fa0bb462208ed36f8334723e0c5c9971c00e828310e066f88e381c80df7ef0e884b3efe5e29257b15758c6f73e070726c6e15c539c6b63e94a98236adcb55a8e14d85b60e7c88b58a38142e8863cc5ab73a5b192e8447281e1d005363a8496ff8c77f17c6c4bd35104a5eea7d0631f6f49635b26784f5edbe6f0b80b34d18b527f01f42df9a56683d39e91725b72b90389f2773b23d2837fac8b3eb42afbd5a1b081f8c7f9386438710627149ee7b633ab85e6a4193f5492355a44637b2ef2039abb28884fd52158c3315cccc7bb53fb5c925fa027ef8879177b1de3d35cc4ddf074284841e1e2005988a9fc28729c0649ebc255460d3053672d095bc8e4f1d026b50e07ba03dee25d2033948c67aacc4bdebe21a9a9683be3ec14b4676ecf61d2a689175b29625ce18deaa1db8659f1bf281205c695a40e4098734022a0362dfd00f9ec03d69be3d7471d8f4c40136ee5d85ec2e3310a4dbfa0baf67e52c730fb3af44a6f84c27d028117d23db3eda33f5578bcbb0c4936ea8eb47e39bed2aacf6e16b4ee66ad00b37ab79f1de6694caeca913f9f86851ad54b0b3388f0192ba1fb01772230262bfdf6a2634ab505df6b4c9980a1a2f90c45603686ac7a21d98e179b00af183d28eccb01ac028b9c9b1089dcd791210375251d6e906500ce5b18de94ebf6d5a57de423572df2ac1008d35667dc3af80266debe35a0b70b103367d537b7d310099fde0acbaea1cd92bfc443f99189e0aec856520c0b02db41900c02a7d4fec2d93ab71913abb5fb6d492ef45ee4a631d93f0a5a8f66c087aa25d372f609fcb187046596cb8dcc0af9bbb7ee979124f9542b5fb0ae1224c8a9eb3eb203059230a82cf876dd64f91708d8d7388d2ecb901f27562a180be665ee50c4e939d1e1c5d63ee03402ff0fa9940f19817898e73bd378a910d92d05e2a67bb6ab1fdacf9dbdb2f8a5764bc4f0de0fa7d6ce5a9d37969611518de892a4fa09d99d90f0b3ee51a39fc3345e3625a92e16b7e0d2c5ad82f104a3b9669f7ebca9cf2dd543bc64111b5c0c9ef1ac51c144d0200037df813785113333942dcaf2d47fc0b7f6d30e0d46db3ac41f646a2c2f6607f9a741f6ed336d289b4663afafeef11b8ddec0d8dc30f65516640aa676ee1e57a557f350be5c9f4be2ffd8192c7309f5b68b88e82b39980bb38c0984374496dce35220f6477976ab83f521945bd03b212d6ea055874224503535e4d722433f59c9b3a6f252b26b810563ae3f9edca5625dbabd54861f0ee7a2bad48a848d7e2e478b1c218de4621557bd117252df52bddc837f820ba398844fc05854734416fd8abde5e47019d0d1e625ce3ee003641f922c9b8b8c3fc41bf81ddc42777093365f5e85086bf569cc7908144c259c08e63d1920947ccf764a9d8c55ad002f94808fbd0dafed07401bac372831ac3da251997bdbfa13b0f734ad53990cb50c90e5da8075a4a6cf31b81d952514890be07a63bd011142c17e4e89f1f3acfe957057e03789f97b0837838b7e868b08a37ec9060d250fa72942718c2e69ff44d3671dac659d13a5415d977677916254878e0e42f0351f57fc4b7f69120cc23e8792741d004243434a8e809196dc3394d90ab9af07ec0cff1b712a79b2503346b45a632669f7358b2d6d5764c0d3b0a62e209ba24bb4fa564d0fb217ca1b5f003d7cf1a2d7c8a8c50752ed6b3c25166771a57eb77e39a90e2df6f396d4cbabfd7f562648233db26d8cf8f685cc019a5680cf965def3bdfc85619327c0042baa00373c0fbf213468e7a63a389c5af2f34930a05f1b668ffc3e9a579eacbd5b215cd74b8b76028badc634995faff84db0fd5562a72f55e0a123c46b52a441e93024c8d88997e523292ef7d4f05a1d913bad5c05c17f84c8543ee7311f87b820cafab6a9e8b8991ce72c71323232e1955eb81f495218a30b43d4f271128db9010a486670e5644c852c856817d35dac731a94d91bd8ae0b6d78c0a7a0e1150fc9f7c8cffee8f35260dd06934cc1f78a04831ec076ea94657e89db66128ecd3c5eab990f336d06f1c9566fdb43e96247f6b871cbf62ad873f69f5063136581d963408518401dfd04b1ce9d6a9e488f06e496888ff2d458c1084877b9aef3dfb4bba9d90aebcc0404efb890635b542f78391f7d9fb388cb2b9cc22279005a50ac1e0dddece62bf0b5df57354d79ca6f0faa2a02e80d4ded848c427aa77c83e1c6bc8c2d349fcc3bfeadb72c61ec33fb4faa7ccd2e2a071cbee126ceff32cb64f4c10e6e5dd12673b55374be1b225c41fc68ca9eacb1710c8985a05e24e85dee1e848cd6ba3fa157f4b7bd2237d5e6fccbea14a69a209bc26f605f9363571fc82496fad4593c7136a65a68863ad2969c198c7577f8e9b52486fb0fba150859bf92f3292b0be13260ac6cbc70b4a680255050f0f75fe58cf7b3e3162a9a01d84b07aee3e88fb4d8bcd76b6f073b6866e5dda0d1e7682bb9bce7633d33835f9659e857c2c118b017f2f8768c1d3af65d3fc5cf1f9b3ee150272de13bd69ff9ca601b44cc9a19a4717adb759c2a7b4ed57091d8f4b279be4e720ecc61d115af5d86fd566b9f76188d6aa07c47db35b2589939cd3ca7036363c1a836d02cec1b2a4d42ebb6c4a3fd54b837305ff0f98be2f83106948493f5f7ca03b4bab18692c1fe2b50e6234d68f4acf373b070564cc250b0c5868868a67ba9c72287c8c9d544e498235ca4f5ddd3fc53686d6fa24bb16e36a34f2c480a438305a5e95845388d272881c09271961923824082d8e50bc7bbc8f0bc81dda4702ed5f2e9655cbaf16fbf4c7b5ee9d040ef0bbd69c4b57e775fc80763073fb3aec2220831ad4f58b2fe979cb9eb7eb865ed1504407d00367ce4a618230e82bc72e4ebf3cb3b0f964e6cdbd1e3bcdcdc612480d736a669b59337e385498ce4af3b28fac9273e97d6b7654a25c424d882a1b9625265f0b4d603d16ec0d65da3cb0b4eb029acaa095adfbe3aeb78a485551c97feb3b89c1b559972b7fe6bb70e4438cd4305df7e4a71b6842d549295c5477251869d256720cbb2930002cda056c70668185c0d9cfaf1801c33c737e5f255775512280cbf8ee061a4a1c4f121271220bb1a3265925635e8b64cca2fa2ccc7bb09bd47f3b042e92a1901aa5a8c8438675ef292823c82f6ecae03f9701b8f916721f3bd30b4cbbcd395a09f29efe162fe9c34459c359d7ef2f42b6e6c798176add4a703c37279579795dcf4ff83782eae1b232decce67c9861fc1791a1e4935932df398f1db29d1e5bbb0b4d9dc5c625e9c9fd644e0f0441356010ceaf69081abb02e2e22355f902f50d26baa6b8b470e7c11ba2f42b7ebc42c027b11d1e909d2a8ef171788a797db939321663d48522a4f7b72f30bc55556e0d6b45ba74726bfca9f258b164687ff5bab82afecb77768407d3099e336d83a6d5cf7ea1141f7d98472eee7fff44a0d1e9ac0a43aaef4c1df30a963783161421aebd6c8762a3969625134fde9daaad1064e5175d07baf639ccfa04ebe52fc42c8e4ec0d43eb9f092952b6f51b42002cf83be3f10db748c044549e6d31e78d5e3b9e9be257ca1fc855a52debf3fdac4dfc0c164a6901a11631b6ceafff7ebac9b7da21a06f951eb42488fbac0dd67f6683680e31f6a7dd8d808a14cca66e070b6dc7811c49d31fb3a2bccd6f082604b4ab6302c28b78e141bc2702b36db4ff4af9ebc183f06c93b07fab68e5a641a6bc07ff4cc08644f0e6975abd465fca48a80cd558377846cde8ba05931f4da1e0da4891c043cad1ae6f2a4763a8456b9e74b5a96b1a4fb696bd8422ed4ecbb0c7f11ba5492239f29fd00fa2a178f4bf51a0b0bcc7dacd10e1fed353ee5b37c3204a201cb1283096d5675dae2ad5019c09cae6d8b3a8e7c3306fa8cd0a98a43fd10fc447029fced4a30ddb202b60273ea7ca962ed08331997c86d46b0b342a833a2ad1b74850ad42740d2a1fcc0968ee64c893e7b73a99f4a1429269f16cef5f1688579f28d7b760d785a25e87287a60ffec11a5e4ed9d6a94028b53d10910133206907bd04ca088eb1263eb5fa4b7b315e246a8afd5af069e5ad22ab586d25fdfd694a49bb0abf38a826fd2d23fdee6d305deee0986090c92789779f58f6610879069dc3ff5bb3882780aed346df7b2ec0bfaf6d0612c1a2eb2ae0e4b8984da061d49ac671534c5d927d645fc7d42df6516525f4e4591e676c2d8fa74eced6d282cf15a9b0e4b56ae951f54d0a6085059f8b216224eb12585a2321eb64674317e6dbfa0672399da8bb25ecf40f6eee2e02eb4f253f15678539e761f58dd96fda8d19ff761c42d22bfcc12ce7c076ae0074e35ef504f21b7187dd97c0832eefb5a1145638bcc05ea0da717383c93bd930b4ff291661ae1ed8f496a7334e9e3445d98b4d4afe6aee22e120be9c0ad579e61ba960f5299ca316ba0aeca812357d992e10aabb8241e8200b70902bbc68d151f60f6359bd9f0646ee92deedf3af3216ed84631c90a38ad31223c603cc1248335e30c99c67566246791fb5290aa1d37e2ca7466e37779740b9339face88b985e069d344f3eeec399da576d6d1b3d2c1030d6b2f0ddbac640c1c240bacb0e1c0470e48fe2a9d6ceaa65a75195c1da4a87cfb3ea9f4cf8a5154d041e4350dcb660d8c969692e20c5760ac00596c5d1c69e06a98ae13bc1ac98ccd97df336f667c71b57845c122222842e21913a040105e2fd90cc5cde220ee5ac0408521ab561b3c27a09c46322ee176032fa96d53051a63f5ed6756512f82ebfdff685fa32f6a5f8b568ad3563a089d7f21da9f94e347b331041ae217efd263894baa2f69d88c2b9c5291a5372d618afb38df9301a595c1baac77076247e0cb3b8dedf9b12833a1fb09698aa7352d3f4ae73a04b5457f1abf27f98f780e58313542f1deba6f3c4cee4b19561fb0500bc30c77894c230a43c4877fd71ab4965a01149d26b5acd0d9258d0469e670dee1737bf195fdbbb6e04a73f379fb3faf1ef703ea37889e2795c13ead8c6351014a5924a94f0cba8c4d897c825e3063fbefcc5635c62625329c5b3ebe2e52b3f3c2a67136d95282fab65f4ba99ed96d11410097928f6b2861d956e6a425504fa701adb567b744a1ba43083b5f7162c369d1e9e9ddd041ff353055e5f189c9177e19b1a2368946d607ad53af145b32e498b14c3a593bed4fb1fcb47a075cc0c8dacf80ec92db358dd84fed54e85802964f7cacd77688004837677da9764b0e50a9903126c6cffdd56e9675527c58cacb6afafa3c8f83d41119f684d3808a126db709b0ab408bf217b6f4550c5a06ef49b56d3cbb5cc79cdf49d75c7deb2938073072bc4ccafbefec195c163f28e05dc20ae5b216724c5212dd2a5e48beb2a08e07c690366b8e0cc398e74756dcf9aedcadc5b65ce108606d729c47eef37cf5ff3e66d1b0106c2fc7c1c30df86d5c12ae6e1059828f09383901078d5e0bef996cc06fcd4cbbf4de3d36fb3bf914a51557d1b52246bcd1efab8d32b8adea841e58b763d3e921d89918a9cb3af9e926f6e6d2b4b8471b2c2de993df3437aeda76d23070bfd200f8acf8ac789076b7a923aee05c41c581b67428f4d655b0059c21fbb7467bb781e0107b6f835ef5d8e6d417a8fa356dc50a8296f26ddb820030d8971f2d4a970a1f6d27a6870d3fcf2b9717e10f396415a9678c87b3f5c1f51ab68160f24d83b738b475ee3fbc18d7a36d13a9cee6ddbb17119192b23103765073de12516a3c38094c470d80a8983489c85b97f3a26f6734fe326705921772224f3d2cf79fd88062c0ed57da954b21aa8635b3556406f3922867a593f7d94e7da0f503c4f42132baf623cfd6d682dccf672404999177c58e31fb74f3f004dcaa6b6c52d4eb56bdea930fba649cfe8237e050a1cd5d58c5e00aeb95a33ea882c5e813772a9c152c0bd0de4ac84b018b5ffb7cc21b3e1c9d1eb5fad75859301d2b3c8842f45f5422c9cea88ad2a97d3707168e118a5b07cb70070a0c5483d9cedfee1283c87794f7f5a417de006feef4acd2f2b49d594d155c441de70c0c2942b67c8a0ff611abaf4971b24ed0359733ac3eda3528ee425a66780763b571c3a4b6a74a375467276623dfcbb50e9ed947554d424032cc532aa933c33a8a7fbeccab1af93e83bab21c821385da6e13743502b104fb9cdfea593ff588771675b3145d037f91334d2480ef79a378f05d330d576823ca9d5ab4284735792e0e7fdfadfa723fe37bd2c644d6df0613ac3313b69cbc70babff360b7cd2e250f2250c1c3f175980c83dc2e2ddca83d95030aebad7f769a002c390eac66535604e9b992ee617fc6bc20824ff4216cf4bc32afa5c189848a6cb828b08f0b33371079576b28078394b23ac619cae3008dc35d043e49ac1b2e249f30c611d29ce135401c4fc2900ace43ac7c6db5bfe93c10b0b5b78e69c91fe43c3214afd9aba83bef9bde4677facdce532561c9cef9d74de16cf77ed4f38af9a424b519d69f559c0540eed702620e896e6db7d0e740a77eb5958611862f59cb22a86da9dbd2e52b4552aad7b03c41097cfb8f972669495acbbf3de795c73f1b98a405ceb99eb984c594e33e10d99ced5715825016b0c57c7f6e735ef9420f48d614a1edbddf229925fa1071db539ee71b23f15aa0c8311a8d91d50ccbc074b7f1434c5a8cd064bb2ea7704f781253419cf0a572c5b4675a7544aed6565ac90c7dd3a3d2b401719899178f20189ee2ec33304b47673004606e1a1fb22ec489a6e3f68d9abb9d967bd63a34038909038861958bfc82d543a91eb59c7971cbf08f196cc97d071a3a98c228d442fb6d792f9123eefad20a18c79aadc2bbbefe254ca7c918b0cb0d9569b286c8ff43858705d359ebe28e341ce1af30fc03f8f23c80e5aa6b9465029a6a15ee6b67387920c429b524454f32bb23195dbdbbabb9390cf19b79bef627250942127a8d506699b1867a79f1bccf40f3cf8554eb928f072b84a178c3bb126ac6baac4b10fd81f3479a86752de35567d994a8f75b21eb0d97c9008e14d61a4a69d7d5cb0093d43178e947615e7a1357cd15a1bcb4448cafedbcb34602ffe05bfbc48afeea50f570acc6d147b9d1dedbbca5744d3b1f68affb822d5034a62b6e8ecb3bf265cb3157206160dc578adb0f1e7c9fa5c707d8687ff2f8ab88aced317ad6660179e66f21df8e7f9f7e1882ce1bf1b4713f909b67d683f5db49047525bc643b9cf2b1cbb5bf1b91ddceb2ade453644f0c37bb4849beafe235f2aa0b3399bb07189ac1a84fc056c7e8c75847ac77115b6b5bed3a5dfd6140828f720674edb40d664a84a974e7a09da4342b55d3b2d0ef2578af5da9100aada3b33ac59a02f63afbaec15c65fc3f4c474cf4586ec243ef6af23692eba3ca491e6f084c9f09465852b137307eacff597715cb7aeb9dac7be934b2d43d9ca62f44faacff8e1d2f4c96d3b51bc0d63535af577486456382fc2bb881dc59e020b1e8e02210e00da7391d7baf46ef2c4f817f2560c38b3382eb3c0cdf8a7d5f7bf71a51541176b514a6b34e3416626703f45020edc05fefe53d8b71a0a81bdfe996ac87fe541a826d539f2b1239f32619cd88284fa53dec43aa12e218f202507a381a397316968a9194742ce1b3a587c62257fd2d9e05db777fcc16a5e23b905278e3f3621816bc3d8fa3b804228fb96ed2581e65552b434ffe5b7411b6d6206280eb3a1b8733bdc6ba02203fcfa5bf87197b2bf41e8cb8fb2de745f9e7990c339796036b1374f2f8460d661e36a9893fc4178a905515c2fe7d6508af4618c551bdbd85b73f7ab56646cb319cceaa6f5410776890d2c5c9f6bb3a3cbfc41a3c9a42127257176ec2247ac644c2d1a5b7642453c95478bcb690290a44f8a08bb9cae85312727e21542a23a45f1e0fe1f8d3b6c29126f00ec69fa7f93823ba24c0ea1395107f3ac012856cec581eeb8aff450f55045615293968e00d2c70ff8ddd84d7a132462beebc89c138854a4a73f7ecdd45115087174f563bfada9f3a7d79cc4aa56687f584fe9b0e44875d85c145f4b3f65349101b0cfbbebe1d0ed8d29c5f4b5c88fdd93b97e6bf68efe54fb1db6dabfe8dd2b79579066f565522d011e3278267e4118ae9a7b6c01d91051b1654a8677f303e4a2f24ee9effb59ce587afb430e72f41c4bfdc4db54d54dfb02738855845fd88d907b0b84daceda89b50cae584e484b9b2193ebf361a03b48157b6cf1b10f219159468555fa3d98c1653680caaba68903d68a1ec831a39ebdc7d91409b81c6563b5ccd96528384ac3a5a4ed2c6f25d3168a8b18ec77143c5a27365f9bdc42ed60da2822de57ed615f46283321f09d736ae866503a1fde26210bd98adf94269f27b629e02e566596f588dbf35ac7b090c5f98155bc184ff2ecad04d25ec0f886ca1e54c3df571e1b6883fa249ab8ee58b247766a963c47ad006e43f378eb91d0f50071f9c490260a93e25d572f0f2a3bd7fb0d632de907436e6bb4ab95922415a36c90365e14d977b59406e15760c3e367c15ce92750ac28b0d4f00f8ab251b3b42aeeaffd5cd8d2d2d3709f7a4fa8364d14361526cbb8de03b15372059cedcb21b3516fd99a76be1ab2744048a8b0f0164b7990cf5ea180d8a658e1b9f2c1cb936f54c246cc1b539b3630e18e867e4c88e47eee4610174b440378beee44bb91467bc7a93b0d053d4c4e126683ba7ae07d21686016b3b4cf1aff7b9119f4b4307dbb55d360c968a554a8ff470a793c9c49e0a1b61d19634949f65fb485964a828665c0541ec242f2b489e204d6c0a9f38b959a3a49e29c2ccc460f5decf6a111cbb63adafc898dcee5f9dafef6d5abe194ec13506856628c085f24de0cd43da4d53a5908876444d05568a8879473f2c0e2bff9cf540803410b8ffb724502706a58ea2b192b5fb29cb36417391c2f888b6de17b541f548799a8d4189737bbddcbcbeebe3c75894f0a175a5c74e694a4672d70103622b22f0cabbc420b8656fa0ff56bf9d3d82288905d8c3e5dab463cda0431c69cf30a9aec10b3f06010e63d2551b718f8f7a5ad0871251ad76c40e670da614a5361d8c3e76bdcdda06b1ce439ecbb98756a833f6ae731d6d1caf9f7a3ab7a5227f783d3fb5e39f9ffc10b289a5ec5bb053e38f6a3a0aa758af92dab05aa7b1930916f1800028876eed2f654f558e6623b6196c57d717937f9f6810e93d482756db1c1b21ce228f8ea795dbd3f3465f68133d38152407e186d43fc3db6867ab93ac50485c1746e0c2592c26ddf8620b4fbc0796e72a9987a146cb63a61bcea7c412743182ad38f637cb36cb52982033a87ce5e086925947757bbd3cb8aec5d91faaee87e62637a5aa4a30f6118e6e8178885f237b72557641b1d76f3e9f35e8be6f25cc19fd326ccd3d1a700b0f907700e072f193af7f887fcb0d208872b0bd83ba631a201b1cb2022c7776ecfe4765b3df8fc371df517d420727c9406807b2546f97d9e367cc99550d59dc38520bc24bb21740ea5d13c49d17269beedbd22c97bb65b50b56e401085310449f8a1dc9eff18e1a9d74e8394c67d36795aff79edf05c440ef02c56730cc7e5a4043a80bd8177af72fa9dacf4135b92c5621af87bfb5424646388eee9263954d5303b2f1d8e99224b14e799c2b44a6b82beaf5fdefdf82d9179e75235a6fdd6be6cb8634ce4914bcb74a862c3964c4a11a485d73d7cdedcf50befb2f709d4842b18c3bc70549bb1f580a01c925bc2e84c4b1d8eb16e398d6728d12ebed2db6d0b7876c66a6401e81de7bdac5861202a96b870400885610c2d0f32bca2a378467ca81be2a4b9b4808ac52b18b64c7251869eea8645bd716cda0a5b85c31353e6d721032a15d8394e9cea8011e2441e9a6dfd0d5f376f64b3504e150455e2ca6c5c2cb61927e3ee61377d4e837f2739cccbbe9145174feac632f5057051645b28798aee270d9c28f0facbad943d1960b3353e60ea9ff2d2222adc18e8bbacbd961e14e61214afb599c97b8235400a87acca244a36d0bc996716cdec4a1fe56959c7a5a62757cb298b73ca423855bee6922f3c663c20c78a566fda1f529820f8a5c80ef79ae6780c6f3cd7072ddcae4e830360c6156aa76020552bbb119555dd526c5552f41eaec85082932c8223132210a1c1c7597bbc2f85010c482446d3eece6b748038986fb98633dad4017afc996cc09d4bb8cd553eb84e703621e00723ff4cc722fd6a4db1407974ebeb614ca325b5da4948ba74dacc781cf2c75a08843a17b3574d5cea1c010885cde2db84203cea9c0c7c13524654b23deb462431a3ce2f4c2ed9392ae5a2091deafac68f5b778517e21294e23c01d9a2e7d5518c35e09bd611296515f4de551ab61cc826d8c9b328c9fe3170e07387f5797c634e4387dede58963e016ea7337fb57b0aa6cbad8d02a972e9e64f14123ad9076eddfde3091b41cf825c28d0503db44a75a464cf919dfde8f342744008581dd0322877b0573ca893093b851025bc52ca0bb6609f92a973e7121746cea6ceede10b28ebfee92ab2e60aa85351f86f5178e6108af91f8e61b5ccd17786b0201e437e0abd97b936e5d037896f5d8a1fdac3fcab2a8764d52866086a408d1c5ed99d630d31dc6a1a108e8143b87e6e3983d2fa4a402c7f27f3f7fa5633248f4457d2845033dbf4410c2a8c43c97515f1251c925e4092e0b274b004f5b3d959a36919d67afe688c144fe4cb83a6212ca169dbe276de1935461934299190fb8b79f37bdaf8180daa7ae2a36bc5fb77301a8ca5447995bba80d6ae426ae76528a67dd4475709db1a8acf09428cec2684f3164a8385a405e51786cce2fdb3ee6f7198dea43bc0d64ee568a32e2ca66f8826775238ee2d30e4f6b297c8907f766d441561d094a0236fbabd8f677b6145dcd0bcf542c25a0ea719203c087614082a8dfd6c032f265eeb4f931139b55d72973139696d539f35a3ab398f829a078bbb5e2e09076c74322952f08380eed0a34b832c758932eacb2cf7411990677de68b1eb1c4ac0b721d34d09229f9f45fe320115e8c2e468a93924db9d20bd956fee4555fde5f28df3af670039cc1b818c938d0dec7ab527fe7e46b6c1d559172fca874417d8e28f70c7ab05fd7346cef9fecaaa4743cf939baac3f9d977480f98d7e9e286bbd5ab6b9e7d18160d052191ea0c0e923dc449ea607030739d870ea08862208dafb655992ce32e82841893e03c24cde37a5069e52c77273219af71fff7ac99a4e1e28b05cd5c8c243f48d1c9cb7b19a0f020392db04e96e24dc36f18f200e1c4afbb5f97be139d7eca6fc939af3acbdd1632beaa9e7f7b3bcab7fa3977c55fef04cf363ede921c7a38cb7c415cf279f4f30266d7823d181041d6f6a19320ff457824f818ba4974de6235f98662148a0836153522b73006c762b59f244d4260a6115d949099bf654a67d16421b81b68cfc9f9aeda715a148f2f94746f2c4088b2b41e93e79a6e9570f15dbc4f9a872114bc168448f0d795a5563c93e5b963c77af4fc6f15f643feee3f9d752b202dddd2b2e56d8042b8f889796f761a85c2e7a2d9d0525d2f60e0ca3a90ff7056e8abe881a3ee5a85e78ce3a48cd8d3216ffbe3119dfcf9ac3c73135aa7434c7b93d046c1ccb76bb74164f1fdfe5a785f637aae98766cd2712bb401860a41374dfd2a824f43b72f872b6998c7706edbee9a9300fbbbee8d516cc0916027ad3a0174416d0dccd5321e8e36b2e329bbeaca3df0f97eac00d18b7e7b6cbcd8c90a9a120caf444267ef1b39064773a956bcb31c81b579df4a40e74e76a2f381dc1c649e2138f3087f08dde52d666e6ee24ca8c2ae5dc8d0cedb788e1bbdc912c200b0fbab379d5dba670d79a63acc76e7c905c256aa3c4c6c0b973dd5c0aaa9ea4d5fb896d3f85f6f06401ecf89b2717de68d4e872595049726771d49afc087553b0ed1426679d52366543afa65e794fc80326d9f4a596c2f9d727c37d38e032860bd8fb925b65607c90b4f85ffe4f66f20ea4d1615dd7c093a8f335ef688ebe185e92dd891a925b3f462e7b61601b239b420452131d7ca700127fa69c63f66f9a6632fa8eb31ae7d517ffe12354dfac402fcab2552a8e61a05d577be0c2869d9b510296306feb20887d616f469049097a5408b8e83a329f0f31087d260f9c92785a0211c233c2d56cb21594f4cce0e0e110f01c2f45d18e9e9739f98b3238bfba7eb9412920ed17b31110c11060525374b8b1dbc14076f6a3204121ad32ba017dc2ee43968ec4dfa3015cec839e08a55ae1f94a1a78dbcd965b42abcba6c479c7639bf243e9d6f6054a0659a681707ee32656a5a1cc1af9f39eb9e7eab9f65614d617fa9d7e941bdb92d4d8f244d7cb39de6b255b0ad73b24ba690b70cfcb7a73dbdb67e467be3ec0f70a272dc5179311b08c59b87cf94a0b485fdf482ee8cb1ebf54abc716455efb5d4827539a2d20a530eb96deb3aaba7c293c35fbc13e57381d3ef610b753bee1104773370f765a4bfa4b37dc57078ccd91d7e70df0ffe8c732606b7261360e1c29747106ec2a2d510840aeb08c6407652a94d552e9bbdbd19a8a43bacc98ad5d2b98a635a7a91e2269a76ddc62fcac626984f63b973868c82523638e72f3380ee82138d1cd5a9073a0b82a54f424b244dbe608da17c8b524d0af62167522c2bf7c7388338179bdc2f4e06dc5f3550cfdfe08abe49317481f0cf726b3f9ad417e390a97237b1b0ff689cdbbf1dc5e558ab4c06f4d564ebad1212e65cad33ab608bc9e8f0ffaf08634142189ea5d277557e07f9db4806478f5e01d1c5772b550e38b826ce5067c6a1bc32ad27e90b03a1e00c0b0af4e7dad95eeda76060e43c587b8f2c84bc76873dec183b55f8f4de56fa9a065529c8f6ee0922c13299cb1e315d8e44b5cb6aca5404e08f542cf3b50bed9aefbd7a9ed0b261ff6248caba1e2142c699ae14b6f75c1b9ea9feba1a939cf3d8f3a29003ebd0fd54c4372438c29ad078098bc2a5260eebb681a67997496e45e2e499c4916b9eda543f0bc01b03d3db82bdda5ec1b59b3fe5edf85b66b47adabb54a2a1ac172ceaf70699dccaeda10469cc8140cd47a01cfdbedf01d419c33297a40c1fb87b8db2e67d0625c57044d81e7970f6cdd3c6abbbb8dfe6ef6f9c2ca336f73da881283db53fa87ff68f18d5fa64db90001aecf22a72fe43b462bdb390e96d75825476f476199c1fa9c16cc1e141d0e479e80bff1c1f34243290ed7cb6d0ec402a9b134c23f99f52e29e98e5db242dbdf0b112cb12d1214d7d113681e0a40ea04dcbf671158bdb64025b405c26190a62a21ba74fb575ecb42b08a0c293238d17dbc022c4d7c1fd5722562fef48df29894ab774798cf4c35ff3d5059965abb0e2e0da850c4d7ef5090ad0f15f5d780f4e3dfbd6080f5a0d3481bbf1a6a454c47a2362a66e7e874f8f429ece62399b9180d6d5f3dde95285e0978c83ef813a1025fc7287e40e3ef220a3f47665f4935137c54fdaa098e8239cdf4d89c514b00e32efa19c81fcbeb9e5e62978e3ec8aef6259dde7f676f06c606707b8e25d479903d87db26ed845f6594030b4f63403c281272573e79443be25ecd4933d123bf18b1255b1abce3562d3128c6ff82e68d51974e9cb1a6cccba40e2b6c3e376518097cc073bd6ee1859a361667104acca245744c0a88c5025519d797dfc38f53ada5d7fd9075013a945118944e8f732c8c12e6a87ea22d2587aa73be29214ab619108658fcdc94460e3197d093f6c48cdf1e42930b8021b21bbfa94ac99174fd01de27f2ba8dc4f3f6003d7d0611914eab5681b1e7dfb5f3f03e6af68ef5df8cb716b4da056aa742b5a04bc1ff3e63337bae48a7008caf18f2cf0a7b4827adc60783f769a4b273fbf73f3331d7ea5c70a0b3da7848473aba503a0f1fe0dcc569163518480040ef4061bf924da004e2365d8d031d7a1486a114bbe8c04ef0033986837d7aad540accaec3c2dba04ee1495961967e8d110e97ecf26882020f9bc8193b8d3c85fdcdc7d83c46235fc6c6d422a60266768f40a28083f3f0bcd5c532234d959f58af6c7d3d8c8d2f8204ab9ac2f9bc9e6ccab17ca306635b7ab22a2ab8ebf3a5adf61ce245acaef271e004425e04ff55790e107650692240aecd212f48d3f88fd57630d0f4f99c25a9a1a5a30c5d6827e9a02ad723592260983895ce0ece872ab6c8c2ede19ad5f60cd1af789ea55a4625ce0fb920c764fa1d0bd05f1e067690e3e5beb870237333d2f9637a673152fadbb54a801cd272bd388fd01cefd3c6b48208942a22540e4e302c6b669945b29ce179021d1b1679444d1e0c38674d5fed5617cbb275cd7d19f181983587f1f68aae4d3cf8052abbed4e2b7b80fddd90ba08bba571dfe67fd57e2ec375a1cde0b6024d86d5eecf2b1a5470fc96feb5437bd1dbd09a29e6ce0f3c8b6831db01e163ae4ba9a01e3d8be83f2080c131365058088e55b3d18f466ee237a710be0c1878ab58d0c4435e6b7c444bd0b639ce7fae14a3768f886184c77bb3a3152648936b89ae65e819c9570728470c7977b20f21d5ac678dbae1b8fde062bfb7850c18f98567057cf1c07a8411e7b6f8cff5d3a3e28ec08ba58f73ee99db3cd567b70e9a72bbd3419007ff5ed48f57fe59242932f49531c72e277e500338088ae2bf62272ba7753df2b04cf760969764d1aa6279145825d9e2eaceef730be795d20090b2cf9af813a4b48376adabc75f7823bc9c8a4608fd51bdfdfa42c2aa057acb75a5e42652515432cd601d1775e6d0ec1f96200c62ef0747a774a633e15ab2841bce5fbb0f739bba500afc022c1bf8c1d3b29cd7d3c4944132d3b77b3be08f12cefed39af50386a593c3196a8892fa747e7ccb06b0762d342b02464a8244c6bdb584bde589a00eafe6fa96c8c3eb23cb70f2c205d413720964b23469760d22b50f50731c1e8f9f47098e7af564b5d2bf306eb0f8e72b2572a03855e1dd88e4fcb5ab07c093c72918cb3e141522541345cd93f8f5d6adb4a9e93981655c37c8673d9919f62e96e1e267ffc79603dd193483a049a6bb8a7546386cb9be8adeea3c051e83cbfd57271af30096a8c0a3742360f2c147052340e89ca253834de6aa84f805d638fdbd1811c4e155159c72434980ef81fefd88395155e60ad8dbe36fd51eaee1529ed20f67a51701e60905af739fe0c0246cf1f08fc0f72f92f3537d17419a4051c627121974b229d6bcf78b9f4d7ec512779cc80f877f4f6b002e6aa01efe2d9e92f268226204502e35c618f2099ef76d0cf067c074984e9be3452ea58e21ff6c206f81e72ae28546b31c46b43e11d640501b796967596b50825fd07795348a36bec871969e58d0142096d9f95e926c09ba4af0a628b3b8fba28b12ee11ccbf4142d3b9367cf858861b8b49a96632f13d44e54a23d7c3e557232831c6f4344edec385088abadab5e2b7da2d4d6f933b6eebd8af19e81d3ea88bea083b37eabd9975b6545bb851241f813405e2c0d1a266615b5ebe7beb6f1661611121c027332223194b6a07c62bf00ed27663bfb2b939e2d973448ab8c415aebfe155b71dd94ac28afe2c8c9144557cf8a88e29cb80ade9f060a242b3a4aa625e7c4d6e4929696e7285051548bac74671276c529d5e21abd0ecd729c5ed15c5dc1ac7765f422764644d346340ce2c67f4f97a944a63779b1462be69d366911fb55c789f79a09d02a96dc8fc842f65aad3754ab15f5ac25cb5cd47484ccde5328c5906eb81631818c12ab5007bb4abbe68b91b987276d0f83c3d16a50caa8bf6fdf810997e5abe9b73db9b76e921ffa2256e3802f44ace000768f6d17dc52adf61d4bacfd9eade697d652b98fd85ddb3bf50a70a9ac4ed7f73d246b0853e6d5b8f21e261f8a4dfeb9025cc70cb7816540d24acc7f0b93dd36b4c4eb50ea962334c9a85f0731565ca2365ec2085157f16bb78eced0b1bf951bc87b3aa7bbaec59f2f4e6b72206b25835d722997acb615f4bf36258f7fb2419d913afbcfbba1c9aa61be6ed0114e2c450a47d8d58441f8deeccc6ebc28e78ec26538c2450e1ca7b7f12600971d5e0936ff5f06831c8b6b4793e61554cc72d1652b1f507c4b32bf1fd7408653a48195bf31b85263ad0a3059315cb95761bbebbc6848d540c3c5dfe354b431a93f08b5dfb2d9ce3abbdcb0b55904b12b3c65fe849fd4b1f7daf052d6d60c9be4ac375f07ba57e4ce2e0c8135153265133440bf35fea8b0f76329734d4d45eb5d499c7f6b05e367b38e9767fdaaa21bda5cdd93c11ce00f99f64b00fece86a6988eb25864b0f56cf0016683a495f3a3a24f2f64120ab35763f7b6f0347d833a92b3b8a51728cceea618e9e79cd8e664b0fe0ac72bfc60dec1462134222318901d8d615af35693f7cd1108f847b651e2a6ce512da14939444ef8cd35d348b6e5be1249926b24b6d4fc6b46965b38bf8f64f9c7566cb642ed136bd4c9347cb4f13103f3185b8d51c593d1f3542ba4c0870678d89e8df28cc92adf7fe7b556e515517e6b96d0fd576684b0c5668f2dafa0fea46ba081c34b0be5abfb82ebdbb51d423ec15d38a930483be494d71089fa16dab6eccfe8b28a8c3236e741850fcff3948520b7751004dab07c8f5abac56189208bf97019cb87821158621c9ef63cd1ec053af9655340431ababa8e73d062c5990d20dfe50dbf8304ec0d1de38b5360230e181784e146202f11b54104a7b77e8c16b872a6dd47e41366899d33b7b781b4a82bc9496f08b0c29d87ee6d4efb73b557ceab084231eb1d1605f8170c94c8d5373e6048191d4355ea6390cf4b8109a6f7f14018b96f83ea2a1d09e325e5d70429d3fc072513bf9fd5ee9a5e0b978ccacf3c1ba4cf73bf2927fda5307ad1a34bf279d1cc94d83be4917092f054ac29c0e2e3214aa1a6ac534fdfc0f11a153855e7623d374031bdc2cbb73366007fdf203057685550378ef7164f25bfec07a0ae14467189ef4027c242954a91d0b680b91c7c9e8159b13b4c4a2d3955ede716d309f7b39a04104008027fec8825b5f5ce3808900d3984e6f53b415cddf94428cc917176cafd1b01bdcebff592cb70e76b1b406a14d1db2d62c09e53c7cf7af00aa8ecf92ce34cc317387cef4b6f682466df989da67ae0913c3309630b9f3af0fc5a37d34607575aba1ef68caf7220c38d01e1f3002d621ff211b2d295ba857698d45cab19afa35014601246cb745409b5f2263f47ef86f164046effc2fb4ae92dbd834ea90e9267c1d772ef06b904f2e69f9c128edb0a631c58ef576d089a3ac23638a2761a61012f9844c4116121c534228fca1c32f5bb97b53f95bd8da0eb86a32146fecb846f94169da5853215f72d5f5de867d6861cfc84c5cad9856e7d4c1f104ad5615b321d67ccf8be2136ce5d5ab1395a48d2e743b8b11b10bae1c69d4278103929e1fb5057b909f2e217de6c18771b8ecad08efdac8b7d5be81db999d05f8178da48d875f4e22f34ef52dc72c7899a5aead736b61ace5f3530f0fd61c679a846c5e50dbe73f7bd174ebd40a7903ca3f2dc7b9084c62573d13f0050f09d3e311fff1ce4cc8bf84ea90f8a443c177e425c13ef50808e904d62eca012b3541aa53259c0e4e3285c5653e966cfc1572bb6e889e250f2df0bf877d236aa242f44ed944fb72baafc5ad8f91d3419e7e7d9b4870093bc5b92ab0a1ae90c729f42eed121dc756bb8996cd61727883f977b713ddff5291bff73a530296065e8a4237760b91f854bf549f965da5e790a5bc883a9a39c9bd924dd647f83df281987bedf9a475013fd817149974475dd6b8c749abe574973012eabea3ce7f1e06e0b1b5681a580d3b4a69df53b0e628015d83519109caa9d6ef882191d7869bd70da6840cb546248f6a4f3ed4159f05b68100e90c84632b38a8720ddd9f289fd47c9cda234e7a9e7511170d03217063107bdb9f0ff72016fb25b602a819018b1ff5e942f7d85d249aff7bd068ae2da8f47ccf503dc7fc66c425c25e9df672b1eb81791689061efaecd0c0a247ceaaa2c2f11af59985f162ca36a0c71d03a1a6b0134c4b119f12f195ee2a9e6ef014f9233af54a583e1915bc416fbdbf4cf7c84aee705a4612433d100a144df816a83de3859ad0f0e121053916769efeb28c1288449d9b09df467b70e24b7cb61f20a8f85bba2123783b6e5197ddc561b12445e2cc32ff68de1a3a1bd01d16d5f707ee44c1c81617935650a37c730022137a5af8d13848bf89caa93d79a698fe744a5f40b94c4321bbed9321e30b9bf17cac1897b99d21dbaad7cfeb9ed732c4ea10efe041db4326e4240f9b698028613fea6efa75f5d301f8812f8dffa83c15371709f7f94472ff8d0cdb2255af80b170837e7f3d3d0c0f31a78f663e027a39a2938a2a75e1e63f2809e531f0be6de3bf57d520d003affb3b91b7079af536f4dec96d0ac62525fac5ba1f668bd0c66994b56756a39ec2e2aa3b6bd5da85208f73b23c1a6ca459bd0b48748a65087c8414fc9d0094f95a2a1da8cdc3df31397e78b52f906c853fd7452f8a526296ea7ed6fec5df8391de0c2610ed5b18fa69d7064a16f9434c15d072cc5abebd5080cde34f3eba3b4761dbed4d532d8d71d994ee7a48924bf21578a5212cec3a2e4a1c991a0356c0091215f90ecbd7ecb97786aa75dd6e7aae23b2b0edf75f5f5a172a50f1ca305abe886672e4083c32609109506b500792508e13e7e1745446f617c772620cd14044cd84ffce90cc52ca4593bba0aeb39b873afb295ad5badea2a851f832d140f77c169f6021faae097243fa8672ca6415bf7f14e1f70dbbf20a1a8290a2fd9c25ee333f5390e32bd17333b1b26c7ae535c347df67a564a3dcba1d19b2f28578fc51202aa100f3a5dd349edd44be0deb36d3a7b10231ce57084628e107aaf2f3e1a2dc02d6d70a121f9009ed3a33834c3b73aa8eeb601441a9a2589da6f22c35ebbb0c857cdbdab240d42831b73b613185827c8bf6f446a3e90679021330686ac517f694fd2715ea7bf9ee47c4b0e303d36ba11603a101bad6bd01671a8be6bb14da689677af482dad547dde09c2774e23b579acb0761af8cb4f00023ff747e90988074bd4446813eace2ada7a7c99f05de79704f072471b4b8bab08e2c03c700ae2b5b580f24b2e817cc156abacb59d7cbbf3368da94d9a1db70e4e55e98e3144d85094325f13178f5e1714b5c9a5ac218c6b4a1485a1e2b7f7b7e9b9a8b3d994ceea83a61e1ba42506c4526a727336098b0f6f3e47cc6723647fa603a18318fe34b9490f8eb8d12f370e7ddb69c92d5810c15d97262b9f78805d84e3799651b380cc2b45761e371f9da1eef6cc399c41e24e04daa84848c2a6b70fa5837c339d527709aceadc9cd251ca793cccdcfefb24db213a7fab67ae899efc399a3312c7166f160b5404bb8a3e972e9546fb34614f1c5139abdf857eae3fea62c4b80880ef34a916844a0b9f814258fd9a3ee3eaa396b1a3650926589235320e3b3577700ee862b66d18e17b16c32e1b7ca60f93ae3bc6b06954f8e576af608f6e2236834ea3f2922f23d0c484f997a0356b5549bdb819b24c2f088bcb1db3710bc26e7ba1aa191b9eb38192a987cd0f0b128291e6482d92aff906b93147a933828c3c381ab23db1e49c2bcdae1196792995d70f6f317ea0d46391b694ff993105536718761a342cbe5c2f17d19780f4d44768cf900120c9da9085a7d7f59f450e89533b6a065a95cab00e161489e67e51ef43a1ec84e919e2ac9b7ebaa9a0399ca4c4dc5951c8c05f29632fca81ee08845d201edfa5679ce49cd735eced94d52237e9ac8dd5d4beb6d4c4bf2b2b96e656003d69bc7451884ef9f696dff69a3711464d54b6b3061734a6d9ce367aa15fa77695653a528f2280d04a2344095b228075b0748aa4176a659cb5a5f2b17d4311acfdaff2438f18cf2772429cb70808b582e114662f549a3bfcb7177b3842d3e457ec53468aec307b0dc7fc99645d2c234507a3e3433c7025b5962d4a73526deb91217927c95f2594ebadc59aff6af73b33a50a634b455eb235fd2e112a09ca23d1bddf065b4167cf87d56266ba20a1169fd1d524319191bb10c7572d2fc524e59123593d7a3a036ed2b9b3e5e0830e900f50fcd47f0491a1c4c47468c4335fd27a75bb5640f1b3f6b7ae585b0b2c189cbd44d961625a0e3b9daa4e1b1d7c16d3b789637768577ca4f3b0e3edb869e251c3e1738e8e42d3ecd70bdc68f5fe5a34997ce5721c583f26d66e1bab3842cfc7dd09793b0c720d3b607808df6999c5f999cfe92f9f17e206ebe8a01362947850c5d62c565ce73c7ef4b0a7dd084fb314c94c70410dbe5c5cf689dbd79548ca985b22d0d0729faa0bc0ead8ab1d467c81b2b77f2d801c1b0884fe1b523c9fb0644dc77b8439d893b49a2630858e23b959edb984e73b6799154049462d4c435c4e9dff7d68afd47c0949c488d97bd4f4ad9f63ea4f9ffc7089a47ca409a2719d29d08f4807c5b13629c187d146b5d14eebb584a65c1e1517a44d84fa06460484f31e8f53fa3668bb597b0ba9d384e1007a624c22623459c28ec04afafdeb535518a3bfed27e01700f03ad56f7f9d93072189c3fa4e70c57c7104b1a4879746e51f4fb11ffdb1dd18d6a54d8f70d02a4638fc44a98bcc0e07d644e917230d1ee5baffd8f415f97bf20f1431d0032ba49c8207a2efd5ef3fb4ef3dcf145c0192562cc054bff1066b79856bb42a3e819c44cc8154329e5eab4d02bc908cd801d17da320b525fd89579aeb4060557b861fe6680f952ff91fe1789aac1c44e0c96f530f5cc4c39afd315af8136e29ad6d67622f6e92f968a4f37ee780e4123bdc69384c5ba206f11bda3792c93370ff5ad932324285064ddeada732b01284683d4466b15cdbb988d0941d00164408c70b6c0967318ac9e1c1106e7eb002dd858b4bc40cb82daca4adaae3d0d35e5781c7ba6fa390282f236f07b12dbc9b656b264088f1d7f6f3279d1eed33a7caa9cdca8ecd60ffa8215d5967440ab56ecb5c1dfc84e65887685be5520b04ade71524d2d70fa65a2251f4a77d5e12ae444c727a4aa1f0297fe0f1a33f385a3ec1ab79e25f6cc60f50361ca479b04a47062111f1faedc3b8c22c7227dfbb98255bdb486970194a1351f07c6e09270e90e729e978886b813f9dd886c75ec80c771000ce91ec385914458c3067ba7b98b0c3d72a6faeacad5133437211f63a0da17fdd6ff8bc7524ece3898f3476f86953bd300ce844def5d97bbbefca8704f83b4bbd4b132cd36e4e0d36eca827f43d47922da241188d3ae10adce8f1aa543aaa13b1b00702e4c06cb922cee1ee720d25ba0a661c5849a25165c32b9d6c5f22b135b521cbbec330720198b57de3abcf3bdff669d1397ee65d460c040273bf0fd9560e2bb3d01c08c4b808de85ca5998c508b0564120298b1ecfb48cfa4127ee34b75463caf384ec5077621b30fc235feb2f9a0028dd8f8cad90327860d0c3926969c327dbf0603c61cb7ab2051cf1e31296d88bd28946d8f068f1135a8ede50ce3314230ad8032eef723e6a6dd6d390bf14ef5796b4f84eb075feb86f43ae4e7872985aa5a727aff3c06e842031b546f312c88ac07bc0df7ffc32d3c4dad26db3e4af517b3cf509044ae44197b7cf3fc639be0e659e3dbfaa2de70e7762a0a548e53611db2944139c7d3415048685f07a9b484e7bc326198551ae26d25bfeb7ecb5f60e241f4ba49ea3bbe8b243fe4c7fefa36f76b200a2494583b95faf20c252e322ae80de558bab7d85fa1a488595715df632e3f41fb85b8f72573f47a47521b96072945bbd3055d94c8b593057fd762fab0557943c25fd8d7766ac7ad160ed09c3d25de6f6baa4c20de6b34718261d2af442e060f327a4067adb8c0a87a4ab7620baf3a2d0e5faccca423c7430a5cdaeef37f99440f3d42d08f47f4aadadf0886a35b6da87587dde4a0d85b20e65843f60683ee143aa6df38ac6aa37bd294c2644df325782d9a9b92f46e71a7cb85f5ebd72f7706f7ebf1793024c97346b455eed192fb0c0eb4f12c9835fdd3c4c8b4992ceba338cbbc83333908e24e58f172d1692251a66397672cf593a4259814b917cac6fa5d69bd4d165d8eda8d895aa9a9b4b71543b3f3102ff8c7dd651f3fd0e6209d8fb3e9dd6ba070f4edf24282fa6496c9152234419bb8737c3829f4bc27c3c59f0fd0f5af37fac395adc372e4f15a19b745c83909384eb531bcc26808efd8c527b9db494c9c2011d229522241d02ae3c163789633cb8dd0ead0f7bb7c5d207ac85496bd55b53e98d07bc8bbf6dd5ae122b811d4e398945167db1f8403d4ed430b00db2c7c0374323954aec7e7eaeda05ffac3075ed6b425b4dc43cb634a21153459415046395e8088ee39fdcc57a2559de42da62b36fa40e6683cbb8a3c603085be457de458c088135d5bd0fc52edc534b0755ff5a0ccc7352b73340e07b7352a6275623f4b017fd05eb1c08e69c3b64714549cc590808eba884697cadb320e10c7605570e9a6613723940d7f4df1a800faf6bbf44e7ab64d25a3ae3c7310122f27093d33c06f9dcd197872154c614e51061c7b7bad14c006ca2934e9ce2b6102e1bef019dcb0643b76b04412959c56c2cc919af57f6d243b1af658e51b6223d80527a373b51e9b0f50bb69b242a27ef2c672d435650cf0d4ec4afc813feafce8beb07c6840a4308c581c4b0b1632e6a6e519ff49f7e27989b4a8421a098fca7115292501305db6832af680935c5e37b0a92608acc9fa525a98f2d0ce4631967af7fc1c708cfc7d112c642ae2f04c8e41ed8aa6ff721c9bdc8226f6f92c5fd11c1a29cd2ea391f02c00a0aae5b280d6cedda50b704b02e3c5c6919223bce1855fd84fac822e83c545627b67b3e99a0fffe3b2df63643cde08caac1582ae408ac94d8e5db661c2c741b16c287948486530beed3b47a83c52d67006c67f61010e2cc5c67daf0726a93e8a21bf8d7d985d99d720d54dea332c9327a55973928e284a0795e2617d7ef1f0cf4fc1026464d373dfb634198ad2c1c9557dcefe3a27abe3dd9593d8ee7cce60e90c055fd4ce305616528f5046b850a7fe7e919403138c8414a852d23f04c7fc4f5dea015ea271c6e75dab902a64c1a5cdd5e19cfb38c7a2d161fd2cec4717dcea544958b4a93c3b6d3a573221f8b573e706227dfb336324b3c19e708dc591d594e4edcc6bfe6bd016bbefda2f38b1eaf680c02d750ca460065756246b530c14a54bbb64606f9ea6123bc112eecf3951ee785d24f576eee22984ca38088940a1ca5b9490655b59bc060768806f7932716efc90ef5aeec49e036875f82b93ba65e266974098315b8e1e5ad5e968fc80fd4dd761be6a10bbb092fbd3887974c7090f4669beb924911c8f86ed6643cb61e3b64bbc463218d12fb5a6dfc90533f5ea52906e8f9be3a59f2fbf195cc4a73729a96618dcb954eccee169faec921e1843636b6ad8f1c2ddae94391cf746dd10aadd6560788d6f70f45cd077bc74a8b2f744da64e7ebc7c6cbb1d75c84b3dc825040ea6eaf21e575ff1ece0d38919cf54e26455ea885d1b64fe77a6fe6e724eb770488428f2b043134a20a7a9badbdbf34d6025b2d1cdfbc313c6f7b6f6ea966ee3d2d524c0863dc20356fd9991913e37b49917363792d767c25f9d8a39564e791816f6804088cc969f35bc35edcb99169cbce2b6d01886ac8cc9a2884fc0e6ced179b715194959e7909cf175f2e16822f641b31a26e1560c088ec277c181a3b699b958763301f6a824d29c673eaa036e11ab9b70216a836054afaffb3875a7ea33e3b8e0f37237f32633a6344fdaf94e42921ac1f99cca73b5632c352b903f612cc8b1863a56a4527cfe5a24437a9e9347ecc35c6e4e92c45f3f27c138bfd310687aa00947f10","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"fabb35447d512b92802037898fe9a3aa"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
