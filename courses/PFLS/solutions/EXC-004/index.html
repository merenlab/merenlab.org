<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-004</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-004</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-004">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c062f2d92c2137c0ef1483fd773a3283843aa83a918af723abbff6660efea9e7912351869004d05bbb6fae220a474a96ca808a5ea01949ab6fab0c4cf3d731a855091e8ba58bfeaa0fc1560c259f9a9f26ac79e820cf64607c481cf803788120f39f8fba64ba7659059dd257c500f42e5ff7c94095bbe94216a4bc424299f3ae1e4b4b684655cca1f163fb945754737456e07cb9a345d383cc4db872f6205c5347e66510313780bd90c52e92fac16a188763bc12c19e778c8b8fac9aa97323a0bc1843fc9a96bed4f91e66b7f4c184de8cff51c1232160799752b48c97c5060d19badc24cbf6f65ddfd3f3d615c1dce66f99e19148938eeefacce33471a54703d3a1916735ac576ff699db2358f76ca4cd8db195d6aad720e268ff791006c7f228efad04718787a8d6eb49bc776365b4a1bdadab584ed22d611a40ac78c63ff8ab623b698e0446dfa221bb72f5f0f6433a1ed8719b23866346b384dbca3736c7bacef42b98ecd70a0229441ff149b7f1579cbe6dfcd1c80ee70ca6710740562cd9639f69eb59a916d38713bf25e3d2b1723a208b828e1f00a8004a595b6980d85166c96ac46562e700813ae9a7dacbca838ce6ca96493c3e266b1f9aee08e707b1578d5f14debe57ecd16353405424828523b60e82d1e9e02a20635f96428d3a575f8fd5d8064e3bf7ebb2f1f2e3a629b77119c1341d67416fb9d9f857069146347cec7eddc24a0a03172cddd261b15eb9305e18f269b92bd0ffb0c974b20ec88023c2e2a571f342f0623a8edc65bb6e6b1b7a10e53776c92d747f19e7dea8607d4674e347eccfb9e4565865e5785aa152c412fbefbf6d30703efa8800a1ce45f360d6039720a47100a70c03248c3f22d68aeb44b4b6e7a2638882f7fb14515a8d30c5c8a2825b812baaca2bda07bc33cb2ed9c157716eed3624d06b8ed3bd8d4dc5879420a07811f74d0cb0b5b9a80f284681aeec82d2e5cc265ff0f30847efaec283e53f606d8383784d1990de02118fe2cae5f62063120f0764e39906a2021169b382142d389fae294226710a5b1c3341b6326088e98a267532e936fe812cf4ca7c09a86dbb44afd88776e26c0823acdeb2f9607056b7f323bb6405c62be0bb8cdf0fe9efe5e2e6b268b5e66f743c097612bcb09b590c7e497677c59648029aa7e6c389e8700fa5004c9179b379db8b326061fb99a75377974cec734be0240a374f43c0f05c017ff7d448d6c67c730535136c3533cbe14e1edcb45e5e2c7db5432cbbf1e0c73b37695cde9d1f58d24e7cec285372a69956f7359d740e98425df4816f6710d2c45594ef6812560e645b97baede112c0cb5546d18701f3d7684aaa3c0b8c2c80ce54e604427e89447c6c34e0cd83bede69cee054945203dfcf1f3725a11fed5972ce6ef002ac48dba58d6da725287eac8ae6a8bdd3d030e86707b6ccbda8012bb261acd48b6e4bfd046b0ac866586a7e2a69dde415eee67408f0df3c4395a3f9af3421489bf15bd4aacb20b9f921f61bead335193734a2db29335f7b978959ffcb6ee6eacb3492f0ae75ca4d8c94786583a4633bcf9a4fac1e939606a5c9ffc5d369d20491062a10135232ae34e77f234c8b1e267269aeb50bd7b4da5f5965d4c8eda49e7166b31c6c971454fd77182581c4fbac982f6c4136e39ed91ef5eaa5210484eb3bc01e853ec6eb5131666a6d8cfa4118d61ba50fc55fc7bd1ebc5fcd725657030f7d7195654847fc3c04a8b488da58bde518ff9c565910939b5c873440f62796bb2bab6b7b5461db1a10eb381c3dd6ba7650dec2b7d39de83ddd39a6bb231f4314c9bdc39d11b58dfe69027298068af40ccf2c506249648432fc0c9e3bd12103389c1a5d9fa22e0bc8c128f26ee18cd97590b0786e76e21ca64c99428cb97f2042643700b23db0149b9f0bd956ae513f4923392d473b4df99667ddcb271a7446196c3596d1c4a23b28127953cc77993792003d25c7ad3e27c15d34d3c139578d4f497e9f80e82abaf564233f2b950002921c259ef73dbab664521b3d48693b5e65fc8262031449bd8803c58d9d3e4299c756ecc838b90f377d13d6203e1224887cd95e934cefe4cc92b2b99e82aa4d47f2a09e2117cef59aebf47f8854d1ca826a1a320e9ef1cf30e0a5afd7fb158304509e71fcaed080420db667168fe30b502667b620326d724c0d2a40869220ab05f34688368d0c316598ec8bcd6274d08fd5e617ff3bdfbeaace755e2ff03476f978f7916b49ef2b6ef79ee8d4668f2b2ddba8ce3b46bfd4171e08ad84c7dc3c3a9ddb10ebccacee4cae6cad8f384132086346626e9ffd8247d5fb4c54ecc961d6c254a9d94ffacc4e0b26762973ce4f60de8655607b51becf4316102b41ea6b35210455c4fdad3aaeddcf6c13f6f47eacf4105f0710a809011b811101f32c785294ce05c14f1a1b40547586807ef195a3086a8005952891ca8bd5d0d50a35b11b5fac4458d00e6b57abd6210baea378c0498265730ce6ba1f5259c063be2f0651addc1bf2e771e228880bbc62915979b1a02e013c6658e8a8e60f77bb9b02105497dbf624912007817066c5f81906a1a2e6a78d424a75610a5228f2c048801a566e31b8e866a9fb32a5e49588f6b0317f2d907cec198bd56b9250e73234442e453b6258809e34c7e3b4c5efaaff4be1aac93980ceb24a93ef28947277c551bbb6cc3cfd97c3fbe7e95b1af6befe877b7af68ec26a93f38afec354a2150d3bfc6916cc702313e60f9364233a4cbb74f195c93cf8dd06a571611707c8586aae93c63db58530a729ad61d4a5628a3524837b9d22945288930b64046cb930183f1a8083377919a80fbad3664fd9d43291f161801ac4c7bb703c55fce72221ca60854ba98df02040437e77e475d68e049a5e3e08d6fb637b4226ad5c31a262be17f89e26b4c2100aeab5545e61b80d843695b33363be39b497e41bbf88e065b4e612f75db3de26000d98d13d05dc7ebe70be59696293a127a93c2eb6d798265f9b7e6a48197372a441966470c0efd0fb9035a32136ceeb9168cca268b2be0e02338a7fb2b3ee6d345148cb969029e905782338e5811b71dc623f65324cf6d60c4ddd295d8d77c8b88ab5e11e72d7ad11e6612a40908c10a7aee71e1f22f45723242b52d4786bc1730240320996d2c2600d19d80659652e3fde6db06e1d65bc8ca0b876efeb512d86982c6d6bcbb3533ef54ece739a26b51d935b5731358d514a86af4ef048dca6363c58fb4d7d8960d8b6919c78d94492fdf35fff09882668f6a05779f53d72abacaff3ba07b79ed4d9b95014a708c79ac0d367f7e2a51b8027d844f3ea0aeabd8e18cee91f391627bf4d5174444ff3bfbeb67620a2a102023dca6cafbee88ea46aff413e51ef6f5ee56f8e76f311e446fc62916770e87228215a0b82fa31e3da86427067dd1504cd4c41d8da9ae8f338aa54bc54dc8c7c11cb70c0544a152b8b6c0f0cdd67a101015fa586479c259411a7e1e0df7eb764a5f106eae5da8e201a6f9fcfef6f2844c4c5fa4fa686e97091365265e77ce82c152b416573e80478b5577f3bca08d226e582bf7f15a7614fb6a5b84af65cf816bb9948007800af3150deca1aeddf53973371f014116037eb3e222f0f90b3544456c59d3a0920de12f152763359787191428aaf874cdeab3678ca41b360ae54385cd28e787ea4911c39cc416796fd5d6c52b1cdae2c7b681d91980adf47de1f7216bca8074fe7831de2dfd48a8709a9b3d5cde4162087c29fb79d4f59d490f4a346c4931fcc5e6a81a6cf39aaf7c75f711f58188cc51fca01235f787fbd47a0fd70b687e5833531dcdf3bc668ea3f268d8daa1905005f0b9495b6f7ed6d0b36c0cf2e126f17ab8ef844489fa49d02d5f594445019e59dd670f21373a2421baee425532df535b9400e3940d15424ea6078fea9a181a19a8bc8ca610e54f84534737d289bfa2d4ad348a80a3ad02faffbbec56137f830737222e0f1a8b183f2cb7327210d76dcb6e177606fed22aab199cf0f5292f7db2113c534e64d72c98b930d78175bbd83e4c31e1a2451be16b5496550e324bd5280e10e7e29182f3ec9277eacd66dfe171c64d4e089cd8ab280fa967b9ac06251c3fc0a3e6afc78c1c36776f4b686af7be7dc540496d7c1e1cb2a382ffb86bdf8904678b25e8909910a54bdca0624ea96c94fd04d01a1ca1b891bb6cac8ace639d2a601553a91f09f7409cf325bc8bc158316a7f327bb2447c8180691cd9db09718070d3eecdfddc0b21f56015e337d767c1d3f2715ec88f191c78a8d5338a900cdd4c3fe558e1b8d360633707a2ce4c2644b646470b1ca973acfc77ae9f30f5fbcb30527e01ac3f3b3469296afd72e8815919371187be1e7fe4bf39d0fa04eef7fb3bba72d2820a791c1c2daae83e7567fc2fc5f25b619362ee0302335c1b187716eb1b8cda5bf4e7074bd781b1a511b9ec9e4ef6a0e5183bb6a73df12f33e39efd4ce41d0ea8226df62b5f1edb922ff91386bc19116196f54cfd853d224ba1b625f5eb30d49493f9f75c40aaf05b8ea34f41d0729f175b79aba68e9c5ddadba4a7efebdb47536bdeb18510ed1d3373ec9e3accf780af6f5c78ee8bdd055f865e9493990ccd45ad9c481ae3731d3d584a3113d9517cd9923641615a4244a8cccbdaaef62bf3d2979c83059f5e6f0c5a30d5e3340812addfea1ee89188ccce2311eb8e55d298a8107785d7141d54615981b1ac6eb0a2011a2ececca41f4457816ac3113fe055566403de880495789568cc681adf4966c0a4bc7c88593e8053af5cb640c6bdec4788da3ab9a1c9efd54c2fffef4f32d9ffd1cd40098cc66702cfe7379a808412df0ffa5ce03065da4fcf7a1ba6cc47dd834ff1473eac7769cadccc9e5e721b5854bceeb952f5c79e4e036fcdb32cf1e90ff7bcc10415c2523f96f42a39700d2d9aa5dae660408505bf864c6fe48fdc78adefc98e8866b254b0deab499a5aa6483ba7758c4a89968edff207fd1244c54827d156ee2b8ef8b6d578e1864969f08a66ead7dde9adcb68d0a7dc0b77551914753d0964a5959f36bb542d8acd3ea8e95ccd32354f578860a68dbc35ddcc8d3817907d32c1f924a70df2deed2c8870be39a4cd8ea4af9494ce5806fd800a4c1006f2e7405e003558fb192d225f9ffea7bd71f663ae3b193acb16cddd3f473edd4a735b469366346f64ccbe123b7ec58a0251c105d1f0bb18527d910b3faa0aa8518f088468331bbf69fe7050676d3578990fbf321df9f37f0b3804f3925c039def52b287c41af3129ba4b4a405a84248b27a7a6e353cb1a927721c0ad90e7a88de3efc853c6d50736ce874c50bcd72b1551100b64697d7f21495c516485224008876572caeb9622b72383e6aa9255c8857435c564ed6043ca01aa0c4494afa82a88e2a4e85ca17f1b38b5de3615df491201398cbf1f490cd03d46eb79a72b66552815b0bb7f19677a2aac6fd6a588ccf6c906b44cef8c3b38923478583c4fcff9e5856dfaca8bf8ab698f1341901473b192a5772ebd3a72653e8cb5a2eda7e04632e898a7dddc0332510de574e72078cb122ab690babb67a2a9aa135d23a906f758128888e5ad76be446b1efcf51b749ed4a32a4cdf9c131ba50f88baf83a9a638c55ca4e0a7dddf39cf50fa4e13d8cbced8841121d467bd9410b146e60747d53252253ea93a18e30e91f1855d5b7ff898c2b5956f17eee414390fdfeb90b6c19c650a96db71537da245b9e8f3c80f30315e361a07eb39a3887a76f44bcd8cef5288b4337e4dc777e8a8b51a1ee5be950455e58606c15972e00524806d888178cf52f9dc9ccf630c35a32b3a3710495379ce0ac1ae844fbe2e34d73e2c4d3aa4b90c2157a3b46752e5ca0c00b08fb829d0dd83e28662c9f993a974b610ee106809766f201c955fae7b238a61cfeef9f79209f90e63fcdc9a9242fefc2dbaffb3d4b3be451132ff71b94639c0176142b296d98848d4b7ca00356f6ea744b619650a5a4477c0b6a0e67e2a95ed7fc41a07418df1dec6edcb3be30c76160d64f4fa303b3730b8cc613b5ef7e4456edf5947e4eee4edf825d9f83d5a2a35cad4fa378d890baf712ef6485bc8077f65ba44880b31ff293e94068d1ffe6f468d3cc3d792c3245031ff61f93fbeaabd1a7599929640725a5c94a83472c3115e986c0bdbbd2abe2a48021ea8eddc408990825b637c5a92d6befd008a5dfae6d4e9f19ea9c20988fdd39559582242eacd3fc25fdaa9be70e2df070c2eac875a9928c92d3748373c6971484f0d49ca785ff1ab97a7762b3f12b820a6ae7cfe73465f420cbc26322d6c4a03f4db0620027bcc9596913284a37ee843807ae1ae77a605d9a55be013c7bd4fe4274c7f4a274e9584caad66acd73850118db0f8fb31bf100cd525a4390d94bdb3bc509a962415730074d8011a858d3655c8d68068ff7b829fed91680cfb85923aeee0fcb86f4368c550f93c67bf549125903beee71329fcaa66e214fc4b3bd43118d4671936306f867e9e7f78a94adca14d8b35cb0c71e9408fd1acdc51b64920082b023edd56214dbdd424fcc8003836c3eccd0d50afdf537e5bc820a70d8d8874e1b7d4939e70621713da5194218b46f137fc5f4547263de2f6b24ecfbebe9c4938490eaca64870b794483d3614c487b043ed9843f9e65c33323def3221e198dafe1734b5ed1701ae884813872f1422fd1498d9eac6dd79b4114f03074bbd45863a19a8183751decff5c6bac8f295b87e0b26a5f153e422bba10024c39becfde62a9ba054022e3d129a853a4c477c49d722b513c9c9f928f8f1db6bc90de8016f39ed158e91b11cf66a006fabe1117d9a1fca119bdc47929209151e67ff7ed2e5dd13637a4f06906b2f839d4827ed9bbbfede390c4eb7b5bfb7320ccd8c7331577806ed1f547149573c842bcd0c6e94fb12839c6169ea60f87fac955eb8c43f2ca94cf0b7dd9c07bc6fc0ff1e518bc582169cfff904133b35b071b8b1a187641905c0a043e6a3f2baf2b9ce4676dd02c0cb3289a923ee4794f60e5a2a3ad82aa4fdb9ab24c3476ef2ffc0a437b415eab3b1c760b0689985ab1bdc524a90397143a3b43a99009c534177a61eb775f0bcc4c34c8a2d1f5bf287a6b224a6b768c2beec0a38309654d3091b27a33544d4b7d83765ffb29f450ac63f779a341ab2f43974bb35987c6acf666dd6251dde744da5b0129e0a27ebe5ad858182608a10bdd6838415dc5b57340e9c833b4eaeafd41f3b6d1f61aa5fc8828137f53ef678c7d435f9c81c4c9579f47e36c6130f8896ae7a7f7c0b5afef71994f65450acdabdc34b63deed108c537186df05258be99a906561502331ac942294c252b730f9fc0746e933e7e4a5a17a1c920f7a3b0ca8e0dce057ee5aabb61aa0b6b6e630faa12cc615dddc64877ce1ae45398b5583fbbc3d5fd3ff25dde97dbb7b042c13b9020b9f344d83ec1473bd6fbe6b959aaa214b8ac871d8a9831523fc9cc2e5db354fa5feb74cc4975cce6de44a97765f4e8a814016ebea692205a3cf22e0e24fa38251e201e2d7fa348f007fc345cbab02b3f41082215c7bf9b5814c778b5d77bd7234f83a3ee57a764acfbe94cb42e823f346024515625f770ba552cce2ed33f9daa6c02cb335bf8dc7cf071930f0b7707b807c18bcbcb0cee9f7c43c84c44efb90b28986be802e0fe97088528dac11bbaff6077734ba5a4755c58c4709d6b0b6ba15aa3a78accf424c98f1650920ced58f003d13f2a3022f297a859c36f8cd312ded3af004030aa5ef8f43a35fcd3366d51487c00bbfdf7ee24401ef81eaf03b1ab6e6810de5c101cb4aea70780bba56bec5684dcf0cd6562bca2f2a81575df8bedfdfb1159d76e0fba1662d9fd1d2b614910ffe1bfe73b2a1d504a72a6ffaa49c13274930d03e06af1102227d4a14163c571a06c29d304fd50759d762ac9eb28091aef940ed2fea2aed62b06f0aa0ca83053b0e9922be40214a85be41342b884b6a601fc1e4e6516e33bc73d2eaee12a7efc310f31a507892a52e779753c0c2adde8d3c1a4fe648dab754792d39e7d76e1f6d01ed5c31c486dfffa8515d42d50115e37e11715b5dccce265ae17f63308171abf54bded6dbc27b2af50878f83a9f8282bf8028cc8aa54531b152accca7eac24cb18b2ed84dad19a577895e1121b4994ed7031ebdc8b65ebd651b0d00c6d652acb57bee99544c4a0dba523cfb34d26e5bdb2952e4f2005aa0aef5c66bb4f89f8b6e57fae4826cb169ab475519d47c7847dbe811027ba2f73860e8fed5af869e22ffd25c08abf3740b8e962b0538631cdca214746fa9d2d8d8a3abed6578bfa1e44d813724ca5dd8cf4dca459ded79787322348580bd70c2f1670a281ed44d0a57082f97ab95f6fc2c56712aad365ea12616d71b30230f9fc217abe9b6e56a0f1aad06d49fbf9ae24612ff076eb4819b0b0732d6cc192f43f123c6d6bf0d30a243244dafa1dbb40ca50b63a0f56641c055d7787f07cb58a448fe322ea0c2c145cf03f97ab221b75c3228fcf29564a4727c8c52e744120fb6ab323a54e418b65609a832a36fece4272449565fa82e1b26d4cbea24032dd95bcbf9e889a83006414bd6251b4f304df2d0290f9f72038f9c5ff00d47a44e2d5f12068bb5e82c7fa64088da289e7b27942b7653a0b4878e6900d33135c9fb8b87e4adbd2355b6bed7822330f4865494723ea899c6e906c129da840e0fb1fb18cbcf799b686e289ac74c710c58c460c88116e7b1d2d36a3280ba8ab4edc0a863e1f6e8caaed6754b67d8923d953b0bb8217cab8662a1af39ac1683912dff5390fba99c38fe892bba229f629b04106a429695f79d36668f6686085ecb99272247079b6dd0a200630f0a400b3f75a5c4f11da1d7baaccad619a791b7f50d2375bd62042698dedb56d60e96df3a13514d12c782baa13713b73719b4063d7adb8ca737ddf61996f63cc388e20be13f6427a52e6716c70afff5caa6dd25fc4d1ff948bd79da0d2a1af806af02cd86443574d577735b47b3548a985b2c6a64b86895cf8318aebc7b5602d4f1f12b1666ef63ba910f8df3ce7946a4cc9c2bcb64bea953beca20274d287f29d026c7d1c2385ad9a49888d1101a7fa6da73b522b55afb21929d771590181cbe2777f7e6f7dcf1df8d586ec8b6c94928086788623f1ed16617fc86ec0462fe8e4b4e4290cff8f5b269dc6fe10e2c5f7757d09bfa037a5fa1a2585043a902489eca516716455f0921edc32b37b2f8d68c7cf4e030b2eb592ed6b8ff64696a66778eb8a871edf906db495d1c58ee6b8bec5e2043b4ed15113b5f4a67621e7bd330ccc878c1380e98c40c2294fc2f43f38b266ea51f6b60c0b767a2c4d79a363ec76076775510414e818c50704658991261e3e9371cb058dbdad0646739940f7e895c672c18430473fd3b36665490984678599a6fe813aa043b9224b49003b33db2bb7e87ba51b56007fd626f2d2bf024614849e0ea0323b8b32194d662c95febdf170a0f0002a8bb8688a44115c75e676a7cdd0fb5a8a4242d59fdea36a7fb425b35d855f4137e124ecfca0163938d88f899600ba747c2620c9eaacb57d6f5a124ba2cec6a1b9cf335a138c9185b7607c65f02b525e137f7b6ee6e3dd1a5a0e283d26c43d55a65e93b866744fdcdb24042e7cd8c88ff922e8b22fddd699b8a5c414094c4d98a21dac497a5303e2fda37af26d1837363a516cf98e76e20cce988d7b793a1b3b2b4a1411a008527ab353a2fa8d980999a5922ca4339e3548dbc9f123a507942eed42ac55e7278442fd884c7dc9e7c732b0a037ccf603b19eb923bdfa5f4eb120510d1010ffd2ac799ea04f005402fd3ae4726b268fe05b17b60905f4f4107402525dbbc317bf46fbdb5b86660268922362d0ba781c491b241acc712bbf5e91bfb2e5dca8f601848127492ecd1c1e47402f7111e1dbe94849558b93ca228f607618618533c26196a7cd0988d55337b017bcabe9ddd440653d0a31144290ffefd195a8b4ae09ff5b9edb10f2ac87c3fecfb0f8eb7e6d073dbc457deed3187b8c4225120029c17972953797fdb97b4a059a8c12715c8aff5d5a46fd453e272fca1ff7c0bb11c4398426b51c002d655ad12742a07ed26bbb59006f221cd8f71ed5196129327de53c1cc19df2e39c58fe0191826e5a467d2b83be293137bf9edabcb14bb708842b1daaa66fd02184b80467381387b8a1c86fc9e82666424999e9d3b0e9eb69ac75b45fc2032a2af70d084981d9ec0687bc4afab4ea62159bb9ec1203c4a7292e7f10056ef4fdd49e572e17251d98f0b2f7ed027f3ace9693c83410fb781d1cb7e1f820edd4631d7621ad234a94453680e1cd049508a371541057b092a5026b193234d78dd7e7cdfc6116a8ac63abc8e661c22aa133bdbf865e027f6ecfd1a11a3ce8d9ec7ed4f313288290fc39c78fc7014338d6eabc412f6a16098916104dbaee07dd166767321c8dfd1f88e3bca354f74f0b6adf27043cc41b322f70eed22d69e1266a7ef1bc8af153e6e6081858bcc8722ddb37c607e00ff0a47a4602fae3f013a9a829ec7c6b0828d2ad0dcfa8d7ac482ae496ebbd3e93a8921e89e7b810977ac82e82a875a1aea16f7109c446ed2224eeae7e412138c561f601dffc9518fc24aab694185cd88e60caab9f1c0cdb1dfcf1ae3b15292d06debc0b7da90ae383822947e561121b3f2cf2c37a626970f5519fee5a0a3c7df8e3f53d261b3b72df8c9759985c40f9b46f58b9a1e41339a301740a1730cb4c187e5e9d6629a451ce12edc04362e2ed0f817e6923a7ceb251277a49447bc7d168484e5a2cb168d45843a9801f52fa4302a469d2c82351cd5020bb7d1fb93d7568ed670693d00346155eac1d82c6f1c6ead5a2eafbb8498dfd52c9329c17d1c27b46916d948291e84823df91d00c16a1e0aa917a61c14d218a3eb6b0ede6a414640cdd75dc9489ddc18244f30377582180c515cdec6c29bc3f8d9858a67fdf79e287aee39226448cada6d3366a6e32d2ccb6b19a338a04ee9a8b1f9100ba2cd40f80d10afe249f1344f95282a78908e88825e913b38fc59273e65ce02612a3a5892c841ac9b91effa491f6420a124658b5bf4ce582daf37c20365b3c3e5ec7c646925f8e504b783b3a677ae137dec46854860568d67d9af1fdf171fa40127e32819753e7c5c32957b94b19dfabe44180a75f731de339286c2a933a41b3f133787cfaa5773084baa57c676bdd366e34cf2dbb1cfff7487792eed516d8b7f06f396b6ccab523043ba53d3c7298bba32c4daa5037f6d4c8d233b1c2dc3647fbdf3f76b51504a11d258c3b2d91091223f8f1199dd13cf46d5d836db8284e2752e8025ba1ca2684739d2021dbd19f44d438a63f5093b9358adcc413a015e8ac632fd6c505d1fd25fc50b2e2f432cf319223e455ef7e42c04c76f2d2be04f953ef59031f75ddcdcdc9c5c5cdb0522f7b5438172b6667b175e1fa525a90e4107a5543457547215b9a6d3fa6ba9ccc710575bcfc2d96b19669ff6917ad17be6faccbcf41c26fbd4a6626d49205de32f53fa16277f5a3ce22771568c883ec838cf58d3f81c11085b37af0d53245563c4d0e251178111a225e43b428db74b0147280e027973c1c323e6a145062fe01cae05bfa75f8ee1e49ac396cb7ce466370f17a22c59f233fb16028a701d243bded109bfc0fc6b6e08afa71c5f464eaae8645d4a52ebcbbcb48dc11adc7505b971b41321b39d495094b04009359e347120964fb90edb008345684b83ac3dbd7c4a3661d644b0983c8ac13fa42473a77dead6649ae6fa729b08cd329efcf102225e9129c036c9cc359dcaace0a436fdab132e8950b3e509596c6445acc8d86cb13c85809b03982c7bf960b30e2f1c8686fd3696c8fa5776e9c09f711c43282cc947a4d6498c16cca590e25d7344bb732f5f3407978e2d53e0297cd896a6089f3bf4c54dc381e4c10904a2ee79cd251f9f0ddf867413d3004f451e37fcfbb9043b02ee2887a7a8c4c63c046acefc6719e05245d43aa0bb3470409fe87b623fefbc5bd14c202b0a5c87ce8808dce14a8b0aa0c78aee00b55f495b60e87150adccaf4b663c6fcbaaf5bb19f342b88754263cb11d5308bd4994f620797da8ea6e192139066092a2fee1489d747554ccefc471900dd8b4060afbcbe11ccdc8b8abb0b7089d7e4d6e5d8dd4a76deea49f1336fce71a56eeaa2c706f1fab2be434b115b92ed8c80ab0ec6a41b3eb712f755ad5c56d09e703da10bd27d15897fc058a76430aa15917027479806e2ecc7e1bb985682842ecad838ead7cfc596403dcb975366325e79f556f2b386b27a5c7910161336de1a7fcc9f59f22b2bc8cb87e3db469612305bc0dcb7a84a9215d2192b4d15cc3a4db93ebc6bd69acba8ddccbd2d7902acfbfc1123e9e7396eb4ce179a85e9a9983d5be0fc3c6f0f47ae4fb56e59baf604348db0e3b94954ca59a0fe4c4bbccf4283c598af32f4d5b5feb0da23fd2b0870a288f0f6f79560738d5184f42a65347d7384ffaadb7d3abc5ccfcce46f89be9d4f86450965d3c853323296588e706ea9e74e124a7926ccdcb3bdded794928fb1052711df57410b2b21e38e885e3ac64ca50f6c2af043ccd02a9169e68542fb6edff95a7f977df8fa6fb550822e7faf8d139940f98faa51a53acbca758a085e67e2beb4d19635f4dfe4ea5d41fe60e354788593ec0db7aa9ebc989979bc354725fc874483b3089dde35a2aa72d51fe99af239f1b5312bb49bc122e63af568e4ce932bd0eb2997ab1804da38f460532c9bf0eaf07fe66d98a6b5408039dc8f0b993873fbfa969931625480d3aeaf442e4edfb8e271b83710d374bf9d5d587e02a82eb9d9eaef174cbd45acc792c3d732b11db79e5aa8fca41d5ec24257598471b498488f65568d779e0262e0d9445d225c84a177c6ed7555d3cf54a844ac4a137eeb783a1ac6453120f14ed8d73da92a8a30199ccb32bfedb7ca5bfe1d87f4261cca9df4738559016a7fbead072d1668a61c987c381702aca5f4536892b9347e84cb0eb7d6033647f2d746655739568e9419d285c7c3927fa1d6a0d5fef2105e438f797e0ca70a9cb957ece3fa8c67683c3212daf83ceb7be632feb64d9c2761e956d7d4d9404509016c4b337cc46bda2d4c97c2ea1fb4dfa7aafb637bfdfcffdab3a675a47fdfd68a528a8c44c2a07ae284a3eb1361f07024e4b5ac720bb27800afd9ff10c6a4250744f4e70652fec3c391c84538191ef8e28637a7f548de82daff70228b686bad3e12ee8f4aac153b1de012b08f59d62eebecd6d8156fa8f5760014c607702a182217479807143120278d25c8f61892e2b6a16262db16117cea2198ea32cf252f99f9974861afc8965a8eb34ed29aec5e0aa9cfd4a50c5b4953b29f81f5b0c12f60596ad6131bc454bd365baeb4b69430d030ccc2d0fa3bd445b220d24b3a2f37d57f9dbc35da7d828fe1deb7b4893bb02bfda0e6e8990bdeef0b7b672cf3a07187207f25ab29db1943cd5ecc199bfad2c4595cd27dd3dc62cf0310c760155e85d26d9abad2b26d41b29ce88f47414063a2b09f4e8cd476837565314817c5adffa2852e14ba2b5a9ec243d3282f180490e1144ed46852b268f477d68a1588d8a1561835365659acd91854c3ff6913059f706997318e10ffbacaf3884a5990d4a87aff6b7b42cc96d5fd476a9031220a36868052f9024bad5e67139723836829b753413dea620154d159cb717a9bfdf7c29b3ae1730179d6f9614237f04fb3d1ac3130b629db1f76a05c869b4c8f6d92bb49f8b5c553122f71a624f811c89cd2e388bb5bbc5b222ad80ad9d2f38c31be7345204443e95eb9caf6b5623036c398ea9fe7a23d77821f2ccd82ab7ed550c043a017cb6811590648289d5b4fef9bc45933a17675e0349874eed4b754d7c0212931e2947fe95c7fe098fec3f96056db4a0dea348abfa84b4814a6810303b5bf07d08463b97b88716ff19ee005461a5317579d9785f613b4118e390b8d30b2aa53f77683c84698fbbf8799cce5fdfebf03afaff75a666181b06b282b09d865ccf613f4390cc629b4b9ac99b33d379f4162fd8a29bc4d8660c4cedb942d626a6056209a5cd6baa6ca4e6784e3ddb7032a4b78df6834fdf08fe6cc0562764d18f9de5484eb88a624319f33bf32ca0385c789e34171ac843b19eb864553b740a7d754ebee731f399a8c807ed277184f83d005be63d4a2f6aa05a078cc99aae294f1cbaeb9ba52aae8b6fa1ae8fbd11b6a6ef7b4b079bf0564f603711d1e5947ed39d51c7bb43138ea07010409c1e6c76eee6fff0e69dcb540501f8800576ddf476326f573193c58c9a1a57624e545abb1ab102dc3204e92b75d59c1cdc1843db9ab93248096f8d54c6756cf4ec77d1f60ab4af9078490e152a49dccc9362b0ca6d69a4a84dc18e707974972e03c5bcf3bd0b8751a1e9ff07c7e2981b5d6cf7f071122a6baa0147249fa9101532370276c6c4045c12f2cd5cd4d476877a4ab87d097ef96ae1df284a5c12aa3092f849710eb090987d95182892c38bcc5ac2a15e714c4a0d751d712d2c2f98712a21ce0986e8c04ab0f475d227186ef4a7ede87d20de865baedd57423fb79786982e2ef12da1fd658b7ba1954a0f7e6f562eb043371e5c36e3fdac289dc5806d721fc3e8784079bdc01924d38917a745bc0115c2687aa8c1b1c85672fb82a9aaa85bc0bf2a059fd123e935ed6ab3e5dc978b2c5d506251271ee67fd94b54ede368da30df73ce39c17b9a5e3f70b5c0b52f11e81202a5ca58d408300af28f550e19ee1cb214772096eaa3a2a48be40e23f536153ac91740ea51035ad4cc2ff081825d9266c99e741233a6c45bdf06ae038e82f9c6881b3c9eead34175618b594c74179db934dd14dce1ee59f9d5f4541168997fc92b06019d0417e5319393a7c20515f3cb82a591e4443efaf832d88de23054ea61674229eed464af336b7523ff7d63d8caa38b97319767c46d44c5e15cce1d9cb0125c9f91fd641e97d997e7af8e809d333be450b18c83d98ae996bc675746c95ddc2e24eee4f50aad003c555fff67a7778a275973ef53b4aad2798fd63dd32d076239c4af06d69646b8d472cf6d0e21dab05bf7963dc5d5c481bc5a9506fa71a0d5d0d53da5b2067b265657ebd307b5a2085fba5498a1f28313c76c26133babc6ca3057d630877778cc7676f0500e57f407346b3737df92a8bbdae76e41f258fd5a575bbc6eb7566134cb0f7d9d71097c3c58c4ae1555b55c72f063ba613c55f20d7f16032d461e5b31965efeb5f28b355dbe9d9f5f92bd60b36c622b9e6a3181f63342a658aaf506b5dae25139962984c5ebd3887542c80cb7ad85d78577af71e257f72b5d185f40a1c4c1177ec59dca02b2b956550dda6a7cd38b1dce2c6a7dba02f2e1dad430bb5cd17b51502b08246b018e52c76c90553aae0fc36ceb46f80bfa79d187549754501afb95d745b36669e5073419bdde03820734b21103f6420165d1c102c7530a94050564ab94c0c5a217eb1c4aa125ad6f884de6601a99e198f9e779640f10726fa30244913f583c6f0a091b0e892927b63d7a2c14ac16036b557c40243cefb458199176ae1fafc893bd67067c8bbfc41399a326d1d45e76a9a97e65817d17857eb85a758e8df29403464c6eedd82693e4f1d6c1fb549f24469c4411b19746a2119e0c3a9f1451fd1adde64afb0925c7520f00c3b157af247857bdb376786ba1e1358703ba5ed67dadd5245dc09ff934ece9622a0f6948aa5a709217a6e78502e0c1cd674b1ad36a9936da1bc53baf928b74ddc33765ba898b8940910d8a3f831e454df5ebe848fd5aa6be519efe96a5a9a3c58150b059b0257223152ff17055f9a5b225082e480a8a828639cecda4613d6911503ab1a2c0179b8869d647b37c1b5ae4f30d80ddf344a898cb3dfa196fb8ab209ae987f272bb3c78d2238b27bd07ca6f0c40690b252300791f45e5f40ed7fa0877e398b89367b93e6a98fe19f0fc624d73565c83802f5e42cca82e766fa7d9eb2ffd65792b5d23e4d012aed9477c67968691ed486f8e12e07942cb9068474b3dcf85dd65267d41fa194717522010d7ee8c43d3e95d3061b9b89f80191931fcc7c239c480bafd0a20b78901c5994df7976bdae3c07e858e3fbef1be1a003d1a6c5b0b905b01cac3d8260e78036e9cffb3dea492dfaec7499d72870e15685167237852766b89f0d03ac37f4f8829c9ce1918ed9662eff85b1030ecc6baa35787a3405c9e2904074838be7b92681623d9b88cc64ec9cabb40375cc5223a27437a1b9b01f4f917b225f187d4fbdfe7f479bde85f922e13a75cc9ce5038407650ec725343adb83079fd7d6f8cf6f3a35258189798eba27df9fe0b5689ccc282d80d1e439f114fb7d62726df28df769aca0b06d8bc1af5115d1260107705ed8561bcd5904a766c980cbdc85fb14be32438d53f1443cb02798f6adf0acf8e6751fbadcfb5ba7680b4447f03251751a8f9edd5d24d71153cbb8826177f511279dd68f546c87a30396b0c35cf94c348456a52bbffcf465f3e924028f9304d3dd9f4f10a24d2c790114fcd2c174b78fa637e6331f6fcc97eee828959ef77f6ac54b547763a795500b9cdc348198a1c1c184ac6181189f21830246c3cc4ef4ebdce028917e8930c36a410e2962a842630fa9a2328cdc0fdf6c11455f2aca6e159c5eefca02a5b93d82b9c4010e4cc26a490daca7a3120f0980659ba506528de31acc5a23d303dda7930ebca13199cbe91c985990db468144fd00a2b9d5b5651d08aab99f30e60b4b3033fed2074d2e2c5297cbbe581ca14f67ab4f8a9e9cb55ec8de17f283c640b88d3686dd67a3c089162ed1fd7ee7a7ce55edbc42358c7de690077ff5f7bafb70f9dd9faeb2c5edd8fd64ff27049bd923c33ba28680ac71a04acd645f6882fcd8f13c79403fb1d9e4e741a3e8c58276b4430d5452fa9b1f5f56db227680286afdb92fdf638b6deb4f5c9db0de01168c9d24bb3095670f5886d44c0f48732e3a00bb66e4645c172b54b26da52f9b249bb144034d1c564a921827e65446c6d825edcfcf140f40476757981587422c7c1cd26eecb7232042e7db2f7284406ea85c184e55053ceb3f71d4bd08e393d56f19f9fcf86c88daa0f100f8d28a06ae50f9805ed6f99d25d3a863e6fdb4e0c3eca7e36f6ae33999bca612730ef22de496c1f83e4bb05d2db2a63355d9490a2fdd3387229dc7a924b8049520c91e505613c33c251f6c3303eade056c733ae795c1bd360e0f247643cf10444e3faddd9d4a458908587588b1a358413bcdd7144b0095fd14d81a0dc9998c66b2ae7b9665089c7ad32e82593495f1aa97cb6c4c4a3c4c8e445766021a4693135bcf196cf1b5b07e4c0cb338b9142ad15ea417c55dc4a2332e8f5b8052584458d01f08ca386f4cdbd30d7d72d959aac88eb0dcae7e9e7fad6e02319ed685055bc57dc449a197f34f55a0a3df1e4a1bcc7f5f4e4807f9f85e26d625cdc819550c9593b3a96ac4bfc74acf759608ceccb0f5fd505294fa27039c8e2f5d23711bc9b82f8aa8adaebb779a76f7b474a1ba3d3d9800fcec027617997b9fd5a66ff321ea9e6eb92b3564e30e2234b8fcf925a1b363c790442a729a3da9d64f45935aec9fa1ee1e21eb9096319c61a1f95abca6e521787168723f37fffd04a38d59fc54f61ab0625cfbfd71bd1451338a86e838db43bb2139d1272b4e5840b89b283248b9a84d37fc2633600c76482a021ecdaaf6d5030a78538a0722397de4c61747b6d613d750a93b0541bceb44382678905ca19338721dbd2a900342ff8b36dc0a77560a3273e2a767fc89af2d2a346a1e98b7c87e3105839a93007cbdee1c4d65e7e8504d6dda837c4f158833bbdef36ae8623d6620b3bbad5440b3026e4c44b46189c5552ab7a22faba6f211a0ee745fc4f082154cb54b96e73a3cf4b62853307d7d05c7c21083ada36ad71e1e5f3454a0788ec1c32146fdcfd70f54dd2ff21348900917afeb53b7e4535c29333d7f7cb464a61ea44e8adf89539768131666caccc387c85911dec09e08e55d7d4849cfc28ebb5981c5b84d02cb2746855f10ea2f512f8d5e0708fd66b9e0430bf50ec730f22b248f86d5baf57585f0db20f19c4bdf14917caf17547fbfc9c084ce660842ff24ca456141b31487825f32750fb8ff923684ef88ab9dae41e9b8d89f0d5190baf94d4939e1042da4feb52ed3357fe65c5ce7d7eb7e181cab1cc89069ae59a5e227d7f3ec6d16cc2ab6ba10d814c790a64c6960986f231d446defccfc0645bf876eb4402266dfd8e3fb4856cd818bc20d8750fc5b7c0d1f880df743aeca534716e3a4de5f745afbe14851f986cb142fd97466fa82d70a65e414185c466b94c3f1cfeb61586851ceebc115d9c36ae8e331caa53d70c777d0a637110f67c47a086af3283e65ec4d89b7797e87883e020cf5607cfa38bae70bd93970c61df93abc1a9baf5b5b76d3e56cbe07bfbc6562914ae5dffb22897301bc2fc5d7fcc9947498713489751bf0ca2055fd0ba6d05425f7bcf00090215df3e86c3029147855431e3cb91236b48db453e0a4ff778fcb480a2a4c0107c8672fd5d58ba8d18db0a448195026359c217bcc179db6a787752fc3226774dd7e4feebba487db66bc012ea9e05c558e52da2263b20e1933f5b6bb3d4a577148798516a1f265e8506d5112d37ab23c301c13f3611658dfe4b5a7fe4b32e90522b5983b3f9680579f04aa52ba8ef933a53b0fffbc512e57a9d2a3c3156cca38fdbf65fb8f06533f3773c1fbbd5b362abfa6110f90f6e2748182fa79f819e81a83eb17d6269eada4ab3f8946e385d03e390910722be444d5055e72bcfb3879faf6bd75fdc4c4d6e4a34e79be418d2e0e354d37691a4bdd2567374cd59ffa41488da517080e49afc9a71f9a3b8c89adbba1f53d223dd39399ca17a8486e02dbd2e26f99553d0421f2fa5601fccd430a53b5756f57222166c204cca993d016be99ea79f44b7b70b7a11ee4ba353f78da51921062d8f95b959ddb88a0393365c3b7610cc3b8766ac69d6d7fe2ec778321dac0a98113e361fdebf0ac1c6e0341eac60a8786ba0f4828b69537141d38b32654aea2184068c706e65fbd18e3f175accb33eb9245c23c467c0b04223fa5c6d1f093a87432e109e892c4ae60346e179c6bf5f66db14ee0a14a886be759495df203654cd63f3a8ee27cd888fdb9f4f9438b49fd2952688985e24858c477caa125226b5c341d5df9071e173d75e0e67b90f686f0dd7cf8331cb19aefe01f5b092d2cd8d5b78d1eaea64d2689bee7a098226a8b32f82bdee4cc0ae2322d3d24444ec48b55cfceaa4cc8900a6ee84cb6e4b7f595e956d7aa5bb2c97e059b30359ad033d19d7ec5c09f1cb663395af0fb71e99d9bcadbd77879b53b3c025fe585d0ccd1b9ee186bb91c4c3c67bd837abb2a5d93985f3afa56ff0546c54f035ca2a3711169c626ec19440e44b13464311496c80a95c9a131579ab51327d3b3e53d32ff8e63e874cc2b395aa52542d5382e4d101f1a279e4f63509f0ae4c85d41b7760721c716c7375a2711f8858bf5898cfd78195414798c3f0e43598d60b9cd6ca977e97da19be04cb59f1d880b72bfd19ace5263d72d77d465a956de7c34379d72a4a27b96c194c05b1513254a780fd9c4a2e20429f8d1190a0de2bdec06b935034dda0024491cf012bcd5493807d35cfe64f61edfdcc476afe2c7225041b67bc5c105e35d9949fcbd9fb99cb7ada0dc69453cc6086c90036c6707e6652d507a8ebf168eab19e448bdb8bbed6602459a31bef249222f63c7ee2935c8c020c8767d01491073fb3a91a338fed59d3b6c83ec4d5178762fb1c974b22788fef51d5c7437dc45c63e57551108d35df1c62b0e1081c64ec4c6da426d9777235c5c1d8be563bb4a77c3c512e342f2fd65f673c4d1b5ec4ffcf5f9da81f125735c43fcc6c268162ead51090422202e07c8f4bc02bdd8d08eaf6063a6ce648cd9225f0d0eb4433ee75e454f997c6cf97f190eb4c397be18cf9c7710f21b4745fec751a747c5d98f9b3683c0635c6c26156dd43b51943d79612c96eca4f601ed19205f910158f78914348b545c1a093b4dab43e7b6b8ea4a5b778897516dea38b4e5375fa29e854630637efd3dcb6b85438cbac0c74d9a9c153b20d065ddc165759592bbe31769aa775d8c6ca54d6ed15b933e9a2ac8f78e9569885d10913cecd241458b9f96c3b5eaaa142efc71f813150aef33c96ce0149d31a6920ad240deed4cb18eaea0ef6c5d95c8e7a0924a1622f5f8f07163eaa59b96a23340ee27ec7378a88bb5efb0595f406fd598218b8f14a7a7212b423c8cb6a4098ccb10f9345bf372906692d0f0b45a078e83853e85fa9526a01eb19feb905b6304ef949e4ba684ff4d9bbf33d82611db5eff9cb42406bf9a5e8521e00fa763711e599ca0d39b9cd034d0fb88cb99c346984edfff93452dd4ce66d6a04f5a0289a7e93bf786b87d958406d2185b216b8469d414bbd11a905dd4f9a192b53230ec3536a1ac1e175e7f3b626aad3c181b4dcf87a7b8fdad2ce0ef6039a3d856d8460a91905ae2df6bd2d6800fb7fbe40d16a7fb9b643e0bb0b082e47c04b8c45255f0d5772e33c7650cdcc460c341d87727ea5a5c2cec9675aa14192bfdfaeaa5666e8be10843371f4fc37e2b38a227144c6ebaed0c507b54bf2768963f96a6c6b2e2eae662e3e8daecfc9ffde9b16d757210c85951c45c37bea467f0053644ef9d23f90dbaca2dbb2b5addf41fd03c5aa4e827e48a8b0f16184991b6be1be7293bdd0912a46aa21e3a4d9cbf381f3e66df929047e07b32ca7880a6e7c52e31c57a08d0a6173dfd15de1da001f4e6511e5d3106a6e43b0ebca38a3b0b23304cbce05c5c0af10f6ef6621ad22f33424a3b17a0aa9df056d81ef518bc2c07b1d5b15a8e96a16b637b44e0f34f9381d737350518fb2e092870b57e98907d722ef855c0737f7d0d24165b79bd21438f033d4e326ab095c20cfcdf0c346c0e7a47c7e1bf4819d3a0c4e3a39a8f02af30f86ea4529851aa568eb629eb67766f1f953f83e6d6d86d8c7bb6a1a006040d2e56e1f90704934def22896f5ef41334fe74d9ebf287e0436dd72f5c774a8a14b2252115b257cf6f34851592775474ff5ccaab498dedd9164d3145ef78a548fe6387217a8d49d111c4ef4558f047646de5c1dc80f046dd08056daeff5184b70803cb274836b0c852067336316c101b6505eb621935eac92c3083d88bdc85bc9f436e667c1980e26e746362f1efa9cf34604b1fb319a0ec692873a1223bd2969e36562846b34848917aeddfcf50a5bee8c2cd200def5242e7e9418f019323faebc901c07543a9ceaca8c881b9272603d740a5b7888263ff0fe2679f07d5bde57d027312813be0d5abe5cddce20a98f052f497c6201277d56d307ecf2870083ee82058897976c60511262226817df1a11b4f08da34b85899d307568c47f0d832b318656df81d19149b9cd6c0b69cb5b3d91ce3588b5a782fcaf2a677fec41922e667668aa8ef4078ecc160d002d0899f61e72446581b3ec16bbb5cf1625a8c2b1ea7d93afe22a3922aaa0b2c6a75960746719baadd5346ce149156792db27f1396c0a7f279d5f28e812d18188c24b073ee51b0e9e521d738c2c529e466e74e8eb1a1cdccb929b151f337ecd7aa48928615a6f5132b61be7c0a198f271f34ce457554a9be4f32f904c89a4981b43d6f8c3c636a1cedfa9ebcd986d836ce2a51e12dba00c9050403ac9945227d140ad339fe00ec073b50d54bbae5aecf22583daad02f5e4c0764a72117f4ccfc3689a95beef07477083a3e806f5c513e3019601e1226891dbc72c6f2655467d4532fb99a20d6f8425c906fe75642b6fa017fd4cd653da5c134b88eeb1afd1daa4287ef3f04e99adf0f2bac74e2c0c02b9efd785fb698d2f41d2ba892c1dc580b97d0763ec9c68cacea58b39ead2c49efb135725ff7ea096621d3593dd713e5f58e40d394e0b3d5b386217d30221b017ea64d992c7415e2f6e59231241921f868624d1751f199459e985bb570179e52e9438207cb810da362ad1888fd52ef16106e8ed21e75b056cb68db9bc2552aa29d7bcf60c6d13a96b06f0e377c6400fa96ee462b119cb946a5aec7cb0c4e8f7cdaf8e77bdab8c5f2df272645bc38f7c368edd39be9d8dcac22545d2eaa10e6bb7ae926b2433339e6dfe36909f385a5a659445f44ca5c5a83351692df77bf1ee781831666999f7ab4a7af075dea96ccd94295720537198aeb2318fbe51659a53afdea865f1f876b643663d7e4220a94898bd11f03071d95499f90731d1cc23db22c7e1a7361bb2ef57e1acc9827591252903e4d2348331e551277ed34256cae0061525d1fabb0922710269eb9230a93f120ddc6abe080d1e07b3943b15a5df50c9d094569eb3cdb61e5b16a3306ffcc51f48028e97938ee354d30cae284cadaa9b786b3659319440440767a6e1510c5c1ef8842f35c084963873519497237f3a6481f0d768e997ec2d5b1f14b54e9191de3fb629e4fcb4d1c903de591ed6690955c507da03c78b27706801859cdf9b74dc0126ad9893dc4ffb15cf5eb18f50647acf7d19d12ce35905ecae942953203d006f5c45699f6350e28d6aed2b0e4a7f97cded53b6ba38c4214c24be849c7bcab13ce5e2549ba0a276649d82537bace2f3f9a274fe15a4de0e9119e852b48e1aaa9d05839ff2a7bd039cfa9a5cc29d4f0b0e5dc3e5bedeaddcdf234559addc41c4ad11fae157ab49ebec3c717955b751549876d28a2f4b5ec0eb5dda11de2802ce4933d8dd62286e9918575f08755532797f9ce05b529b272d3d33fff74530aba6dfb9caa9976ad980f873603c76f4fdb12a89640d91655ba50f1a29ffbf1ac27a0eea419915f7464aabb7ce2e88aa7263dfa0a320cea39d9220016ea62845f5983ca311f26fe549db9e963d4785fbbf56d33d0080daa5255df1633d8e76f9851d30bcab647eb4e12d88ba1ff08f63821d403d8eafceef9a195d9d5c209cfe75ebbdadff295383d112e7997016fa66c233f4af3602c144cfd719ca68627c5c3145d982de3aed505c8d1cec614b4099f6438b8ffbbb380072b70837fcb101ae2de05fbed448a234c2449c837ef66227f5edb11e544885bfb928613c6c2163296043efb4c427f20d4c74b3a2eb2515adfe910a35edf8e4f372124f0fc5c655041b75966314639c5110dd1e773b93c3222f06d76e04197a3dc18695820249c88f4e001f636b7eb6514f350c249597f506c9834d0809468df8d9da1198271429fb50e5fe3fa01ff1b5f5c25eafa80a5e1e5cc8018a6c05e33a1ddf39ef57f6e4dbdc2c3f09ca66d427d7d506ef24c3d7829610cd709a2aba126bf4186b0e64d51441b3d3d93a796a93a27cebb1989abf468c42e9958e502eb77035b1582feeeb2491e62821347b1de63868549ddf1f3e3e45194efe3492abfc4f8f36d6563fac4d51267df2e242535e6303e2f5bbbe98afe3fbfd34d57164429d988ea3c62dd990c6ed3722584b74bdb1a79a0222188860431cdd54d5e17c8f2e4ade7e08e13dfa292fc6cfa48708942303a08775e6f751744941ce3d1d36ffe1dd838fdbc98dd6cc205cddd20ffec7ce5a29c405760566c388f697b0f226c630d0ab727cf813c52650bcc8ebf1a55cc6d436a0cf19cc86a1a1652f691c64caab8edab15c97452e8484a5321192fd442b007e26178f952bcafb7091317ab291a95991e602b0808b008c2c6b215cced62a0f3b8c8be6dac972acda7ae5dd34d439deab991ee60508118d4c143d286a92c47a6e8443d8a0c157576a0a5b3034971b77f96d89b3109dccb952f11fbfde1b87cca431e2f34b9802805792e5dbe42594506f4c2fd152ab5be54c7b63ba71e72deeaf76e6c93e80ceedb9574181c1053cbd50f4e5cf9a426d95ec7245f1c506d3bed7318bc8e2367f024db45538cb32257ed6c461c1f5fbcfd5b6ead2de3b234fc11087bc79524dffa75edd21e8d4c5b3c4f34c1d9155d7bf41a68879801e5cae0423214db1f774f3977adf1e1c7c65a7a0ce7b35c9e163b651fc45288c06f6a57a7c73f549a20d0fe8165b51e2355449d9d04ded8bcfe2db736400fd4edd693553297bd3c1bff434e86a2b24a1b4151ccf6b6fb1ee68325b7ad94b2f248265487f263397938b22f11eb9b919aed01b6f7c000d175c43bd56207fbd6de77e498050aaaaf565f5388d99534f249c1c37d5d927cacd3098249033f69bdd75906434218f836bafcdc452b3a74b4ec608e2a4a790dc9de4c26dde57ecf50bdeb5b71d3674957793acee32cff7540b0004e6cd8f915a808133ea3b7e3dc8f61de90dc91a51e19081bd7e36251d2d55912e627c49eda266107f1cfbe44d57309bb9d8041a4788a8a8ed53e9e353f6140ca190d7d31c39cf4fb6eb6d08f71c642663a631fd6a7f7cfb3fbe51020f36a221f20bb8bb9554ebbbbc74dda8a2a6e0a5cc66ce23e9155ae212717237f9842761b8eacfc","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"58a72956d161e85894e8d18b160d053b"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
