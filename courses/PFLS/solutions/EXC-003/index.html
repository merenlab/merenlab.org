<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-003</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-003</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-003">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b348f2aaa675272cd0a5edc805d4c53f4d6268aecfb22df76198de73a3271af643e240db2cd5a844562590a675fb2fde5594ba242db73190d188e6071a16e09d6c466045ae36544045918fad9e3ba974bdb11cdd09d0ad45b32f0dd5c33c1242c22f7a3288dc6100a062d6f2cc2a97194227150fd1f37bfb13af7b075d7430175427a6834d5bfd9f40015ce19606b63f0a2b2fcb9828fea273e3ef72ebc134395361932d82cf9b7997003dafcc5eb060c2698e3b71f9a2e37e793869381172be9b7b5f93f1bde7844baece787fe3d8f5c5496418d09f13de3b660a4ed640d388b0185a70c34f0117757687d6ba5271d4abc962fc832e0511cc6240f20f0fde22e65e75c3089808132d2e1210cf04dcbd7342c1cb60eff928681c925856efe713a29c31950ef256a62b9ed22c715718c87acaa56dc4ce69c03373eae731d1e3a14644c165a17d98c5d163a55e8be8f829843a6d988489aabbbc64ce3527e653c4e07983f70625004c15974f205c91661f59217035d6f6d9bd58e0a6218d6ceddfd2907c04db39a21b9db290dc55d7ced709932ff34c4677a1e41496f1f94137ec5aef724850a525cf02de6c77b481d1ef9b59b0e919207f30dd1475287e11b472d3f02ab33537812653bca03c1716d8828023ecd964eeb203ceeabdbf6217af58d5f922baf2b8aa997266061eb2234ab8a06dd23459aa4cf28dee767f8b983b51c4fb4ed26ac702f75b36dae7054eea4b500f52290b95e7c1ca43a7fcebb1f79bad081956e10363e4ace66c07bd416a1211e612b045af0ced68abef9ab733c094f6d4ff1be439d7b62d281234f73868d36c934ec6170eb92665d014af0fa9223b6fc6f901eda239fbc0a806b4300bcb06fced40a560a0a3abc871ee593fe4a853238a703f066a8c4f7870c81a8a6abc47542883578a276251e06d1496d0130fea15615b07a498091b67304acae062874dc181d3e277894a9caf135e8475210ef5916c463523f35b7d6d5a0b0f35c31441efbc8404b7b79fbd87681fea2c9e9890180dd3b0d47d11ff4d048652212dc95a451ed1611f70bd8d2fa025b974b3aa61578cde8044f7e39ede0625c5b3f483be8140a8820621594a4a0ed7728342cb2a8a9e0d4febbd1e9acd0180a795a4c0bf83bd6618a73063cd8cd07b5aa0e9e49126996f6012d8a80d306abe8b25eec87d6feb61f2b55f7e7f03f7829c2cd6f03e58f7a16323cd4138b81147974fda07500f4426d6e57c1df75ec739a59bf27da29ee70df5186f7a369f652f536f23d36966e289c23c36e345580a9fcab2e025aba74a158042306eee4bfada9d35114608675fd94f4827c0b540f2a24907d3f40439dfe4eb3f290330f607dece6bd9825d87515b349602724d11c0efb8601cab5e02d04ece5d38c788fd76337f6ccbcd58a8db7ee14c1919a313939ba8280f5de2f8e71cb2309e77756ea4f0d3e08ce160b33002f9301167b3888ed4fe5b150e34177ab04872e81ae5b5622341b7f174d053371db666f1ea29baff61f33111cf96cf08fc2ea5d6de9ebf40fdb84a1703eefb76118dd717f0fba7148bdcda4497175456e84dea071509ad308ff47ab4f8288d9e766584c8511ea17a2d719df042a6ca01e1bcbbf7523562d4f6b37e44bfc45769f7360087a16549eebfb0a70b688b1d49d69177fc9fce0825b7ca93a1874619f4989aae35132da9e1564393f4f19088a0cbec065f9122df89560a1d7ea44bd04e05445a93ca76b160caa2d26abf0fb56b8b620330674a476e7a363acdfdaa4a40912af789a88c9e357d26d790db7ef1da5a4bc29d7e746bf9a0aee894b1cc263941a397dbe84b77943814ed1b754b93664a9f1b9e6d1783434c5843e642991d79d6805765dfb10fd56a4a419b91a6dcf99267dd608fc2ff417b65cdc5ae8bcbef8d154ceb8435613c7963c974f3a6d36afdceed1f948208cae527e74dd77e40397d9ade480f210ea4c9a9a3c6d136ff1f88f18fe1ae3fee3fb9068cf68999f09dd52e99af2b44ff597b8d971b2d4554d7373478b151d725b95a97b8f37e307ffce82db33185513244ab6dad9a209087cee56b4ffa47887757552e7427629b43ab4e70532760a30a0c024c67335b3f4c2b5001b8b4f4e7bbf2a708602dd89dcbac327543f6abea0fd13b02aff00de63d9489d929f5d39f1580a3480bdcd3d4ebd0790cfe3a5de674b111caf9c387b91361de9c733c252097f80025bef9139b8b993d8aad3f27aedd3563cd8420c8828ebd97e681349abf1f74513bdda949a4ff2aa8f7c3b9ea5eb03de2ab748fcca48fc4be7abf7d83e140da3623dd6a40ae556f6a7ad8b8370c69f24b784690e07262c8869b814cf285b2cc83bc40299d5001953b957c347bb6b5770c62a1b16004173974620c00f296168e26c2382d52188de349e57b398e8204c9b2c29e54a5a2de1ffc52f6eb58e76234bef21fe86a59bd8791153c3468cf8e1d216ee43b604b6a4be1270c8e13d0d3d1ee153bce90a8b7ca1ca53a0ab158e5532eca7f4f2e942434442d76ef685a1de6019feba42ec981c84edb7b420e9dcc23a3662d9386f0d06a18077bffa75d864ffe02ae2e3ecab83498c287d782cb4c7352241a2531e18d47000985843e610cf237550f6c96e27d43b58167d269494cff8e36842e1aa2b31221b3a6b3b5344ccf1e87240498cfbfb0f95f87699f7b276dc7f25392815ade38c1ad26d454edbfc1d71672e4c4233eaf2edf6cdbe870f2bcaa40d89b1f2bfbf54f1174487e419e0560cdb8a9e80967340086497af6d190f41be0a18d5c90065a4a000b95f81d69bb8239b45eaecb97c594fbc35ef1f5a6e03887e422f47fff98addd066cc26a1e68a3a78340bc59add2d413e219a40bddaddb0218cae552ed69dffffe0b6f160cb0b7ff1811035273c4f1eaa4bcfdaeeb45159e806c380dada915f9ae6845144db8b8c9b5e42205dd308194d0f9bfda3d83d6137462d54467040bc297b37ab7127c9c37d14261dad166c3f2a36570c09896807e8fffe96301759bd2317e0292fcbe3373ca56131560a19f9533ddda2ebeff345c62693494513362cc1a4d5a2235cc16e1386135c132c0d06da94dd0fb11c39362fcd0a4753f57661a9d24f7adb1e7ff86fc91f72cf2d7dd658924d44fc79402ffd92709662bd11c003302d6bed0871eff4d63af56eae16abd096dbbd900df59eda9c39c6a54341f76b825e40a6d11ad91dc7ebdfbe137d9834daf9b90b9249c33776d0c6dbac1dbe87bd516c02c6e832712ea9e419e27be36107fe7155a93e83356a851d781e64aa4bc6fc83576a8eaaa67081095ffbcfd1a05c320a7fac36eda401f9ead21704f6edd439cd88d9f064022e4d135f69c7ecba5416556694c03f2a1addc7b1225fb799b076ca6032b4ac0d83def335ac8bae5210ab2fdd03e12d2359cf2e19892bc1c0a6451b80a2257a7fd7609cfac0c8194bb50a1a7fdb368769500fbdaca861529efd099c99eb79a5f547b5efe90b34267101766cc493afa1a0cebe1d58330b69c09611e5950581e5971593738bf17c1f81832bc0ddcf5c11b6ebf7df0efca22cd6c9f94573c3ef0e498477a105fa1d5c59d0676e0a484b5539aee8c55cccb271ca368dc946d61c776f420211a61a385366f31ec7167191d8ec96281d92347e52ececa57174cdd82093cd81f3b2851b37c1241297055a5e6792ae60f10ca57f6bf9599dd4d8de243ca44e160e39eb5566deedff4bb8b971f2b8e7f87db506a2acf17c07da027fe9cb1db1f5e1ceb0edf353784f2a7cf7d0e458b0ee52a10fc10f894b1247dba0b67cdf8139a561f5a8e3f82328201b81d7bfeb07fb5b03721a4985183932f02d1e22c7b7efa59870b01d4815404702005ff49d8c380c9e1bc76566e41e0ecc2cd88f71f4f905350fc99da9251302b144eb6c2a82467eea5feaca11c90c3fa1f93b90c946a3a8ef26653f9d69e4813c93fa445ed2e457d958c916b874ac9c46cf9a0bf9036242c2734527093ad15d447fd0424c0ce351d4db1dd239f7581ea56eb52b0d7dd50d9ea61d93e2fc4808a72760da2278c3e065cc83e053ceab892b770d261951eb25b8c59743e3de7deed08a871422f31413a18217ecbe86c8d12879024c7ea4bbcdd0ccaaba6f3fc8486efc94a2f27c995ef5eed8965857f4c84ae2edda3a904cacd7c522be62c53640ca74634d095fd713b2ec2f04bc10e31bce18a5eb2039def7ea833c033ac53a549e1014218299b2151ca6560ddc10c746af979b74f4d4b6a664874a0be036fade6f790b4925a926efd818cf9e5591c1440d165d3096df0467787c5ad729578601ba6ef255115e47c2cbc27d2c2cedff2865d8badb6054169aff674273407190a28576438470523fe523a1324023be472eaa835aca34aceeef14e404a85611fa0a4c7d57826716408e3c4a99b5df12fc3fe40dd04dc6316be8677e7c860925f3f8abf5ef95a9bf598e99ed55df619914fa686a3fc29cb1c703e7a2e34e96445bc16f3d906dc1b49ee894c7213c47677c1b6ba2f520e310c5edc9429d5a47d12f222f1613ec392ba79282da1affe5186b57a5400b409ca3292463192a63927eab8a29fc260089fd19f78f13c9ef0f86e3334ca0ddc0fd445a37de03e48a19bd29b0ea8e70e996f04f5f6115209168ed779c96f330168883afa57bcbac2b24727c089fa12122caa145f5df3eb8eb0ca845af32787f178a353bcd17cc9eec73fd04689f302e644f2869c708592c87493173d594f7b50e7e6fa7d8f16195b2acb2b4ea6439fda32494445337acb88ad0e8b7358c1cc8e9be733aa0903bcf80f6c3eb1cff2460d5a1489263992feebd4764d7fe7853432e8e96c0d3be56761c5a00ca6091759aa338b547817270743f98e48dd83952629ae976cd8e88435194742d213d19f45b5cd64a404a15f1a5e8134d5e8e1e1e1f0c33653f194922178175bf40a579da63b97ccae69a96917380bc11039fb3b546a761572b06ee03a6876a4667962c33ce2b21f04b18dd6423ff56ec94bc31146b8dd137d881bfb5508b2e47c4c500038eb344f5175bb473821364ffd4de3fff8ca016ff5c8e33202716ccc4606b5e7893ebce954be54ac984b80b058ddfcd41c6ef602db8b03e223838a17f9aa95a0d6dd6f435361f531aac99f0ec81fb65d4fe35713703b835ccf694bda41325732025798352c58c3a318725464a7338497b7aa56cc9bbde35ff5c1ac6efffd4d9f893808ef8729289f1cf5d89f7e0170f1b7ba624f5743681365b4c227237c2b3af4bd76b45e69f70790a626ea095999998c66abee073424a21a00d968ee49ba644cff2b35c11ae3d47b8ca9d6c35b450a4e992397de78a69df76c9ef2f4c07a2634f72b95d5f95b975df7b73c74338f0aae02b66b0194fe99d3f8466dc654dfc006b603f64fcb9cdef362e0f14e650e3ba0e07ae2193cdecf204e3970af17fd89486b91cfb972912c7265c2ef42e6854906ca498468b62b9098cbbdce55ce2f1c344a7dee5e9f6cdea010ae5ebd64e7ebf247bd43740121ed5f9a3d5a99318a4b0f2702fae36d9a99eec07cee60cf8842085185633124d08480da7d22ccaf810fdff74a1d56829e3f2eba983a4218bd182f1cb192db8fd2c4307d5428ef305ffab56a14fd14bf4303186d1ef735111366424993541599a2812e2a22403d4c4767b6305d4781a4eaa16dd7064d610b81cc2c65258919ad4d8e5d1f7c256179e6c3fae575da06aa2511954e7665e558e36a5053f0a972bfb6039f63cdda882cd2a96188572edb02baeaed38709761df85c62cb0d27790cb2728ecc3420e72a77661538d8b257b22a4628d350172e1632fce4a13e4fa1b42692b494454f43e9668fa417c020323b4a6957ff8b8557ae4c1d024da2cc10673c9e729b26ee24273a82afe1dc3685929784ef99682082b22d14dc14ee10d376683ad562045cb7c970f7d2e8eae185cfc0ce9d1912f3be39ef42c98395f264784e4ae96525f3110a1c164cc76b528ab3c9225ded8a153c5fcb5eb27b31bb1b33abf56b3c2a5d97b24244171560348b50a8f1279765eb7e1737abdf9a217b9e2b263a1c57ed57fe264f4db91ba17e53f961e85d2d20a7eadafa533930e98430e7665c2aa7dd2e93f1e7ed8cc9500a72990a5077d59c8f1138b8a9133a25bdfc3fd8417625697fec2fc55d98a7dc67c9d285aef0bd6b1abd683e83fceac0c9842dc19ed3b0c66919231e8fab10c78706b3435c9ea72842d96a1fe01c4dd492c1956b663733649090a9c5359097c241b1d8839a07f874ef15625ff846b643b3ba7de5dd63c8fcbd50a0d2ddcb8ce8b2f37f6cf0558cfd5319c61abe2bff0dd6294510427fd415db57843ec5322c25dcf5937d86806148f0eb4112c7a129b4923b21790f6067cf2fe98eff51da74857dd85af6ca2466a07e576d5ba76a4befbd469a2e8722ab2131eef22a3a7123ac6027dba4e1bf6dd9212d5ad82c20dae728ba36206bdbc13cdce71bfccf41203ccd54c9946be9de9893f4c9646f1f5d9ad72b6e92ad603d53217b52cd70a9425a17ddaf4fbc7dea2c404fde425022bf62013db4600329fa15b2d5c0bb854646b6bddc2cf62922344d9a3d19036e827ccfe3e0f3f0632362aca8bfde8c51fd09b8f91e8f7ef5083908ce7ecdaa57e6b3dfdaebfbeb4e2b2e7e932a0b1b419010e3239a588320975263a245766f0adf4ffdd22dcc4bfea0aa6af2f263a6d47e022932d17baceed38628bbeb93c8a98193e5aad449854d5230531d856b1cf4db4eea2840c377d15acf268e3201dd231b90325bbde4c6990d8b0cd57900543ed77683f2308d58deb7f723c2a0c90317c86e142b1cbed10ea9e9685755b4a0ffa3337780df2e9c935ef542b9dfdd0fcf41144718c47932d5eb1e64b723c53860c2cb528dd6bb215eee9a813e00e21845ead4b821f873a19fddb3b1ceaa5b66d08dae69079e62dfb3ac57c9f1d5da04fee0bd15251fecad446f3b9cdd19319032dc82f8a0f6b5d3cdda2c60ccd03477e2f98093960909df3964e5e23d61c82065c6202b273c2739f1eaefd41ee9b2fbd69f1622ef71331f32656aa1c289217bf92d9c6524cacce1479545b907076d99708b7e63f9af2eefafe7842e7bb84b0078652e750a15250260b6cbb2b58529b7e3e1e973567102bfc2fcbc7cded7ccac0b6b0e370ba985284e216f138e9a58997cf68a53f6918aceb363483b763020e75e1217753278fa924b19632d6709b26a6e41e779272b138bbfb77ef98297301328bf79904624d70485d0b99dd321d844c7c9f46f58982e214af1a8ae2634b2e554d599283731893125eb36dcf1778f059f25f239de38d021874c355cef631607157a0c248d09289175ecd3c8f9dadc62d2ab70e7245e43097a38117fba752a1d185d7085acb7e58367055c4108d83200f6bd64d6c4ec533e58a811c9a3adeb2c2b2410ab992996cf2a8e5f5ed6e861c86e58f7f14a991b729dcbb659380d708df9456743e67ec0aafa490a1c6af31cef09db1bd0adac70a8b89c4f483f345f2c7693b7320aa8667cec25f06f233b620f93b07c6c67f81e8b93205d62b8c787b190179cb1a4b8e2a4e175ed62007960550a513d3545be37c3ce7b3d0dc02ef7156df278ef9d535dd8dcb41e38664406d9c86cf48ee23247163d58a08f407d5fb9b5ba794a636e863d86492291746f7c3574a21a8c6490c9331432b41524f9edadbed75b11b4a729f93c847a0ce3062a483e5b1e9642bb12e50e6a85b3fb0931c3287818731d89c2efd3ee208c26f93226e4b043df956b7e1e078bc6d6c975519d7b4de8a9340b06ab2c9e1bdb71d52de13dae8d8b780e572dbca888fb1cabfc85dfd16e930b1d33f4d5d005097405240ff68adda9d6acb9a4aa9b468def95f988451e9c192813488fc4dbe9fa14368a822b7ec6734886c3e284f5c4ff10beed2b523aa3b7d7c087e33d76741e02bdd0e1e2cf02eb251d9e928f26fa896ab1e9777ab76f189a051af0138ba9ccb24321b566dbc0066d11ff1727279761ae8aeba9def901d65d469ea730558d85f532bb7b2ea5459e4e3792bea4da22665aa9d6df605751f38e87dca906c796d95c174276d3b06a98167618a3f164956c66e349c7756ce9f699920da166f482a71be9992dbdb83034767ceb1b845eee6cff35cdad920abfad5dc31d91381eb91dd571ca0c056135b22d404bbb1a6201e86162d24b5bb6ba067c255e305cfba402115dc5ca66f2e8c388b3bec93f55def469b07a7076cf436b4c0dde050b5a9607a24c7aa3bbd8c8da31a0990970ffbabff9817c8497ab6a37fb6a44a88793ceb4a2daf90dada68ecd2b5a29e87f41b6263b190df601bd59748d6eadb4c15d973eff7d1515b76d041f113a8f981067f389c44f70aef0f504f44017b72a0a35fb2839decda7e3933ea1c88ec71fe7fc096e9ad9ffa457cd75b0e977d84cd684a174127e6222c9be84bfefca1a0fef59015e96be16ac91df4345a5a388cc58b5f5c2260b8bc3202e40d5e498b074c6f18995eee87ec4a3659ee1fb15ea5dac18e4d685a65fb545a7b9aa93e0fdc8fbed1041aed746471371f56de18dd1e84dae11ff20c4927a9e8097c8298c64ee300407fef654268aaa0afd4d21d4cfab6eca451b81508ff351b440ceb65650d5a1e10b8c223a9d070922d6b30cc80024b4d63946f7a80fca4cb9673924f72489efccb82ce5263e94c4be77a317d6fc031b65cee2e4b0bf11010359288445ed73f14552ca7191d7548e8eb3f517af1321acaa0f9ab4f6650bbeddfd3593cea4c2824f3ff9572ace9dd8b850a295e6fe9651c6586528df1def95ec6156c598fb8297b737cabfadb96106558a156f37e9e77c9e9e495866c55b234a5b203d313bbf1639b1242956d2a49bb36d9c0d3afe26033a04fbf8b5b0dd4687e3ae3af71d0904f06af468f5ca601310dfcf4ebb05a58203e194c9ca6be8e862c77d517647df4d9939d38b8b51e2024ffbad54dd5e78a7eec3300da583af13d2dce9196e7f767584b4a10169c6d3de12020bcdec727988e93164ae1c85f877f927b2ea7c08abb6e77a7a1c8feefdb99d0f3ac724ae22baa2d73bb7014caa688867b8ff79e3b6650ccdf13fb6e9ffbe965419b33afa22344ad30b1ed6e5e94bf89f4ac86a7206213e8e1b2383fd50efc0e0f17676c9f0449cca8d98efb41e58e07bc86110604b332e876b3f09ead93c061bd12bca5c4aa12368de67c5e7111e4b714aebc6efe3359e6f6dd1af0df0fb29c34d897eabbcb896ea14e5522ea283cd3eaaf7c5ad565b7dbe52fb23873e407ac3145f317135a96c984511fb12d96f2fe73bd8d387416f2867735661de1249ab7803de85f9a703ca297214bc9e6fb04325441594d7120b2126237ff902863e0265f51c641f1bfd7f7565c25017329d01f78614c887f736f1bc260609b56bcdbb3c0e47cbff671e69736a20cf46ac01ad49f915453732cf98fbf2b0eab3626ab61204d6f5623ca35476c6071c285dbaa0e393c4896ff7a7334989dea39116efc3164939d0af669470c790c0072e53249b0c863f48e4adc1287dd1c892a86311fc112fac334010fc94f3b1da3db8c2c1c8a448ca73d8d10d3c51a9d542ba58e796ebf165596f7e65ce8f93a5f381deafee93f521b8deed16bb9c19cf67b798d836219031c920a6984f3d62aeea4117ed8889c277a9b8b981117d65454cffec22b559c9b6b0b6812318a29f768569fdb0af603d683fed7a335d617300558aa2dace4dfa20d0d5fb4f8d76f766f2581bcfe09e03b0b311cc896c5b07b05acfdb04388f5e223d0f76912c8171c7fd01978b34cc212c9144d4472b81ebf59654adf8b3b7b10598e3bdabeb4f74c42828814afc6a1d02fa0b68b7f3a178d80f0c3776cbbd0c2d6cedd42fc843bb70004ee2305c97cfd767618d3daa44db37d9381d2fd270d6b4b4c70822301b3af60c4647182d403f6aaceb24840cbddc232757f9653590c45117e95b788e131eabbee9394d49d85cf47f838796f55d3a8e8a57e620b708b22484cbe59095011f7ca974a4f2cadf591ecea3ab5e5028fe731c6a2da7ae1361f9d73c8b45b5a046b7113be3331355aef98028c16c5662dfb2a48ff144db8e9fe2ea2114af77958502e2d2b16db3a4cf3092d074a61502b6e4d66556e8551d96d0689566379bbfebbef6a7057fea72273cd0218c705896779a2d35c4e84eee943041aecd17264a3c9c78a993487deb61201dfe1e7fc84e16cf8a2f10c80ffdc3618f17cfdd7fca3a37dac7dd3b7c63a89c3239ce445e65cf007711405af7e41481c6444bb96c558f52226deb0c740e7d870e26e6409232af4af39e6231f1e980bd2a2b3f2bbd2a047dd09fc1afb7738103262bc42754c7e4f7bd10e3694d73b21c4475d52def0a86dad1ad275fb7c76d65dab31aa97e95f5dac259b76fc554729e509095b6c142435c9e72dac05c4b78f8d7984498e5eabe09ea13440619f947c87a90cb9ee746f57eda89a12a01038961328a626963102b8d281c79426d8701d31efc9ee8d99c868cae89fb696a5ff7e9d688a6139f8190faddd35646db586c5453af3fbf12755e79a35f85db05de55d09a815f860d92159969535de4f09125222fd9a77ef99960ac83e6b5e8c9946cf2591eead5b1b23649effc009645f12e75ba454eab9d6361444b6929be8b1b092fc792055d7ee8528fc5b565c26243a839f8e8d3266cedad89999566b97e8d93939b7526be2e08461941491b87054f12683076333458d7b59cb0e27d28ed2f27f54e5acbb0e8bbbe82fdc6974725f6c533f0e01809105c15c3d8909fa33438149edbd4d098533d4b87189dfa8a2540eeedf0b2f36bd263160a436150d8a706c7e1e0a3a802d0badfbcf4419dfc8aac0b4d208ff8c98bd8ffe00976352ed0e5070dfff71a05f2f32820027706e802c88383e79d96cb248bccdaf34b5b30c1318cb5b444b2d51cfcf7e024da299fd9d22d93d6606202b1187ad75f4165816b2639e0fb0a41ed49b07fc92f3ee6659121c8e2b55ff0da12d72ed98c1a7962974811ae757b5b694bbdfdcfa00fef404f2d5a164a191e4ad4075273de9d51d5e82cd6d2a8c9ced4041099f1045929fd622e252527cfce8336817381fbb6611857096b73a6fa4e8aa5216f30fbbf08a4486cd557116346c71ceb9efcebc2a5d952b74cfbbc4a9c7467ac655a43c6f1ef6c794bbe5155516cf00e21b65859aa40dee3f6f139103f1bbb1f0906170fdcf3968fe9e17b340d7fe4e0182f4abee3f172eab66c02b63154d36ca5b589680e953ec7f648e475ffd91a9c7ccb576aec2a760473b7d685219b282fd2aa330d6a724e5b97054f8bb2d692c73bcd69ff4fcf4316b0d57b8f103ce13f85825b6bb0b878f05b98dc43ccdd4a9b2093045cd33c0bfbb36c8021ef33b07043e12ae03e9a51312a764b167d3f4acfaaae7af255d624bc876cbea45c884f43ffc0ad5d45973d76d66cfc6182043aa9b39e86bf04b5ba4a6c95bd130d13af1da537c4495818143ca6e1094d40bbb55995fbf2e5548c7bf4dcf61075a21e76bc01867ff497e033d111ac4c7224d79de4a15bd80430a7b67f6e09effcbe75a184a63b15ff1f2dc4aa8a8fc2e7c82fb574fdc8239b1d1d8b07668fb91cf22d25a71fe718bc1deed479d407abadc069f01c0e1ed1f1bb69d3753b135de01cfb99c254d22b806a1ad8cdd64865d870f2a8e8f58da7c48f5a7f446379bfc2f68a7c4642b2c721ad5ffc772781fc20238b70942155843b0de7636663c2845441b88b1011f1d83ef10f65e4077f5e24eefdf64e4a170a3f75ff178b5608a1e01264a2dcd388b4bff87663beb100ed2120babbdeb07dd0fa9024efddf73941216bea46565ffda5ae3e5634350223bcfcf4032f5dbafd15a042b2469084c7869f1259f1c83ee16f0162b5e2710f9a37cfa130aba0a0730d22ec0254d04ef81782647e19848cc891bf79fc584475a3042054f6449b18bcab7839f0ebf3464c256a547867dae93184d46480630bbd5789169f7dc8d1f53d144b1fc1d0137997c5b65bf31a06ddd0ca3399b866c82987b2cbdf7b0938ade5157b6d4933ddeabd2503cbf971552f37e864e332bb891631772a3ec597cee0144c3db74a601b94db4c39e198161ac74d5dfb19835fecd47a62603b8905c29ef00eeaad024bcdce1f1682d96baf4ea2b135a84bc6379ef97dd26d107c2f25bc934259e53b78330b2e6c97c2681667258c66be68dce81a41b2b27d6e76268475851afa5fd04569e585215c5fbd1217f8018b45c389e7c2a4fe5c63facb6a502d0533027e95f30bf11024b0e8443d5d4be1f8a4831366388805aaba06d4fc06471a523687cf049278ed77f76fe2bfe77c8d511cf98ab99fecf2620e5f64ade7b20890de6b1807e7c2bfddffea0d8090e4718240c064892dcc1b11ea2a1c214fcc58f235ae705c89886ccff45b35d816e36f96eca7322eb1cee306d08a370c723ddd08ec430ca9c896a8df1a585fbb46751afce33fa70751a3186b95d84f79335e6565bdd44015c03519d236b22bfde94599cd9c351e8a923a67049ad7127d2b8bded2dad7ec883287d08edf9e510372c56229ebde38b1685c7c60d8698fe5308215e6792a7230234690a0d09361d11f03fd3879aca6b3d417c97e2811056ab69c96da5ab8ad37fe4f52664657fc5af27ec90a271ec0be023cba275bc669755c36f000418890921db41576405d32884b20d0bdce5e26e47fb4d22736a927e0446b9dac3fe54affdd6a6e7da5e237806c239d15c86d04bbe38df283309ef55ac2922b689876f66ec02ce9c9ed55a87fdc0400b775d3148cbeea1a95ce92fff240fcb287d51db1ce1a0ff6d7522be1793f2d1612e3a35f2b2963dc2392b47a124f51b750a955d590d85abfba8079f9f18a2eb07d3b7c8b88f1545d757f95e25e19092a5f702b05b842c643da388e6a5419a93c8ae60c9b2a96e4fc820e564431f2efb3b1f3a3feb5a383975aa052bb42ddc5f504d29e06a0abda04a3730a94808461af1801d4cf9352117233805515e041ea9ffaf6f0944c1de5cc43f236a43946f6a851df76639cefcf546be2f548d36a115e10db429aaf08c8efc3d03b9a7c514bbd01ada118cdb18f847b20f4aa0287a3d32079b8fdcbdaf7c431fadea2e46e74b98eb5879cf785959147af6422ae204bdee3593b114148f7896effebe74edc462463a87910eb20d776759fe90f71c4a4dae335e08fa2d3ea9e6260631b51b28df48ea956cb2454848bb4574e5834faa65a8678a6f452f57a7f5a7a101528fa86c7cc881d4d451d02c50e7d5854cf27f48ba19c8c1c2e1a4f13ef6352a6d329dea31c310284f90b763662c26d48abef01f5e7cd0879b82969d5bbd42ffaf8008cca414e6a80a8ce0145ff1dbf5f0ee3b409a57281090ab30995fdde71c5c7f4d40a062e53f9005e0273472f932d7e25f81a0c86b8423b821db90105ed9f5fba5ed4a28804d042813c108efe41cb98409b6b8e91d3b73e880dc4746d6d40647a2df7b59b1278bbb456b9ea45fd5dc94b4067aec2ff2734afcebf8345204215ed5d46309d5dfaff10da447f151afea9d973fe9d61c6b6065c8172498f1d1f257ab2da9dc3cc73ae8d0750115d603183514e4e61389f6ca031e6251bb06a7b72b0ae4a1e97dc3deff950440d4418f53d168289d2db98f0bb9bec68a02fda6df12c9291f729fc9094f58c7ff4d557b2c9b18aa614c45718add9e2123599f905b55f04c8f9bb09c6fc8f69ddc30d1d0f05af821ee776adef5317f2c38e3b40936c84062256fc559c72bac53376dd2b5aab16d75a485ef0a783617ea5e96aa07f2f5448a40c480421b540581c9f61d5e0de5bf5380481d671bf6717c9788efa2cd1fca30d7aa43ac002a41538c554b5fa8f3759081295d2035dc122233622604ba25a30fd5251ab979aa8bb1e4363e868f64f1046893049763154e7f691be29edbf28eb00a6d34977749a50385dce430967df4c7e1ce7dd2a6d455b817c0f947017e984b59967f59e911aa53bcfff44e0a7470c95afac6786b8f05454fa5f97d35e6a5b9d0dbd15980266eacc7d13f6aeafa6552d14154baa27f0e92cc7931ed11937655f909e1685c7b5182bb867f3c4510478ee550e5ae4a03c1a68568703436b810bb840fce4ef9049643839a6e9fd30f173641c83b60e5cac09d9d81e106a203c94f2cadae5e8d9ae2d1cb4a6ff024099803e1846b63940088ce6ea176694e4fd4d1159e5dfb6ef63b1bd7987eafeb5878058a7d4c4d27cea01d5af041243cb0879c9ba1156fbd5fa5335edba4b2461552b2574eaccef52f4f5bc7f16f33858e154e3240c51b56406cd348e20301bd1ecb69a2030ec59b5b0a1b8a30af53e22cb2fb61f274d63fac3488252145beda13653e9899cc6f652cacdb7fcdb689ca166b2eebef4efa40d6703a62c27ccf3b111b4cbc0ba83b5db60a216df11be967e4a56d38395fa0a15c438db3841700e747647f052cdadc66d15ed3e0c4b036a608a42f1b192d28acb442546290f80d38b59f41f1ef63a59b9814ade6906a38dfc1b08c2cfe2b74b4daa3389519945cbe2a6f9af58f6936493202a80d51127d3a615297e01acff017afa6222d8fee70a62230aea3ed7067ad7164c14f01f542b1d61b696e1b3e44f7c3874af5b1c9d9921c68d5278848569c6b052a08b51362173a5e41e912a94503dd256c24abfb5f62a46817854e9de5b389b2a91e47c6a209b54d79da175a7bfcee4b7365ce61f5c89e5f1b558d9c291b8fec55349fa3ffd1fe0172056d81ed6763086610742111016b41d4289f681a2e579c47cc5fbd57c188f2bd274bca20e2565c8e14b174c9968dec34a841fae2b152b49636635eea6af8ecf5afa5c2cac717f520326c8bc31b77af19192143b1cfb4991dbeed37cb9ed11b29fb7e8c452ec8d18bfa8eeadbe23d8cf0007ec189559ce8fda9373b20840aa2e1b69c264ccfeea87c0a2b7abec4bf939f6616fa6d7c8227d824c06f2d388b2c0c055a6580205dcceed629eb848096cd4af2ca3fdfb69bc65ca320d2ae456001ddee773ab82894fb3b0a76f5e1e93de335d36fbc64f6f51269c66a72d49deff995737f45869bbfbbb0ed92150676e7aedae9e0be84d12611782a165d1902c621b96d3f5a1c364e9cfe1262681e2f59884842ffe207f274c26a18b7b49bf7ccab01eb25ff55708a874e15d4a8908517d0ef5607f31f8b6d7f6ee963f1a743954b79a2cf99ab8af4c9f833b82b122f2ce06e117fff3800066d8baa4b3c6cfaea6007a7562aed179e477fd6c1197f2f589f49a7949b28b831e12aecb415a00d74c135586817a25d76b5ad4848da92ec27e0bc5555cd7bf2b7f9f41993ed3f04eb97d4b0b20a4106d154782378fd88e1cce96740f88319303496ed1814dbfcbaedd7c94436df30a30e6615961d1a633ba2b1d1244e99ccb98f451c32c6ffb6b9a48d02184473285c13362eb468bb2ae7699d9529e750d488aa92a7fdc13ed24aecf205b41c6f596d241314aa28755c34d3015e1ea3f0f659bea39dbbbef741c093440e8fd01f55f0dfadb70a402d7521bf070d3b6cb0fbf1bb9c3513c8ca76fd2ecf0872efebed455a002b94c65e040e4175ba888dfd23e4994579e3f493c1c56c9db3a501112204ae4ece9097109eb51edfa97ee7c97e2de59dc32e35fba2838cc3da20b8bfe547819d7feaea7807231efe70a82fbf8875378817d3b5e27b429a854f800d2c896a1737046b0d7ad850efacfe6efb380555c5d158f9b9588e4bd77ca5e215217fc6de5b2bed44a0af8f1033628bf097ece1fef24a7be9fc1ce9ca7ffbccc2ebd1b174677b0661fd5af304d5ae0772a6b98e569e61ebd31be69644012ee2d62df93dc3a6820c8dc91a646a68375f7b0713cd5ca5a9ce0aef4632eacc91264494b69d0df2b2d444e7cf4bf9a5112c174e68073aef42bb4063606ee119f7bb5c43a4c36868b43ab445dc0192e08cf1f323255d5f3d9a05c77512eed41d6d74e1c0666b1ba8324412f9933435be93926011a7b82825ffa4f4c4c43e3d1369d6baf922f7296b84c2932f6f865abf93918be16260e8c522698e3f914b32abbbdd90cdb4f567c79e78e8272b00bcdfa1aaf3cbb797a5bb0e97e5abcd8f24e0a777ba7b85912e8e637bffbeadbd570518ccad937cd37585d9b6c3e06298591668f509dd4beb8b31be92e9c1b35e59982a0a650dc776ec595e04ddd876321e864bb25d74ad487d2c6176a74b9517b4de619c5b1fcbb1d5feb0e13d7ab6dc624ad98519426f3a8236c0eca1ad63c29bf83ff65ad648992d39bce4b88f35db832e5feefa3ef6832a8a8d0e4466bab707e06bbb940d9f562b10bc6f8409e4c7d1e28f4ee2ce4bdea4e0d0e8d807179e37f2d58be631db1a14840f8d9638d033c7fae45c729cfdbf74c66dd3881b49934fe0ba735969977fe64472efdcdfbe9ae20fb349becbf25238696bf5e27174632a2e774626d931898b64528eacc8dc26db2e87567c82fb3cecf479c41c541b05d188a3c687f61c5db3761255278a00a082eb2f45d937ef41994aec3e522cbeb958b330727237afa1581e0fef4cf863c8b00642eb5833a5e8caea0ca69620297517efa96e535c5eab33cfe0ebf97a7926b2d3427b730bc59e3f53c2a95fec70e0766424f36e65ab3274af24931e88ef49daca7eb1c1463ee5a7fad8daab892f8e6babba2b55fea62537e70f5110be70c913703b8897cace2d0f3e429938ab7d7bc144871bc0ea415fcf7ed3a8a86c19bfb4df01b125081b53ebedc37e3eaf3d8b3076fad678e382c69a309c6192b155f561119e93f0432986be95e6d951a24366f08db5629aaf3b1b48b52aef3672442475693ac632886827ab33d264f45d32d07f17a09f2e87fdd30d388b0893f601298781f228538dbe77bf86849c756fcd76ded764f114a4df57c3bc12daec4d531e171ecd87b8d1e48419ab4b363bf362ae24a2645a3dba60e1cf7e2672949850e71aed3cb3c91384697f5ba06b0b33199cbe8830d3aa908efa04cb91c0a81f40e8e9ad228c3fac3f8f12a43410f8b125e571c3d262718fdc8d07a0d6ebd0734e67547553d902ddda7de495e052203d52b21833ac6803d8cc747fbd32ed94aae2bcc6cb7d518689f00842d7ba9b34f2534b3e4f1ba0644efd483c0c163f9374cfc2e23a11d038de829532bdb6c7b9d316678627cfbbca174c8e3d31fd37ea15eaa7cf75207e82d1c77d353c973d4dfbc6222d476972612269d12eef31f4a2a07e933854be6a04feeea23a568cb377d499536cb277a12bd1f5eaf939007ee90b189e212616aa17feb69b0e508908ea35a3a1ea5743120847c5507c341e2f7e473f6df79b55d27783f325e88cc37987e55a9bb4d3cf1cb4f6987041b392f8e60e4df65e746e7c36264d26c706cf9f7f38606675960bf4578223d65cd57adf6137c89310496901cd4a6329e049fba15c5d4014cda9dafebb209e2c551ebfe34f085e2367cd5af88c54baf09e2cd05132b13a1ab38f85938d1571e1c624a26bac50f78128b888413b97bf1400194167169c50e67f5b1cf56773c033a6d1f759ce09af08c81b9ba2285c6f60023e86d2627720f51afa294f45c71312d4302a49d2b658827b66f2550da61d424e7b083a745bb35c0de91da0ecb10f6fa0c5f0c73e2ef78605e5929bfb89da920e8d9915e5da1b96f0d075b1be921c9530d77a2edcc7ba539456ca28a5a9204c203c60b73e82162c2c569b0b23698fcb3a58458624f10725fe5251d72b71f63ec235264af22714bc17074fa1dfe33253f9e5903be09f1daf7c8aaaa00f8944062472499de2a0fd7df1cd47339467caa8eb9f04833b5c288e9732a1c56ac1e09cac3f216c28f22a4eb4a07812a0dbb2ba2bf7910f2906bc142b3405064d05bf020ce9acae3c384b1f366f64c688e691ee4d8bbfaa4be4e2e43b8723a4c9c7592cae06db57a8c6c6f5f8339699e196167291dd9f6a2a5a02609e9e52c4f27aeb9c0140f2f87353a21f0255fc756d6d0248307d3f8a98b81ef62629a1691771349f37697ec0e2fc72891915e008f7f8cb0c95e939bd18bd7f388a84c084b400d9996bb02dcc0a4710cf63e7048ee85d81ddad9da32dc65e4930cdbb2bd38c9128be8785a9141b199e85c2c1a303c3ae5611f6745c3783a661c66c52528ee86456a482bea098a148030142216efdc359feef697593268b37279efc416604a21fa966e89d53d7db98d272b13ff80397ce7a1fc3f28cf82ed20134761530c314c581d6444a683a47e5ff67d993e77acebed63c337546949bf3c175be9dbb4a994256c39c1c66fba097b5aa09a553b8b2463d432c85dfb4283c1c53ff4fcabf4897c79ff43ac9d8c4670ee92531ae46b6e4552b3295e2afa10321095e287cb408f5f2f4510759b5261e63e298789daea774961391d330f507f1cbd561aa8061a91fe02355ecf0d1e28888f5f38495f6d29e1db5e0febcb6ad9ee58d680d946c64bb620cd3dc24fff2f593eee91d8ca5376c41c6ff38241399dd2d8032ed356d4a67510ed901d3667e5fc5b0f71b44332c972408effcc573eb1b0cfdcabf0c8a72e61cf4ac244c93839a5f9043b9509562dbd67bcd3f85344b0be7ce7065e98b1e4c43b6f5561357d8369425f4355a8b7d6be4f8a51c3793315684d316e31bd7b85b4a50f8d80631484ae88246d1c79b817f172c530bb7e9b95fb45460506ded60d6cb80cfccb3195079dd67fefcd91362f016a40d3bc39864900eac2fd3e655830ae23e9513eacd21d3331fb1058a05e56054643931ff54ab86429379c32585fc5a50b8030c3c3d0e88ec3c607f373c5907c5d6d6263f51e5a47b957b646983f052ad66f58e0cb9d74a968904ae8aba23fb7a254d3abed3112f5885868fe1442b1f768b94da4c5736b8173ad9a283a07c15e90ca0fb762edcda6bb0324aa36cfc5b2c025238962d5da1375ba411af05518112edb62fa00385defc704376c05cc5d2e4f55d8adb5609810a32748fcd94dc55c9c47178343842b9bf5d9f3353cff5242adcbe9d2bfa73d25c540cbe5466a35b04202c35d143b41a3aa8a05db988e47e2e863ffe6ac1d1578a2216c239a86cd6a5f0765e7ef6b10d213e84a3d63d20f69c4c6363b448f9637d15bfc391d21f19116d7294fd00566a73af3be10bf60d684719c671c560f46559e9c68f6ffd1f283bbf7f24c9f26c3ae7cda87e2d77e8c95591403844818f99af71ddaa86252a713973d7a3f4581948ae07b1ccee65bf67c5e57e359c54b59669f4eae01a05b065449d24da7f618b80f3713e854d5072fe68cf48f05bc17f739bab41df47415ba5d219661576d0de1eafbab9492a148b20ea4f31cbdedfbeac99a654b1840ae3c69ee8bf7229b643266d4377a7a4b3d2b06233329ff5962bf31deb4825235ddde018a823e375de49c10496c1945aa13cccded9a5ed86dd8b1b50a7f0bfbec94ad1eb3271fc709e76d3d9333dcce10781c06b5b3efc8c376470d9251e295e24fea1b4140c675cfedbd994ec8f3dd201f6fd9401d6f2d3ea573fb177c07eaeed380d7cc588fe1ad5fe4e19c5fce3f59f76309f10475824d1017019ab6fa5582b537a70b6d0af734ef3f70edfbe9a9ee386a743773b50be6f1b2d5d2d482cf9230db9a3f873509576492fa2f86a0d8c19ebf84345cc0de82398536e7ca767a15e43e994b2345d7f9575d6be8160a285b06d491426bc1d647ba217080c5db544664569edb44eebf5264dd14edd2ba091c494346a981edaf5406a5848f697e190b86ff3eeff6de395cf03fda879ea4729fdcde0a4ae292351a9b60561ead9c4f445e89f9273ffd1ec4a561a3464763c81e59f550d1f1eb69dacb705a8f504dcc638c0f2eadd0f4fb3e740c583fb01c681084a807b04f130daee97c952255bba9cf61d78a8d3c94098f50d174246867852d84de3499cbfa68d5f9112e651d83bec94aa5ec2b3d25017ea3a15ea2799262d823cdbe5488a7de5d5b30466885fb5ccde8c5c7b016029d354c1d16d9f0032dfba8b3870ee6bf279c21ae7be9292a554ea42413654b3a0b661f7a870d7472e1bd41f3186eb326a2070cd34845d76673f54dc1ee770b6ea21354e3dd9e731d6cbbf679e258a761c0eb3128eef063110c03d7bf5cb319cd7f32253aea3d8cde9199ea091832794db13ad393d2252a0d57b17bce1915e40f5695c94786bfc328c976405ba2457bace8d0cf1b88d9bfa0839f2e7b62587f1e8a2560a137ad233ac135eb86f4be9f0e6ccc70c849ec31a677b2ce26976d53a61519984aff7c2677b9168466157945fe21b6c48bd7375f6e40b6e3fded44c89352d0c6954781ff69cfe7ebb63f2ce220871515f3631c9e0d431aff57039d36c9b94a9c6262fa6d27878ccd4fdfdd7c97f0d7697bbc9dd8c048d9bffeaa2ab97ec1345e83bf9ad53945df4f429b33ff4c358fdbabb5ed0adca80beaf7f8ca40a0b2a019820c27e2cd12f90938d9012cc121f8ac99e6999e76b0cc0de17a9c6f9b2039cd1d53bcd962d1afc5416f35f1fd8c2e444fb21166a1c5a03fe4dbd70ebb1bb3991322ed0a6d0877566ff7535444a689792f45216b59d1415f4e57ef9649af5d034d8e1e71180bea6f996e2ba3183936ace28da4b5ca6d3ea0d0e02369f089751e96941a902dc71051776d16b6a1bdbb1c6dbab435805db781c21beb52b096795510977606b9e6a7818d87bff173621b741c970767fb90509d81ecbaf2252519380e53d3bd122945ab62ac8a4bbbe6b001152b856b1681e725a26e721563c7b043098ed106748b74ea50104990c96c4b7f9ea067cfa14cc3e321cbf70b45fa04d91303d633483269f5b460ed1b4062a7c307f60aab2bf099a237cb7b6d1e59bbfb1974227523cc58e0cb04bb4f4110d12804075736a7db7dff335df25baa74f2c6110b40091d10e623cb00a02073cf24c0b7f354a28c45f1099579f6c554c8c3d6fb915fd1ad5b2aecc0ef2f564411b8a609e7809659f022ee91e112333904360c4cd540f469b7e7135383bb456abfd78cd1ff3a4ecf84fb41453548a7d8fc5f1edbab7f99921063cc60598e97e80b7d14016ffd5775236958d1cb234a9acc88d9e1fe17517e7890f0f8209112c6cc27cb76811b25bbb16ebf6f7d990fbfc683a1f8cb400230a79cb759d98fe265f7f2b63466e321cac23aa367002dbd7de35e2e9f9113bb172c51a88f15bec62c42eb154ca28a2fb6b61d4e1604a4bd03646c057c37e6902aa79c4f233506857dc2ebad7de14ad33e3de72743158796140f992bb6e01cfe6dab46df60d2d3de2d8eb3a95ba90c37f262d2921ba5418f634020b132a0df3d5d9cb9c8eb021abb492e24fda68369515ebfc1bfd5060f4cf565fe5184f1ce07b6758e9f0badc99c3eedd4e78e9700ac1de53257bde51c7b3a70917d396b99a8aed140af919d4ce5646ae53965dbcea96b0ae1441ab9d1760ed41380a28b292265dd3bbcd1ef8dd815f877330d975f80ea63f6a6ac86d991ea2668494b331dd6969bf8ccedb242498c35ce10a342cc9e42f4667437b714c0c7a0bca6477bb1a787b991765c3b67e53d7b62ff992a8fb93e0ffaa4cc56e1e4035718931c94503d8c4eea3702bae1699106a2a9d0696c474a2a471fa737f5e8d657614bb22957def82704e82fcbb7a825770ed4d952ad1dbe08ebc07e7f1e6cf159f6fd72556c59589c7edf1ff0df5f91b5f5c58c8ab00ddc711698b89b1ca5c0889540f3e6593a1b2d884403d251b3339983b50f3ecd4516bc2ecf353525a2310cf505b833dd35beec6f106da69bad7ed06e17c3d640bd0b66f97d7d2e4e03b50050523fb079e170392547bef1a01b11fc61c47e9082272c4e627fc2614909e900a577117fd11813a5f568abc7cc664486e6d12e713f26923cec280b54c3e11d712c8cc28907b1150031033453b07a5367a6465e13e13b439bd24e8223d65a3da12b82f2a6188866ac22b28bb984c47e6db3a2790ddebde2fcb3607cff8455627c5f80c40ed82b178766ec82f830eb8097f38a49043160fe957dcd791f6c63c2392089b2064c05b937ca2f4cf81bbabaca0da5ab4a7d3ef9018e8e669812c9301b6955666de0bed37f48c6972553d20b36ea59c27fcb81b70bf54f0e688452a01d38faa98a4c418151411fbedc1e7667db08a031532fdaad01b727ed48f0d9a1dfeba6276ff36c9de6fd73b43eff4706888701bb3e10b3069305a16a70ff245ceeda411d53fc3d73c5ee6c6dab134b91f3b9ff28883bee5e013ca8c519a87f622af3f9c7a213390b6d551a728c1eea22096c2e55d9b8141c3f2cce4744c0613253fbc17f59ac0fd48746bb73daf287dbf3c98b2e4da6430340dad6a29244e4c9b9491ad08ad8e390522a44162b470014d97a68859637251b00e63f45119bbc4fada7cc04492103855b0ab08e4911b8452a1dad417727054592b61c169b8fe5395112c5be46ec43ddf829d0fe4e679aabb8d62c5c1f628e11c8c5a817953b6ba6f8b61544cd50a3374fd3659b6bd00fd6364030c22f6321e158b154409e044d680c5124e94e69e18a77cf15ef132ce69a8e5ef56f49d5fc832058135ee607e4a2d42ed4fb12683351c90e0bc0bb869a33eeeba18c2bfe7e5b016575e17ae396ea8bc28ad1d296721009a0b01c29136e1b3259b425981f4f23d0580cb095fc76aae8dfa2ac07d0ce8a1cfe44b7024378c87a0196f674f0585ffa34aee0c71471772e13a82df1ea491c96a0f5770b2e6b2ca92a20c8a82e8b59945dad6912607a6001ee91304cea3ecf95beeec7b8821db8d499ab8e47b5a9c3143cb7e51b1884ca4b8fd4abf1ab51a63424208764d2e4359ffcdcfe8dc8ad08387b06f6362f123ca5bfb98e98830680df48e30deac338f0b41495f4ec484ef8e15e2fa800389671655bf73cadd410a93bbc53b9e9c3d622b893595ae9977d9b9f8994cf9db6c6923a6849f8f7669120d96d6ce0d5ccff95c8c6041bb9b53fe0a0e76a83a71e29b69c3ed5ff62d12faec7c8017613c58a009a2b6c28cc0e46fe5db10efe118520eaa85c64cf75dfe00db972360e99c13d8e56176cabb5c240bc00380a3e0aa588e3844985d54312126735992a5e94ae772344944384635dfeebd9f877b0a501c6f900a4222771b544589570c85dec96871099cbeee38be42dae3b5c5218c0af9c8be56289e03842dccf3c793880833e9ac3289edff9386cd75172c05db0c8f76ba9a8824609bc04f4d7494bc62205ac5f087f2eff863e98757131565571a4ecdb85361b10e6021","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"953e7348bb7d9cd965edac2f68006395"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
