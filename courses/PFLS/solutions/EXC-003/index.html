<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-003</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-003</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-003">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"ba45325faf02f0ca991b3541a49e036b324b5dbd0d8c64ff4cc2bcb59bdaf872704a166dd3952dcaa9a9397ddc4ae7c76b4d7fcc3fe3a6a9a4dd65c2d65cf5acee889ba85ae7af1a4cc86c7b4795c4dd6ecf711d2726ff0e456ced267f8d3f5af665a42984ce31f854a762a58e65ae85a9d38b326df100a8b6026b5fb416d3413a7ef29dc4f1f8c5f3e9a2169460510688d18c71b9ba5029f0d02f1bc0e36c6b4861f3b28a6a2a57df152da5a3c693c0002b2c295a97f7b040266b85361d36c2c933068da0c588d0a86972878cd7c2d84efde1cca170ae6f85ce169e71fd81dbab0751967bb351df9c352fe08d9e312c315a2a6b5508a7d5fa2e45b6c8d38c473c57d35b549dafa08eb3463a733edd74a8a0d8196cdcf2f9668ddbf9e545c2d343259460277ab7cd14ca86bdf294817c6d771acb75dd59f1a140b10b989eef488c307f766221c7d825aa75f6a7092acc117f9274e3a882f08714cf56cb1f2432a1cd4c3fb03a6c352ff50e9d48ef81aaa17a5f374d600e4e634226b5d3fb5d283294596b9c551a3d11885f380f646a7db5db434a39107a93432146f26d2bb386737d54dfc8178e17bffe4ced9ec230ecfa6b93b6530e65327b5c81eb0b8886356981cd3a77edf995f1f2bdcde5c3d082d47b15016db45615e2e69819a5a1fa87f343f453eed437dcdec2419b7c1172bba129da9e3739cf8349f5efc95d593af6a55e75a3ff39118f8e2c83f64af027e17e0415fb8e0aff5de1c39d9f80eb58be65e294fa799209ef78462f3f8e4b7c6e6ca785b54e69d425bf9d2363cdc7ecfd7723956f64e24b0b6566eb935ecddc33011763c48c1c8a370a21c38176e2c737f00c748165f46067c52a15c64bb5d6f33d5a1794a9ffb4f0f538faaf948a64aa6ef1a304dcbc4a811aeef7888ab6297b954a71098e4b1c78d1653a7e10dd54522e45cba4385bf98320cc4ae19513d4a9dc49d69db03ffcfdfae46fa374027295d8b2de2a4c445ef36fbdfb32d5b93473b480901cc9bffe0cb2cc8b66ef78d2777a7dd480c32072dc47ded648b4d01d022303eb8382b2bca3b708eeb2ef1c9ebb6138b4c72f68a3048532ec18abcac89bbcf0d8a249811f27ba9d12c95df5213ecacb60ed06ed7572d46250117afe290b913660a0d6f3d67169d6aa6ccec81bcb54dadf2faf7db5a26e8f256a8409f8fdf8bf018459af0a98b61c877bf9f0687c6620d92da9e04c4b767f153654a0c7d3ffabbf5a108f195ee5a73847b4b9824d801cc48ee826f622737ec4719942d758a282d32f24b2742465cebca8ac632dcbee6c6213d0b6424dc31aeafae024221aab76b39c0b2229dd0ae1a415aa5e2615b50daec783db2b9e7012f0f4a260fd73f9197df93329b899ae7502ef034d8f1a267619db5e88e9bf0b57618752721c912ee53668d1946d3d99c93b988b4ee6dbda20e16a6ffd4f8b51e419dd366de7f9516d5163c6e940af29e3de1c0bcf92ce0a8bd209097056ec72935f306c163b348ae0cd97c10342aa7893cf03c19e4eace607ffa3f6cbd3e66fdd4ef5be03591b24e5b3cca376281bd562552f79534699a3b77287aba370b9343774ecae2ecf844703e295477a31f4f04e4abaef35320635c47ac394357178c00cac0fe03f4ee641798032a785d2b5f56356146acd0c63b6a365b76b8485c5c50a9ef02f9f9f2511dd38e215cd8f8f797796e00718a9f6936d08abb38bb9fdeb30740581568be5c2090b2c34f81e88fddb781620fa94d785cd6db4174459eefa84b456eb9507b8987ecf9240239d7acd168b6b6d7c5c88b1d630797e3f02632b124a672eeacbdce2c4fe33fab4cb1b98c2571f1faaca71f06f5a82ac6250ff3e09801f863707bc246207db763fa3554e6ebf38a1b9e2394f3c6eb0a183c90b7ec133da3647e079e67ee0c453e20591c0ee3a622d92df34fe17abb56c6f25e63f4076f255db1704708666ca0dcaf93577ba3122318c30dfe8f598becad43ddf2316dc562871936d1c75d19373f670f1c7e797d97d8ec075648284d3b7e7e73933257b9992cfe498cb0574335a32a6c830f26ef79c643528bfb90b8a1e86545bd30ba71bc12247ac695bca64c4566562639df10b6a1608365f2d55564fea9fdb7af34d3632cb06cf70a65a744adab51b919aa0c869d062eec9243107abc4f050e37680765c1bb3d172254e44fb92ae0d81f9d909b4b3095d5090279cfc826be73851a94af50dffed479f0f2f2a7f15cb5a2541ea607bb5d551591b0f6c645777abe0c2f76642ef3d303f9c817e6179bb2afef1aece167824e855177bad2b9bb346f59e0ef317e9b22df95fdc1baeeb56246b1307edff42333428bd82a2652247af379359fe1c33bac66b94b5353af9834fe2dff81e1b22a19990e575fb44b5edbc5008f30c836d977c6de4ec35a17cdd50ac9b42dd2cbac718c60d8ee6b951be3e841262323fe2da6559db4b09fb16812ab10d17e19bff43d56b13f41b02d2a4c1c26946260e9c21830071a41c60bf781d3d0df25e4f5513a200788ff23f6d4d2beb8fcfe78171e6873e5e5253fc7dc69903656a5c2026cfe018f56b7c478f3bcab91d55133e32691d833997ce5f4dfeaf0033ba4e0a518cd08476fda98e01a2a7305bc5516d681ef03a146f898326ea1830b571f403e092c169dc7513a1697a67839c26a44800b11086e253886c1328774eecf1b5c3c89c544de29f7a514c330de535f4139ec85f77fa2ff3a729f4e7e3a5dd9c3d3a0b31888c1b0c25f13ac1ecc69d1329d71a94b9655bbe799af236903338e3180ac88959933286b38c331f605f0c0ea22b90d7989404332ed441c3b21ace363cea0d9f8f5b9b8539e5c84e2e08228604984bdcf9fbff1537b0330c4aaabcab4006b4adba45624b8ab74c9f39acdccce1a7fde96645de548d2625e871b0d33087af0f6da22b7da11ec8ad692086aa17c4ae05c9a5a784b2af6300d878e078d0b3640e9414f4b0fdaaeba700a2d78f1a49b1b9361da5e0f976d90cbb3d702ce8b35277c806de73f62ea5f3bf1f2ad01ea54d5e0d89eeccdab2c9b42730a41264e99437dd1415c0b07bec743bdd755336f79ee10595fbf2410bde741ba8cc3c0149547f70d4365c00e2a119cf14d6bc951ee820c0ba6c5280a175b7bd0fcaa8a2704dac165d06c2cb20724fbc5e0a3a68505f559c05cdd1dcb7026fe73cb786712d74a64710b05bd56112746f642179cf621630daecf0e7a2d013ad83507fc9d5f588388fe0b05ce3144906d3a7c79f2496f678342fedb3dcbebc575698d66f8b64f25c4daaaa40907068a8cd7aeb44f38c00abadee45f2abc74076b36463c1b6c0d1e2f16748b9a222e1ec6b1b81ed455101cfd3705d02fc916c391f7ee4c8782342f0754db287da56fa72aa812e76f43242f0c93e2425b8c94186d7119beda0c1c66f366665d0d4553817d2d8ae37189ee12aa448c3fa54e9a703c749dfdcae6ecfe516e8343797f9ec71dc5f98ff39a4fd22c81c6578d4c4a036ba625a53f06a2374afdc3f28f5d480f2622e5222d20ff7e328657bdc259421abe94be611c0307f5ecebde93d5827bff33555d35f1beb4cd3128556c574989620f7e93a48239116c9bcf66d3281a4a7c94d0f3140ed3ebc2ca00dc033a35e112d55cf2bf98f14849d018bdfb31eea2245c9bd1de8c4f300da8d1fc196c546ff31732138076585691b1d5cdd691f9592bc299fda35787344f9bdcf48305b5073d2a85cc7dffe3c28505205cf43472f11b850c6aa091ada2e716a765d00acdc011cfbbbad7836087709eec6232c0d7df632229ae50db92e1f6bc97ab5f571afb3878cf979f20f6d81d6fa4cc37d346510f794d6f7c054c812bb6f989a90af55998378caa2b1b16097fc10f2eb55de750c68c367bb51ecf2362f2226ff20180e8162749a4b5fc9de392efae8a0546d031a4a93047377185327615ede7f8ffba863f51d2d936035cf8e149d132fcd2119c14f0a8ee459db6770755916a150e4e03e14e98093136c082914376075e165b006b12196f81feee3120026e7311288ae27cabd3b609e846ffbf47d92874df6a7c0f7006f047641aeb914ebb1910c0f8a6c4905bb6ee4cec45b3e85be46a42ea68ce435304ef3a1cb1acbfef28291e8082ef159c80f4b47b09423448f8553b986729846fc93f3a44bb0e8674ac05fbc4a4e97749d55289772be9ef4e784a732cff81b5a8dcb5a093e95aba5aac32b8b07467603959f4caf619dc22eb4f12dc0cac801f48e90f8903ba8c14a8310b79384132129c08671b15f94038f9d28b18a31fe2062eb717c41a28550d45125144b02ace1265d1f2eb79af3ae6c147921b68240ee9764702e10e3a739a0c7c2ad3b2d6d091d1172b502664ee1ea54bb9207a0ad1f89fc36eab382cbfb193d2aaf04d0b278f081ee26949041d41791085efe4ae02f42e81c2397473f728e55f8708ef249fb52eefab93e561d3a5b8866ed26687d7ed83638a3f7a579883ad04db271c2361572a89b81582a59b2d8a9ce46a5068e5793e356e74f876b72d7a4433c0b8615120a27105ee871f754530dfc8d3943727aba8eee82265c0f79668bf65bb941ccbffe94537e27196a59d97d9079d5071c293734c48bd342f71d6f5706c4869504df7247fce784d6a67176d472eaa21b58e2fdbb7bef96ed86d3ee4f8d988a08407dc0a53f5084d8f7bb2608b8744824f7d217a0e1721f1f6f78f43db18851775e4e4eac958b4b446366a081a499e9f504c69513e64a3e2463e77f4de9d86d412777072ab54e5d11dadc2ae16383425206020c45cfac6da1ce5b228b67010d608683acc373c2758b33fd8d2b7f8df46bce5795d7e9bdf9490cf9df4b9c148d9e0fa4fd02063fb3fb3a0f7d14669d1c4c790838e524b7b22c29028ae913854c10e2d88ebcf22117723ead781043695a4d332489395691b245384c39ad668576116fbc111f270f3295159c069e9a6822962901d8bf03193156baa389c304173e286fdf1161eb2881fda5446874923c6235b289b360dff9086a721738bcd277cde2fb7f2dff87f1e594e008f8aa1eb58409e2a2540d52a8ed63d7a66c9444a572ff8ac5371fc7ec1e82459e9709a526e5f66be8a2a2cf6eaf75498d1ff3aa5dced447f45b7c8e4dbe33bd2cdb4a426954ba07203459ba6000b60caeb7aa694729992cff8af9271b54d51f1c94d1a23fa98d8de21666861098a4bb95ba3f6729f72ccd2299266242d224fa3600bd548801ae282ce315890755a92471e69378db24007bfaf2c764df62dd058908dea7dac84b44946ea171d6d6e7f2407a09e77a87d724eeb65fb333ae5e57d8c332c5ec8171b388e7480540e722e1ee907ff09f48e4ca6338362fc31d62e67ad372efe5f6e226be8ac7f5900fa292e7f5c0db3ba7a1b1167bd10dcc1666a2bcf6d525d3f0554326accdd63220bb4bf0cce4485a11d203e78f53054396222ee93a43d8eaad0a2812c3ab294e9f06aad00da8403845e8f4bae637d01691e06aa72df2ca88e61042639bb815953a219a47719d05d6b72102237840abfd7b660747ea9ac2835bda85130944fa2aa806fe4c9ca8df07b16449795b3c5eeba8233ad701cb146067088f9017abe51ebc3f0b31ee56644da8c7c49fc5d6fc4e3fb09aa71ab3f5bd53b0fed9dbce125a8aebe57fa8dd754cfe698e9346b9651dc013647dd38c09a5c7afd95e27ea456a07ddb8bf4d844391680c7f730f3d31c72980c799f4daad1417fff5aea66c47cfbf3aef6261615afa0eca5aa2a0f03e33f2dcb984df4ba0da8407c3b5913ef05380626a02120cc9a12385dbe784e4e223ddee317171851a365bfb61acc59ea6e071faba68e361a88baf436c70353ea498c1b74e44695530ea4d3d2bd01944a66876be9e12fefc53ca7873385cdde5dae69718f256060c4fb29c8d3b3ef21a587f37afba6f89fe79c045fa056ad52d9893295edeeffba37cc23a6f7b0f14ad094c18284cfd8044efc427fecf397dd668b5004b4c5922d1e7c2a7bd699f795156311f361c23b9294948009d9c44ec96ad4c4baef72bf6ce34db6729eadeed47616de86d67091df4d40042efdb9a68e2c33b8339c2ce26b2339caa7a992913f1407f6395eb67e39ca19f8fd657817294972b77e0e9206054d2f33dde14401fba6fc689445549e28a61c8f1ca779f9632632ae5eb1eb87f4e3784bdac3d9780a5a90a78933cc1f4140b5b381e12f21ea5b9eb3108b16ca73bc6f3fd9388247390f92eec605ab5241f6403d41525a0116f096577aa911d44834bd4c43bf064dc2cf84e0e93fcfdd1f7f8a933b79f2d79c23673644855778cee802b2637a09a88139f6be0e464443459f1bef0b43cd19100251d9126a127ab53564927bb7ecfd0231ffbc59a1ac9c3d3f1bfc22a7f7ce6c47e0dc3b3979c99c7e7f32df48917013ad26a2c383a6cdd9f0ce1432f2dff1f198b1c08d178abc9225262639452c5f956986c9363762b24d5489862bb9d2e8696a547bd065a1a1788d11bc644484ef60061c69f658dfc44255546b741df052e993a0c4df5c87dde1b8baf92bd606ec3449015317e83eae6883da25683a267609e38ce86e492f038887bc7ffca00e25557734bd6097ca62eba55e9815512580ffb76bb4db235c4a4ea8f83a3873fa534cdff102d9f1e86ef377341fad88797ed0f04f74ee047727f3b4c26098797fed6ed81f8e55e04cdc69455979e27fe9247c02803e24b4cf21683848734bc2f776c82d8d869735ef1075df95a92bb278fc1a526ae4a0544a1e6d0ef164e403d637497141035696e3788df3d74fea7e3471a79199bd9b3ae8d8752c3579a4a8dc0ebfc6c4cb92f7451bcc630b3ef67ab2e92b0200c6d01cd4a48738b1bd42899da13e6f06a1eacdab64393226b8128c4408f5a1b02709ee8bc1a5268a79ecc143dd37365614f82f885e0f9aa2461dcb7338de4a215a320df40870b7aabc98839eeae92c1bbb195a2a98518075cb762f704a391321a90b8908ce5717d278ea0d55be018a574030da6c894d8bbff01da759401163cebf933d5ad46fd6e1071cbbe4471aac6b043eb83922bb9c6f261065f17cfff8e1eafe778de8e5a3df06bb526f44f824b341f8715c926eb5e37a23489b458fe80a177b8fa9e60fe38fb0e0d3425852153605026100b2aabbad4570671cc3fc7fa3f75c1b1b2c3b3b744654de5b1c155992ea7e676d6cbf3feba2afad077bd29cd0952fa039099a685309302a972b35b40ab7b0178bfbd7a4db4795b5cee55e5de223d12273fa70bf849f1455c65118b7e0824ccf28d2719afa12aec12b2945f23160b1e3117fa9b73dda790565f7db7ac266f40d72fa3d18db811352599bd27c9712a6c72bdeebf76384c595994e6b7b500ebc619396ba07f9fd3f9a15a323cbb3be6e9cf993aeed1d05ec2ddbbeb96c598a4d98f164e69754bfd06a2f5309315d2f2fd7b616ece78969b94d24d0cbf3c959bb15b4971c9a856a083f48dd241792cec296ae2f37a2db15ec95c4efabd95ed897863c50a7610db2a5e99ca378a9709b2c74c9db745d9b4d74456139ba57f3dafb0fe7b19961475fe7c8914973e88fc19f64f5224c63b4e1a5080f3a185c491e814615a60fc3b40bdc7dd6dc24fe161fa42f676946be156e6df9b62b063c5ad4fd226d11a04fa6283bc5d4b7ecd6df222d1877211c7565ff54f4ecf3fde5145cda1ed08c29aa7a2cbb1ac8ac3ed44f3682dfa2918756dd6e2444a0c9250eff53b118cd24181aa27a0e88cb5cba170735e652ddd4c935bc42dba1f085983a40ce45255f5e49c04bb40785635f7b8c4a3685f1c373d14d62945a34dfcfe1cf5d93c5f69c2d34177e28f3b7f1c1842dc46e9247e83e8b15183716f5954bf6509961fc497d79605f0af57e503ee48b53db35c65a6a4733e93a26958b4e81f34c39a43a91fc47f562fefd65dc18cd98dc6448faf0f88be9a09c415921f66377d7e44360fc0bd5477c2f31a26602e45ab4dd2f4cfbde1a47713e5065f8fb64525bc46239a27cfe5a2d201433fd9d50c4ae948cf423facc7c0365ceac1a3d9daaad845044dc6f86f78732d3eaaf455106d59e0c723c8b7fe4686af3de988ec4aa93978ccd66e7b2ddc469b2b7ca733d123a4cd0a0a4fda573f29386de92a5360d4cbbd05bd9ddfa0a0d8ef94cca4375591914815c15237551d10fd51b5602aa36f18c6912dd9bbbfa8d0ba1a30ea4574cc4deb9e9f58ecff9a85765cd7d6c7a69639230b043b2f42ec5157bc9a092e90e0e526f903c560dc12aede8ed7b99f6e34bbeaae38cddfbcca26f05644258cc5b0b7b5cfe97cc2e470da17da0d602a145d8e00e52c99aa30de9456413710f1268df6bfee8c8fb40983d00bdc55a5eb1523174f21745a511ca5203f4c12bb5cc197c876ae0f376021b5f63c720f5fc587e9716113a61c81f1f5865fa1e16fe8d4158311a43069ad5363ce7e5f067c075d3a96c9d22634a77b9c3de7a96737bafe147a0f875d2692aa636817a99cdc62f7fb8c197e79198135580a193d24d1f6c4fda661f8b41d4848957d2b353aaaeae57a0d7fbaf1ce240db1eaf113363b238fc56ba62ccff96a33d26e7592922425a8d2277fb0bb73afca48daec18533747f8e33cdeff83d983923fcfa817f6d5b3be3ea9a4ab32ddc916fe76177e50fa85e094bbf3c75bdac82b5f477d2f484b3b23582dcf45452444735195602c3bb3aeadd8b05f4407f2d7c37b73fa80f65f301ff5c4840508be7bb784d6caf6d7855c3d3d8be6231942a2f282729ab16463a6128fe36556d432b340b0c31f531e307c17b22d51e53b4da1d5515454f81d13b50b46a9a94262384dda082c4e6d600b2b2ff5390ec663c281ad4f7f00d9fbe4f08120dedda18381cc39084d559ace285bb7da5d130aae2baf4aabb270784714871077cc75f0275bb85ceedfc8b1c92feacd3986057157a8cf79023dfc6dd665948577234ec471c29f282b296385533fe87ab088eeeb578b0a5c9cb695a979432e1a7a3a392eb00f92229677fbdc2aee2b80d527a111a458550a82171846bec1837d7f0e071c7441c8b95ba1f1017eb39b0d4e771efae9b4672e69a894040b8a0be90c797a0aee5d4cd7c50efb3b64a4fffd0230894afb1877f7ee3b56a700b5de3ec2dcceb7ce1ee9b2d539337e6bfb8af74785b652de3cc02f5e37e83a668162a6d5526c02ea9246f4d5a6ee3caa05b280ad3ebf6cce7d347014d55151075db3681746e43afe0e913f9d5cc9e4305beb3e5f30b69bb2b09763035b1f80ce34b16cee2a7028f6a45ebb2a3b4ceac0dafe1c49c7dac8ec286945664ab458ddfaaaeb6f6ddf154e9f89685ed4185fd2d8c45ec09ef21aa73c6dd052a347e50d00b5d2960bbfb7c3e96fe574ac02bdc6821699130e386c6d50ceb37abb1ea216eecefa0973959751105cbaeef8554e10d356b784b4c7ae4d8411f3c08bc5fabb0dd678c220fa40b5698b001d205c0b5c26b9dd30ced979c55dbc1af87143ff2544be04a5e7ebb8005673b041fd9eaa4ba1bc55a7fd0b895d0888bce7d6c883263eed9a89707773a39e83a43f3f47e2673aa722c2120ddec6fe6764ab1f5a937b711911d11bc33b4a9efe49fb124b45645de95768b1e8f21341671e5a9d7e619d16382bd34f313fd0e96fafc1353814948668f5c6a3c124ba750f450bef71ac9b541a392e4f04a5f8c5263d636910555448f90c788348af6f2cf1add928f713de99c93687fb73e0a105d5f4784838b080ab30cb8772539c990edd61dd4b59d1a24d1e8e223f0c5065e5fdb7674464824a4ebb986618da265898ec73fcbeeea5d11688ac97677bb9f275655b8596c67848315dfae6ff4838f7e3788d5b16e0ba235eac01c4d9193bcac031f7a7d41cb69af6e3f0357e5b8f5c22eaf4ee53c2a6eaa4e997419ecd52c42883f8b6e020c6b48321af167b88af26be4d2e569f642446b7ef0c070d269cfbeadbac1f62dc0646e054f7ff0bc82de43f52e43e4dd9dbddcd4c0f0802b921d3bcb99b0a2a4145f30afec8b23ff8de2d10cccbe5bf4c329fc4a34496fe651fb653315302e202ae804a26ede97dc3731b80ba967997bf1d79636e8167eab573f86ea056f7e3e346f9ead21bd40dd6a360ab15322f171b1ec7d12b4672ce8788c55a8478dcd0bfbdb15c6f893e462571556f7deeb61bfca4e529e5ac52a1598a1409875fa9d4ee8fa815cde81ca2e26156fa58a2958b81712331ab3c60e5519c8e7b7c90de9fad3f06c8362f5757993d0d24185003e89597c94f50abf1b42fe7023f576e6412cd75ff7b13b943e7441381a2383fb4521fb767e02f3c90bf2125c6f5dae0fe04f010a900252531eef9df9d4e9c647aedb09c081697d683e788ca8748de8b3dc70526e7c0d9d09c6a97d908b9d672215476007cf1090cf0d6bf3608c06ede03671eb8721db49edc642db6e7ce9795bd37d7c1ce48a14ca457c56e685445fcd11f40d7a2987030d8eb8d313a10fcc5aa0db7af93c88d14cd816ce5452ad1cf7c2b638bdaead8198a6279686c1ff4874555b8210fd5d4cfe6c58ba22381ab6a70f6668f6ef1a2a5bb8d475dc438328bfe4a9f73fa963c74fea9d2049bce16d63e7aa7d626c124455fd50cd110db3a0e3f7e10f084a9bda8324fc8e4a58cad55c9ae0cfff2fbd6003449fcec30abfd81aff3d43cc5c14b1c2236210494de7f65073d0f2075ef53edcc8c0d22e19a81e52a8975daa032d0210a74fba29b9913216d0d6341b4be7e77e063f86a1098851422df21d6e746aeea5defea6036217be0dabe8d417e74a37b268ab8ff43d6380fdee82ead60ec8b53b9010175ef6b17485e14506d2e785aa83e48d741bdde75efa25ca72dc1bbcf94234e0e094cf22715d7f4a3cdc3484d1e0d2f6a521738eeb5e02c0844ab5c34d4ebda52afa1a0d5074a58fd62afdd61c83f035f2b4cf3e718850e7aafd569146c99967b3ee584b7e074af7cb47255d521b94b84e1f8f51294666174f89fcd50553dcef2fe4b8c4f03dba235ff9b60e31b1896e265cd92b2ee505738bd766a62fc5ee7a50a8f81e4cd408fb404fc2b56e2910f407c7a535bda43566b22831f4bfce76b1e202820477812d20aef64aaf9cff40910bf95e17681d3c0774fe1d7e07d88b25c1b604be0ecaaa4772334ec5bc344f8defd73afe33ca10ccf90144a68c7d541564bbd90921dae3d578f40f4271b6a666a06d6d9ac593893fd4bbecc7f2474b14719f1d0a3667cba85ff54ee60d74ca8e03cb1767b82d4bb056a5eedb65ba3fc7efbb196ca5da265de1314c1461cd113528109cb62e376e5a993ca0c4ac0b085dd9734fbfb1129f4bf34e092041d7ab772da59fa207b1572ba6947806a6b45ca4244117efbab546136c994643e960e61eed4ac636115148c4e733b6e8cc5586fc61450e9722cc1ffa3f8227129c2b53c02d5dda4913d626e909f5f9a0739757d6bee95676dd4ea6c0a3740ad07bf331ccaf636c814dfec8072f8f07a257d412509f92d946cf1cf8c57425f1c8b913c930cef6fe60352418647da20a7b7c6e49c4d9a0611d37ecf9772acfcfe7a3899946024f12ec2fb244542367727a1f62a4337d8379aff22f234d47821c0d011be594b4da34e93c62e66b1d5ab76b0a0dd9a1178d3cc598bf73db235f34b6bd8d7aeaa5128abcbc3499e9050cdce6803e304764dde3715c98c046b8de78bbd21c16ba5836599f96fad2de7e68ec3eff44356081cf6c4736ad6ba462d9465bc153adb4b9e77a4e502b726d4842f4161cc6725df0fc3a7c54ee42c6bcd4859b0b8cfd5f48977faf5ffe7fa5d86faf3a3a7c98cc12bdade5aae9708710f4250730cb281e4398917b86292b7be3515c7defda9f5f6be849f89bc2e88ba2b9bbeb5bc287cb1ec0ca577f5dd1ce393dbb6124736cc9f191907c0fb3a6fb5481a8fa6dbdb0bd2989b7268eb4d592a6519fdf8371c3d3f80af612325e1e861c04227b02728b7282de7b65946f9b15263c08cd4faea229458ff58fe99cd867accb47732b823d5617ba129050e0000a26566cdc526b9008fc5da106785c8be61418538697a75874363879050da3d95d8adc361d73a943cc33e21a1a86ebc99957f1b6ff0c965f45abafe4e346be67a81a5622f378b22101472b9cdb2a5433fe879a757d1226e3636992593345f27a9ecceb8596363a6b65ccfe2a5cf0054687486054482900fac67cb40a3b35fb62b45381a4c3b9b346153d9adf1f8997696d0501bdd8ed7cd269c1bdc84141094a55a2875b9ab7f06a18e266252faf005d7f648336b1e1d9922153791c37e264500c7fc0ec117ed353e96e0bd902d9c63931aeeb19dc3448de741c63783c983df7fb1889d60d7ec28917f979052af7a225541c95470ddc37664ba369c17ca9bf4f38cf01d8eb5dab990a7acb1e229aae793dfe3f6a838d27cec4fc74dc5659d364cf1aa69a50be7d07dc38a6568f6ebd8470b20de50fab14d621e70430ce00a69fe40485b131db05a761285b11ed8d0bdd34c2cf0d88a6ed5b699db69eeffa7537d995b7887732b7937a43f7c0d62a2586f174f45cfdefaa6ffd6a9150694ab6919ab8baf58109ea0678b4762900832fa278dffd56952729896129266c4c30a6c9b00b03ceb6f12a25f719f9f8d8a27cf199a2a54e6d2759b5884225d6e59a88248872cb9b0767e4799d1f72df39d7d6f2908574d06d213b2b47097ed03062aff9b1df41743b537fa45504b4a5b88a1727644eb2540ea58195a98d5c368a85f3f552ed090c9c0eb15b072821a2707c8238c9c9452060f09f1cf7d9f6823461d559ad8b8d34cbed4dd506236bbee6c5c89575e4ed01b5ddc6fcff09ae90a8ff255b680d65f3662a3fc9742ea60593ce2a6fd1bd96808de9d6f37014a3dd658362e232971a7b8680e31db2240172d7a04a8fb8536541fd17d261df387e24675efdcbdc112898d926741d528b20b9aae970c912bedeac951d38da52059644bb032687dc0cda257b638a6e6ea61871da7fd50697de1481e9c8532973f62f80ae35bd5487cf7620c4709c847d3f14420f0f18c2dfec60ef57c484b541909421174c7d9bf4d567ad04d158a8490eaf24f0f72833ce4ac8b2700e0a864af9d25a5116ef31c90473ce1a51b31c9175985a49f4ab5e056ec367669e308c7d9b64b092d555e1a0eca0f2fba77fae17b8d4560b27474db8cc1829b8b11b674b6502151ca7d2545a2b1fd0c6874a36512047597565b16e3169b083f9928810ca2f238caaf5a1af000579179a7b7fbe217de05dbda2b9cf1720b804c69832c0c0e3395a4d8188c350299445bcde1a2c1cf408d0cff3cf624336dbe9e1b80e41d8944879b84d7838ed0a4e0b43d48996d5591bd5b124c4f1516c5934ffaaa1e4d713c6034dc55c1941210eba66e654d6888bcd0000910033260747fb07594edf145a6eea092681c751eee214bc70a444d1f89cb5c235e02a1be8cf24afd8a79cdad126b8247cb4f104a1f60fdfcf0ddddf63480f387632669faedd2c4ae90ed4edc41065f31892b572b007f8e9b43989a70a6a1d479c1965fdb97a27c29f2f557c3ff570815870f1ebee2a8b92930f3bc7d2ccf5af9da4360f3410b832d9732e65a034ad9a32b63ce2a6438ac74d50bc4ebccd16890c7bd96622e1ecc06251f896a4cbf2f3546fb196a52983c2353fc751d0f5a29437f4992b02de681d91c3c40be4f70f8577882dac6eaeaf9a5a84cad517ec22cf29e374c4fd002a9c4bfde541c786caa782f6c5a6d88f96e78bbcdd238800d599636392c4f2f550721006759629019bc098d492a2761f2c12598104caea24024201237b0091a07fcbd4ec438b0403774cc58693999490f242f7f39f7215f0896d4fc95f383da7dc84222aff433c4df5f347e03f4d8b354914838c2d104948866f84c22b9bf66f39b604b089bda9735b56d88f14625de10a60dfcc67574746dd949cc4f2fc6294d93ad497425d0cd8531ef0d1805c768d586e60466dee6c7139f8bf832b7ecca5b3d9814063e45a763f61655323ad182c72ab602a491f9a13dda3fbed60e1f148982af499607f7ef37b68f7b61fe478fbc27c80d2cc470408e23d64ffb71a254643a4162d1d727356a0fcb86df822b383e5acdba2d3727ad455f632ccc9bf4de7f6c5c15b1f90acc5316ae2ea4dac83c61eb996dedecf799d687c00bfff698201ca19013790c9612661f8a48a5e580d570c2f5bdd2affa600dd4c37b6bad015f4ca8d43d6851c827afb9ee70657b0e1659815d084bc4bcd29e081695fc452b3b2d0ebc889bbde346d538b04c997f6469fd3f1153aa8fbaa1d53cc89329f31884327ee5f5bcf55a1b1d50ee5771c5f7095901a5b5fc6755e14fefcbc20c4b4a4468afde4a1ed025086fd6112d945715229e0d16d05111ef0e71c76495af19d3dbaa148dc65d665d1865b7935b6aea2c46ee74ea4b81caf7b8ec5d12796b82f55c502ae43e304160ed5a23d7095dd283f167065abb9e4eea98c7ec70ea17bb06833c32fe5bdbfdfaa4adece7547b7265d62db69e97da65c0f76de04ac6ba3b259a098261042a51984b3e06d93a4269a8e8262330e10261a584ccae2edf0b3e5bb9b7cdda7a053884a47c82d4c99bd49b5d67315e69173d13734a37c490775b90fb34346157693b799e236f154cd9f04f005df6a4902c19817eed1ddbe27eddad0d7f7bcde824f75cf0357101bbaeabd8d6c541fcef55abf7f8e91d4895d8254e131d7cf12416bffb61e9e27c21b08c45b7e87ce127fc14db6668b6eb1246a7b7367156e1426e751760f2a8f3e57916261dea8b67191aa1d9fca84322a9d50bfd98cc5cdfa0de77091189091f5878b8f92e60651990e0c692f1a89adfb1568f3c9dd619071475e9bd455122f9c29ec23ff6c265fb6286384f03de79cd2ece8e6e51b662c24cdb386196e459ed31aacee698133331d953843fa4148322d82a0ce4e0fdde5e12626ed4dfd3a31bb99347a12341a763de968ef97324f3b87a2e424ab05c7b4ba6c8abcf0c972ed48b8f0c3a972451c2ab9a789f3dc9988773ca4165f3768b1bbcd779972b31ebe88f6c37cea215a0d17e37134007b82b8e4b8d43fef84149b0e80b737b411f1f236f2f3aa5df876a88c0ea2cdf2e3d00dc59a67e487f08d3c654bdf49fdf93f247d193d7f7e3f3dc2136bca162661ded74249d730f71aaa15dd66891ebc433080bfcffd3a69bd9362391a09b851ec387688cd5c2870df4cb5f9cd7c7395852d813d36cc357e71dc82c1f45792c1c2a178bcd9f067f1b6de6573823333866692c09f184f188bfbcd2f21ec38733dcf5f7006b32fe84407130897544fb702a681933ab373538eb560d673924cfcec9f851cf0c596c06b0e447e224d467d699da7077c03dd0e9ce8a86bd6636a5fd78d727e1985775e4293a6fdf8d79ebc8518a7191fbdf511164a62bebead985341ababb96a577755d577ffd2bc8a10f9adfe61e01d60747056c4bcf651b5fe881c7a7d6ca90784e6df81913edad62c4ac44444638a63364e2e489de22b53f69200a87266ee228095db0f47d9acf0e8f5e7322ac0c0750f24b4aa45edc000f09e48a30c97e5b403664d9761b49768d4ebdcf78f48514f5251c72bd07c04111f8bf0b17497df3932f4d9d328cb939c2a36e79b2bd9dc671429bb19f8fed974b4e952671d962ba5ee0e0aee1f64fa5f25fe290f4bc149b2bc61ce6997cf79b3bc586548958527050796bf93f13c917f4fffbdcce2b300873e64bc203f791b82e54defc77591559cfa1ec8695e2864431b2a296b05c7833c68e5852ce1cbdde3c560ea1e0e639e9068c85fb6f3d489cf940f1f2ab570c8168456f750177d43f0aed32be764ac89b703c19a97ebdc4d0628f56457e3932d2216eced9af0efdf88719c30987565eb7234b49051155b9f0adbe095122bd91ab2abdce937ae983c784fd57d38bb12d3fd0d0a3a70eaafc3129188afba111ebeb7f9ecf096ae2bcb17d4f06d0121dc08b0f0c7c35681a94e4498ac60c0b154db20933aee049d7ad6029888ebd7f3b72b08b543ca7c67d3db30d6b7ff6d0c451349a63552570832ae2caf4905790fc995beae8ee72dbdf5d262259e242fc973d14241ea45d1f8331d320d5b86a993e285a421871ce2c73bc957e64ed1c1aa95ba290d88d1f2cd5df0996b187ef1cf33327d77a34269dc80f1079005ad280240aeb183e765b2a06de4c045f266117982a04852839c97c0703614632ee77194f7075b7b1bdaf56342e63aec4695aea055a0ebff1add79185ebc9a19c90d1dd1916979af80de8c809451924376f217d9f081f82a5a2b4fc61cbc70cd45e69574d220a21a201c34a38374220a511b89ba8ae8c888689d2555877ccc2cfe9f6209d6b48f84405e4040cbf7de50200dd47e077d54595f9ef84d7e5c588ba79cb2efba5b921c9039bf68636d7c7bd0fbb338840b633567cce9b0615c2fbec45aa485b7b57b6ff2d9865c4a760796d68ee07cae2112b215b55b267613c6cf10867841d620646c0d23f9b34b10705310914cb46650287a8b52f15c5a6536469c36845aa469e77011a5018a71cdf7d87f7de95630dfa45d75febcb3ad19ada97912151df3ee71c67848146c8aaa669b3c77d5915b5666695c7dd303360e61c9229dbde09faa4a6bf7e381bc4caebee1f60b968536e62e79bc86fb4307d7262d20dc3dba75c9290a23a2089da2d2e47e98310097601721f4af0f78a7fed840dc906635838aecbbc3315c55d33ee1177fa3e67d27e2d59bf3336f8645ffb3858a8db27ca5757b3d16f904715cb0981908c6cda0e8b1aa52129da755ecf6dcac1f898abc94dcf4f525d344495a844c2cefd98b880a063647c8b7763f8d00b335ce24a5bef3838ce1409227e0b6fe1c1dd93151c43b85e20d1d46448f21ea4457e9ce86e7134e527c890209bf1cbfb7fdfcffba60135eaf80526f3d92ffee598aaab562c4e16a9ef8b5da6dc5510a9782bf45f3b91cf933030f777d694b9f39d5d207c853e65cea3a37e613b33f5125bb4c209bc49f3dada8a4e0c0ccf48fd0cd9b1783498d3c34a3bb2f822dc98c2fd3c800e84f15f61b1e235e053802d311e27e3726d5c37cd6289e0e8b8ae7e17cd16cd028b15378d049a73a28d1360a33b7b394449c53b9881eed37fa191f31fea666b541dd581de7e2538a47a149f775108250b6a9a8a0d7696b3663f4c0c5e2a19ee9924d35a3e9586adeb25e5e510f16e74d079237516c5e3a63d92a658b930478e9b4756d6d6f6e5e65ee19eaa1140342057ec97f4209b6e518294fe9025c380b317fcb2006f23734f2346896fa738f9b9a0bc3405014b7007cf22567ddcdfaab242dad993a436ac29dbb359fb1f51cd43d8b59d775ec32bdedbc40eb66402a88529f475bd99ef8267d650334a54ecedbfc8363e562644fe470dae68e8a06354c8a34c5a006d89cd6f06aebde2afc665c614c7e680e89f9ffdea131a27cae2e5bd9ad5ab8b52eb7ad928cad14a0f9d86bccad061cc75d55e2c53a62af308c5d2a0b91e4bedeb065bc35413aebd4be0cfb37b9f10d5d90e8b116aafd4daf2a83ae9a3d70a016a814ded4f930468a057e56047bf9c18865d2d2b18d2986220e7c032e7a6699242cfe4185447398bbd5468d2a1d587106c2e3f8ba294a26cdb615663a09f013a445961f8f4a5dc947721008fd9a91e3ba56046af955b3dfdd8165fd430f6e355e17a31a19d7588a147801427f0128751e01fb30989771d36ed33a66132d7bd50525d1dfced1d7415b5ea7a3e6e6c47c345670532e828340e7fde1467f9e383080a028a529b2fc6a057c3d2297f9eccc3dcfa4434871fb0743354a0a6ccc3cf9e47674017f41aa8ca8fdcc8ac0e8c4bf080998505b40b63c25972694ae4fefa6ff822e0fd6142800ca563cb3a88f997f89e71771afdb999871009c132418d9287c69bcf5525d77f9d82ff5c1b1791ca36424fc403f5dbe3dce7d374533d8ce5f61016beab8ced3aaa9b21e1530311212dd1ed64e4a066be3208c9d2198a37c013e5c188240af24f3e76fb83ad5b94c0134bc0ed31c273173f858ea5a120bfcaed4752f74fab1a74402c108fecbf6b054e3c563f356bde09955eb45171b2f1f5ba960ba657c0fe331af5f23ec2b13102a143c1c717889242a3854079a8cae610c8d8bad07cd1892d02fc454dada166c0b006fcd8b86fabcf324cd20410bfe268e65b95d4de1ce687bbf01937f6248ded7fd2013795b9025f9d61616f5eb3d11c3095e38e2bc931c1ed62ac1a6a3b3c00c0519b8139e75980b4e99e8825ec71c03d3682785756882bc6815bcab97d8002c090c7052f33302a3262af289f4f0e4781fa38b51a740c827334bbb924c0685382bba2c318b36c7010ab163bd390202cb13fbc1fbb7732188ecbe0cb5a1e64572e81df059c5852ebd84d52e4e2b91bc5e72cf9b9c125d50754e0e1c51801adf41ce5c895ee1e7cef7fa00743372d45a023ef07a6eb64dc3556444fd1a29dfe4dcf63d3a0d7253785b393d6a7fb8be708fedec3722a1f12715fd231d3019714dcf12a8b9263cca9a086592689db43fd8d929d74f46da12065a483ecffa25e3fe5f27fe52e59f9b8d0f8ccd890204731dae112e3245a2b3ce7fc0c940bd701eaa6b3951714d552fddade0b0e1b96ab55aed50dd740ad3c9859cb182a95fbdbf9aaa790e064ea11b460fd525eeba460e42307807ec1cd0ddd5bde24cb85d16e0047bb0129d9676136810ce8e5f065085ee9c8717c79d92123450a0d26f9099d0d4d20c5de7edb0171a2f802cdcd616863be734cb6f09347071b4262e53b8bfb96b6645f7da37dcbcfbfecf97bbbfff44ae2917db75415908f1c39e03cf72d95bb4f07d47a5160a81c0a0704a06ff83a57a93b957e61e930a91d17f8a3c08e866e2bf4b7edb47c0c4d79363dcb4bfb0eb1c62ce973a9d246cd4ea5a98856a7d79930ad7cf1a59807d9082626bf387901955558ab5591ca2457fc01e296af3f233be21254b858cf39ba502d714bf09688c437ea24e41e2b71a7caf73c8876df016aae11deb86ff7e070ce22ffbce19410be2ae92d4a583360e560d9e940e08f388051a58576b08cc8722db351d3b52f1e9d3a165f4284b6d7de87154b7444fe7338d56f65e98731fb68a928e3216e6ba153154455fa14ec4b1224f4447f04e72ebbaca93424ba92d84664566d392a83f9b7102e32604554076a842f9c459b4f4813157a1284200043782aff52f5cd7c622a89f0a3fa9c38b644c3553a9f5ed900d3666cf1dac82731465bc54bf1dec19e4dcb9637537915485757bc1f984847d7d24e2502e836d65693f8d4c4e83e5577a6383d8aae2f26815b7ffb8512e2910e6903d589a5b42f20bddec821659ce910ba2157b17caec370e3c2dfdbdb6b1af4ac3131b16faddbf95f34e66857b40694ed1e00f3fe5506b14a6aca5f8c098c1401d5e2154f34ea679a97f0d0c8f816012ae3126879fba0c270d6930bed3a01ed2874ad4e5601f41acf7716851cf91f2f10ebeb3488793d6c41a7ee556cb848106affdceab2189df1fcd5746b4eb46b70c64ec996aa1bb26bfbb1e723920479c0ac1e353b243d075d156e41025091ca36580721c5f188d1583da3b32ed93ffe179f5ee218b058b519f6e3c6d5feb46fb8a602f5349e32265ea526c830e8e283d4a67fa57a7d53fc4de2cfcdfa549bb0e1ab572705ac990c137ec7ba590cc182511c9b7dc6f80fc88921e3c1e0d90ae6604c63ffe8514952bc21651f27d600265172b9705fbcd253792d6b3a6c0cca4f47e0013cfa87b111f9d9b30b1a4fc1a270651ded913e71cf4c88b60702db0880e47d94cbf253197ea6935eca1a93bdb393388ab3042211fb10e60d2852b8119d318bd6d53055576f82acc87363802d946d52a09a73ab5236ca13c83d039da2d62d8afa0912738b3a8ef347034f266e40216fca94b2b6af7a859370a54199aa5a522215e1e6398572a8f7b7e77d3d4dcc64f9c0c6d3ceae264e5d7583f8347f2d2726abc0c471bcdb51e9510b41070c862582c69dacb6a94790f76e36d55cd0ea7bd343c3fd5a9cb1ce4d28052987556c3198441eba0c6336484fd43bf2d3825710d5bf947ff07885f8f6b7186b2de885b0e48a3f10919eac10a255139c7435693a819f75428b9fddd92426cbad7e3acec1030a5acd4b13b11c05accfd9512e39525427b26f1d4829bbb55a2ccda90ae7aca99b762c45af1e5003b2b0b4e48a2fad3701feba18ed5173a7550bca1d5a8e4aa43d83409a2562f66f80fb52ea1bf1c9fabb20d4178be401bdf68b4a33fdc77d0e67ff2cc7bc6f46ff773a7d51545ae4790cc82f22f876d5982517a59a4d96e205ae191b4356b0dbd0687948c90b3d6c313130bbaa6c38085c87a52783589dfdf169c84facab549a16d7922254ee3d406049a83df7171dc5df7c89fc52e3ee654e17734382bb3d1e0df7eabdbde00368874423bd86efb510ff6064d95e715df699e62b141e08e4a5f791de31a6a7ee57995093b042318487f6a29cb42333edff5d5eb3e79b7638c60510f8d7c07008b6e5fe8652cf183742c0f5011ba4df1ab183deb7c2399f535e1be84d34f1294be6e385e730f5c3f4d7ea25efb9a72c97a367aaa8c20a736a42bb3b95c9ea24c37f943f5b510bc236a163bd6f3a7e011abf4eceb794119dd838d5443f47b06c7e5a03ee24bbbb388dff35011fab217e4b95adffb44b28a64f22cd830b4af08dd69fd45d60ac05f63b79b35ee8294b9dc0ec0cd131a257bc338f648938840c597c5001c0a7b4e562814026be2a4660bcc4d5e745fcf1b47474665333485efe223d6e7d03dcd3c5c01e68cc59d2c258ca33e0671541c39d5a2b6471dc2ead6ce25b9b931097d78cd88fbc04d388e0b306f549b56104d44390c7d7b573e9e78962020c77cc8a80ee121252ac398342434289bbcb3a26d590","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"1b369bd11f5284475c5e8c98736c9bcd"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
