<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-003</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-003</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-003">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d06e1bf7feeb35038dfee6061b75d4a3f4edbb19d41d92d8549f8b54357cf873972877f32319325eca5e495f4418ecf843c19eb7ee77e099b82de62ce46d8b1f3888e383aa583269815bffbde00a03f32c6812c27ae0f5696efcf8de892b56b05e5a4299d45930366e966fd60ace26090b307e5e6be37f3f44cc3b6b0e63c61f3ddceb5b573a521c2370b3aa0f5fe52c7bd75eef31ac39d5780b7ecf4fdbc2d9a0e87c01258fba0289cd2c6226d6b1aecb1382462a9bf76c9e40fb179d1d39c2e49e58744cc45b9da13aab4438c2749f7e5e79bdc1d55d3115801f215a9d37fbffbb5ddb4c5ca7e04302bfa8fd85452c9a44628115986102e23eb954cccef4393afc710900eb718deb17741ea1ac4ce601c94ef662d95926c1106f44281ce69d86e5674ee435ccf41c9263b62e0a70e9386abde440060c65c786de7a42aff3791caa873262d11a0cd08696e32ead38d135f8b383a0e4d00315de64d79b0838239530ca9be1a782020fb9e8a032ac8bf2079d941c54d5e32b69ea31533d2e45998b803e6e28ca2cc2c800debcea3a4e9122a0a471cb797f8eacd01721be7bf3571d388a930acb52de43e596246370cb3ba5ac9845d3cf2c2daa9572414d418c39e52ef2c4e66385221b3a2f07961f2e7d467e3fdc08bc81ff4701dc72b16703c7d7a39d37d37c493b585966107e72b854547d9a67ff08a8a3827b41e2cf313aabbecd022e0c90a28ffda6d7ac9bd6fabd5231911a891d2510c5456abf15990045d8b73ac1c5599e7fae75816829a92f1eded88bae160893ea2ae174f802912f23963767705817e1224542e483847c02e974ca3e36f6eb9b9901e5940246030073d729359ccd1de0e9334aa197cb6534c01cecf88797a5e5bc865173d30b053a2c4be02e83f999891655e51cd8f47a801350a304548afc1a4c3a18433a41d1640106421b6c88681c976bb47810cebcbc0f3fe1a2b87bc447cb9de59d459c67514921061d120de50dcae24eb237cfab59d8632860e31356b48a8f44361a4a9efb50cf87824cec734990ccf474b55a009660028191a8f173dbfe2a74703a7cab2189cd5c7acb9b03c95d400ca25aeb03a1666bf16e257cd0921a7fb28587e31766ee4ca688b270ecc256117bdf1b56863240bffbe2867fafd9ba3866c3f1ae8984fce481601675a69c8ef7030c585c159561b2342182a2f386ae94215672a07e4b9f1ee8b8bef3b56c5dcfb82f1a9288fe1be8c17c675d907ec71e73d1d2908a1ec798481e7ef7eb9f572d28e3b23d4e8da8e4267b6fab9ae18c09803a4c0b02c569cae731ceb032e33ab30f875055c8428dcbc5e8cb8a7569c7cb2eb198c3c081ecab8cf3998ff16218cb3ca17ebdd61d8b048867f2f8a5c46553bc27d71d31e060f5133b5f70d2d68f93a35559a5078fdfdf77ffa3fbdca9dc86cce331c5345a53a9815fbce321c9934a7a5654369f0d41f1f83b626cf06bd205ec26a55cedeae98abf2f40cbcbb40c3d1c2af274b4f60c3279e77f5e6bce34c19e0b94ed7281c218c5dce0a8db4a27061de06bed318b4a8cd14035a87380a66192f75cb0629add9efb44b0a82c67d20f525a4b3606b136984520c3ab7eafa59905d1d1d2dbe94da3d15098b56fe31c3ecff9e88d14dfa5cdb805f971b08d3344e14293547cde8c63011885999512e53aa7e18e1b8240d21dea93a81a2a87d67389d7c50c6ae1a26dc2ef2db8f211b5795aafbd760d6bf9512935efdf1944077be8dda140b12f29f03078013dfc6d32d0cb38028a1c13533296c4b39ae7d4391794640b9196aad1d58bbb1184dc2572cb7495c5ae1e36fbf363d594ae7828e59e88e08de96f0d7b75063941d923fe22519c29e508653cd4b766fc5a8d9526f4974e7a9769093220db4e940bd0edf451accbe7ebfd9798d0bbdb843fd7984d772bdd371b7be0f16b929769bcee5b3e0813a92d5ee2d5f5cbb83d117f3a3589d38fe3372299675e7adb0bfc56b92029a684c0739d646de32f35d4071c41cb74f83457c0df58aeb1bf213087b9e9aba1db5c883aab0a4a047c0d4aacbeffdbfcbca2e172d190cddcd23a2461280d819b022242559101ceb9bab9b3a87353c60effbe4c05844375cbcdda558bdf8b61341d9afd4714ae1646bd6b496c151cd4b230510afc73ca223d49abd4cbc49275676db40c481774ff0df27d5a2e60b15c8698cfc2ee68845d30d7db5e0f620c3f0299adfa66b3f9448c705a4a10e8e4b0796a6e9f6c0ea4a21035d58e03cc5f196a5ff04c413212554e7c7ce7e7f068b542de64681ec051de25e7748c02ea7178ee37e9c4bf2679b1e305b91f5221881cc70cc8b1ad4d580747100a530853261688c818cb9d74d32d650d54966c4144b9bffb104d17c3c35eb7ff253dde89e2a4c41bdd46915bb9d4eb64e21398aaf2f88bb6924c1fa5f5629c834126f2375150e30286142e02b91616f9a02e3b1474f5bb96a243771e10e10a6873477303e34e74a7ed1beff0131eebbdc1e559fb0cbb0f2fb8d0eedeab95561e826b6f2226595ed133dcfbbb252a9379f161da3b9d89526ebbda63c995816434625c73cb9771293055ac495d0e0b1b439e673b95def60cf5847d5e091b6d1aa1122d3b27de208aaf9d90d3902224c99e1a7f1d1e751eec68b2c0146f7a752f9cb2226996106691ed31e1d7f8839f82dc10f7f891022d3f72f1f447c9059aca252f91ece93a6df61597b1593f2f4a511925bdfd9ad9bca9cb7aeb04de9c6c6388cf4eddcaf2d56b4688b3cd5e7ca1f1936073ea2677340eb67fdd3321c1f64b4cdf144892e7d667d1ffae7c40abed8655e4fbe41003a9df119d995c327ac756f0f6f99cbe3ee3bff4ee4740600c33f4c9ca460118014b01e0ce3d39eb406fb780f9aaa89cc06496c04d2280b42ca2ad5fa926a79f789b0d7804ea14abc745df69594f31804d724eda0818d25372aed9b75320fe74c4c1fa5f80009a75853dfc1bc86937f1d7916381f770c2ad01840f9c3e98e53a5a9a858dfb49a4f1ca3fb17b0746e343ab23e0fb549e66ce39aec90d55887d2e8881868ba3f29200ef9623770a21d76bd733a66417d28d768bd7c646ffb828905537b297a3f0a6ff520a4464f286990e9df9526a60255a1cfc686e854bffe30f728c12d6acb7acf9ffd6c03db4f09ceede40c8556e316d4d1a8b3f92a61422e6e59cc9436b9e0851e977b9c9bd2919ba21f9d8b80d8785a1579ab4b957b8bc918c41e9c5cdb6a9e840b6ba9b5b42b46034ea5a85fb8177d0907cb185fcffe5405fcb3daab966204e101be34b0a5d30abd7fa9c65c65cf89084113089589c5f27839f55b97e0416d7e1b9f647fcef61ed467618efad510ce78115e72e86fea88be97185a70ff0f0efa10051b409856b2812002566c106604d4f527ec01d5aa16b86bf33d5991bee495a5bafcd03d50f2f055317ec2f6810093af5479e1ce4a0445af929f20311ecec06f8275bdf38e41300c87119010cb5a2baaf4377169b5399deb20d93e1a37f6b9a83c99fc92d9abe7370a5b36e0866fac2215ff15f0a35606e542cca1a2e4020ea8653beef3e5d64e5b841129a8a64526905fe6fce4dc65032a53fa2c2572a30142ae96b21d2c7720a773a8e70ad5e4e266235c1635b80d0f6509242a506fb3fe4bd26790a043796486e295c16c6a82b5767b67555d3d2f528eadc12bcb632b2f45db9797d08006996d28de23b989319fd956943e35393f6688848b5de63514d27c52abf0f891f9eb4818096a143e9d82cd5d9cbca9a840b73b843b3232c2cf05b73aef971559ff4d3e906c635a38ee0240c283d8fdb3489208ee00c6db11a937714775a35e97a254bb41d6d22f14436f04a2044e5d909fc00000707cd6e4fd68c122c0709a44d1333ff7f4f581f6398abb243efc522a0c6d6b222fceeeb271cc84c290f6fde61408846635f4f070418b6bb884d8bf39c6a851b1e043f454dc26fbbd43d55c4b0c7637c1838044c2c06bfc9a6c15ed6591c35a4ce17446661fb7c447119a8b4b76d1ac74239dd609224a46bd67117950d2276ca839867e05805d37795762f318b34c00aefbfbf93eabd35bd442cecbe9ef334dd615c2552a337fd8d1bb0712f40aa38571166d98e8680e0a3d155b5e254224dc90b72e07d8c6ca875a3a42fc7fb5146c3e401c0dac9c5e1836277ed75bd4e044462adc15f41743be694e4f24de0c503b28945158b56f2372b480748813f8b3714402be1222ad623f6acf550f6ac2bfd078b695d21a07baaa65bc7938458a887c27bd9f42c08c65a324019c74f4bec04415da3b116bdabbb6ca48718b070313d1dd5a9a36e6f8f0cdd4e666edcfadd87403641593d2d71b2ee28a4ccf2343bda82aabb896fd1fb44d3a06bf64d6addb91a60667a31ffff1ab2baedc1f98dc5a2443fd0220f3651e7a41d93e120178efa20229f61a68c22222d8679860fe4035c7dcfd8ed78f52922ce1765c7976928e54d2c4f27186c891c86e916ebf48dd9cd7fc02d0c02ced95dae8262f07736eb36a3700bf293b58cc035ad21bad5cd392e9a493b11003109ed2cf499c7325cdd766607bc680955c2276e8712a4dbfa847fd79244147dce4c1faeae7f91324c62fc577a080b29b93082476df40f6beaaa5560807c21bc5a97000a9e1abc78bb3ef7107051c46a2308ca5329c1d415912d3f7febd1edb283787c8a227bc8d63e3525021cc5fd4ac5e396b1e01df51683b907ff0d730e04612c1243cdd78afd31676c8879e6bee4a5fe1b17be23126bf4617d95352244c2a3bc013063d42e96b5b5346b6f4149d6836696f0a2165e7b825ab0cbb48a1e151dd0385643ae4e67c7a4a8798f4105660ffb95b77df6c21a443cbab2273f4f3c01e3ba0eb08008e60c1827dcacf67d193d0e5cc2275ee4bb85cd1a809acd2d86f1c2bcc05e84c4dea830fca94bd867cf6424e8db02b10ddec926467b981b5086eb52b24e73da300886ffb506c350ba95e4c6c17ac14a504f84f12ba07675cd016ea56d7d9365860bda0f81ef01c89dbd0ac5906f6f60dd0b216bc6d702a8dbcd6569a0af2533afdd691a8ac60cc1236517a2111e25bff22be4b960854e23f8e886ee1b9135fa35b10610be4c80b850bb2402e39066aa7d224c39d934a676372ff4a96224947d80273acfec462a797cb3866462e1a5acad059fc14cdc45f5ef4f9f48d8f67c17962cc2a2fa23d29bd91bca61622be615067e98201932f1f827e857382ca9bac1c185c5d404334929160e748944d62873ec4f4c801decea9bcc630ebf5fdbcb4f4c5a01ee7b341db20daa63583a01f8c985309544ed95727d73672f25f3241b6e9ac05d90a9aa072e38c4bed120fd9c496007ae87744fae4d932db41ae6f61b8295b698d1415aaa367006e528c46526d4847ecd9cc8f3f2df121a6a2b3f003acb2a8cf094a9aec5a946b889795a59fe260c41eafaeaef191b70f7f1fb5f847da9692d7846f6d5bcd0c837c9e6493050a0957e14a7947eefa98d75779c84541cda7956b6be1e8acc8d1396a443425cffecfd61afd8d5110b62efceefebf40ac61dccb7592cac99a85713b98cc632e15671ba7a12c67ea78e283b2d70fbfac9119cc8ee933c9dda844fcffba813d678f22295e43ad129d8ee506c1caeeb104a147b4448fc1f6882bb7ff6418d3492753f751eb567e38036d58afdb274d4867fefb97d2551d6253394619be2f3cc659c5aa9d436dec52bd693e5af7640c979d57651a75086b45a17cf2f7a0a923463fb12688e44691196baeb7c2ffe9d8fa1b5290bb03d8875baa62ca7a8cd6541d8a9372d9a2261989ad5ddc92629337e292209b1899b848e1108dcfcc1bd7af3f9f1b99af19a2dfcec8f552e587a2cbce2371f1ddcb6976bd671f049921c6db3d752e07184fae152005609edb1a1136212a1a3600286fae70bdbbd7157809ffd492aea8236e1ec9424110a084973f3dbfb51874795356a8fa1328cb5f9a07b4a601009feb4fe0a08f2c27be7ed616f6d977773c69da4b6fc1401578fdd2f6da433676a3241f09120dcd8f661496fe6284fd29f736ad09bd50f21617a4033f3552fc6a147cf12055193cd432cb08fc663e9ef0e5147f7b65a93d5a15db5ca3e1680ba0a14e4c5524e143d40e85e81dab137665c60b02b2ea5cf4b463acc75a5044662d2a98cd777f7208d130455f516d6176a11aa7bdd0f49bdcd1755cb70bee1b44624a4f6a124805feb238de81ec4167d0fc6f7652cb3ebbdaaa30d0d58c0adb0197a2929bfd6c04099878130492832ede8da1f8701dbdb18a87d6886f3d4ba644a84a3ce93f14c3e9c7043ab44bd298f8e06c13aee926be43d5362e7e3068754507f35028aac3893e7405c7d4fa5ff79ba05ec40ef01d503630eb0ee5e6ade3af15601bc7c7c146edfd45b9f6680268d963729c9721b6088cdea49e7da9abbc4624864659d5a4409709d81541e9dfe89bfbe13b0874be00147cd7e9e786f6cf526fa21dcf56d6541300101ca20fe0d23dc67726159f5b409c6d37b824d9b434bcb0ec109de8eb16688cc81019e32de72e1f4eef9e66f48fd4bd3b5a7e99e3c2b8e98b6e59478ac2d7d4135bf79a8fc288a07fa83a0d9b2c95e61a003eea549126c4c003c882c0c49dbfb91da64aa8c12fc9a1c7ceadb29d9a687661409afb6c64bd8ae85d533bafb54ae378bdc8ed80fda469a58aae14474efdea2c4c72e7829432942db71940f63cc74c4ee0fdf21fd69368cfdffec92843d85ccdb8b3f9cb54f33bd8233037d16a0906d36051e9736c1a5456bb06ba55bf7424c2ee4ee55918a09c14d9b51bc6ec80df32952a107df1f1acab1c5b378724fa07533a99ec7bc89c00d6bcf3ae63064b34cbce6ced01911d7c137470ed2b9d77dc31208ad5f658aac316301d5e35c73e6ca5b4c25b619b5dda3675eed6c329e7586dd964ae2740359ca1ebd0bee4e1ee70c352f49aaf34370b3209cbedf774ca743b289be1873c7db589c67a857ca13df13f39f9f0ea25a16cbebbef5980190af2d337a06a4370421fcdadc8802baf73953e826ba254781c2d822aef7be78fe02b523696cb78a074372bc2cb7ea5abe02334f3f4a02776206dfc46c592e1232eaebb3a22670a29fd8350fc84746b4c089e8190727ea1b4eda8a5e228fc3ba90702dd1b2f9cd386e70f9c4376e546dd8f6f7d7e3e50fcfe32a43a7ef5c1d3c1c53dd6ff03626ff2bef43cd85e10dfbc8048274c11e6a7d278b88ddd8dceb6441ec8c2631c6ec5147eac76526e47f2920141cd3d921191b27c44c3071b5587f6b8ff70449c2a89a47137880a4d13603fac42e8c06ed60fb1edc4a02f4d2b7d7fe82bb2cac142e7b2f99608f4b795ada44df64e397e931c553871906147c7203d41ccb6c5fd58e5a2b0e7883b8495d2080a290e67f0b608fc8af700828a45f56dc8ce21d9e5298a053598e5827fb321ee207509b421ba646c7cd71d1e65b9f2e44f8f975b1ef0fbedda024113a3dae3c2020ab049f9e23989495066d2ac2ffb3820b86697bad97de665d76d3bd39babff7b5a25851b4df5d9388aa3c37e73f88d69fe60e159683aa1d670b76741da69bf90dcaabdbcdbced23a4acfe64a62bfa9d16cbc765386190cf7e9f4aacc5061d1bee81600e16f35d3054b786e7848f3448d7ce22be43cb8fc7b09f2cb8eeef7f71c34528245d1be712c6d874d0b125ddb7f817f9fd97058d1d86cc634b2708d0bea56bbe985c119b6bb0884d24fec2869817ae9261462eb16b326132eac2af7500873b9ff89568643b9c863c2bc49117e500dd10b5b087802e3f52c2a159706c7384df3ccc262aaaad9392f73014985349d0b9cf421a54e258036c4a2f468890d8bd99fdf40ba574c7a2a9e0b2a6042920e66fbbcb44c0d1b34cc0ee623bddd9c604657abd3ea092228856d6e085e619de30f04a51112b02771b31f5917f6159b08b81971ba0f8cb0d895624bd3ebe1bebf186d428efe9d70ba656a56327c7255aa2baebd6a86baca9821ace1c8656c8b68c45007e41878aa771bd5bf57940101720790829ac2c6f054d760ed0bda33a14fb07d6e788e9fd980b0dba61aa48db004b24c6129466180d48cee62e03a16e21a4b50507868d84f2502bc471cc45fdcf5c4e03590a70d5ef3202b3909d06980a906c9faa2ff285d64f8fcc6aa6a8ab0772af4e7cc1a7b174760da3999f9af53ac8673b6017525f487b749ba5ddf9bd7884a2ce376ff387f1a7d4e1c675659ef56f6643086eead6f879e2cc9bdafa7de2aee1e1f8b12234a6ced697354cb77d7ec2830908be2d35e63702d76b53597eac2bb4a296500dabd6a7e8ccf69fb0d1ef25723af78cbe2c1163bc55b1dfd059efa279c6f305db56fc46454a9c494683762e43fcb0bdf14393c08455f820876589f653775ff4fd60494670c7cbb907ae82252d931ee86748465697a9cf910dfe1c57439d4e3d0ffaf8a7cb6afa26350bdf23e3426a5c1b8a09398be051d5434ad7f26004bae6d086a734bceebd9ff646bf1ea95678997098fbaa0186076b91bcfc7ec6ab4d3c6147a81cea1401b6fc16ecaac9ec42f3b0957e6383a6f47d00f9661d02a09abe776f8792fd47998667cb3be097585760b078b0794fdfd0c35729d33343027cfc6f15ee6fccf88e458a708d822acd37859aa79206abdf5ad030ca6246c9c8409ed2a4eb2f7b010de3b4c96155a57899bc47b48e83edccb5aa5ecb7430369d6953ede2bd2a66267653772f296bad040050635da3845c1a17f975c39fc89a4db5f095c030b2c697307735711738ecf5a8c9c65196bab5b24ce8c99b74208482bfe26c804ac943b905c174b0db5afc4b94da026d90507eb3e34fb74a315e318311c8ff7fea8e29544c7d641980c25f56222c653e59d71c8d830b62e88f3ada7666b2a03489123735fc752adb9f540b2e3fe381bcc1766b0551f121cd8d8c1227fbec5e16f3b5228ba864d0bcecf1ade18f902e2e4eda0088cabd5e8de40264c57920dbe417caa702b5efa1af06304be91e5d97f174972df438f880d155d267f58be6761869c0654f38a6220de5c6b1bdc8b1f3876bc79b2d124b1a27c65b0320a6cee4ebdfadf295f8a78835e002e1d00d931c0a5960afc42b5a2c59fcab9bee0dc0410b20d5734050eb10dd6360d27db8c2c7ed040715b52d337fc9db1ccebf9d4f79ba1cd7c51e35b0943b570016aec415358b462d049b2fb2d68de8ddc254ccfcac53bd9afbd322360a3eb6978912f2dc5ec3c01cf15c7995c5a16f2e8af3027822920fbe615ba8fa2a5fdd9aaf816a323f3e51c80a0fe4670bf4f260192cdcb24fa7caff20fa8ed7fb9d6ba542cfb4dcc261a1a5eadd9555d9f9cf185aca946282b5216c09a8ff36611b862d75475402fdabc522aea94dad1376e201bb3bd283453dd585ac68b5771559503e48c284ef793a3a3a7d56843fb4a26ee663a2a017084b59e6fbe4fe8e76d465d698830981a7e6dd901d6cc61143e86fc9ed4eeb6aad4002ed1d81af33d6a3013735baffebeed25bc7f35523d6ef6aefc3e3ae754882a58db46ac754e32e6899e25f0571f7f2e0fc0ea806b46a211baae21dc3fe5b7f678b14844595ab04f200475b6c78c56d2b56a145e59a787e7e82fe6bf941c252195fd61a8f1980e6dad05258b02662e8e90e6287df91d9395b4127863a75066ccc42bdd4022d8319033c7d036574b3f1c2efb9ae1e823c4d40e4caa2c11c03883a80d9e66135b43b821ca637d71d5230c5e10728b1cf3d19b548c443135ebd5ccb713e8b7553622b1b45cf73655bc1e6704a5a48fd2a099e61173df27b3c00ff392d1694e0398567cc9319e93d12e7375418d6ed5e8dbc0f664bc9faf2cd561af7883460f711532418291c68358626db990d930172a47c50c592d13f3e4e7d2bbf5ff1f2aa7d4acf67ccd10ede021e9e3b44434151c5ccafa8faadccfa479a27e66b036ba63ffec7c53ac3f2f71cc5f6fcf2b9697f2a01cefffae8ff4de01b9197d043646606d0dd3fad379237261563d74a6835c6ece0f95baa3f4cc1ad5ed81d57fdf9fe5a438a2b306a2efa135cdc132b1deb6a8e4708df2b7cff461ee49066c2906e90dc4694c2c4038b385c838574f4dfb3a098410e5b962e250be4fa0a8d371978cf2f7462a86013377681883122b319021c70f63d65dd9070cd5ef3276b5c2e44941da0eaf61361aee8c5da186e313975eef1ce2ee211b45219189893281b319c042749abe946578918533a1f86a964fb383598a8369b11ce9061eda1c6f78c6b5824fa9f0b399badc116ce3444623903361b825f65e8d41a8cd0a900903fb5969e7290699422f54914d949f8014f783c1832741fc7163baad2d21a736013e5296e194ef79abe6784e77b5a49b93bb7d77e9a411eb9c2a9e13f67af33b6865766d3ad9849b7a224c086d6eae3b9c96060d19ba60fa2b8eebb37b7f46b2a81ab0a483a5828e204ef95b13241ff879b4efa91b8a69055a1fb055a1ced0636e58f9becc0f4da2db8d914908eaa1f90323d3039cc23da377e5b8fb1ba9e68a1e0db2059e6da89d53b0e1a8421caa7f3df157d1fbebfef6d3a74410558b1fad2f280229003740777d9933b3e11507a8d6c0330346f35a239a94e3a95412a60a7620d51ab1e0ec95e32631686fb2c6e1d94258d8fb402db204142323138175b6625d80baf34cb93c0dcdf5bb98df62bf605c8494974c13d7da8d59854d65f0ba25a84003f109408c37313e61d3f9ea7eca808a2f9a88104fd59afcd8cd67092ac2dfce87a2c21e207b2110e68b27f83ad23be9b1c538eaa380ca9d4ff2317a9f7fa9729cfc841bc13e4333812151c12bcdfabf827696121a04fe3b531860331cc123c56915222302cbbc5f6bd6084f7364b60ccb54920744e9b1559efd2f47d40dbb98acb495048b0ac5dd536245b47855a855c3e5363a546d98fabdfaa6cc545ce48436126edbd19cfb246e80c31bd24364dd5796b5a73a2ffb6d3591743019024fd2ceabbee0a1937e5af881738805c9704a92cf0f42545789fc6efe2692d58132d29387263c01c1c5e3805b0a418a1c17a26198d410a9c36b929235a946d1207f1537fcd830ecaa4f9e2e694092e4ca164e6bb4e936a673f20782be26621027106d69cf50df76c563adb1180e7e435af854215e34d52e6fb2ed3188f57fcd5cfc786779d74538fd76c2f9785ca90b7993cef211cc737d50593a7c586b9371396f02258dc092ef1c6fcc89255757cdd04737b1879252fc6c78ac099fc776bb8f1d17dfe9ac0ebe781dac1d008b19ee1122053a352024537cd9f3c15e53a8bf72c5f01068bce9b5bf5fb665e2adb6641139a536a3dcac9834d09eb40afbc3be1ae87fedc41407f76ee571b82a01d14543c69e8e98f8ee5f3581f618134fa7706d2a3176e930d0d9dcac57e79378780b2119559543c3c97c124e18452c1a79fd7705661acc14df016f43645e94c51eb9daaa0691f23458505ed1ea05897b856fd450ffab4daa3c62bd29fa1f4c386986c826203d1cd05ce51b86ddd242340da83de27b3776376b7ba149aa4a5d8301e914e9ed96773aab5155be1abf294ac2081c806cf4beeae56eefd535c66fa757f3ef64589f70d9df3488e0a07183d7969197a5ee14e425782851de46085a1fc67641dae33be1d082e0e218071c31edd388517357a68a038fd64e811f21be23d547a5a95ed61a010eb359b6909ce25410ee96a233309576ca6b5eee99d9646d31b2f8c0457b8b10d5a02dc1c7da1df64162b515bdbb11e84bba71505a0ceda7813082b156eeb08eef9de186f9100296ce952a4d19e67b3cb4d463ad3baa5cd77b2ad15eda3d15d5a21ce7d1675504986ab8e2378dde0968fef2e458292b0a4a70b9807f18b7d457711a6682d78347ca44cc292a76403d12e1947ee105d2a50475068844664315b4385c53e7b32994699783345af748e923cb670bc3a3cd1279f5cf03119b77a3e570a579d9f31f9e510b93119cfae27a41dbdbcb76122975bf4f8127914997747825b2ce69cd04321109b9daa5436797c86a62960dc999e902e411a3120d73dc4e04df324a1f36d4589b4292dd1e154cd17199bf394e8d1c35974e4eb277e6a1fea8c5311b95a01787e19397c1dce6e8bd983caee266fb09f8a457af64a74e5e69ab243ba173673ac920c636d4188039a79c86b514568e4eefd116f76e97323db74730713f176b3d1cc0945b178a583d4d9bf3c94737e544477453960254eda815c085c1e362d30bf47183be8ca1724ac8e87ad42eeb0f5e41ca4f4d31281a9686eade2ddce16e7efef5a32c8bd969ddf408a592c5bedfb207c51e451380d6dd9fbc57daab6f677d3dd1faf73cdce5ce649150ca7805652bb4a0736f8970256cb45d598430edb5402f983d950213a00b93b19e62de16bc1423ba5a610cefe855bf0d7590ffd0d0afa79ca83ad1c3b0eed84928e4f830cbc5dbf936afd6a316ee1af6639e678fb73bc5e0d4227a568482a54632071c9b41a90bd899b4a146839d48e2b4e80f9fdf9ee3588e1d846fbfc25f04822eebdecce490c63e4877ba0f83cac6d8ab79a2a08da5eeb43549479e15b2d51cb3bc63fdc601f60db9a6fb17d838f37d4f91dfa0a26c8b5f9a566ca3e0bcab02991bf32318e5dded462e691ec830dd04f8394e98ef42522a119eaa64a7c9bb5f68307a085842daa1029423d463fc2f6464d4741e7fb1010bbdc2c92e6fe3a24e7a2d5da31d5e131dd4d793adb20cf06c2c017dd1488fbcb55ce52e92c2dd2c05e2fd885dc4faeb0de42c6cf693e6aa5add719dd6cbd5336d0a8c05c95aac8a8f643c5aa287f4729b146fa8d4c0fb1914834e4f8e598ae4c1540da3ce2dab1a98a9a6de437ad392cc34622b734ef8115a0348b82f042066de5702f3c81a5b521138a1a8631478236880f87c32c04628d6ad870a69f2ef879c1990a9dcc0d25b4d741b8799f57f729a8bd7e5e9ed750a7cac1d0026c6739a5f71f42213f23fabfaa0524896deb6857b6978540466f67e3a4cbec5249736fb23f22069565dfc60a7c9d5a62226928682758df17dc21b9abe8c33d7606f2ad5551eae6c938f3341c2c1b13491bac10733b14552d7abf4856674205c2d467a39d5dc60a31dfd849364d13450f631d087a550ed1098ba1d708065d91b765352b28820e4b03f9810250ec8251d864ac07b59c5f9e5cc035f7aa350510bb50e35ac9e1727df182a8858c8cb67c411343cf5444975e29c45bafbc2452057ec849cc73ba9b93fe0d29e5df6b12a96a23714e77bed320a00e7eaa484ecbb45974e59af23982e459883bed0baa326938891ea49387bf37590862df29ac31bcddb21f160e7388011eaff92019771c6a52bde445895e9721d7948f3c451102a9703d4ceeb57b7eefebe23b94e2461a88354ba8bff0f03b53f7307709624c78f3ab9348a2037d7d15faa45c5273613829dbcc763d11ae9d7d2d3200d6744b82db258118fe1abba1bf7591aa7adbb81f283ba443192f9b35063a360f6aed61ccc7df6da48167c2f9a3e5d660be76e7ad19c188190ab0cc448fecd3308e16f3d5a5efab65eafe8ef6c67e16fc3a40447fb441df8b802f03d365c1992c93416145db0e15e873c631bc82703a45bd0a7b6a50707df32bf0b88138c5c51cc3d7310dcbe0d607269da566b2e710c12efde4df3e0a912ab1dd0eb6539e2f01c98fda173893246035e5fb77f4578317f770e37f1185d204d117ba159677c016b77479bd97d9b306f4ff21949a3a237bbc7c519690fd7460df940b433ee5506f6870d4931687f89f8c9fcef7d3157bd7ba8e51fce0c63c140d65f996339d18a1daa64b79a46577c5075944766dc7457ed1308fecfb966f69e2bd0b31d8543d939c92337cbb4af4c5c5dfa60a483d6bfcf7862396fce8038adcb0fa98ba5432009658b1cd548f5c6b2a09505a5c6edc79ffbd260c00ddd80d414f2fdf906dbb74e01bd7bbc7f5cee6b9f60b3c53f5c3b84e3f75b0b9131d3b4513f8767d1cc8ca536ef998dc7292966d32250b06c4752d7f46db41f8176cf8e28833fc896daafa6c7a13ea450435cb3da246545eed0ae03eaeeba56c7ac399d26e004b20a42193488bbcc20a4e807f7052dcb3f5b6f789863d3ca5e238de12c5bcb562425e475e2b79816f0d9cb66ab176a2950c91715809824b2d8234527834c8bcbcb7d7608ee30ce2e30f958eba681dd9fed16f7a29aaa2820982c5340908f241797b1e60f47b414d44791484c9a7c34a71e83d3c8793ed428c69daa8024aab18cef2e0b6fa8ee1fb461e62132be35d26a387d643edaee1053aa7698813092611fe0f2a542623ede3ce45270232f29b71372f94935caba3d8f60fa41a68cf474e148443b8dc78bd65f31254abda844af4014e0a14bab23f0cfdacfcff603a00cd79fb10f27b287edd2bff704a7f615ccf54899c0e6741e52512056e719cecaa4b83ae4537d5d7ac09ad761bb6b7c4633ef29a7eb7618ec6c79c101648b4cc415a562eedc9c0a61509efec7b099cd9d5f46e4c3e730a038e04497383dc512b14de8edb4db43115ed87e954f9455efee5f78fb077cdda3cb3a48010cfca0176a28b2117ae99f2480658bcd57ab982af3b53aa9f3c3aaa1d7355b47240fb2ceb6394ca51cad97c3e0c27cefd843f2d2b7e2a89d934997d3879cbf071180d2040b838f431a779e70bfa94b702b2f13f182708c6a36b0e809c10971571b890b4ad39af2b758d12088d3f6672b3d4b55889409fb381ac098c5602c76d65fc59f285d48fdde1533e8912734a63c7c179d6686a74a015e1b5a915f73160a0ac544f21293fc9fee3afce830e08995941df2e15475db5795ca15cc79fc1f89c05f7976685ed795d71658267edb7a046ff1aba7c69bf5bfa3e0681048f7ecc8af931bfaeba4727a5b2ca374e660fb58c621ec00410df3856620f29409bbf8eb096559d09c040788a8550fae8c8cd649606a088f0848cef274c47bfbb0f37c424c88cb5e5bbabbfb75e01ceaabc59c32d42a08d261258af182d030a77afd1dbb7caf254d1a3a587d6f976c2c28ff4051758c07ade228ed795188a6fde6733d67ef60e4c4c8b3c075e60b30099652d2da6e041ceacdcb93ae71f5298e72426cace31e0d88c2880d26770c6687845192c021def8a599c5625460ac7eab125d9f8e3352efba4d12693fef7cf66a696e92d1b8d490a599f2386b4032e8067c79eee4674f5df9d811e7806e80c163bad06bb70334a8d4c9e0110b461abbc42199fcd375e8277f224cbc690ea5027debf51f587c6f59cd8ff0ff9c96976ab6cdf6e63b6741b9a24dd5511a60a22c32d35751107cdf1bb330c371b60477968984e932bbfd34bb1857acd1c3cd998a1f6e174b427bad405748f66c44956a3924dab094d0e15b4023edec15bcfb562fd480bf6cc3e7da679ccd7b67cd2436f9ddee579b7d4033543596fc45980d3a06382e8477b2087ee99aa590e205678cbbe757b0d257d8f262fa54ecedb8c634eea69fadc926bd6bb961ba58eb81f7a8aad6868193ebf91f4919a02df242a072ec9a69b9151cc78618e0b383827917c397ac15f4dad17c2a65ff54890a5a277e091c7c7af2046bbfc26e42e3969934d8f4b9a8a6d6e47494f799d252dc8f3d24e490bb1ebbc93ea93b6a7fa4332254751322bea0562603d79031e9fdf30c88729102332758281f78727a6682277f9c9f8a74c5a14d10310bf3c662ec2199c5a5b6706a5f9700f5070a143c616db89021e01ece9ed0492d7941b9272d2831e1660986ae3138f70cceb78b2fd7f287ec2ee7bb0b3fa4981885a631e7e278e5b06552f0aaebbfd00e9a6684a3f8aab9c7ee21ca1ba6e97dcbced1db29be6fdf159cbb41addf442b2507b9c2b4602de73b4ae21741c63977743e709fb3241729e323db2c7cefb024d5d2b11a6696176fa544be6c85abe9163643ed1e7e31f5917c03f51e6a51f8f53ac4072198067a33fd492279be0381cb5b5c3eb6fc8eaa722ffccf334febff8d655bb5bdae446c1d26ae1e1df1aac8eedae4855762f8e9f078f0af9a2a20f72dea6b40a0075c2b899d307a8f72f482feb4a69c066af379c89876d29cc3451e510476aede54334ad5c4a57f77a19c4f8b2e1e86c2ef82baa2f44fc3f557de3ebecf927526aab8616675930cfb677a7398609c948423f5924e5c9846293440b52bfebb7d485413807035581bbd70135bdd23353e7634267f40a7021bd08afdba95e9e15e71a42ce07c2b7e557cf5afd7a777f42941a25dc834e47e229da3ae623f7e8b58eccef04f32ecff16b959c5125204f9923482358c9906a055e7233d79335034d478de918c0e3d6275a229693008d074553e5566878b5e0503e8e34c84daae0e1bb4b3bec177d72ef1cadc6d0999c3d127988dc0319ce3796e8b516fcc453179ab7a18d984a51a15ea2051beda845bf48fbaaada694755347c7d8247c14f11a3ce490db86a3e1b37163acdffbdd45cd703151ad58fd26a3abf30bb9f5317c7d71a6fb51373481dcccf232bc8eb090998b873b39a43405e09d8add1a7bc87e8ccc5d7b91fd4a4992aa98cabb92af83e9a137071057ddef5f17510533e514c61c6f348a8a01e0b84cee9eb80817d3b7aaee13759746b3bb2424bf182055431e99aa7cba9c1730e8bd4705c4effd6130d9aaa0436529b36d432e08af20084f534337c7733b84e8d30ee449550c8cb0cd62b5ed079057c37d66eeeeee548318ee556b30026254b18fb20c334cdf4f8986cb06665ef79298fbfb79503de1c7b175c2474a1b01427995e304ce3fd0f714994d42af93851e914b3f6cd4d04f8d90a76a068df336336355e02fdfd020bab5b1a01e6aa51d4b36d82c241552a134cd458a94a57d137438d50bd3baf9eb4be98bb10a8086105f5c74c5060815927b27e20fcdad4dc02a6be22f30148576ceda5f18527dafcd4d2a7a9e5d9c0817b31358a295a61b06fef98b11aba1451bc8a420fd980b9607ab35d49bce625f4c9a59eac9117c4abb1a61dc93a6fe8caa45c6198cacc9edad7fc59df756824bd535438d8c69805b8649e970b9aeebd59990ab60fda11778be484da993b11149d9f37962d793f3cdcc2efb0139b1657b6dd41248ebdb2c805ef68da0de8a7c5e60c89680e34fd16afe16530c4bddfd1f9f24da54b6c115373ba6f1b018aa58969a840b4250ab73f8e9198dbca80b3d1e52533e271441384c5ce083b19ae1dc6bff1c828813a9be339726807ac834fd9570234af698f062300147b80ddd74a07505c4d078e1788eca798a1356a6520f4285cca15f6039326d5765ed8b555be7d4d872e33e78fdebf5de457ce49117d40a266375bee2a016c0801fa3c4696697759ba4042a61a21f699a57709e89b210322f15097d01bd4a2d5c19e4cf4137f30ca94e5b591d32a6c76b5307d40fa17dc5399a8196ead06d2cf42c0de9284dc39c4639e39ff8b9c452cb558589d4a25dd674514ceaac3fd8a73d600778635e55bf942f5e1c7d0f3bce9116a65e5ca4122206c0feb5d232bf4092af2c0a127d706655087ba168f16a9a934e7077c131e1bac078dda5555f401fb30ac6488c41a04c575cd03a111a152e1ed904c7d982d07af650dda0165fc5be59775d3ccf5a1a8ca24e0cbe513e860da2b3a2aea71ffb704a36a63355b5d58489903f882ab3503b2755a40f80fb7a58c34d523e6d245dd218ca0ba2cb9f12a1cd9b597333ecf78eac2894e4180093f85d62866712d239a7f3e8475165abe8415f29ca38f437ce2755fcf1640be09b80ecc7559435259e51a5f4ec689459e16ed80a36b7ebc1831a0c92cbd4f5ca8fcb7858fced19791ad2614dd7bbe98bedca14c3f68e109cf53b4d40883b4ebded5f51bb356c0d3958f1309f99990c14c8d4039acc6b07d3c4e05663e6f6bb7ad9f66c0f3a971635faaea07b7354ab94dfdddd796d575e5098d6626d73d1926a6e74f9041a6f2a016ade79a7d65394641522846de1f0fe97b4f91355372c83b66c36efcb7c9828f9d6d2cc71c59b4dbf05bfbb27ac8fff7c8ac4f21c0ab1c622f27a90be0a6343fe99c73d55b313f19afc440d8a3fecc07865df6ac812f31ec955791cc9abd928b6a37876277720214370d8cd602d4876c545a81051e0c68e910aef8009756d34f6ee327155f22fffb8d966c11817257e7516437cf4cf389ea61158e115a4e414b6d6074dac3ef061c2a67517ab7ba9b0dfc068632bf52aa0c3be4c115959d633e6ff675b8633d2898ea9fde044df375211ed9ba1b142f1a3c0922f21e24f844ff395e65cf48ad6e545d58d4743729c439cad76ece245d0b5cf21c5898dbc6e7441d4368b153123aae6c6594eabd36518993868d8934328d977a632eef4fecbcc47491b9a6501c25d12ce25f4ba56a6cdefb5146543154cbf453a431118aa60f89dc8320782bdee6cbc23e5b978e8b2abd98d6dc3b162d165c9f094812c89ba5840962eb2f7f3c669faf4db0f1d41e14726a4c91726ec8e48fe056b7fd303562af5aff5bd0af43e4b4a0dbbd0693f541184966f84a76d6fb13469a2fe3be16536e1ab1b4451ba436e6f3700efd91563a18f727b4226eebf347fa4e0101eb6989910cce7162999e726eac62a9abb25361e2ff6cf48d661803357a33c522f80f3ef0582cbe61396d6e19bf6f355a6566f784b2b783b4ae561169f551908bc600c07e2a56d234b187356aeca898b47fefa90a03ea277341c450b4696b51b3e45e8073346d613cba006e3965d49e7ef0ac02022420a47432359f2c5ab52093ca64507042b9e9d92173ef343045695a60eebdb3b6078e694a6a8f322641ced7c8ad6f0ef8aa5fd40e664f227920a04617ee350681bd2fa7389f64c422491ff72b81772a561c82f6a64f72f23d2eaa1bff3e65dc1a959d4fb7571671c064752fc25f822a4c72ba9e07b7ed5aaef63c31ee8fbb651834a1b5fd3b77460291d323181d2eb85c2d4670f3ab385ab3ca3e98315e6f1bb2802bbedc9cf1f58d71db32bb004790c03ff6e1327d6f816db24f5d252395e32f939b88b8c58d4ee3dbaaf30579486b19e425dbbd59e6ccbe94e1619a0dffd6e647819f1be2472078229169f2da65c7abb62473eab8daac02f364527e423e5677ef5c373e30c638f034d98672c9865be21d71758d0723815275fc518ae1702c1c55bc2036a87b6379a0d0084a65cfa208b9623474d5d53503a90c10611f3c0958f9a5e0b3ccd011916d9c031c2b026e5b682792d0151dda3ae3ed2f6754a0cd615434a218bad81566b43d59b35c5ab99c23d4a7ed51b9916c399e7940cb49d2f8c26990e7c0ba02c84052769bac3649cf261eb5afb2ef2e13aaadfb605b05d4902a8b5000db0c1072738ff40b2153b95da6f9b0395dc6c849f81afcbc67bf63a0a46d471070c527b1af3c1183a3d21819094f9859323d56d1e8f7164ca68833a7d43c720ff4432e44d92495578d52bd1bac9532a46d8a494823ab60567851e511700a9cf1c43a6c1965d82b76f4bb3626a49b73d1710a72e0a0382b44a714a53706ec4ae01c68ca7c185cbe6ac45905ffde4dffa25ea5d72426b5a117927ae11a53eaafe7958d64a9d1100040e57c58e893cbd801c48ce3382c4e001a90e4e0fb922e3b190c8c7b49b408f57eb4594bcc5afaeef55b5aca6d668d81fdcc29035f7363d956e04f6e00dc4f2e02a376879a1c65a7bc4d8d91878bef3c81431b8ba0867458e93a6c7c50fe39925f6b38a39b8a33a6f6f10977207d234db3838e2ef5963bbeb02e17d9ef79f1d1f13b5979ba544d6118de64c9e0df24227c323b58e759b3de1cab19a036c902cf5bbd47733b4e601335732f7e2db2ad2c35102189c76ade056716e34a234c22e3e928cf9489a2df50db1de2557383ad448bf8ef96a66c1ab5e20f21c42bd00aef6b28871bef2e4fe15cf38e9af91b52f2de08d516fc72a4f3b24ea5364c0f89649a867cf10388251c626ef80ae8aecb03326e08b3c6a061270f3bee345d828b6730364734811fc898d1dfe573cd7db2c8e86e84b3899d0a28b5def8b3c423536f0f3de25d5ff2c5f992ed007a5dbcdd089f7016e475528fb93988123ca0c16273e2ae98cda04834b408970a35f0d8cbc64afe5d4aa2cd2561e7abf0384e1c00952b3ba1e1a9f56288fc70c981ea18328e95ad7d197ede4cabce32434ee3b53a838c90b23ab9ee326f7d69ae29fc766e42e9d46b52f5ee2e52d7e3f09550654d220cd26fd25ce008edbe1491e8edd8c1a1fb1f99eac521b7bf9b3ba38c6789793831f87e86efb2e74decd50d26bbae603b9185a0b844137ddbeddc939778fa00c5cc080a8d8ca32d7dcc741fcd259641e422724509d99c2baa03d04abf616bcc16552693b2584971d858e4f6d21d7f76a07fe69b105d30be458c2873b16691bc49f90baf368876cc08c16b392eff140ed9336ab7504d55b5fccec6b8a0416328512f01bb0e8b1152c460798e29224f2d2813b9741946e3f51c40ce53474d2e6a5465dbd50418a2272feb4c27574b80cd099c9ad06ab3e51f9493c95bf880bf154054f76287302fbd497470367c69a6358f5ea3a8058e24e0f0a8e4566b33bf38b38e01c4febf8c169539efaa07933706f8d0b0d9a0ea68d3b1d9fd171d7a48751b00f10e52569ca83c307cc06c2e3ec9c16420fe3d1f9273fa1b3b6c704c909ff7814c91b5614789db78795bc70530ac31df802b20ac9679ad96f81e3ce3bd2b7a02ac42b2025173c4157064409d88638d3008a2f099bb6e2b02fc978a52ce3a879741b5c008a6eb8738512240e9959b35622c4cb94b48efe0df5e03da836f327d08ced9c71ce4ad0178da09be71a2efc8f2800c14be3b94d81ad1ad901a95974891e68775723208503d3dbd98c301d639812e3eadfdf113447c024ed648dad5fe319b3606ebe5914632e81f8747f37f8fb4cffc4992f96c983d3dc0910bd05ecffd629f59d13394419a2739a248c7f44aa10654c64115e4b39a5d70d582f8ed2b3cf2f25ab6492641e1db6c4bfad0da3d8c637a1b33022841c54902a76958c3cc2a500fcb1264159d18f81e71a5f5d41e47991d36bd47c0516c4bb095c22ccc27386faddb1b20a8b1426c2384dd1f04d49c6df5eca61e775ba9fa96ac79dfb3ee1e093fa0956ff5ed71377c8282d1d1fdce5f6350e8c9f2d638fb32b02a62b8c726e09e557c1c3b74b42bd2ad1d00dd5dc0a76d7844196acfa37ad3331b33206d603f8cd789089c4a7d85de14355f20f2689d6bdeb22791b4feca734751bb77854328197d2a2a65e34b11e22e40602ec2d885d60a57c57dff2b618b7dd27611638e93ddc1f699a5a86364e59cb2554bdaf9124cb9c9937fc2349af375883d08a7fed8b93a80221ed0385d35328001de7168c39646576f79c98a0078c78aea36349c6ad28f4670f4999d09ab6208a0815ce7c082b63a66072c5d777cdb154fe3f24519e72bee7b5ec0d3f87b1dea2a4ae2ac7f4f0f2b53d5e5d229cda32049573fba5366833635989c83096ce12c658f106606993a5e7082ef8cf39ad4f56ea87cf7ce70ecfd8e10b425dd712f36593041fb64950a2cdb783239063323010328b902c7931678efff10e9fe80340b7d53c225665cff052f3e1d5f270cc9c2d5ec32ec82345ffa56781f065eaff3ca88afb7aca86d8282353c66ff1671a34968c6620887e24989fcd420fe01d418d701232969026642e2ea9f13242fa53c4800e5ba5277329b236ea9c8a3e63f1c1b9d49df977029fb56f4ad0499be3986d23833e712d5badb2abb87553d6618aa7eaca3566828caa93f3285fc9858ed85ac5316f1d1bd9dea0bb3eb171f0f3bf068de92eed68fbab0bfb5208e8465a33e90c8437b7b5a633026981870eab91f517bcf3338c7995e4d0a0f68d6790d7991aa9beb9f222d1b0c851e9f2148f8ef35c3c254a67d9d71ad65122eb9fac50c939384007c7bdf51c61d609d07291d996ac8c5255e0ca2c15809769e80a5339cf8227a0a1cf5836f7b87e9f5e8cc4c0cb9cd4549ec7fe58755cb38d211ebe225ada363553794e17569e299e7ea0f4a02f866c8e2ff21151fe973987b7515276687af4108c61b148d42c3ed94eae2a81d05c58562c0acd2d457a846fd34ea22f20688c9745aaf7b267466b0dc9d7dd61f1d23aac6413267c3a14981e4284481091fe8418b1af114a3ba8f3b47368e7a77ad3feaac1cbc5fa7fa467e60ae78da301314e22aa2c4801c4594a5f27ceb143fa8fc9bd3eac9b5af2b60bfed99c972b9832e8f08e9bd6b92398605a24c6bf15b8aaf51b1d7318c482b787fbaa666b122084f5396718aa0b41347047d1d7b564d629cc59d636457eac7c3179d760c211c2bb3a8d5f426df77c0093e72842a4a58c88dea0ccc080cb21c27ccf0bf324b1d574cbf1af24f2d8e3fb11bab38606edcecdef0fa55ee23e533586e6bcc747e599280f483d1a39e1397c6e49cc73b508b2dbadee3ecb6e482158bdb294d5ae7bc37533643ff77a7e0db2e7c463f0d54dd008b32bae275a830f461d30b7ee3041de08e82cfc5b8faeceeb3648ff4b7024a2e409143687c7646b2cdf324d2e8b69abcbe594017370632fc820f82a5bdb68c13f866a305c245fcb026ffec338c1bff6cf02f732f199977f5bc0c055c26c635b5308c68438f07e4c960eb3c32376faedf2d1122c2e9dae99fcef77361e68896e8c8857b3e70895d9d87a4544b09da7c41e5e2adf040902f1ac548d5f095f2db6edca852bba1e6e027253ca181eaf31f1c7d5c547e448f6719a310c183b5ce90d1610ebc744647167d64884c0f746c55a41119e1a3394cd66ffaa7882a01ff878a581d4ded4799e63a98d32a24c0fe5318574afe7cd4637249dd1bf2622216f2693e3c887034aaa1712921f4037bcf7e4a426f7d8b7852745983d3003a7302eac63e3c4794bef6a1887b66c3b6d821dc453ec65d7c54b58141f5f58f589865e02be30b6938ea1c024b6ddeef4747a226a81d605bbc671ba664e35be76c9f17fdcd435a08aad8f0ff7e170886cc11ca7ad52cfd276fabf8ab80c1835af19e0b5a83cb9ba5a46614087558cadd427db91ed72d229f9cffc1f43cc714af32b6886b7e5566cfa27f2ec542845569119d7e19718f0d0dddd42400fddd51029667289c805694fe80a3b7ea82264614b962192dab3381dbfcc08c9fc3ece3713b6efcdf679410f6375c229b2d0957dd7aa8a39ffdba204412891ab5f4641dbaa492b4c3d1eb2cfbde359cee20c4acf8f9332307074cc305c004fd2d20cbd99890126ede74fcb03f895de43ca947d6e725f95c0c3a76f9d987111bca2","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"a867ca9e98ff303ce496e6aef9fcf8d7"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
