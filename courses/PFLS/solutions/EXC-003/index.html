<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-003</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-003</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-003">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"44ae448e57e34d863907a66ba5900e1ab037761de598dab73c294edb0cf50bab3cfe8108ad53569b4b0b5cef2377d7d33bb746290375f9ade9304cd8cd416247d0e5198e6992e2c1048fe621798905e58852776b61aa0c9e4188833a1e4a0d0e94f55dfbf8517f3998374ee6820b4a04925d990bcca397aecd619d06d794ec4d07d67fc6f1c266fcf3987504ca3539a2d98a7baedd5fefc29b1217a7b5cbe8a3915ef1e47eaba2928732d435a1596f8c87e44118135767e456383a8276f09479ddc8a2fd266ac88bda53acf8ea0d15d75ee4291f37f2a49dc25bbb795d915ba58ea4e1f57c5c93a089d070fe4c956143a2e7bd86b491af67a777d54e3b28a9f4ac88461979df4afee6535e98023fab60755b5046b754b0def03765e9dd8d6cf7615d4be0454f83fc42791491b84ed671746dc0da186481e2318343a0166448f26880eeac89bba6e3c56eab530778f5381000089ea8f82a7624647985aa508aac7c4e7d4b139904823bd0af2ef6e83209bff1cb6a71478f31cc2c464496074893309b038d352b5569163448fd69b814647cc9d83114ed9ab0bc77469f56f639f2972b69c362bbfb0f08a35ceee81b101076bc9192b5a697c588c76400fa1d9105745cb0f10acfcb0cf56900faacd2d5fb68b4bbed906369462cfdd4a366a743604eca718bed08d5e0c001abd0f78566f578a06f2e126a3f342cfc91429e34e117c47a04ac3dbd7bd3844c560148425a48fa8251d53668fcfadadbfdef2c5783b685d0d5635d3a5c18c523f7bb795af2e5d8373ea318901e0bfc536bf5f8cf941652165c3abb16cd5786aa3f13be790bdb4ac97b71a9d4846f3b89354ac92a3d3e02229e1e524d4675824e7f8363610415b2abc0f6f9a2dbfaef9605170a65b18d0191edb69ed913c98c25ddfd52a4f52bc5c1ff95e2482b2242095f3d9eb1651d0912adda6cd2a7b4c1416011718bd2cb74e8b179972d72cad8df8024dd78e3a9ba44bd5a33d292917903558d70720c4b0d7603028f0bbf081f73d1c98264f03b280dfd20ebae6362549424cc7b118bf207b2902c1ceabc76bd28edab3554a85867f2cec7bd6c2385783dfe3e19cdb41d92e894a72d9fe948aa8dbbbb772c97948585f737ade9e9fd8497ec0b608266b66c3bd7169d634defe30a1be70a184eff303271c98ec5000894e30a7ffdbaf941ce4bb77c684b6ca785ca84579fe7bf7e4904892a4df74c755cf55f5e8ae183584f148348326a5f9bb1d13c894f4f234e840f1a5f4e7bc0da4f18c099d2664d028b8be997ef8cbb136f548a6f5f252758f3abf0d0640190e7820a99c96bed77e1ef6116a78df05762fb4ca631ee17ae9ef3d6ed71f1ad62964eac015f2c522d395414381572a88446e217dd8384fe62d1ab9e03e8074c37b433687ab3a891f98c24eeff6700f5d89c38df54f6cd938ed4edca547df9145b73d48e963c016d4478b1d73bf6e31305ee3cfaf953b313c90e4f5bd453a81f2ac0b1ee56438557a252f379df453924743d3150de30b378c7adaf047384a87663734173ee349e6eb7a94ea5c7b41f7c6328a6513debbbcd11c0774c9bed28b5cb57bdfd7d20ac1f99b1227241ba6ecf4611b0d78c77b2f6dc9bb3c76d903de98d771600c6edbec41379c97ae360927e1005bde264761e72f8d82d351c348c6e1ec6a56b82cf459b12e8346fdedc7e2a10af10fe4b5a8ca8cca2234eacc8af8299102746550bdac45e4a22ab9a299951cfab31261973630d3ebd8ad05de8e738e14d77bd0605d937a4704c1c4522b0269a304ed24b4c388b38d1b5c44d6c1f49655f8134247ade4697008e2b206139bbfa630d9daeaa10acfb2f731cef96bc566876908d954726f6d0a884d1f751dff6b0cb1d36ea72152f8896ccdc44f1633729574d9b01fd40e86ea7e31b1e3495eb0d162a87c0f7d02d0a00c38e2fb4709997881eeaa5e7ae6d3d16b4a64b7eba7dc1a9c2ec7d97a6b304f4378f2a2dbd0c31f219ca9fed901fa87703b5346875874a4db6381fea15c3d0e23b2b117227c4220579d6fcbd5f0a92309ad18a8fc23c2350823a1527a61cb97c3b3c1d937160c606bf189aa4642f079a6bb612e8e4557f834f3350758ea967a857c7a0714e5f2fb3f6e8615802bb83f98d609ace343ba5437be06db78465a1f0de9f0659c2c5c77a1937f61e5293dbe47927d5f76e3fb037fea6e1213e209c77f9cd46c74b55ee3a36912f27752524969441c01a57986943c69d4f09fc2a0e292dd77755ed9f6c54bbaca921e4c1b3e2a2a2588ccdb4368aacfa6dbd4b4090d7b9d80fcd569534ce847ddadd0d91ed3d87985ed00e5cfc43b6eabf15a262bd21ab91f868d763cd8535af5b8a3ba74615feebb072209cd5f0acb8b9f92a1127b5d44d35ec2ebb95b96ea6f634a9888500163db45474924db0e1c81460fbcaa1995053936b404356395dfdc3a65a18e6182c31a4bad391fe79bc5a0ee9b695ff10a3a5bac0cb6bb373fa58c1f21d1b16f07e7a9aeec4fbbbfa2db53a33c6d7955011f7e87670b5ebda4b15eb7b20190bb06aeda77d605ac603211d57a1e10c4c50fe53c093d3659f48ad3c2ef41446d905decde577b1fd052c323a2db3a5310b747d18ae19579ab096e7f4bb59a1a53d20bb9a86aa751332daec7d39c7e458fc18287ff1def0ac1a4ce80dc778ecaad0dd88fd333b4bc74384a200791ca98aa195c6e38b445ce74a24c6e9b7852a4203d8809f31ed4a6f29dbdee4ad5576dde9e7d1b352f903592a5b1fce401fbe38bbc7f048d534b029c60e027ac68b35a9885fcccf81a21a7997a1f35fe7750c1446d6ac722313c871dcf5a8a485970e4475738208f694a94c6388ddc6ce29d7d56516c2133ea4494414ebe14b2e6d21c361f0d4022d8ce2a268838aa1df96a4f9763a52b52fe92b015d7813b1565ea0da9bc019e50b1e8c1adecd324ebb334e514a66658ee01278792ed007c2107a9d94720a8d60b2aeaa9671f4b2a6dfa7917588c81cde6ab560fe9a7848ea42c351706bf7ea9850e371cda6b8a39e2ef6ab4d1e8349674b2e0c491bb12d886a0e65171b43ab24f812c78ad90cdc43d3d17da7f42408f062cbd65840ff381ea8f894849ece96ae165f22c6e1bacb6d72b2877c2a9fb097161258fea9337f92a1458d113a732b4c56f776e416a3d0b2d8c20eb5c313a2212e716d8d0a6cc45497e99b3d0abe467a9d937be727538dec5a17c37ccfab6ccd1270b69a947c87dc6fdb1dbe90f0830c070ae38e332bbcbc8893dfb7804d717d0812b78bea61bab2ab70a8b0294c549c9195d10595dccd6abc6575d6288e7bd29689fd8e79955fac2a8d5dc53d03967197e4edda69df66aad39505a8bac85462a771ad169be05f369011ec6498d8c795d2ab860c9ba0d98d334745aca3254e4aeb921baa9ef0bafab3d8dbeaee14c6959d308ed84393aebc463341246e0d6c7237f941ee03605a7d9054d5fe402a86502cf955eb63a8ce0c9c0e675ee188909cd21a71c880c5aeb57b9fcdcc6a4a3ca822f459c14d7f9c91ac3a9f386037e9f5ec5e32f884a9fd5775efaf4d2da73e3dc5093b4ff619aad58d5faf57abf9dfceb3d1736385efc83c2c05aa29f9690d12f9616887656e7feafaa18dcbb514c4f5c3530ff85bb2388028414d639e633ad326a238d2749a0c272fb5922d591621094a08a1a2aed681622ca4d4c6e2afd0f8a480afab96322106c41084fbbc1f4ad94906f7486dcd3c9d75b2aa9aa380e4e5a50ba02a28ad0ced52e16ca2662b5c17b4c53eced5e9c9e5eb16238cee2be6af755401fb19804370ad5fbd1587ec330624ebabe03dfcf3deed2c70e31d916cea312bf78578804b98de41b39b94692b987bfae0da335255d3d492bc5e5230b71323f9e4ae02f15394c45a7c750ac467fc5ec6a7a9a301b013d20f274b66819981d3969701c388b8eebeb012eaaa5332cd072ef5cbd82a38e54835da1929d7cf4597fb056e10423de49c2550c49a0f77696fb9a1019fdd2572d0530e114c423665f447e0af5b9938c4734c8aab05941ba6a54ddbe6b203db2404be07b48e991550ba4f03bd7d38590c651dfb54de9c18354f534752456f05958093c2e7ec52a0c53aa10a5ec78ee3bdcc6e8b44f534a8198f5467b0d7e18436220710b33512624ff6ebae02582f035123eb0feeac33d74d4f1c12c36baebe49add6bd55d3ecfe8868c83a07e96934a0a672579a9209c7956e2ca41d1d3a445402fcfc0c744776b5356425748da88df8743294f952db43dc7a651c0dba13fa086706a3358ac10d6c4e928f011ec4c8d1a52804b5cdee635264aeaf2bfebc296e0f133288a0a3db394bafcbc25306eaefaf60c6b00e5a389480b1a79c79fcc903a19b94ffad63d0ac78bfca86ba7c9df34c635dd4bbbc55095197cb523b928d788a8bdde6b91df804fcb9f92b8b9b896e778ea5e6cce3a9b81724fba7448b0a107c6159f603303e338a438962f5d66587c146c6a2f13c6375ae3bd2856ebf96392735f15b8b02eaae9808555fcb6c10a51b04557260197d4ce220157763054c2b776a6af3db35f66c613936bb35619eb01e6e7980de0790d8791088504e8fa0917f6a5536e29993fb81bc27c7cea83fc7817f7f18e5e1bcf476538f35a793733c80be5523e2dda6f506b8b813456c151fbb88117b46192766ff0a82c146e3f416a8055beaeca8a354b4913fdfdaea97428d341d556b6e15c7e309afa6630b91362cf960693f0be3a0bc8d20a9e2f955e2a08dbae3075bcad3fc96ff5a9b92623ec8148d4bd8685c4700eb8989e3042c7463a568e2bfca619cb966d452782529c2564ffae1371b764f56124fac6928051dff632bc91da9d85f45bf55dd727bf6fe15c0e16f4972a4c1c6b7fa222149d462f9e4748d092cc6b4cfffc51ee7f9867b214d993c7f4fe91d1c3153af49f6ef288c162a2c25309c1f912f37b27f901ba08074986ab5b42a411d92fe08c7438c661303001ed620429a716b4c6957dfb731414a9e33bed9b25d3dae3b558dfb55447695d3605900a34cff816cc43e8d2112913993a779ec01cb039652edb8eb72c2b6997b577741c769f1d0fc49a3d2d126707ed2917afde11d2356a670103863b5dabd7a90c7b150c2f007525a7222fff6ac025a06602491e584530e87dae5fcac3335828113c63f292c909f38d9d9bb5568d47e710b27f4d53f22d82e04dcb465f003ff0a0528432b63f84e3e26550125429df4a3b0c766dccbb2101eafbcccb0ddec8d4046905652da32771b1db97423c302a00805be5c6fa48ba52a9274734bb961c85b2c7e2a99b3f13b873fcd8f40ed4ce2c716911edf695ae4d441b3d95a6f1b1cb75ee169d1244f275aaab5d20c7f6c440d492ec207e1122e390f50ee0448f4c573758e3ef3a0128c5d6590b48963e7eaed9aef838067b8eb58905b1f08a3140e596d24430941d7e0fb66a1f3f7bba8b795b44b918b6deb91c95b59aec0ed9b476fb36fbec981ff0fd7044accd99aba46826a14a42bbd9f507bccbea3e74ee062f49578c62dd655034078f7b022c362cfcb54ae4057bb2be08d57ecc5a67064d00bb8563ef67961beb4c9d90001f6a459b5ca4d2f89133fa577795098f0085145e9e3250d4f2f00edb3731e7918fc0933af256cdfaf4eedc169dc6624da01cd82cdc53bdbde7afe0ece83781070bdfef240fb43b614b3e92ea55d3b8cb859fcb1220633a6f538327611aafb56647d6d39b4ccc35d5333f0ba8699a7a0b40835f6c97f94efb888947767e0bf7fe8b345f8b52dc5617484472f14cf89b12451142e02aa7e5241400467ca7206f1317e2ccc2f0b7d579dc03861d161dbcf58f45cccfe5df168fe53337e758d5148fb3543077fba21fdda7ee67b82d40e75d9fc4b8f79e6489595d52846092b155e34fa155a5957a53c78652bf2c73b34137bfbb6290cc50962dff408da6bdb29961c292dec347d36d8a70c2532d1b9c8ef97d6eaff520fe9c3ff23cbc5789e089059897eb80ad179ae78161e582c5671e42b6103891a51cbecdae7ebfb7fd698853b4e22447bd1985514c672e9ba6a8b7203d22c19a993804cb9207f7fadef31fdf3803866bb559c02b7fe8b9dfe1c8a6f8d5999887a596bbe735adcf2ec7cd1a7c9a0b2bc18d8c40fe94f18aa816c495d0b92de72cdaae68019cde63e117b74b7e1c2f0e23ae62cbf32e0f45841a54ec3c0d00ecc3f8a2d02a388f840f72be3cd37cf35d742155daac65695504d451885fbe57e5a52d84b9507eaf8b0e4b3dd63373a32a5679153caf4efd0ae09f8016b37caa56b7d8293a61fcf50d623ee81858d43e0fc7c4d9f034d9ce59ffc61119ba3dd1c51a71a943b4127e96a7594f5a7797c8e96b8e3e76e821002e0ad806627f840a5a9cf8271039bc50df18b95b060cb702e5ff6b4a06f450e870ff324e9d3729d1b04f1b6917fdf36fedbd24c3d802a72830f1c07a582e4800065116c37d766c9247ed11c789a82bf12aa72cc8584636274fc4fc9863473067143af8a0c98733c8663e560cda7ff97acb1675389d7aa9d1bb4d330ce2dbffe6575ed4ee2d337bfdeae55e492819acb4752ab171ac6d018102d2a720ef898ecb11388ffbb4341d22feedcd91ab39203639e1868522d9042a2ec8c07eecf70555452d8d3a0c74247db7bc513abb0cd4eac95a114c34f43919c631b50bd3b6faa2548a9c0b000fd165c05d0ca1bcf30c270db33b86b7ba639dba47fdc8a5abff168461f1f9a4062026fc0ef5e5ca6f9bd2e5354cce61b367dfdb2b8f9c79b662e19371dee1ae21cdfd68e55b06cc714d3a513f70585b53724fe8ed75c61272c06d082e7feb1da0a8a14cf694bde06bc0c2caba358e91fbb9754f33229dd56b1c3b79f3320d97db8a94a0ce1da37034e7eedbfe6e92a01e5403a561d7bcf99f208b050e19e4de03499e4e2be7489f1d6af5bcbdb252251c811a405b7a4b6f1b8645f9585804979fd5d7746e3610f0439986f4bd016e9fa363f7eb620950a14068632faf85b91ddf205a2f433dcc4a1a188aeefab8210e1df686677b4817bd0de8afa5c32424c289740f47c7f754ea5a6ef57598b575d16e3b626dce2096350275cf1b09da7012a02173e6a7fb5acded52a0b6050276913af624eeaf655e9a08d138907987a627a52652c38fb27489b65bbd9a2db42bfdb5f3ae0cc2284ecf5f96052ff19e8a87fb194ab84f387a3b6a58784522c7f9a1ffef572c71220437a1dab9e0b317b1f0e993512f3173197a8af2965f4b8786462052cf6e74eacc07a9d692369e151351e0783b95e795a95b9fffe8392b4df1614093fbb0d29071bfae32a1a452da7a06a1acfb7af322d2652f303e67b8a94ad851509174d1a7604086b05f9f14aadd669b77964eb7ce0b7d4e9d78097b5f5850b85f2dfb38706e287f913472a78368db567d2edb853af855b0bbcb0e8e2cfb8ec17360f3b543ee4367bf8aed23a12f3af275265e576b5e5b054c5d58e338de8417d889f9df9d2a470be7e9dd4d8a73f69087b81dc22e26db953f73d0088c8991ae655ee8821656ecdd1f9196c0294e4ef335f4a72d831b8e285ab8d194e158594790b049e5f5f2437b6950a14f7cb89003845f3f1014fdf74ef64501a65a89bcd1e869f32e43029ab0708842605dec1c51be5f55be8f9fbc892ac3b9589e6b729f578793086b28214eab88c239e67f1f5104a520a3957b7b35673d89e889276ec12d9aabb9d165b02cb85d1920ab5202341c97f4126023de434f6e03595a8ff40416f666d00fcfb4d1681dc6ee54ef47dc031736686dbbc5cb09beadaf4e9cf296acf276db315a48434ddf336576fa50293274e61c3e66e1e955953aa0f05d021929e4a77f9a4f5bf81396f6f6100c1df1c32076fa33cfaaf40b8b5567cce562953a619ec4bc08654bd5a99061118b9c6b9b55170c4bb2199ecaac22e63ed0a8352f4339ecdee91dca93888a24fc26cf4da36886a84edf35775dacb454d2cb4ac50ca63727d22c220f228580585df56d17eb65b23a35b9acf8ebe3d415029f2f9a98926b21711dc24d5c6f174f601f32ea071b15738c6c5689d261ab40d9c161cf84094506c0e018dd20c5cdbdb7c175046b3b3ac9dd063eed18057e296069480c2bea3f777b89dcb74141d5564ba2c1387e32b0ba4cd8e690062bbc14371873e84733826b2db818b8df2221ceb6a92c44cb5e0b8032001f59eb7477a6fb92b11a278ea6d3722928d38594bb0818217c32c7e2e5877bb17d4eda10e6f5a99b24a9ebf07252d3d6fd01402849ede57da9cf350e8dbe3e67c7aec1c1be0d6bb59b271ebb7bd69d682178e578670e22f9cfd4ef6f2f3afa382ade473f15eedebf89c56f2418b76e29ac4ba1571a1af2d372943fbb16ea6a019059534e6d5652ad9f45ac38b1f391b0ae65273bd48d9f9f94a30cdc8fb26ffd2286cefdafd6d2b22bae596d95b8a2fa2e21ab9aef9cf3d8ee0a65cbcba1960da51b8b96f87e2ec4d512997411962bf4e9de18d6be9cdc8eaabce5f2dd4052dcc2544b1df2c972b6a46c33d072a71200dffe2fc9af509f677dbb75f16595050afc139efa10db23ee869a5548dfbcef46788202a311a990dce2df5feb3eae77aea8d4d9659d6de7085783fe4ba95413225ffbf92a4e316bccaa60cd44d721ebaac90bb6c62d7af07f538165f7880328510dda5b8607815709aed2208c7efeeee012ce9c2d5199d19f2b4283e7d28299ebaf3c41a641f3b33178223180d753347e90de96d43ab56196551c0e92e2106ac13f9e2e6212720f6a9450540c9cb3c104e58f24c547c16c2bbe6661c06426be3d3e97f8386926ac24e45dba6be6c240ec45e8cab5f80799cb4276ae7195647dd7dda80e6ffe22987d11e8a3ee8973750367befe36a143069043701684f937fcbb67f49df5f0c30a88225afc6f115693fb903bb2e6e7b3b7c1c19faabba95580c3d87355c0b7ac95ca49c00e0efe85fe3e428b9f02909880d8a1923d8fb2a8ef61d3e0cd62ae113a67df52279420ea8ca6d5642c463f58126ccb0a8c10de541c4eeeb1d6f9260a2a7d73c30ee40caa176e2ae659412c7b31eb9dc7c5a583e061275756ae8b107e2ca58535dfd243270df018b7bba77f3a0dde4641ddd8a069a9009112de4a6476b8661eb68fb608e34efd696be531304ebb5eb68245e6a4d8273a0aee121444a78927a7c2bc0dccafaf05603e10a0cc6ac2a122bd905414e4df5bbfb9804320ded600b5818305f62d3eb6838d112aa6fe11ee27ca23f65360e6a5d38d1b346c6c5331cd2db69b96dc1efbdeb97a5f34e6787bbd3c0c4df6d4e50a49fccf25e7baf064c59a976fe63173f51cb330646e7370a785e7a60486ecf9f35c8a84ea80ac40f550ccb60ee718f95fc01068c7c49d9aace54e89217dea6f8eef13d88c2e00f6a5bee214d8af53581adcfed94bd11302d6e49b4574bfbd9fc50d8b8edb989008c87584ecc2ea8263376d432929bb984bd8b3762b0ad76389f522eca744c53d16e600a18e43acb217a8bf3dcb70074f6a606472edc7ec9a0a3afb44c005d1b67cee25039e338ba61f3d575b7661a08a9158dfc29fa5514c27b2f9836f013a45032f8e81972649517f1bc7e71c3b9de3a25f6ad279eb68135a451eafcee4dd165fd018d88060c00e2dc05194f3dfc2cdac26a212433c2b3b1e3c19a77e43d0ba3598f738a85537591517bd045d95616f794d1b8ccf7b1d2d93dc5db27a92d45ec22b4730aa8d31cd0ac04df0ca000b2ef44013f004026376eefabc715887aa97638bbfa78d41a3f0c425c2762921070e2ba1ada0055b7aca42d289a1c99d31115471047c02e086bc88a2e83c126ac97574dcb28f07671ed9cc5c65d5cb7ea9d639965bd1afdb6367c3a88090d92a83b52d9be94b0686af2cdd15a1d8b023a78de86719ef0d5f489521eea8d653c3497dc07aed46427d4324267ecd5d34e32061458c683524e7062c11842b182bac658bd66da979bc51620d6e315634c7c5034350cdab13dc8d200bdc7141e079d9d46a79f10bc7614ee377c71048a018f58e4848d15823b49344d5aa11183c277b7ba6d264beb5883b617d70f54cfa1344b0a511a97ef2022c940869082d81a86edf24de4e46662e3e7478986d66f924d925042aa81ec9ff9c508d50fe6980432c9a2647bdff66ed8d291cdd65c3bdb6d95bb92506443af3bc33f1260fab2d315266e1e4f9d060c848ee796ba12f0320ad28a7bba72bdfd5231f1f9faa22a862849df84da1a6997e719ec5bd86b957d22613e8ca1a8ffba6b8a0743993ae32feeb87fe62dd103d6688b77220de21af57a1170be58542c0ba3fed53e81bbc15541d84fe4106595b803dab6dd0a4028015185725ba5c97105427ae9b02bf05235ddb7b838642c1c439b59eeee479b5b276b52cd5b24bdaa381c2f0439209a7dc7da2011a701ff886ba3b466449be6a908e7cf7c59a39e3c99ea611bdd30d49893072a7fa400f6fd4c68190e132184e307310c890600ceca8b5ef93d34cd2b36c975d7be80c1952b9ff0a68806c8f2c7dbb1dd991752614c97151d5226234d43da6d69053df557d2cd202daf6eac63b000a135427ad1e6b75ff28383782ff256b3e3b618f6db2e07e3dfbb0d7f276ec03dda2de2a9470da4455c9e3f75f091224f9ed1701f1649c2f277bf829969298394fd98ff9ebf0798a8710ba80b354ea4c0c23cd813ae902892b28a46e13cd376c7e13fa63b986fb81548f8739147232a2dd4eb8e61cb13519b7dc7a4439519336930c97e80819ebd158e8962f74059674ace8ea2b181b6354f3c283e7441710852427bd1b1f83e6eff577b12076c6def82156508d7671c87c61a15b9844fb8e1dc3ebb5625c075a2862ff8f084d3f2d859b1e6959fd5482fa8017e9fd0693b1cec667cb38a8fc72dfadc20a408b6bc029cd40019891610177625bfca22fdd39d0c9f51ea98047e75a8922884fc10470765357a9764e8122cfb3c7d66ff7b96a24151d14c06024f4e33894775f88c09b12a9e10e715cb720dde4dd3216110916031fb7877d00a485bccd982435d3cdebcab5b55fd03c3e3aedb736b6be92a108f409e73b3385d714f60a3303ce3a358f26ec086ecd7223ad6be5e1499ec678572e3d11801915b0c53c29345c395fa50dc80bbfb87ca03243ba524f10263e53b74e2afd56fd601019eac3d445c1f437c154c1426a355cab2eca177ad4c0ddd556f5d4c1739899d7d3dce7bc6c678bd9645a075ff6b07ecf3f062bcd3239a8c4a2bc8e2b5716cd97ba82b15d2fa07c248026c458c61b5552404fc57edab345ae9f8dad38becb02824c7d886cee86dfd880b3840543a8a4c953117bed8544a7101caf95f3b5a7c1f52f4ffe58156ba157119c456370bd97ff4737598bcc09b9364fbadae97fecc285714a7988d1c9f6d9416447e315915347dbc0e0551263ac907da3589603088f1327341393caf91c88a33a124c12e372f1ae75e52dc8aa15c3d472778120c8003e7f9246508513a40064d464d9648d816f8c86af7ef844bf6452fe976cbd9fb81e21117a7ff8aa1e1dff53365f9a5e3ee60416612597e6d7fae20b0acf7e992cc7fe721bdd38023aa06bb3e5af20b051cf689a2f9504cd7e863e394133ed0c12a0f419c336ff2bfe80d592b59fa60b180e72cda1190bf27be8f859ba842bf0f7dd292ebe4ee6b09cb4b76573f3e6a5285e4a6a1ff62fb0a720bc42568186563a35bb738a1ed7e690042857e1de2aab21ba34e7d0d6d56ce8608d45ebcdde196703fab39cead7e1693233b84bc9d68b68d2f5d966c5f731a4247a4ba99dea6bb8c04caed32e1e6dab98f6843687620b445e73f0122e13eed55e3490bb1fb8fdcc30c81b2a3094ef921abb48a72d0bd6772c090c6c970a5efb9924074d6860dd929dbb064ad5a1696d53df2319d21e18f8def0bbdd3c6ffa583a62050fa8af492bb72888397939115370a4bfc14bbcaa71698f58c2263c73e8503cd5289e748725c10b095cd5a32c37341dedd8a4081a8b39221eb890c2e009ebbcbe0adf01bf071e7ec0ea788f9de26561c31fd0e8fdbb71f67eeb0d9106aff8130462aa0c67ce1eb3d4fd6a4b79b54472f7e8d1ab0bf62785e686bf563b48cb8be8a91a896262babf5048deb647b49acdc1118e995b787c1cbdc6773058e1214774b7f944ca46128825e524a48359e2ff6682f0c715f409669482d464d6fe1243021cf088742770f701864f774506d97c1a046c98253eecfe0953f60c7ec7bc82c9cc7deb08c6a04fd40c2292d02178cc84855129f6501acf0b2cc3ac16db13b3a6c6804e96212a9ec2607148546b453bed939c445bfd8b9fdb8d372698cb7f197d9ffd8a696eebdb4fd20e07cbf4cfa07f529a67bb4ba75fd1c65530588e10644b54e8ce47088010df0e78dfa60d2ac644ced443ec0634f27546c0b0ffea8ba145b34cd79bc696a30de6cf0a818393267832d8c7a6d6b4b5b0712ca0377a2a9a42fc735997df06368c537ec118f56f2af484a3da32eb799cf5aef363090f0ef839836a48a539732ee7da0d9f11d231d83268c88d4d77f646f5ee076fec0623802ae69c06bfd30fca47d92865a6af34be3441c9814ae77dcdc9d8f15edf689edd45a1533067596c41ed61df0283c9093bc09a5cdc6f1cca3d00852ffd035b8c27da07047a0efdca927ba764d1d4c896e3c1e7e6f866e1de53fe610e9e1ad3aeaaa541083399c8bf9eae5240801534f55b2a33b0439b7df676f372d7b02c41f08fdfa4e36523ab7a2e50c0deb9ee26ef3b60458ec04a03c08ea2f3813b83abaa69bb06d014fd5bac19bdc29c3a15d1dd968474105465db6ccba6652515a6f20787c83060f091d17d8ff479db9179f0f04b7cada0024d87a56a5e4f02ee48621c96b440ff7dd3f3ac5898509b8d27dc64303d711b0798e50bbccc23e268d8b76f1ef4050ee72a2d6e820d8685385926ab4ab36968d5b201e382a8baaf1416425af64946791f18340107cda46862b02b4cf5b57feb708c3d67a4bf7a7de7b83b142a5ca6cd06882ccf24454f9210e4c80b27846a846039e98e51e8fe018770fa1147f862aeca9b1b5c56fffe6c55bd6a69ba0bc26bf0bdcae52bf1fe632d80786787c15b3902b664a9d1e8f73ab715d7064425896ea294cc8a49d5a87fdb63629c483d557ad340d1abd2dd35f6ba31e5f7daf956ed0082db633b1891da831c7314a6d61890cc2a8118565a99375304c2d554caeedb8ef5a2d85800263239543f65eeda9362a124299bdd2f8bab662636f50549a8239f029288ac89a6959f5d274471f35f9f4e64590bcc0709c5772522774ee3ebd9ee8682c56e10f903a4e97760ea48eb4f9f557a9c315839f3d5fc88f395860e44e248192624d6d58c5be3a86c2d954dfef95076e93ebb14fff27923d42f6505455c544a735174a766ce632abe51ada7a81394109242fa41c88008ad5c2ffcbe0befa3649a566fdb880aeff62161e7f9be03682f862058bd3739b5420964c308269c6baf283d0a1d7e8fb5b8a37aba5e070becf80d09957515ce40c4e255aa74afad7eb1c3bccca841b9df249f9f9d96fc206f63df1fa10639be01cbff549d04306dff95178bda97649c4ea2f2a14026c38de71b23f17964bb0840830393f27a7c52d756311d856c96a8ea75a11e279ec8810c66a318bf388a08cb01b3ec95bebb23de9fe66588dec1d893e86faae6a60ca03bba77e159df008a1006c254ad166f1027f7a1b287779322c0881bf26b908210e22203d3d834f0d5d26dd2c1a98508993980b73d79d60ce446b26d977472c2f34fd2d1447db6f4ec31606f271dd590e6f40e755477fb32c33422d8562d5d8a44e2946e0a4d249f2b246e278c1c0b2e7da9f1517ec1f4df2cd43b417b258802acd3a793500f7a2abd8d79ddd35fa192f8a6748b64789631d5ce2dfa3603852b996776f7d68fb06d8b44f6ca6bb2d8eff5dfed26ae0d48500273fa4e7b644fb93162145d1419acfb7e566f265505447a75fe964645db92839714325e2249e2a458516699872bae65b49f18fd7fcc82e529f4fa233cd23b32d3178e2fcf6f023fe34f84a47a00dede53fe8b22045bc883adad7697bb7bbb45669143e5eb42ce33b7539fd18a6ec12745d55683b63fc94850aa76a31e1e3aaa7132256a47e2e98adaed8adaa967fb06e71ea1b49c2c856b7b593d818aebc4ddaaeb7573173e801ccf500f66ea78419e06d5b138fe7026327cf4f90d912a2c577017ebc7e7730f208a85c556ce0a21ede4c46e45a96acc5cc61f8373e3ef5cd99b86e2fbb3e5d86c069fd3c26c0cef455deb417e3425359e71a3c70b99735959c6d51438c7675bd8635867c7aa6ace094cde4279104b55c1c93272b489f8d52da82765e0730173b68d4d2e354693f3523f4285cd2be924bba0cdcd5fa7b22004d660e5db2dc01455cd12d6760840f162ee36fa972ed3ea03faa3ed8e744a4a46840587642d324738fb979bafd35be937d3d51e02620120cc728323fedd87624a300055b2ee428f4759a3aee49293c92f217ce8ce2a5a8d35ab8434d494f357fcb2a0b5b95ea546c53578f56441d505e1550d37f84ae812266c543db0094a4ff57cbb810a7827508e1cd836ea895a7806d74b6e1770a7c6d8052b523ecbeabdd660bbec22eb038a1475a54426546ba203675187d4de3f63f6e2d04ab635087d1f079da4cd7621d045ad1485ed2fbae1621a42eb305e785acda71e98cf4be1be0f9c905975a809c89b9c4bae4f88222c63a868cfc9a07634829b01efd6ff6ea3fa92f9a40854387f17d052cedb1270dd1a1e6de1a69fe460a0c6929ed9a750a86c988fc27a81b4e5b34cd47cfbb5447620c6d37bb377551229c4676e008569cc98c7dd0b64c70d1777f83ef17b79609037f1a000367e9fcd8f5633f830454966466796d8bece01ac2071a5547c1dbbc24500e1caf6c8e9d6cceaba50123a29436f2dd7ef9ea6e7705dd085d6e3e04bcbecbeb53f5a38823ff20f7829aca06958485040c31f5b4e6c8025dc94df630843a6f547756e7af4ce52c5780065d08863b1ee66679c8b71178c641049f17af6dcf90ae9eba8827d0478fc873eb61fb05a1fdbf9676b6704262ff80273a59771c0b9b60bea96467857f7020f98d2d8712e3b38f0e37895da75f0ffa2a148d97cde13a2a107ff0399706e5c22b673c25c9680f83e934244d68426f23b90fa0668292e37374017e4d9feeb20194e41dae720d8de51e2daa09c2db4bb481bdfdd377cae521877ed0ef9a0f75a3dd801d687f3076f3b5f6d4fbeb1f4a674e1acbc123a78f3db150acab08c1a8e9d824255b4b62ccbd19dec242b75c00aa9b59a507344a59399e68b84386c329fe1d3dfe67759e6071af12caccfdde68b96dcef5d2506e5e60a15f569ee537ef1f30cf4914a56f66e1a2c6c6d99ae95dda592a1e4cbdd9f0e823448792c554ae40f231c231dac83a648dd1bebfb4b3d70a0877f5b15e6b54478180e2122d56eafd0d1d5aa08e35e060419ed6f18e398f741b158831d0e35cae98faebddfc10665f1fc4d1fce95ec21c8971e832d152370c79d5f9b232bb0369ad291933aaaf7e20082553c1a305fc64145226f74245a10b346b5d8be48b42a3215bd6128492d4834ab514f2507661a913aa9e7090fd9c5a8c444fab33628eaa83ffc875c7077116aa70f578164096b67809da2d2420a993ae6918e2e4d84e77a8a95fd7a08d675636f72b83864802a85cca7c5fa96f2a3b04acfd9841c40a6cbaaa5b54cdafd17478d25cab856e1c885de774658d9fd8f1953180593cf7ffda3a58b3bd15fe4fcea4ee4b20de5e6fe695a806de7315024481411f2fff079539272f41812b899cbb8957f1456a897e595acafc6e07456d6b0c53fb85832dfdb20b76e21f2b732c90c2c7d15dbfabb5bc599de783124d7b44d29067b82137e69511b64088098a559bc7462070837c82777089487ed5948ddc5ae2ede0aed83ccdfbbd1deba93af10aa5a91561a89e03fae4c74b30ed8c9f4909a759f4cc9fda4acfc162bd7083ea771246bd9ef1f4739f0bed9c72bd47b1e52b78f94a6afafda57f9178ccb10f452d1ad9337cae9f6f380645cf3d5636cdbd4444a9ca826fe3c7698d1727bd141c1db18ad1b4deb112c1bce579463e757bf2befa72b77f620b34dc403626d911f92779b11812c68b041ebc459d7539fe26c1d3cadb31aa7db7c5b3fbed1838ef21f3b2c00cece679007db2456dce51ec0f41aef9635f02ab068764dc8ccf3a08f10bd4f5655755a331dfef9925fe1fb4d4af08d2a63128199389d2faba64e2045e2a1d8751249edd18b11411d00b8bec2a1850f8c1bf3c8554149e4b75dbbe3543251da4bdd1462069f766a89d85cd19c84a4155ebfa4c618becb518b7a0500a31270fa83803ff1673590fd1aaedcf2793ea2cba77af2f542f080283b0f819b9568a1f1f8372ce8e0d8110542e818f74734ac720bf4c5d352889ce7035a5a2e3d51e5682ade22128ef38e921fb8fcfd18c3bee53fe7c0cfdb47681d69a8d70f5bcb57f5d03ca4fd74aab69d5597ee55d201abb10d3841a64ea88a333f40ce4d075b61b2f2d44b89fbf29547e49f6091241b71bfbd1fa69c695ccbe36a909f512564d84b9213637ee58549389bbd26072c9e8eab22ca23a29adb23398411c6a508a4d65f8bb5ed7449349ad04168ac42dfd4dcefec9232cfcbcb04c7ee8db27b71fed276fb61c3eca35daa23cf812d64a4c0be120efe8651d78b5555ec7e5f6f4cd6f313efa4f3349bd7711cff889bd4526fffdb1fff77bc3986ab7a41f9b4d0dc81cd22d2b01e14468787a7ca6713907dc55db6c1b6b33fccfde0179a88986b4e7a2c9a92c347987a49fe5aab0a0338494b19864f7d2e04eca1d975d8ef62303e0ef9e4a184d712abfd2ea120c6544bb3c4cf32b46858e0281a24786cadce495b86752b966b267f978bd4c08fa580b2c6ea5a3dbce3457c8a49bcdcfd61bd0b3b7b46421000b67b42045cd79a7ce22bf99d0b6d90417716db8c432f137288c874dcab5099d61232ad45010d7efb87088a94bee2c79ff238c7799b2d88bbd6544e86676523e50934b6bbc92953ede52c718358692edcbd51de34885f732a895005c62029bb58dff3c0b17c1264a77a2d58113769051ce83dadab28918fb01a27826b413c2abfed7decf393790dcc0608dbf58546362661eda1b73c30916ad977eeacaa53964a687e65399d41d8715742447856509f9e3c073a3e1cde65e4146b5d32554021e7b1ddc86567fa634553dced1447e9454bbb70cf1eb7c876d2ddf47c4246b2e5b35c3f55f65d3b770f8cb7e8429719a7300abf42d41fc79e9a45b2e989b283848738ddb6cda65615f18fc233b03a1813b941c7a956743db7d0e4e4b1f8bc43ba106b564cec74a6921f1b67b6f33fcc7b3aa30d94c2ef75734eab9c69c24eb2968bff355ab60bb5986676f68d0d9f05c58d6f3e3c8d6009859fb51771dcd5f909fefc496473a14e8e36b24c4538a9300c7d14b09764880e2bbdabf069d148cb30e96d41aac593f6539be9f3d87cb8f2b83ffb81250a2c845ca239b08095bdf15488a740cc85de8209d451a31e495335fed80ca209461603654c9349f814c4e0371af5f52989599b1f7c58f99bc9e7238d4d52c470e3ede58d5f7c264dc514e033d5187ecc77114c101d5a80e46b896853b1cb9b3ac68cae206aa4719d69f655fc1fc4ef71786bf3aac4c188dad7b61122eb3bb5156a975e75b27b4746f08b6d9d7c5410bff0c0af2bb2e4bd4bc89e858d91d083863d5a4b6af4eb304db664fba1cb003e85f94a1cab2d7e61e5dff23694ac634769f02246732103dad6eecc8174352e9cb35045db73d70e379e41eafc0c410f7d908fe37dbae7302a623d38ab3a207fe4ad162b041317ce80a102f1d5cadbd2230a106ceb6cc7d4b656973a5330ac1a39f7f4c84bcfd1fa8b42e79bf85c51636b676f172b5caff8e9b6d45b8758145b029c7a1420cf40fa12b9661e08cd4d571ba2b1cee160fdcb72e7ce203a77165995b5d666481455d5ba2acbac26b18b570f76dea278b3979590a5f4529add6fc9307cf804f9a156f7193985982a1c7892309f3dc49fb4caa02601caa47729098b9f84a6b45396b59bc08a604d363bd98fe4b49c8ca367f7a32e9d9978ff036bd7ff440e588e6ccdbc5aedfe806c0ce895920dc8307d2648ad2a7d57626d457fbea1a9b9502c7d8a76d4ed7d765e2eed6da931c745606115e0b90d9052b8775a885637cc2328feaae7af06f1ea1fa712304bfd5c1cf635b14b7c99dbc1e464c45ff23d987bf5ebb7207a3badf63e593edd68ce9b926661e2f1bdd1c4ec17a9b6855869da53c0b2d3c8dba8d512b32336bd2330452210c2622fa14efd16f5db439b8c994cb825dfef91d92b0d86c8104520023aba25ebae70f8be2f441a86350d65447dfeb7e244f040ade9e7c2b32161e83c0b163368b2e594f1210045ab056d96af9d6d67de967f8a4b51efe91c2cbebb2e67bdf5497352167cc1606831c4b91221206155ec82c7303073c9dc814b0b34d3a7504dd84c2b851c4ce142f6197c78a9b539a860556ac09d352d48f04070740020f21b35fd9665091cb85fa37372862de411823afa45fe96317243328f9209bb94d54132e9b7fbc46dfbcb13682514676a0fd86019943698ea40828d4cc2fafbaa2f9db903003b56caa1e3e6d1df13c11bc260a1748bbe659957bae541d8e5d8e2992b39497c650d8b691b7aa2413d2ca42b1ca02e5db1a6dc0a83ff02d2e35fbd22341bcd23d0288f9e2084b38453e0eae7b9d2c429f256a27ecbfe4162d1bd10e8303bb41918ee97b03231cdba9477bdc1d1f205ea567922ee4307e630ce9aa4ef1a99a6ab14496795888577b970a7b47d7f3a8652b60dc982fc486d42287a19e602572c09302dca9848e41ae8ecbd1ee311d671dfef0b9c9478f8110fe85d11fbb72c89fcf40556de6bfbd18449919581dc052c858362bb2e022da87e943e56d4b54c5c43b9d2c8c6f6822b0198743a16539c76e699cef983dbbc836c489d168370cae5c8755c4a3a11ff713751617e2b5a59826c2e8db65299a1f0095c1718962302d2a2122194ecc4669ced11d0be2ea5895deec04f65b55d1183cf7a8a72a896e6e4fb205ab1dd83e26cacc4f9c5f597cdad3b391e5508183f575841eafd3e532d3d87768c5a0a2598ff8402f124672a036e330149acf91733976d7c5171b8bd1fab2d238977651843b3527179005a08c323da23710a99ded8e464c8c5967d625ba49e55b78a71609618386ba3021848e60c46708e5280158bc5d9519a9a4d170ab3134c8a836c44b0ac5adfd2cd2384f2f615877a114f4a10596b2401df5226f256c85dcb362eea7a59dafce92f3243b65980bb61e6862bdc427adf15b0aa2bf86a5b7e0dc0b7a1f171668e71cae6f24f403eeef33bb27bd973a84f9bf468fc91a6df11755e9a641cf4bc2b93d9154fe80b80c431ae3004b7fee86d8a56ee8985a603173dfb7d4b181ac01e648edbe7436e8cfcaf426cc49afc8a2441b61690aa0a98e8369333aa07d99ffef94990eefefb718147f7a1984fa3f6c15e5c2cfcfaceb0c487cc0930d766d3c20bcd300fd8f5d01c74008cd5087fda47567f16e8206e51dbd77cc988cbcd46becc6334708c726e5df9fddb1b199ace5726e1bce332f1a44771fbeacaf6f9d3495acf22fd665757ea18dc70afe6838fee2552b25a8f68203aca03916163f05230d4c827ab031d757180c40f50e22173b49fe00688b3cf2ba1cac7ab2691d014b3bf9dfcca463f72d825f85ccd00dc6e126f3eb6242afcb2d435bc747e4fdd18fc7cd5fcb7f63230374b8aac51a169d635dbe0166d8c6a83aaef2099090feab57079762587f7bc13e7e890f0647eff13f07923859195562a84e1f415bcc14f7080190dfcc7b903c29fd6b9dd98a05d46ce870d5edfaa3a463d5dd61daae5bbbf77f3ac175186dcb76bf32237ccd6458c35ab8b5d10f3c3b973d9e0f44f3183bc6db961081dbf38b4949bbeb2c6e98a4840fcf4bafef85f24e825c31a1d9cf9008792253b98d86847970a39dbbfab1a5ae617bacb6f038f269a66317547e02d2cc8597d103264ff24c1d6f2f5cf2a7d8e7d8e14f9ec80068460ebd52c75f20a8dd5c116f0a8fed65d03903728a99ea4204876cb4dd951c60384fb7ae47371f26e415b7a78704861a1909346a261fcd44b791a4d17a139825bba7189ba44aedd66ac000fd6cc3a97ba3c90eefbbc6dd19352bb86959f8301385b1c6326be34292fc22d809dd48c0884892c42ea4a3cf2caede7284176afd7d550121aff7f046dc5f2541fff34c9fd263345db00784b40e3f64bbfcb210c04dc542fcbe8081d6f0ee772185e61ed3fe115364f8872e6dfcd127d332acefee38422ec9b82899d2fdf1c8e39acc3ecdf85f5bf71176ba61ad11e602c3d574846668c4113023e51678dada0091bac39df7e5f83b616da5caf72b02c9dc9a6acd30e617080b903f260e701dbf75d933d9abdcf526494f81656184246ed2716e2ec7f96460130af46628e56d7fc22ad15450c53ab8a75d1ce83366c0a24138697f045cc65ec85ade8d12d24ddf60690513ce52761e446d1213eca3977fffb68048d864b398611c25a28344f9397ca3e9f0b3b716130a8ac5d0f35dae1353642097e19b7fc278a3d3088fc832a24d3cad61f82db7cada05b771cd9d2fdf6ad8ef08799438f8d52654c26e15d533fbaa52dd6e2553f3258fdfdfe3d57df024a9073031d0134b86ff9aff04a87e29eb707d8e3eb7f6516f8eca195a71fff613bd5179172c5eb727615a45423c0aa225929801c5cb30c7cc8fb85f7b0fb13c30de7171f4f891019057e9ec40d1c5df84c222c7a8851e35cdf1db8cba6c2e3c119fa40df16688a5575b37972c8161c15e338d67c8d0ebfeb8ebcb6bc84d2e10391ef340a741d576292e71ae8a980188f58d91cdb5c76e93a19c517458eb7791880ce68561455b9246cf871a66aca802af3b5e61733f23796bc2d6e9e1812d217b3914905fb1eed7189d6c035491b23668b8d76cc7cd7ea400a3e141bf59a3d3e2b0781dadcb069bf701113a724b910ff4a6c0a331d3395a06514b77ee8c619609d310fad25ef45c5304db358b5336132b7565c5fea74a7b6da91c55353dfa103ba34299f151012e33fdf513b061485489a4b4a3d06f9f4145fed80bce7fc7764cfbe40d224942a9eb2a0c80ba0d351fde17a526f74a2cf6b6f5de7cc44ff4967be66babe42475659541d979be3262bbe4653547e71713e3cbde0afa3c37ca398e63cdbfc294fe9a99747c3fc59271a63edbcecbba1e58424a26ef6437dad69adab4424233d8b7943a1c5a503907faf5f9ae441f874d1eac602a5b112b0ab151c4a890150c79ad030746eeddfc90683a5d580a67fb8462d0c153c183bd6e1518de052de62519f45e7430c8e125694ce936bbf255067eec474c27390703548821819bf22d3cc9a7a96d68dc2b6aae9231554215893709ca976480c789a06b80b4192c866c6cbf6f1c1bc70b893a3aee27716344c3aceb0e9f25ab8000cb398bb70efc1adad51510a647caf3669fdc64279b676db5186d16e53c3d78be3c8b98d285321ce04c2f52d6e1f63311e982887db860fb029075977b48914065becc67ffa64bcbd192314463a518135a311e08d1284df6f4bae906835f53953c6d64c3b2982e050e5e455819e0e7dffe2b1acb57189cab29f93babc488c45b28da62de04d50ca1f92eb6c535ad343b569f30e28f998cddec43d942c52a38ebe913043d6b83555d026f7b44f188e57844a974f217faa12b255eb844b73c227104947a1ef6a733fc0f2026d58e7144bb58b8938deff41116051944d09520230079b35449e63c4553630f37b2c174175cc296d050d0802becaabf765738f2bb9410f3f76df8ccabb14412d3959d36dcc6cf70a9c045aa843899b9db6185c92271ca87bbe349c613ad87da38da9741e979cfd8e8d9971a2872d25f996b7caa3c097971200e20f749af28686fcdb675db6ae10728c8d7b183a2727bb1af8e3c596146fa93dec5e406ca6f621c80d967cfa4efce3ae4a90f51f61de6ea769369b53800745bc269cf05940503e95b3f342237bd6266330cfa25ca592e4df4335ef9b5e9b1886bd223e47e7bc62204d34a750f6132cd6c5db859aff671b488d488a9bf30813d36053a85b3c44cea61221608979f11c82e7eadce1623f221afa8eac503e55f8bac0c0c832a0242477ce7208d7d5a45bfbb91ec4667ce40ebe84fe285b3f1896e3b8d285fedad10c5ca5c99e04bb3c73d4672045705c51130a93b8f502a3a12701d821bfb9e7d11cc5ec6e6bf5f5bfb38d82f580fe9cf66a471b707579a15e8556e32d2e0de49dfefa500c7fc3da31baf4974fd10ee47b5b1df4b42a9b64d14ba9cb5e082b2eee7dbc14dd24bb8bf9a4ae40c74afa0885c5b15063c47d583b258bd4264257497b0e61305caf5de324df016e31ce727d2af1be734d4ce8ff090aea8627f321dafe8c1fc52408fffe217eba4148ab40d8298b4468f1510f052e0d07aedb23b1a2a8d2c7994c67d8ea7a5c4afb7a8d60bb5314cdd31ece1a9bc9f90bb0cc4e7b60ddb0a7c6fb1d35f08ab6283f89cab51a6091ba5281da6c54c94716c2b6c75f20b61c6464caa75bb94ccc3090bf948359931f1f75ceaad6074731fa4230642c13f3655c3a4a2fecd4b074140afbe60b7420c7be6a28d9d7596d13476875efeb85d750d5a33e8254f203f3c36b4368fe96560650d35bc672e8a2ef7957ae7654519182a4bb7920865980f727a163726a276a35a1dec58cade043855780f3690cc348f8210f52ee853244a94bd7520a61595a43329f7a80a34806cdc855ee91196a464066b16120f8f1cb722a0fa749038ebc87b357a611c517f3df15ca7c1804f83ad614dfa7a9caa92241e7a88ad5fcf22f417dcb828a5a200ae9d1a65d35ad4f54505842a01ce89be5b36177d4f06b36bd26ad4584e8fb8d5078a8567a48e7ff4368da5a769570e7347bbe3f15a1c64cf3b97da1953b6d4922f9bdeb93968b1066add353c2bc474dab599226e91390127d2495b065734962f39bb4a89873a33bdb961e8e8b865c2e8d23bb7577badeaefc3b454486875a3cc6d3dcbbeb72b5343bfeb1bace67a88f89644ba306a3fdaef6400ccd25ee61537349ac9cdc85a97863b3156be6165bee4d071bd0fec11252c53e26ff83a54664c37141c6e6cf7638fc55db75735c1143454176bba1695ef9a91","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"43f41ee4aad31266c79e69b5fd66e59c"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
