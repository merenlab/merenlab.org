<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Solution for EXC-003</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #217573;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #FFFFFF;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Solution for EXC-003</p>
                        <p>You shall not pass! Well, unless you have the password. Then you pass .. or <a href="/courses/PFLS/#exc-003">go back to where you came from</a>.</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="SHOW ME" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0596581a8ac8550d27776ff59139c2fbfb18033324e73eb1b451c69147bbf90b0453dd8e04d6a6f9b633311ae7cd44ed65db8862c7eeeef9daeaf99a57bbec3d577b1c540631fdfd059d79bfb002238ede7effc88716c35a101b7470d87e6bdcfa09a0eb72fb332e7ee8cc1d09625b5ee6135b0bdd80e32d3bf7496c41d3ce1783abf6c803d279402b1fa82b84d3901dd07d4ec2c30205146fc9075e0fe4a473d312204bddff2a1513ee50596c97b2ddb2d79322f5c681661277a144c8900ac70c44ca1c712f7ae0b366cdcb7971f5998ffb901aff1f2d0ed42bda61a3e78e7d555eff23e2119e2719d65577c856f372eb9798a45238cff7c57747c21d33764cd0d379745abbb4c5b5b0e839e3df25f310da1665ba315c9611dd912bf1c6518e3af153c0f538fa6452e7536368cc876e9fe740f605f257acc56ec37ffee50978d3d48bd489527a09d5d75143140ed38c0e94f67354f11c9ce4b68fba0c3521339962251c599297bfd9dbfe31cada33800417dba2f0955cf2e71af148a70b0d1c6b2e693cffd44f7c97f2f0b2220e4f7e919463046edc55d2532344c9f3ccae4b2a5b982ce9f54996945094dae85698f4466731ee5861a97f444dfc0941dae4951e2955b912157be2aa526c547ef75a1c305da0deefdd2b938cd5b4fd1a5701e4c2b644728b7543ebec246d2da31e7ea43952f8670769e5cebc4f533385de4546e81e1c59ba999ada0eb0432f03e199ef3b989aa8c9106c8a8cdc0c24bd362a9684933e8a70bdeb8488dbe00c206ec160790aaceb9aefaf5ae157bc05be6967bc8d523ffa8e898d2f93cda47b40a28045a696776845f91b859d363703d0365ad3ac2b530dfe753b7b85c7f6abc1ac9705559111bdac20c68bc28875b6be93bd69a11c72ebeb40fbae68c5c808a0fa00b157af027582181b2bf36d8a619c78d4f9fb5e5978af75ac7f2026cd3afee958203ecddd6b32a4558de01d19c006f5d6a15184c71a8d185d1b3194d3c1e8dbdd5641a18d2d5c1917a721f3a9d4aa3085deb16dad93c8ba0e7ff96200576b43211695cfb792c65aa25de4a9710ca8b63b1a966f3ca8836340f99b074477d865176eebf4dd91910f1d77e33f4aae196422a3f3d3b411197e4bba0c304e8892f90f551373d558ef5927b12a5951b975e6ebde423132a891af9b7d50e21666941b023a0a323ca9b972339c0e67f12f9e7b4863a5080600e70c3ed0222f5cce1cdd8a07d38ff62474f5ed0bd6937c19dd0ec7c4eb0278f7808f433acdfa743bc25f88770ef2e23ee4aabe9eb596b9bbcb3aff10f85970ee2648a4a8b731fb2aee30fb4430ba03c76d3d38770bd4deb69214fe2355183210fbd8db6d39c9cc64276d17bd67fa5c263a6cc9d9914c2c4eb026e19b0b3bfb20306965a6456a5f44294635361e4deffa57702f3953075c7cbd16cdf16998a15dce4bf10ea392b792030727c6a2b038f86b38548e1908916ac266c0282176598309503775813d554306114f4d120a203981ec3e6e73cc3b8bb02be8a1c789205df6111ef80d68385f1763ff6ee2efe77062ef789680fdb71f6ac6477e356d60ec040034c24ca9454b0be222f0172717b6fb610390b6599f561d5fb62773e575f5d091695a7c77301e831182140a2749a36818d0c0582f9bbbfadd9ef8dc194f7b28fb6b14917e6352fa5c7ff9a8dda659048f2a11585b4fc495b3ba8dc7e9c57ea79aac037bbd143311c749bc98d2744d9b60b71b265f552b9eb6c80df8bc7f836c6bc4a274310b0f8dd6bde89c08fd6f9f65c75a6083ff0ca0b912252c7f49c75ca6630429b758be2d558e0d5ba2c238fd61dd012ae3b703d619c4f4532342817811f40332a13a54c97b7f40b7db00c9659f399a51e2092433623be7de54657e24dcea0289eed8b940f37abcdccff649064f158d179bfe1d5d5daf9c1c548f940bff22e024b0f3712abde5ebf058ea0d52d2ca27515a2d50ad5dbb7c2cddb2b7dc36bf9f1f02eb15b89a2729be58783c8a284ce3252fbb797dc6e672813ab8155c5f6da17e155a51feaae8eaed8468410e54393e74abc2438831c23a0aacba80c458bb6ccac06c19728964e9904410b83cae9ca89a69d0642d09e5ede300d045839b00254414637ec10a920e9f74a5ab3b0193c69d457fa673266fc9a7519b03dea262e0552b71d95759bdb8cd877f0ad2232f0853d69ee34f9eef5d09b16e7d0999cccc9ef75e7ee890800e0e9d4d3752b66e4a33afb4a12926b44ca49d446c52599424891bda1f0ef7a49766ccfdea2021e6ccc21600a21408b0b0741cd5ab308d0aa22850b58d39c932efe9b715e2d2282779b5832b4e29b0526bf0990e4a419068425b4d9a00a94f2f45a0b7fafff5fc6d3cb0ab852c485936075d753ef41611acd8fd4d8b505702d1648deedcdc10813344967fae3038138119487f96822e1e2463badcdaebbc238df07d3ef8f69c481d4d21eaf8755ad0f595471aa7c36f5e1ac40a661daf9960614b5226f56200865c4935ca7ab7bb0cb421024f577aa52074200f746641ab5198a3f72120cea82f3f1bc8ee2949a51626db4172847102c2408982d74199a2ae0337bbfebad22af035be283dc37b7043ba0608eee532d9cb32308f8227e67238e3b9e1127e82ee2ad5949b6d881b27ef6991f100b269697b24f6db0ed9e0907da6c9a7100fdaf5bafc93b0e1996feb74d53537668c24bffa6472b4d060c41ec086bf9bff02773487d26b13bb21e8f059e8cc7edfd40b40e2770c62a9717faebf6993bba4f17c0f35aae071af131341c2dca3dae905c34b44e9581f3efe0cf89142138370172c3a54706509d41ac609a18880dab50a4b9a3b8565cda6a05e4fb3e2dd1a2438b07386b3f4786a1910dceab7bfe9341ddb202f0a5987319a2bc262fbb4c11d6ba21a0f0d7df79e69a4b16e70fe5056312f7dbbd6a47d2f51769b540f30015abacb622f7aba7ef736a1ff3a232f1c2b89bc630640e9b8119add0a095e56ee101dc39f6b21a71fd9dd2fdc710690c442bcafe813979bece8204164871180d067afa269adf0181fba9bd46b7b597617ae1798a471c7d642bdb7ca49759e5bc46e8fb8f6c463c14d3cfe96f467125a5bbabea3bc53480fb74ef3f2c178bc5aad6e153c4a7b0c507e380f0585956f2cadd6774a3470ed566e6840746f6695b9b684770b99c1ac295e50311d726b98b8c5b846152d6025305c08f6a39527734474548f66d4465baf8bca110d19145b99713547dcc685861f1b6211817806b7f2258508a10850bedbb18386ee860293898cfe0d2df53f3e7ebe9fd1955c9842e558abe6cb23ce80e01fa64715ae5cb0d1b3aa62cf38b44659b356d4fea162c2ab0eb1d496310154f2931a8ddb89a6236db19a28032fa98bf21d52fac4bdc793fed2b948150dbf0cc433cd3d75d477e67d857fda07fa66130b97cafabe11f623616dc0eae903fec30a7b94977a955eee49a9749bf7dbe777e2abb76b63d852dc6b73afeceed9a02d9f9d0399f520aebd1b183b2a2553b71ee1f3a723b24f7ee8cbd093aefeb4fcb3c8a2307776bdfd5b0ace8c22df8483b7bfb0a71419c8ddf125a7fd74f9bc9c979d65394d137ddb7d5daaf70582b5d4aaeb3a19a6b68d70c0be9f2a39b20111ebad281f5bf2ae8f514c592e3eb04d9e33225fdf90b4cd7435386f5d1b61b1de964e648b11e1d98a6f9b40b1e3ed30d2f9ac28356dc3c8552c49716e461ff004b1ff72f90cbe87e94b0e84abee18b9ed9fceacd02e07495f3fe0cd976e997315431c61759bf6bf52a774761ddc5c30f8b3a73be7d6cadf91705e649d87782a901e0965b196ee5c62d0dcb1a943234124a1dee302d85d6d62c89213561cf269c64a3f714a7087e3c43b0462158aca817a78a42882e16624ecd0abe78b5898f1ad40cdd265a16c6d70247b4948375ca1fae662c9d37284c984852182ca6bb9637b880cefb6cf6f9c32e95c9387a56369b98d18aa73c0aa96a894d98f48f6388f19200291b17294c7513e8b41f331aaf75566ef8de29e0f476bd02ae45c756f3446c53d06cd40849ec3aa6e5999d200b6e09e824ec7c2b87c7d9d8d51e04ab65f470710298ae7d3cd77407b760fd19df8fe457c128e673bb2a3e6e735d16ddde99e1117c5e0bf4570cb58d7e5afb5c1d7952f383bbc985b27dc22225ed3f117b272477e6d1e07eb623655d7ee8069475cece94f89cdbcb327ba56f5ac28788051fa199bebd7b3783482859ea07d9fc0ef2075a8e0974fb2d8fe6560dda8a35f815be280d1be2e349b900ed14c5db5b423f9ff35f1d9f1722aa48dfa58b5517cc19ce33a052a55a5c476caad528d116b8a05ff5ede5fb3cb00fa107b05faff97f21a0f64d18df5f4927c69e11cf3726cb45d7ec2308ab1b1a5e0b64c5a3bc7db375e3299306ed6cfbe0b81be19599662dc81a7372b35d7276aaf5a00ffe8bdf2ba5c37e20c4eaca718122a641a20ee41d9c091481d0f0fe9d4506187d02cbb0e5c1f78b43c76642c5dff84e578d836bff11b85a0b520a4f371b4800e0863ffa579e33a48ba69e27c2fd772a9b8c329c094e819626a50c7e4c870c6c71a4749397ee590da1d1f9fcb0e0c03efde480469df8074529113533661ee6cf9b8a42cf5c13da46b55e0461fd35f2a24764631f5641e6036b434684557e763842b331dc2da6eee2c09329257eddfcfa6eb93df832c4b968e37ac07e9decb28d0e48a12ea595156f0cb475754fbe031ac481a02b629dc4f6641289d336d13a26358dae15a157adf6c679c6556c5aca1324b9887a1a78d00af9eae9f52932210f6fa8f388892168741435b99c1893373f9d5afcecc037c9ef298da3742895abaec47ae21a87873489af54364d1159f481280c89dee9b19e12a29592392df308c08fbdcace2869a81e45e59456c121236b209b9db0f56955c23203851f746145312416d246ede1e5181c70912edf1475f24ea8e763f6016e11315d39bea6d94f75a37d93d37386a4defd48c601ef43eb74583165523de278464a2e8b6e7cb0535f4dd35ce828b278eeba1a8b0a85dd6b4c5601660356c2940d35ba6146e977dbb2446f016af87311b192bbdf5e7eae03c4a0d3bed553330e661e49f25ff65a85682a6fddd6d0bcbc846879087438c74b64bdc9b1402e8e37127a0758c399bb8c05c6f5b2b6712b0cd6b9d3570590a54206bccfccafba217a6fb44f01daaed144ad5e0a0d6c772f9b3c2702c97d5b49dde33d2b35c9aa5c7f0a5e8d3fdae59344d1a22d61d867cb2c223e5332dfad0f2c382aa8bb5feb193a7b9bb522f4354ffb943217bfe2d953b66ec520ce2ebebf600b4c3121a9ff15accc10a6b798c8850b80610ef47f75bfd85890c03b11c4444140b0a6be2cad58fb09786dfc6940eb10970f72a9ebd0c1292ef0419a58cc30d5fadb07f08dc9b1c0c228069d31667a7522dceb64e869fea64bf42e4ba15431137b2a45857b7d072933c34b206d51f7fa103137db867e756ff2283c2315c681ea9ee4a43d213116054492e76b60f1844ae93845fc5c211dd2fa8052499a44516a6204e94ccce948917063bc47f10d6155e50ad2d8df68768529360e0f434a28bdcedd0e49d9784a97522efc1a928b0571745b779a4ade0cd75193ca2ba188ad16a80663e9971021868d6919317385209eff765663f195f16864422b6ad906f1355198934d43a52018db99c1f0cef81d3dd2db69bd44358c2c1a27ee4657556d26eeba8d7136ebb6d0d6d683d12d4c004e4d4e4a6e8449c9d28a7ded976e184f0c4744d433fa9a6c0212a1b94d4e629d18501de9f13ba20a8cc7fbca12b13f5594114a135cd4f88ef76fe38e5eaa08cc1e08b95d19ee418b5f180d0a5598e1ce94b2d04a93514b04a1aff49bddd712bc71cd01c86da8a142a15e16ae57dae47eda34c798e3729b123330d28e3a221e475b409c31c712f80a9738446352e7d1aa1038ac061c8c8bfb25e3966eaf62597cc717a0197046acad8cc23de2438e8c345b64a38297b7f048ced65bb5f7036f8b208f899a87fe68279631c3609313eff6df7160b638db329fd9c2911595db4967a71aaffad7a31d5d7aa85905db49b8b50f21deb64ec2a43c56e968ea0d4b29fda4e7b76d86cb88c71ca028b4ceb3d6d3a13f0a0e18f4e00bacf0a0e207c0247ee0e93e4de239788e31b9a3982d0549974a0326c0eefd6ef78503abf681c83ce9bc25b758d5b0771c6c076ad9ddca3ee2eb6c5555d6c868a9e7c272b20ab5e6135f7b02639cd11d4fa6c5589a3f40e12918e9278043a920ddedfee5b5b76bff03b2199996d050ae3447d1ae67505da0f8863c00ac0fdd6faf832d2c2af41a011a2fe265d65268e3bbc84cb88c2cf1091b7680a51db8c0d3cc02aca665f1bfb2405702b05d6115ba21ae4e0bf2c907c0f8b83a746b00b5e3fdde02dba6ab3571f862ede40ce242140f110fc90cff3c03fd28c2002b6a5d8096ea02669258b66d0426e9fbd3ebf61fb8b19850f08cf9c5a3cda91d6037b488398b86939a1558423ddeaf884068cac9e211ee848ded9eca63852a46e1be4d3851e1b2ce9994d8440001692ba52c3c6ea28b87757750985f070eb458fd9ebf65962d0cf938b5f61fadbcb3ff8c063cf8ea0f27ab1a137719e48e51c679c9f4ebe6493c4f259a50e589b3812d7ffb7fa6cfdcfa176d09b5653d2a9bb3b0eef2f0d3dfdc2a32501cdc5a8b3546193f71a5d7048c1b5b32aaf54c98b6b69e319f96dc3f210cf8be116e609f3f1f4835a66e21485926c03ff65e7a7e03d6c46e466d463299ae7b8e9abd7d92c6cbcf9df26fc68283e66fd015b10572116715e0d4835a1b849eb8b177df7bff0b7fee829ef0deecbb6db44973549be6d7765148d3e4a8c0398df68cd7bfaa3d4568107d8a2b4cb3d6f20a63edbce0ebf83580ea038283ff16c74723c2a3c1484229d047bf52287e3f06706b8cf4690f81736b123cf5233eb3cb4cf8dc0a5632003b2593e0fe7d6105ba30531b4fcb49b61f5feb8ca65e61bf77d149677749faafbda68a6069829c77ba8a4a3b87f881c438b6bb0793960c997c7dcd39717bc753c97d4fea7cedd52a7023d022449ab2fb66128aee1e85cde217f1465c6e581a6bd9ea342d1dd7b9f1ed5f4b9caaf92ba11cf4b65208e489dd29ce16e22e6711959ce40e96ae24022a467d0825cc46efedba689fa46b95b79a11f2c115b64617e1aba386c84b13adefb0f5aa443b4d94b7270f78209875ebc0140f9d05ffc97a70e75a2e410ffcfee7d59e270b2f56360abaf61dbd516b83f466d38cd84ee4fabb3a3a0838ed2da15bd3b1ce5ff944790351d776de0d15c7085483456e56c48553c9808c084b1c75fc1488b92ed95b7f1508cba8a805ef12ab6874299c80365fad6d486bcd94f1f510a018b3bbb5feacce26209c98b88b13b678e141c9c24a2c5f48ab1141d9cb472dfb042c41f38a2ed96e9568fee7cd9e33b1b249df1b8a2e7e42ca3501a7e17873e0cc97232e8f2f892520091992e7cd91b43582e8584de578c5ac2beff5e97c00dc616f9568ba13f32aeb200be5c149ace1035b33b49c66f210fff52dcbe9f897ffc5d6be820271831868438edee46b4c160f97e9d7a652849ce92d0dbc8e83d098f4d321aadea155ed5b836b28179fe10c700be9fceb5e7b0c35599d3e1207d76c09ab7afa020825bcf1a0b54fb7fdea3bc623d051ede053a85def969aa77e345c0ecd20af3f1715b282c8d02d9cc9b6daf69962edaedf5c142bff4acadf26905af3a206efe101fae1f93fa8dcd63cb322934cfe6e706b2f2b4dd296995f3219e1438d35dac439ed89ef2817b72e86f8664830e0f15a27d9991dc5ee666c4d5688f77af75ba6381515c316afd5078e7331b7237bb109da4bfd9d9a7d055885556fd58b7c290cca0c37458f0e7c7c9d324318d494e38b00a31c27d77ffd9f4d43069da4f9e5a104c5d4ef4b04e4d013d5c6aadca0f1931f4dcef8b9f385755aad110507c20490b446e9def03902486d90cf604a54c91be78254574c860b2f5e6c81553256043e659e934196460d5bf6efd5f5f83f0aa08acbe9665bd756485cf587d05b169fe4a7941a777722bd0d4a8a442d304bf114954880defddf8f362a3fd67c03f231a9fbc4027b167e88aa4fadb1241d211a0b419b7d09a9c2bfcf2eba215124f1365d224095a27c48ba126b1e8728fb6e7c711d5dfca15d0b771f76fc943e70c7945ae6bdd472b4a5adc0a18d85f5330b0e01acac2e5d29de166f94676612642d8095746250dfa6835d11559f4132e42dfcc9aaa61c6cdb82d37437b8b0860729f1cf3eabf8412add1fcfadc8f82e304eadd83c36d47a4c7e9973d7dcc32440b331513b5bc25ea22c9eb18817f8db27b0de6a6640dd88bee47f429766c298dc1af67c135f360cdb840172f5d794bcac6e6666e6dcbaf87c691fdb1ef297ef4f407ff2a59c3f8af467dd976087bc66626adc05b26ff1caa9c52e562513fad4a16cb26bfdbb7c794d39748c4668139a726a03e2f214e430fb18882cbc9dbf3cc0b2ed3fae61fdab65cd3bad7dd940abc18478d959e0b212279f4320edbbdc1aeedf6638b9331e47bd6d90af532e4dc712abd7ab64fdbf3f69e134f9618b681d43dce90babf1197e32c8766751ecbc796402ec320e511d87ce73ccafce3543c3d6c0c42a6e15f96c2a95bb954567b60f8db4cdc65eea392a11ab9cdada6877d511542fb7369f4722d02f29b78b7194d04cd9cd9ad9f32c466a47964df6535c524198c40ce8e39bef89388f9e31baeb61d19666d1d2754e328265624eb509ee3ce92c548374af18310b8603b61df629e7fbdc80e864cd6eec3a9ce221f2e6d8dd94db54fcfd5775b98e5da1c6f66ebe275c6aaeb3b1e3902a4bbbfb0eb6536ba033bf441ec62c85cd3ea18afec92d73d811b59186f9faf5b4d3493750d3d51ac19c9ff6dde7d75fad7659fe6d366bb410584d0042b6a95607b2ce11b7acb5dfb6616ddb4cb0d865674f69c6608261889d7bfbc1112616549874b2cb94da9b3393742371ca2ca3a7e4bad59aab448623fbc7e116b977d7b4a521a228a7ff14f84ff012a6fe2a4a8e88329aee8a126b719a953ec941b7574ab7ec51e2428b6dbb870001a1deb834c4c4b373231ee26eb62b3023a54a9f291b70abaea1176790d5c69e8e699309037e5236e7a19a2236d868c75117b455a1154fb718987c5f17153749849ff3d2e3c21b9e7b2192dc305251c5bcceee102baa53566122561d9bcdec4552e4ff5484f57639e4f3c7e91dd39a895b6aa718eeea710f382dec139f3132da3571e0eb8edba8fa7b34fccf99fc73296da363adea73ee046bcce4b8b2de91feb99caccffaaccc08d186c6e12923d827234f550f62b8b8d320fe0b3f4d32a8c40f4b722c3eec208f5988b7c8905703b8b0cbb36d72648d6ba3b131d6b65d65eaee088142c1697324329a0ea8d233635de4d9e16bd451bc3446cb5546ce5bc33c4fdc15942f61d9e6fdeb1aec55d8182123dc920fabc78cd6904a96016e3627b8be4472b7b9508d3332353c68ed6fbd738f13143ba3539a026987d25ee1721b81acf70c398bba342aa47a1028638185bae66d7d56e0bb112a8760109fc436433c7cb64e995365f816fa8bc2ec7f11052fee7ceef745d01d73f4819f40c3d73ad5b0efef89d125ff20dffad3f92616b1a45f47617ab6b956815409a472c53116e01c3758af69c65a53a282d182cd78d407de92a7b211e3be7d4d4d2cb4a64853d62dba4de8b5c85fccfa0854591947b75a2e2b46b8bef6762e9e33044a5b767a4252bedfc9032e8d3a520ed4b5ccfb213a5f65c9c955eec0ddb86a9c7e85a923c08fa2e5ead47171e4561eefffd34dba82b886191bd9c05115b6e3d19fb84c90374ff97fe1bcc6cad0e46280fbe0ac0ffd7dbbe37c233b9f3381233b494de63c6702dbe741a2c8bc2583bf41755497b34ebce0f786b2eb09f6c583c44c6b6bddc3bd500385878ebd743ca1ec28926e3c37900abc619182bef963649e23fc1b1d6ca4373641b94e2f0ba4fead8a2be5640c994473de8bddb9f0d4a2c32500c87632872bfa79d715a785d890896c42ffbe4e808f0048cd8e10a1ae00a3a505681da3b949adf8511925f42abb830c86a9e6d4136931b2b662535eb89689a6781de47bf1b37ffe8af2be5cd486ac25df5981580800f5615c1ba9e2f985c672ffcaa5caf19247fc4b684a193695e4cae1eaf96aabad146c542fe6e585c6f760efd1233d2baae873315cd7b0283f61195a0553fab58b5e4b9da645d52f4cbb2bb9fb432ad96b9de5c1afc9a52bf50cb366aaef14c27f8f7c6e9c4a4a50f7529bf1a0b9fd082999f306c43d26022104c957fb523c46ca748b6d402d61a175a09641f945e08f1d88e8feb6b671436e81c8e9abf3ab24f43938512fdc8599cfd2a17c8c0390bce926b2f1ea8632c4432265690126577b8f5a0110d7d20d30e912d5af0f2f2ed10bf36d73cbdb59ca364b68f4512bdc7236aae8b7354e98ecdcfa9d8bb210bc00abff81695d63b6a7cb871f0083bdd6b60aa66f06a1ee089f372d748253b9d375802e940949bf906550cba314e0977e3f13db7aae8415514198f06606285a76d7aa431f66bea97e8535c6a17e9e3a9c068896fd12e7c497518ca6cf33a52d51003f9301b996ba48bbb23603177656485ee36fa4955f8eadf1284de067e8debf018477421d28176c0e4e30c1470088b1fd8e962abb80355004025d448343f77b4a0aad824f9aed8dd73e5c806c2c094b8a297184fbb16ebeeb0ab991a482257eb959aa6b57eef23a0500ba376e914ea0bf16913fc2281b6514ca7114ddde21e9166b66e215cc4e991977c86e716f78e3c961287e234817f62683ae15e26ca0f5c3a923e6bd18508708fb04e23f86c3e863de05a7cdaa930c1310e1e2380940010a312eb2b1d5cd2ff70a61deb5c009d505c6bb0e27673ec87f78fc48d115e6c4221bebe76ffcc3af585ba198f0236399551ac2d285708f8ab934cf91f2055f21e85a24bb4ae5ad0d22bebc1a24d1df357bc80dde503196bc8e6eaf38c376972614858cd9f1ce386f00ce809f41eacf8330ea7ad46bdc6161dcf4bcd87f09b7051b13006bfc84db0704d928c0407c6339bd7384ccbeb7c8dd08e9978b23a4a1611d0f6a166f0a7ecc768c64fa4deb8dcde6b1fac329a9b5217e45851e61808ad461a7fafb9950c8b898a39596822c5b6bd11371c06a38f5fa74ee24f1b3ec1b852f61c6e7bd04a1eb1bfd4f47ee218ea2ff9aec2b507304a20b8e810e1b4ec05ec3b69d8842b925e42616124aec8bc6eb756689ce31a5b22b43912d5db44bbeb0305da1ed14eef04261b03cd647da8ec0e42340078318061aff29771d26ffee381da3e69b5a4440b0ee3b7b29099669bf68e93c1824c7092279f0ced6c093903bcce976a648aef48e37f3610c7d669aece3f5bc725dadfe35a9bbd510dc2ab646a7f531e701718c2508a176902f6ca4b15043dcf1395cc50018b49777f930dce658a5faeac887c1f8c05e72df83af10963f08a61e637e97c698f09ec9e7cf1f35c6d5aece4603920c67fa6f8f174aca55201f0ec07e3ed4f4f833f373b1fcbeb78482b97e176dd1b5bbbd4b25266142c2f820709ff1b00b9e32bd59a52afdaa1751a7d6abb93a1b226eb36e7a03edef019d994eb8d475984b0a2dd12c507a76aa996349c3ee5727ba21f1e2a16c1530e2194fc1c7fe3ec524ec13ac759111bc9a07fbb03661d4d999b0d3650b78047d38effffd7766bb0fd2b8341319f5f81768981509c74619db0bb2437d7a382c119ca4e27b39b5db0d7c52c79e2969ad41224b3629002cf24784211eb09287a3cf4eae235c4dc8d77131d06e075567c5137d89974c7656f270de58674b31cc8c4b2baa9543884af79f1310c937852c5712fc5ded06ad5d712e599514c53f0afbc61361c738af5922391f42e19f305ff8ad3fba754ca42d4d5e28245656e698056cce6ede0963613827ba2315310fb5cadda2d274f816c10685e0fa63b5323e05d7c5b9924193376445a201b2dab6cb8c3c52686821699fccb90b15ae6664de6541dc6133f9e180f7d06de355978a3a9aecd9555691d251916d409edbc8b3c256442656484e63e72c843b9703b03202c5d53ce0bd3cff40b6fd364d2d75fbd0399f4084ccf02ca14ddcf0890274fcc4b65f4479017ce6ef38ace31554c5080da698f0547ddca6760483e62bd8344137c42e178c13fb434ad66aec33b30e5595785b083fc5edd207d63b8ff4eabe2e95f3a49ce00ba8485ce69df15fb5fcd8f2f694db992d79e6ab8ae8597739b7d8060549ee08cfb98af5be1a0453b9466d67a8bdb25fff741fd8ec1f5b1cc6b3aee0489f679317e2cfe64c5eff2caf7c330d4f076dd34c8cd52bd58f508af074ee1c96dc93d0189bbef2e82b9288ad96992d0826473bf34184b3468cb8cbfa7cb7a90219ecc8bc14453eb264670d4720950287fc7800b11aeb927dfeacdf16c3d341f75f98bc02bd6e67665f5ddcd981886d059dee42278198c500319e4f3824c35022406773b7bbda75e75c8ce5749cf712624914b4bc799ae94ccc903b362d8e8ba9f5cb5f68b250b615a020b6d4dce5dc43948b5b7513bce38dab15b7bfcf6f6b703f86c404220e398e01953b5b2a6e86833ddeefa5390c4b20c5cc831db30229d58c27438e616bd2e7bfee420997f038a5d082c6bec4cebf1cce1112c681f02b4f36b823aeac906fda339d2be2fdce77ba1008c3a6f21b991597afdff26e96dd4750460266c980ec2a02e0d323d616dc96836db183ac30ec17b72d7e614faf0baadc79603739a357bb6875873724f33b9a56b781d2b87eaa73d7dec2ae68e5bdc7d77e2109f15db36f890bfdada57bde13755762b4723ba1806a32170fa91090c584bd37b5de244199d3c2b8b02a9cefd3030cbeda5fc50a120c9dc2708a203eb32ccbf523528245be627635aa17862537edc752099a9e195b648cb36c399f3b8b4308fb76cc4b032d8552c1e3d045f1bddb4d1c497f955ef69b44cbc9cc007e267003a8fa2df5667f1b6d179d6ffffbc7ff43a12d07014d6ae688d4d27700cb4675e4016c784af2e1cca0d6c20fcfbcc60f5135a43b49640069817381579dd421bf5e2615831d48c3041c82259fc8f5fe375f365c9130be32e20ae561104d939158571727bde68f68ec004ac94cc27fcbcaaf2120389ef532770521d0c3f5871e638f696def24e74241766b237e9c15b4a8112a565cbb7ae2e4fb3845c834976f0d6fb07932e67ec62d4d0beb34e13a85245d660b28d5833ab82c0c9aa71c7c6103a620611e90e8c3e768bbbdee24800f187970f42b0956b8949f8c1c30c94a2171f6186161a67f95cc7f3afc44feb6b4647ddb034de41c1870addeedb3d63a4f7d94bfa97f1c6d6977d2350a68d7c48aaa910d54e328002e177fe3005d6cdcab673e34bb54d2a4c424e21534430e72514ae72f47ecf48cbe5a1fe0f464403961b0e85ae35ee0cdb961526599e6bd40449f1b2dcc06b6c1435f5f9ab55beb1af6324421be552311b3fe9c318187a6e0e35f0eb91c31d5b1efb66c41e7e31228350bba5f180f1b2321ea1c656443526c2bc4198b7b82ce3f88f26238a02d12f763df9e0295c00f642ee304bfbc4009364ec88c3f1d6a28341d11e8a8e6ca90fea0e28a01d2b2d133313036aaf229d0aa132919dca11b7d464df0e8f25c286e3793175b26ee31697456bee3c767a8ed5303f5dd7ade9de95a252a87303b6c6b1ce67a78d0cd8c3aa904ab831acb176077a1a0ef697e7a44283c9a95d55f99d7d878279a2e2350636ca9f9353f23fbec57b5999d51fdf7ca126a64fc29a35ee8e4685ea9bbddad2aa94e622bb0e007e6f2435792f57dd7968c5c0347a3c48780e5dfc639141e772a271a2c032d1215ed9115f6d89af63214d479002281dd42f804695cc833e30f83972ca7a44ddcb957da8c79728be87722a536ade311cf46b91be06affb7a886f8518ab29276cf2b353fff8e7df9fd7a1ce2ad8e5423ab89600aca3108376907feb4991b424dfec194423d6dd3ea371afd448d54c4640a3042d80b0d8a3f3db8fd129bd0588bd5137f38f2ef56b23c70e3ff70b5c6bb4820742d7da3eb7e2570d51a524e44a5aa5738ae53ced034d0d183e895dcb2318cef95d7d10dcc7bec7337b745e3ee6cf7c11d23d745309a6eff38c9155c50e0f6fb85e99140a1191ac2d503a087e62d3f91f76a1f9685bdf7ba302e4524923d159f999806de2b8efbaa9317f5eafcb995cfd7bea443c5bb12d12cc838912986511b3e3f9098f196388718edc25c788b5026d175dddfbb1d5335213d50891e2762172f520f80413d5faef941a1cd472ed7f66a5628be124fb46a2e327ac27a2c14e3837cbd95a9ffd6ad2022c2768d6179782cee7236ab7a16997dafbd278b2e8fc76023be801a345a14915cd5502675057ba24ec26f97ef44428ed5c212c00b2711087b13b12cde8f759b107a1c71011b1217ef08a411f28c5114f1b60aa6335bab5cfcc273d6ab92da3d0cc5144401ec333d97701f0748556a1b35683a59fd05e507b54dd3046be13ea6e61e1919cb9985dd8954149ad2298fd0fdc50ffdb21bc77c78f4726fb8bd6703a9905a395c357e4e723fc29bc72c1fbb407582c6c5e6f3a1f5e70f1d00d8d0c58f8a7f5f3bc676757eb6a02d90ebcf883852018435c33ca1d80efe1412efc7518b2fcf30c3484ed0876e45e3035807d99c76ed96fcd3a43bb549be5260e0d2d5850631048e868ecf22248306156dabbaa09208a6a06e5a4745d6b46a6b46816a001febfb484d5604f31c4a0f8626ff51b61e71a9e1fa0755477ac65650814710786ce91cb34be6d5680020f844d08a7ed1c1c9c62959f44a8220a8773c9a1322a3ff4734348cf3cd78a417d9b728ae232d02ae92a8b30e77de4b0748619df8d1ac2f66362e789d1540d2379a267215ed2ff5e45012b23438e28942899cc9fef3dc28af800c5aaf4d40c2c38f79fb16df76d2cab0a5b636cb790e8fe8f855a4c513438e82620772a86f960db20c82bd417371a0f61bd867260bff7c9d41284efcdf6ab46dee75831f3dbf33f278e4a79f73cf849132d3c38c74a932b4ed476f799f8b7d97c9d6962eed4c52ccfd117f2a555ca4e9cd83cf51251daf3665495494205e4f6c1c3390a56c8a267b552ecf2b482b5ea4b2df7d1da4f952e633f4c5db65464859ce9a9b53841bfa0febc85b081dac967dbbee03021af0a18b96cb8597ddc585f913ef0e651d6a19a72f086f33f78e6b6fbe39075d125ced026deff4b90289fb5820cafaf754bcfea5cf7ba4e1cc5920eeef765dc6f69a9ddbc408e91173717686dad3918b6292ed766465179996675d480080e1932ac33f2fb1cbb3ab885c0de2918fc8793dca75006863787cc8d459c4a01fd2e1926bdf66265320e77d81fc72ad25947a89d7ba598904c0644d19a1b3f1241049e5618fd76124c445b2cc6701823d36f3139a899328d991b4ba6fe42c26ba1acce96edd40da0b606a82f67d8064c2e4a980be6bb6fed22af59c0ff3ba87763097c41329e3d132a2fed5c7ca1ab46ced7d2307da4dbc4fe9525a81f08a0054de53a86ceb4e88f5ff684dba59c47489b75525ecf06a887b99eeda459a229da5ba851681322c4ca890ea30c7f3e1cbc475fccd870601ca53bb8d0dc3356f58bcf726adeb646763cd74fd43cac640b7cb8a78b89d3f9122c167be75fea616ead45e0fef54516332d87e77ef64448f00167bb8d790b91182bb0991be7c9383b73bd7a739a997a19bc4c97098628849b35f18b8c738b37aff0f72eb95dde6cad9f09a00234d7ff0bdb54f800041297332620a23d028f384760cb0f799c134aaf9bdf1d65a538e013fa81a9dd2b8b5e19deb51b35177436eedc187db5fee48829ee4076dc1eb27dc1a0dda5709686d0ed01661b777f960cb6609c7982146257bb0738ca565113c81a2a3573c71e759c12daf266305a2924a873d89a8b73e9fa8f7be0772e0e879680a55676b9712ec05268ec64e19cefc4583acf1d384064acde025fdd697f72d5d41827f7e119cadac491688cecf5733b8ed56d833e46a9073b871eaa39c06dbffd5c46d706c46dc51706d573b61968460730a48a6f927fc760f01b67eec63571ec36b89aef33852ead622dd4ed1eabbda86fadef0f1c7de749a21324f2ad84bc11b5b455f0b7aa7640d127e2b9b359ae981f82afbd5d1d9fd1f52fd9524c0e5e19a05b4fb0ebb91ffa186e37589af73aa8334093a74fbd8bceae2c4d2600b38a6f1ac6853d06565e432a94c96ab06ec18d078aad7084b352f9dde19b71f00944edde8ad13d443ed561b294607e43feb5f9852c8be18f09a95c4d190c52ff040bbd1f8b515806bec51207fcf2f807f99cc6adecbfb96a063ae8de6b551399337b05ce6da6d8e8e7cb9e0594c5016a60da0b5400e3b6c549d3fed30c3979f8234f8f5ee3b8f64a3f5b22939c89c30e41fe9bffd56eb6223e27a25c1c0fb57cad2054f9ed9798ad4d475ef2d70b32927b9019d5bc00d9a1a210cbd17beb1bb3b01aaf70ee7dda4ed187d52602d5a97dc1380a2ca5cd5e257d80ba5f4d4f25c667da62c6bac2305e4df04e02bc3a712f8ac8b6a92aeeb8e7f6acb9ee46b5d962188b753def111ab7eaceb65f31e478116637469372307dc642371a22d6385349132b9312b1e22471f19db7661f949a99fd890e79b5820bb944e04aafde006cf39bf5cef42445928908d8409c9ae1b881df77e243fd40acc58a9c67c15043357f166203a7e2c9237f9d2aa6e141fcd5c7d133ba1629fc4ac63dc89e0ed0327232d53d5a9932ce0823ecd460c07ad6ce46e173c844a02777e84530b705fa085427f15d66ef5150af2ba6089a7ac45bc09ba9d74fcd462dee7b93580fce8b85d1f20f8206f6ed30f705891f11758e5a3e99cbf5ad3b708f43bf5e9a0f006c0a64fa8127fe00896915e997c2a04f196b3a52d293fd4c5c8c631eee47063de90589ba7806655f65f34b1bceeb9b5f9afe939fb14ec3a97d5691b85fc8f699e6076d10a732940537424ca009c4155130d591a802fa2951f08d2431c38402347badede9f48cccbcf3024d34f4064bb031be6212b405d5e8c86f9be71bea871800ebb2fd7a67b5208dc5f6c58e5d047acd161b8ef5e887a6b20e829332627e57f69663dd224c0b1448042df2cb0cd4486462c7c39dcfff9dd64749a3f7fd54773d85208b1937197416bbf7666acdab18e6175de63ac571764d493e006c47735b57e77d98bf279193764eb8a3dadb5f289bc04910dfe3054f7e4b01c191e9c560fafd225c71af105d46185805d33efa25a294affe51664713c25a5d1990496f57a25f95dc5e4e857e24e0fd84ba7fb9a79a2058dc821a357d5c076df1da2940b1c84dd1a9ef70aaea1e6bf34fde4591b143d54232092a4c639c2165ebc26a06354c4a96cba6e5e904b17b9477c87ae1f6f1796b740d7e2ed889fdd38a3e6e143bc1be343c452ec82eafbd7db5683c7a4e89fd36c393beacb6c5b5312e57823303279b2a8db8feaba529d0ac178ff44c9a5bf6605d015b7b6c671b5f71bc3fcca8fe6bc7db77a5dcf83831ceffdfd46d26a3befab35b3ccbbcad9c09aa365d574bd4bd14521ba4b16f088c15a7870e079b9ea91ee43960142c323f0f8cd12052649127f4c0fa1f4ec843dabc5fdd318e8d9dcd9106c327934b1cd551acaf2f5145517f6005fc1b255f972428cb2eea014eb49717016a3d600a61391e103d244088931cd05b1052349a21ee0e029f8d024c5614abb3f17a8dc5494c0c708415f1091df9029335e5c4b7b9b9b90dbb4d666d878d3383cef6027c7b6c50a42c2226e7ff30402941f64bd641c71f23d96dd297bd2635b773d93813b4e844e1a456a078d7631f4fca0868ebfb82e03c8b24c5f5396007347ad6db09cd0122683e247258991fe2efa6e9279c5727340aa777e0353c31e486f9bc8dcf6e743e4002f94fc63e816cc7a0f22e74fefbea5ae9fd6c1bcca8792b764a42aa648e9df634e799dd922880e9fbb24ff590b483f6d5004e64f7d27f146abe0fcb15d2c608cb6ca22ee20823e2e6be153981baa590836b43220b0aaba31ccca06eae64d72b4a851da235cba9b2bf1f8587c6af4e13b5155ed34e073181525ec6a127520ae8dfac8d89a1fe2543a188d5ab33d916de3f30215e6ded9a57ce3cff64d90c29b0cb0bedc4deb9a9ca7d806664a8fce7d88943c4e1f2dbb21078dfbf45f4b0cd4b8278079873acb3aad7e08620aed1e0dffa4a818b7d66dfcfd75d8ad7e6d8d992c7f4c4912c7c45352d1e2e9c8e0fa3a3aa993d0f0012f78ec7dae96c20d3b41538f38c2ed53f8cdc2b8903ec66832f4a281c58a96ae6ffee92c25075ea0e76c8f83b30e7b521dbdb726f922df947f77822610a147ff6aeeabd6d87fa04fb56f87ff5a6bda253afa7d5ee50c76a9fd2885976338d3ab2815b7ac0db7b56a874729751b269c6a70c51c65ab754e0ac1a2cbfda42a74d9a9162d842b1bb1fa4ba8ba8d0606f7ec59baca4cfa4eb5c8f69b06960f002ed88b52a78316d859664946366edcddc99884ffa615b639a06dcd0e7b0d11c6e85440504598fa94bd3a3ab22e67bc6fbc1681168c2cfb2ac5ea338dbeae6c7b19498c040e41484e3a62555e2707ceee6c2da590b6af20e88c497ac264cd5cd25ed9fa82296fe11616ab9c9dfa636d4a97f99fd35f5522a23375e84403fdefcc8ccbd23da12dc56c7458d6508ed43050170cbd7a6068c6ea9778272ac71d6cf9c2fe2fa5dcd13a854dbd22cede25274c70bb5ca5499aaba96ceea5655404fcd2fc1abdc7b6df29e592458e9e64f2eb95807b4e1397f4ee96abe15bd072678f68d7f75f4d146d4fb5923bd396b91f8777974f80916b62cac0f4c46d8a12cdf0e29b7ebe372fcd18dd8dae10a14f2f2ab72167479c09bb605ecf6ddf6b798d314f702693c0981e73553828306fa0f935c1017e6cd3fd8c0bd98abccb73a4ddcf95c3b39157a6161ea06d542e35875f4e151bc5a7f2e7b940673137b54ec96f1c7a1e39131cdc798b587ed9d5cf7e5dcaea7cac0a46dc972a518347abab98a3b4a431b0e920551ef8798d85ae5349e8fe3f96aa7549a4890bfc02e73d62b104d5388a7660ccf96c17bd7206c3dd32e73bbf7d043c91ec9a95e47604e5fc09590fab23401627ebcebb61657bece8f3795637fc4917383cf12dfc2312055ce8f60e60b2e336a679ccab42d2f8a923dc0ae463b662b872824fbc8af16f383a95f9256f00c14daeb0132e65b62ff3c72de2fb089aa2b8e6910af6deed58d63cae9f0cde33187554bd4c3d22ac2617175fe3ebc4d03a2d49ecfc0e108b4737e824c013e349a5efd74e2df18e9c7862cc81a94f1a65aefa6aabed4c2bad8016d3bd60fb2ce8eaf7338f1e3b0359796b44ecf78f7f68302b5eeb50728447a40cea2f864d728dc4fc1d3d18f947b9fd5a41325bfdfb3f3dc8d7d11fc766785a1d146ccd902b2a770be031992dddfbdeee86997d26578143e462a9133e8e736fd8a47e5bbe9d3a60687ccaaf348a23a788a764aefa67ab0bf9bf50a12dfe7ab8676983f0f937a48db3fc763b17685d58995a1eb515714c79fcb3ceb599ff5e47691210eb29edbdec461948e7e6c888b5a5932ba38ca9eb8805c74d3bf5a05395dedba6ddb787567af7d0895c2a6f1632307bbffde4f422749bd6d0116d843e4a1d04ece6a7fe8456c5a639da245b8ae5614d9d5255c528fa9d144ba18f36ae58ccbce4b35cb954645af0af6fe625a975dc6df65f9576242bf8b531cfe1f5bc72e324d2e5a5c41b871d3bac27d78755c66994e5d0faa40e602f4f872132b1ff216067dd3bac07bd677d33193da54fd5b1ab22cfb0548257eb2ecf898a85ccb9bc4c12657c8d3c846c6f3005c8ba5cdf493a3cc06c1fcea5a30fb2bfafc099252c230a2be765addd41370709dde909e7758c547dba1f84e1cf5f5af2fd798fbbc05b081cc6a13a8a05f6cf1f6242d441a63c9fad3c3f5e1ff9840000e8fb9a68cbf403296a574359161fa18e84f69f9599e54227f9cade63ee73099d5b68211f136c8c02a43102292a82b63a5a2b8fcecf9c34c28b81e5282bd08c82d7ce4eefee84015a9a248ca051cc8a2370ed948fc3cd1bcbf7a0ed3c7604d603ee803ac87516c73691d27cb9a9d1a52e8e011ea9932baebe28097dc55c7cd819267474523c032a9ce23b869b19e4c046db9819c76b8521b4149467f6bdff3de039cc14d3476248e86835ca13465133e57e379cb53bb499e0cd1ba9751188853dd4f5e5a63f271af98f0ad2d2b1955223bb6fd94c1bde8af80173c7a801d0c3795d9f5b87ea65944f1d23123a12fd22a1812973daba2c01cae59b16fe9a7a1190420b40ed487f8d2e1838bf401fcc8097c4712327280f711af1e8829ba9559ce5fd6230961d7a356fd388d86a0c69959ea3984b1c44e6beed8498b3ecfe02370af4570c124b520c2a0234b8f45d2afb981d5a0cfe7e621d0abc80abb0f473557a2a7488e5c74f97474d148dff81b6ef2a933fa1c20d1651540e137416f5caa441beeca2c7e857522a4a023fa434dba53031b60866c488f9208809060eca9c2697babc5aa8176507b14b2c1ba92412c286c8557d9b02cca69251c608d144bbae5692f707bcd5981ac4fccf56eeac3734432d7dfec29849336dabd4ad67319c83f719a8f345e3efeab98af4f31f5c8a882850818ca7ed3df0bf558c41c72c2121eb5b17d3232333faca89e4d759ba64c096e9fbb3e9b84e2ed1bee62698097299ce7fa814698905575e998e4e93bd5c544b4d0f17a33c25d719e19549a5a50ce356ac4322ba3154af7eee17dd4e267fb366725c3855b45012ab30e721f94b6612094ce0b984d1c4b64","isRememberEnabled":true,"rememberDurationInDays":0,"staticryptSaltUniqueVariableName":"35242ef06e67bdd028e1664218e90703"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
